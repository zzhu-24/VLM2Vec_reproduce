==> Environment
Python: /home/infres/zzhu-24/anaconda3/envs/vlm2vec/bin/python
Version: Python 3.10.18

/home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/12Nov_repro-Qwen/Qwen2-VL-2B-Instruct
CUDA_VISIBLE_DEVICES=0,1 torchrun --nproc_per_node=2 --master_port=2207 --max_restarts=0 train.py --lora --lora_r 16 --model_name Qwen/Qwen2-VL-2B-Instruct --bf16 --pooling eos --normalize True --temperature 0.02 --dataloader_num_workers 1 --dataset_config /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/train/retrieval.yaml --data_basedir /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/data/vlm2vec_train/MMEB-train --run_name 12Nov_repro-Qwen/Qwen2-VL-2B-Instruct --output_dir /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/12Nov_repro-Qwen/Qwen2-VL-2B-Instruct --grad_cache True --per_device_train_batch_size 16 --gc_q_chunk_size 8 --gc_p_chunk_size 8 --interleave_batch_size 0 --lr_scheduler_type linear --learning_rate 1e-5 --max_steps 6000 --warmup_steps 100 --save_steps 500 --logging_steps 1 --save_safetensors True --remove_unused_columns False --resume_from auto --report_to wandb 2>&1 | tee /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/12Nov_repro-Qwen/Qwen2-VL-2B-Instruct/train.log
W1113 01:30:33.664000 136011574994752 torch/distributed/run.py:779] 
W1113 01:30:33.664000 136011574994752 torch/distributed/run.py:779] *****************************************
W1113 01:30:33.664000 136011574994752 torch/distributed/run.py:779] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1113 01:30:33.664000 136011574994752 torch/distributed/run.py:779] *****************************************
/home/infres/zzhu-24/anaconda3/envs/vlm2vec/lib/python3.10/site-packages/requests/__init__.py:86: RequestsDependencyWarning: Unable to find acceptable character detection dependency (chardet or charset_normalizer).
  warnings.warn(
/home/infres/zzhu-24/anaconda3/envs/vlm2vec/lib/python3.10/site-packages/requests/__init__.py:86: RequestsDependencyWarning: Unable to find acceptable character detection dependency (chardet or charset_normalizer).
  warnings.warn(
/home/infres/zzhu-24/anaconda3/envs/vlm2vec/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/infres/zzhu-24/anaconda3/envs/vlm2vec/lib/python3.10/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
DropoutAddRMSNorm of flash_attn is not installed!!!DropoutAddRMSNorm of flash_attn is not installed!!!

/home/infres/zzhu-24/PRIM/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
/home/infres/zzhu-24/PRIM/VLM2Vec/src/model/baseline_backbone/internvideo2/modeling_internvideo2.py:539: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @torch.cuda.amp.autocast(enabled=False)
Distributed init debug info:
RANK: 0
LOCAL_RANK: 0
WORLD_SIZE: 2
MASTER_ADDR: 127.0.0.1
MASTER_PORT: 2207
torch.distributed.is_initialized: True
torch.distributed.get_rank(): 0
torch.distributed.get_world_size(): 2
[2025-11-13 01:30:41,513] INFO [src.utils:10] rank0: init wandb
Distributed init debug info:
RANK: 1
LOCAL_RANK: 1
WORLD_SIZE: 2
MASTER_ADDR: 127.0.0.1
MASTER_PORT: 2207
torch.distributed.is_initialized: True
torch.distributed.get_rank(): 1
torch.distributed.get_world_size(): 2
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
wandb: Currently logged in as: zhuzhehua16 (zhuzhehua16-t-l-com-paris) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.69it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 10.93it/s]
wandb: setting up run j5ydza8p
wandb: Tracking run with wandb version 0.22.1
wandb: Run data is saved locally in /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/12Nov_repro-Qwen/Qwen2-VL-2B-Instruct/wandb/run-20251113_013041-j5ydza8p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 12Nov_repro-Qwen/Qwen2-VL-2B-Instruct
wandb: â­ï¸ View project at https://wandb.ai/zhuzhehua16-t-l-com-paris/vlm2vec_train
wandb: ðŸš€ View run at https://wandb.ai/zhuzhehua16-t-l-com-paris/vlm2vec_train/runs/j5ydza8p
[2025-11-13 01:30:43,015] INFO [src.utils:19] Loading backbone [qwen2_vl] from Qwen/Qwen2-VL-2B-Instruct
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  5.89it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 11.22it/s]
[2025-11-13 01:30:43,630] INFO [src.utils:19] Loading lora adapter from Qwen2VLForConditionalGeneration(
  (visual): Qwen2VisionTransformerPretrainedModel(
    (patch_embed): PatchEmbed(
      (proj): Conv3d(3, 1280, kernel_size=(2, 14, 14), stride=(2, 14, 14), bias=False)
    )
    (rotary_pos_emb): VisionRotaryEmbedding()
    (blocks): ModuleList(
      (0-31): 32 x Qwen2VLVisionBlock(
        (norm1): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
        (norm2): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
        (attn): VisionFlashAttention2(
          (qkv): Linear(in_features=1280, out_features=3840, bias=True)
          (proj): Linear(in_features=1280, out_features=1280, bias=True)
        )
        (mlp): VisionMlp(
          (fc1): Linear(in_features=1280, out_features=5120, bias=True)
          (act): QuickGELUActivation()
          (fc2): Linear(in_features=5120, out_features=1280, bias=True)
        )
      )
    )
    (merger): PatchMerger(
      (ln_q): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
      (mlp): Sequential(
        (0): Linear(in_features=5120, out_features=5120, bias=True)
        (1): GELU(approximate='none')
        (2): Linear(in_features=5120, out_features=1536, bias=True)
      )
    )
  )
  (model): Qwen2VLModel(
    (embed_tokens): Embedding(151936, 1536)
    (layers): ModuleList(
      (0-27): 28 x Qwen2VLDecoderLayer(
        (self_attn): Qwen2VLFlashAttention2(
          (q_proj): Linear(in_features=1536, out_features=1536, bias=True)
          (k_proj): Linear(in_features=1536, out_features=256, bias=True)
          (v_proj): Linear(in_features=1536, out_features=256, bias=True)
          (o_proj): Linear(in_features=1536, out_features=1536, bias=False)
          (rotary_emb): Qwen2VLRotaryEmbedding()
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=1536, out_features=8960, bias=False)
          (up_proj): Linear(in_features=1536, out_features=8960, bias=False)
          (down_proj): Linear(in_features=8960, out_features=1536, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((1536,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((1536,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((1536,), eps=1e-06)
    (rotary_emb): Qwen2VLRotaryEmbedding()
  )
  (lm_head): Linear(in_features=1536, out_features=151936, bias=False)
)
[2025-11-13 01:30:49,794] INFO [src.utils:10] rank1: model_backbone: qwen2_vl
[2025-11-13 01:30:51,010] INFO [src.utils:10] rank0: model_backbone: qwen2_vl
[2025-11-13 01:30:51,011] INFO [src.utils:19] Loading processor from: Qwen/Qwen2-VL-2B-Instruct
[2025-11-13 01:30:54,741] INFO [src.utils:19] Loaded mmeb/MSCOCO_t2i dataset with 100000 samples
[2025-11-13 01:30:54,742] INFO [src.utils:19] 		Dataset#0 (dataset_parser=mmeb): MSCOCO_t2i, num_rows=100000, prob=50.0
[2025-11-13 01:30:55,597] INFO [src.utils:19] Loaded mmeb/MSCOCO_i2t dataset with 113287 samples
[2025-11-13 01:30:55,598] INFO [src.utils:19] 		Dataset#1 (dataset_parser=mmeb): MSCOCO_i2t, num_rows=113287, prob=50.0
[2025-11-13 01:30:55,598] INFO [src.utils:19] 
Initializing interleave datasets:
		world_size=2
		total num rows=213287
		global batch size=32
		estimated num step per epoch=6665.21875
		interleave_batch_size=0.0
[2025-11-13 01:30:55,599] INFO [src.utils:19] ==================================================
[2025-11-13 01:30:55,599] INFO [src.utils:19] Print the features of each dataset, make sure that all datasets have valid features.
[2025-11-13 01:30:55,600] INFO [src.utils:19] 		Dataset 0 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name']
[2025-11-13 01:30:55,600] INFO [src.utils:19] 		Dataset 1 features: ['query_text', 'query_image', 'pos_text', 'pos_image', 'neg_text', 'neg_image', 'global_dataset_name']
[2025-11-13 01:30:55,601] INFO [src.utils:19] ==================================================
[2025-11-13 01:30:57,534] INFO [src.trainer:350] ***** Running training *****
[2025-11-13 01:30:57,534] INFO [src.trainer:350] ***** Running training *****
[2025-11-13 01:30:57,534] INFO [src.trainer:351]   Num examples = 192,000
[2025-11-13 01:30:57,534] INFO [src.trainer:352]   Num Epochs = 9,223,372,036,854,775,807
[2025-11-13 01:30:57,534] INFO [src.trainer:353]   Instantaneous batch size per device = 16
[2025-11-13 01:30:57,534] INFO [src.trainer:356]   Total train batch size (w. parallel, distributed & accumulation) = 32
[2025-11-13 01:30:57,534] INFO [src.trainer:357]   Gradient Accumulation steps = 1
[2025-11-13 01:30:57,534] INFO [src.trainer:358]   Total optimization steps = 6,000
[2025-11-13 01:30:57,534] INFO [src.trainer:351]   Num examples = 192,000
[2025-11-13 01:30:57,535] INFO [src.trainer:352]   Num Epochs = 9,223,372,036,854,775,807
[2025-11-13 01:30:57,535] INFO [src.trainer:353]   Instantaneous batch size per device = 16
[2025-11-13 01:30:57,535] INFO [src.trainer:356]   Total train batch size (w. parallel, distributed & accumulation) = 32
[2025-11-13 01:30:57,536] INFO [src.trainer:357]   Gradient Accumulation steps = 1
[2025-11-13 01:30:57,536] INFO [src.trainer:358]   Total optimization steps = 6,000
[2025-11-13 01:30:57,540] INFO [src.trainer:359]   Number of trainable parameters = 9,203,712
[2025-11-13 01:30:57,541] INFO [src.trainer:359]   Number of trainable parameters = 9,203,712
[2025-11-13 01:30:57,545] INFO [src.trainer:360]   Trainable Parameters = ['module.encoder.base_model.model.model.layers.0.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.mlp.down_proj.lora_magnitude_vector.default.weight']
[2025-11-13 01:30:57,546] INFO [src.trainer:360]   Trainable Parameters = ['module.encoder.base_model.model.model.layers.0.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.0.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.0.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.0.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.1.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.1.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.1.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.2.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.2.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.2.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.3.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.3.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.3.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.4.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.4.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.4.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.5.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.5.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.5.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.6.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.6.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.6.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.7.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.7.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.7.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.8.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.8.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.8.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.9.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.9.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.9.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.10.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.10.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.10.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.11.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.11.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.11.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.12.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.12.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.12.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.13.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.13.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.13.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.14.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.14.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.14.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.15.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.15.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.15.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.16.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.16.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.16.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.17.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.17.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.17.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.18.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.18.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.18.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.19.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.19.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.19.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.20.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.20.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.20.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.21.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.21.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.21.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.22.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.22.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.22.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.23.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.23.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.23.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.24.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.24.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.24.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.25.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.25.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.25.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.26.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.26.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.26.mlp.down_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.q_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.q_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.q_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.k_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.k_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.k_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.v_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.v_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.v_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.o_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.o_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.self_attn.o_proj.lora_magnitude_vector.default.weight', 'module.encoder.base_model.model.model.layers.27.mlp.down_proj.lora_A.default.weight', 'module.encoder.base_model.model.model.layers.27.mlp.down_proj.lora_B.default.weight', 'module.encoder.base_model.model.model.layers.27.mlp.down_proj.lora_magnitude_vector.default.weight']
  0%|          | 0/6000 [00:00<?, ?it/s]You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
[2025-11-13 01:30:58,383] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   6303,  26148,    624],
        ...,
        [151643, 151643, 151643,  ...,  19507,   1809,    624],
        [151643, 151643, 151643,  ...,    279,   5473,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A simply decorated room is shown with a blue couch.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The two woman are walking side by side in the road holding umbrellas to shield themselves from the rain.\n', 'Find me an everyday image that matches the given caption: A man riding a horse in front of a crowd while holding a gun.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The scene is set with a big sky and high grass, in which stands a number of young women, striking athletic poses, many dressed similarly, and holding baseball equipment.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Young boy showing happy emotion during baseball game.\n', 'Find me an everyday image that matches the given caption: Tennis partners having a discussion on the court.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272F26530>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272F260E0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272F27670>], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272F26AD0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272F273D0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272F27730>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272F277C0>], [<PIL.Image.Image image mode=RGB size=256x380 at 0x7F3272F27430>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272F27640>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272F26C20>]], 'pixel_values': [array([[-1.7922626, -1.7630657, -1.6900735, ..., -1.0962781, -1.0962781,
        -1.0962781],
       [-1.7192703, -1.7192703, -1.704672 , ..., -1.067838 , -1.067838 ,
        -1.067838 ],
       [-1.704672 , -1.500294 , -1.4856956, ..., -1.0536178, -1.0536178,
        -1.0536178],
       ...,
       [-1.704672 , -1.704672 , -1.704672 , ..., -1.4659997, -1.4659997,
        -1.3806794],
       [-1.3543098, -1.2375224, -1.1499318, ..., -1.4802198, -1.4659997,
        -1.309579 ],
       [-1.3543098, -1.0039475, -1.3105145, ..., -1.4802198, -1.4802198,
        -1.309579 ]], dtype=float32), array([[-1.6900735, -1.6900735, -1.6900735, ..., -1.3806794, -1.3806794,
        -1.3806794],
       [-1.6462783, -1.6462783, -1.6462783, ..., -1.3522393, -1.3522393,
        -1.3522393],
       [-1.6316798, -1.6462783, -1.6462783, ..., -1.3806794, -1.3806794,
        -1.3806794],
       ...,
       [-1.4710971, -1.4564987, -1.4564987, ..., -1.1958185, -1.1815984,
        -1.1531583],
       [-1.500294 , -1.5148925, -1.5148925, ..., -1.1531583, -1.0962781,
        -1.1247182],
       [-1.3689082, -1.4419003, -1.5148925, ..., -1.2384787, -1.2384787,
        -1.2526988]], dtype=float32), None, array([[ 1.9303361,  1.9303361,  1.8427455, ..., -1.2100385, -1.4659997,
        -1.4802198],
       [-1.6462783, -1.6462783, -1.6462783, ..., -1.4375596, -1.4375596,
        -1.4375596],
       [ 1.9011393,  1.9303361,  1.9303361, ..., -0.9967375, -1.1247182,
        -1.4091195],
       ...,
       [-0.9893491, -0.9893491, -1.018546 , ..., -1.3948994, -1.3948994,
        -1.3380191],
       [-1.7338688, -1.7338688, -1.7484672, ..., -1.3806794, -1.3522393,
        -1.2953589],
       [-1.7338688, -1.7192703, -1.7338688, ..., -1.2811389, -1.2953589,
        -1.2953589]], dtype=float32), None, None, array([[1.1420212 , 1.1566195 , 1.171218  , ..., 0.8376511 , 0.8376511 ,
        0.8376511 ],
       [1.1566195 , 1.1128243 , 1.098226  , ..., 0.80921096, 0.80921096,
        0.80921096],
       [1.0106354 , 1.0106354 , 1.0106354 , ..., 0.88031125, 0.88031125,
        0.88031125],
       ...,
       [0.6018794 , 0.6018794 , 0.6456747 , ..., 0.5532498 , 0.56746984,
        0.56746984],
       [0.9230448 , 0.9084464 , 0.9084464 , ..., 0.56746984, 0.59590995,
        0.61013   ],
       [0.9084464 , 0.89384794, 0.8792495 , ..., 0.51058954, 0.4963695 ,
        0.46792936]], dtype=float32), None, array([[ 1.2880055 ,  1.3026038 ,  1.3318007 , ...,  1.690855  ,
         1.2073728 ,  1.2358129 ],
       [ 1.6091708 ,  1.9303361 ,  1.8135487 , ...,  0.93719155,
         0.9940718 ,  0.823431  ],
       [ 1.2880055 ,  1.2442101 ,  1.3609976 , ...,  0.90875137,
         0.90875137,  1.2784731 ],
       ...,
       [-0.7557742 , -0.7557742 , -0.72657734, ..., -0.32839438,
        -0.2857342 , -0.243074  ],
       [-0.4638057 , -0.5221994 , -0.5805931 , ..., -0.2857342 ,
        -0.2857342 , -0.2857342 ],
       [-0.8579632 , -0.82876635, -0.82876635, ..., -0.243074  ,
        -0.2857342 , -0.29995427]], dtype=float32), array([[-0.33241987, -0.20103405, -0.08424664, ..., -0.39949474,
        -0.34261447, -0.243074  ],
       [ 0.10553299,  0.03254076, -0.01125452, ..., -0.31417432,
        -0.18619375, -0.05821316],
       [-0.303223  , -0.24482933, -0.14264035, ..., -0.3710546 ,
        -0.34261447, -0.2857342 ],
       ...,
       [ 0.33910778,  0.32450938,  0.29531252, ..., -0.7692165 ,
        -0.78343654, -0.81187665],
       [ 0.42669836,  0.41209993,  0.41209993, ..., -0.49903518,
        -0.58435565, -0.6270158 ],
       [ 0.41209993,  0.41209993,  0.38290307, ..., -0.6412359 ,
        -0.669676  , -0.6981161 ]], dtype=float32), array([[-0.42001042, -0.42001042, -0.405412  , ...,  0.21196808,
         0.21196808,  0.22618815],
       [-0.3470183 , -0.31782144, -0.25942776, ...,  0.22618815,
         0.22618815,  0.22618815],
       [-0.405412  , -0.39081356, -0.37621516, ...,  0.33994877,
         0.36838892,  0.36838892],
       ...,
       [-0.2740262 , -0.37621516, -0.33241987, ..., -1.4802198 ,
        -1.4659997 , -1.3380191 ],
       [-0.2302309 , -0.06964822, -0.04045137, ..., -1.2242587 ,
        -1.2384787 , -1.2811389 ],
       [ 0.09093457, -0.15723877, -0.06964822, ..., -1.3664593 ,
        -1.2384787 , -1.1815984 ]], dtype=float32), array([[ 0.77706057,  0.77706057,  0.77706057, ...,  0.9798517 ,
         0.9798517 ,  0.9798517 ],
       [ 0.7478637 ,  0.7332653 ,  0.68947   , ...,  0.9514116 ,
         0.9514116 ,  0.9514116 ],
       [ 0.791659  ,  0.791659  ,  0.791659  , ...,  0.9514116 ,
         0.9514116 ,  0.9514116 ],
       ...,
       [-1.6900735 , -1.6170814 , -1.5732862 , ..., -1.3664593 ,
        -1.3522393 , -1.3237991 ],
       [-1.3397113 , -1.2959161 , -1.2375224 , ..., -1.4375596 ,
        -1.4659997 , -1.4802198 ],
       [-1.7192703 , -1.7338688 , -1.704672  , ..., -1.3380191 ,
        -1.3664593 , -1.3380191 ]], dtype=float32), array([[ 0.13472985,  0.16392669,  0.19312355, ..., -0.9967375 ,
        -1.309579  , -1.4517797 ],
       [-1.1645303 , -1.0331444 ,  0.42669836, ...,  1.3211333 ,
         1.3495734 ,  1.3353534 ],
       [ 0.10553299,  0.10553299,  0.13472985, ..., -0.96829736,
        -0.96829736, -1.1104981 ],
       ...,
       [-0.59519154, -0.5805931 , -0.59519154, ..., -0.7692165 ,
        -0.7976566 , -0.8545369 ],
       [-0.405412  , -0.5221994 , -0.60978997, ..., -1.309579  ,
        -1.0536178 , -0.86875695],
       [-0.20103405, -0.02585294,  0.04713918, ..., -0.9256371 ,
        -0.9256371 , -0.91141707]], dtype=float32), None, None, array([[ 1.1128243 ,  1.098226  ,  1.0836275 , ...,  1.4348938 ,
         1.4348938 ,  1.4206737 ],
       [ 1.098226  ,  1.1274228 ,  1.1420212 , ...,  1.477554  ,
         1.5059941 ,  1.5202142 ],
       [ 1.2296118 ,  1.2296118 ,  1.2150133 , ...,  1.4917741 ,
         1.5059941 ,  1.5059941 ],
       ...,
       [-0.88716006, -0.8579632 , -0.7703726 , ..., -1.3380191 ,
        -1.3380191 , -1.4233395 ],
       [-1.3397113 , -1.5878845 , -1.5732862 , ..., -1.3237991 ,
        -1.2953589 , -1.2953589 ],
       [-1.7922626 , -1.500294  , -0.72657734, ..., -1.2384787 ,
        -1.1815984 , -1.2242587 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 28, 18]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A simply decorated room is shown with a blue couch.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The two woman are walking side by side in the road holding umbrellas to shield themselves from the rain.\n', 'Find me an everyday image that matches the given caption: A man riding a horse in front of a crowd while holding a gun.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The scene is set with a big sky and high grass, in which stands a number of young women, striking athletic poses, many dressed similarly, and holding baseball equipment.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Young boy showing happy emotion during baseball game.\n', 'Find me an everyday image that matches the given caption: Tennis partners having a discussion on the court.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
[rank0]:[W1113 01:31:00.829379267 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank1]:[W1113 01:31:00.841054973 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
  0%|          | 1/6000 [00:03<5:46:31,  3.47s/it]                                                  {'loss': 20.6075, 'grad_norm': 1416.0572509765625, 'learning_rate': 1.0000000000000001e-07, 'epoch': 0.0}
  0%|          | 1/6000 [00:03<5:46:31,  3.47s/it][2025-11-13 01:31:01,044] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   2518,  13647,    624],
        [151643, 151643, 151643,  ...,  39192,   6461,    624],
        [151643, 151643, 151643,  ...,    279,   2114,    624],
        ...,
        [151643, 151643, 151643,  ...,  13955,    261,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A toilet and a handicap sign with red pipe.\n', 'Find me an everyday image that matches the given caption: A man in glasses is standing next to a girl holding a Wii controller.\n', 'Find me an everyday image that matches the given caption: A child is riding a skateboard inside the home.\n', 'Find me an everyday image that matches the given caption: A train on the tracks under a bridge.\n', 'Find me an everyday image that matches the given caption: A man with a suitcase on a beach looking at the ship in the ocean.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man and woman stand next to each other holding video game remotes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The boat is navigating through the urban area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bathroom in the orocess of being remodeled.\n', "Find me an everyday image that matches the given caption: A woman blow drying another woman's hair with a pink hair dyer.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FACEB0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FACEE0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FACF40>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272FAD450>], [<PIL.Image.Image image mode=RGB size=256x400 at 0x7F3272FAD480>], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272FAD4B0>], [<PIL.Image.Image image mode=RGB size=256x261 at 0x7F3272FAD4E0>]], 'pixel_values': [None, None, None, None, None, array([[ 0.0617376 ,  0.20772196,  0.54348576, ...,  1.4348938 ,
         1.1504925 ,  1.022512  ],
       [ 0.29531252,  0.17852512, -0.0550498 , ...,  0.33994877,
         0.29728848,  0.3257286 ],
       [ 0.791659  ,  0.71866685,  0.48509204, ...,  0.28306842,
         0.36838892,  0.29728848],
       ...,
       [ 1.0398322 ,  1.1566195 ,  1.2442101 , ...,  0.4537093 ,
         0.4537093 ,  0.43948925],
       [ 1.0252337 ,  1.0398322 ,  1.1128243 , ...,  0.8376511 ,
         0.8376511 ,  0.7949909 ],
       [ 1.2004149 ,  1.2296118 ,  1.2442101 , ...,  0.59590995,
         0.56746984,  0.5816899 ]], dtype=float32), array([[-0.9163569 , -0.9017585 , -0.8579632 , ..., -0.9398572 ,
        -0.96829736, -1.0109575 ],
       [-0.87256163, -0.8433648 , -0.7995695 , ..., -1.1958185 ,
        -1.2242587 , -1.1958185 ],
       [-0.7995695 , -0.7995695 , -0.78497106, ..., -0.7692165 ,
        -0.7549964 , -0.78343654],
       ...,
       [-1.7338688 , -1.7484672 , -1.7484672 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, array([[-0.9163569 , -0.9893491 , -1.0623412 , ..., -0.78343654,
        -0.68389606, -0.61279577],
       [-0.49300256, -0.5659947 , -0.6973805 , ..., -0.51325524,
        -0.65545595, -0.65545595],
       [-0.2740262 , -0.24482933, -0.15723877, ..., -0.7265563 ,
        -0.7692165 , -0.65545595],
       ...,
       [-0.303223  , -0.15723877, -0.12804192, ..., -0.74077636,
        -0.7692165 , -0.8260967 ],
       [-0.15723877, -0.303223  , -0.2740262 , ..., -0.7549964 ,
        -0.86875695, -0.8545369 ],
       [-0.11344349, -0.2740262 , -0.2302309 , ..., -0.81187665,
        -0.7549964 , -0.7692165 ]], dtype=float32), None, array([[-1.3543098 , -1.3543098 , -1.3397113 , ..., -1.0962781 ,
        -1.082058  , -1.082058  ],
       [-1.2229239 , -1.2229239 , -1.193727  , ..., -1.0109575 ,
        -0.9825174 , -0.95407724],
       [-1.2083255 , -1.2083255 , -1.193727  , ..., -0.9967375 ,
        -0.9825174 , -0.96829736],
       ...,
       [-0.14264035, -0.2302309 , -0.303223  , ..., -0.05821316,
        -0.11509342, -0.15775362],
       [ 0.19312355,  0.17852512,  0.07633615, ...,  0.36838892,
         0.38260898,  0.4110491 ],
       [-0.42001042, -0.47840413, -0.44920728, ...,  0.16930789,
         0.16930789,  0.18352796]], dtype=float32), array([[-0.28862458, -0.7703726 , -0.68278205, ..., -1.3948994 ,
        -1.4233395 , -1.4517797 ],
       [-1.1645303 , -0.8579632 , -0.82876635, ..., -1.4659997 ,
        -1.4659997 , -1.4802198 ],
       [ 0.48509204,  0.20772196, -0.2302309 , ..., -1.082058  ,
        -1.067838  , -1.0109575 ],
       ...,
       [ 0.85005265,  0.8062574 ,  0.7332653 , ..., -1.3664593 ,
        -1.3806794 , -1.3806794 ],
       [ 1.0252337 ,  1.0544306 ,  1.098226  , ..., -1.2526988 ,
        -1.2384787 , -1.2384787 ],
       [ 0.99603695,  0.95224166,  0.9668401 , ..., -1.1815984 ,
        -1.1815984 , -1.1958185 ]], dtype=float32), None, None, array([[-1.1207349 , -1.1207349 , -1.1499318 , ..., -0.8403168 ,
        -0.74077636, -0.669676  ],
       [-1.1645303 , -1.1499318 , -1.1207349 , ..., -0.8260967 ,
        -0.8403168 , -0.86875695],
       [-1.0331444 , -1.0623412 , -1.1353334 , ..., -0.65545595,
        -0.882977  , -0.81187665],
       ...,
       [ 0.54348576,  0.5726826 ,  0.6310763 , ..., -0.7976566 ,
        -1.067838  , -1.0536178 ],
       [ 0.791659  ,  0.6456747 ,  0.5580842 , ..., -0.89719707,
        -0.9398572 , -1.2526988 ],
       [ 0.93764323,  0.76246214,  0.85005265, ..., -0.9967375 ,
        -1.1531583 , -1.1247182 ]], dtype=float32), array([[ 1.098226  ,  1.1128243 ,  1.1274228 , ..., -0.25729406,
        -0.51325524, -0.6270158 ],
       [-0.6973805 , -0.8579632 , -0.94555384, ...,  1.022512  ,
         1.0651721 ,  1.0936122 ],
       [ 0.95224166,  0.93764323,  0.9230448 , ..., -0.31417432,
        -0.45637497, -0.61279577],
       ...,
       [ 0.5580842 ,  0.5726826 ,  0.5726826 , ...,  0.33994877,
         0.35416883,  0.35416883],
       [ 0.0617376 ,  0.04713918,  0.04713918, ...,  0.6670103 ,
         0.6527902 ,  0.63857013],
       [ 0.14932826,  0.19312355,  0.20772196, ...,  0.6527902 ,
         0.6243501 ,  0.59590995]], dtype=float32)], 'image_grid_thw': [None, None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]]), array([[ 1, 28, 18]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A toilet and a handicap sign with red pipe.\n', 'Find me an everyday image that matches the given caption: A man in glasses is standing next to a girl holding a Wii controller.\n', 'Find me an everyday image that matches the given caption: A child is riding a skateboard inside the home.\n', 'Find me an everyday image that matches the given caption: A train on the tracks under a bridge.\n', 'Find me an everyday image that matches the given caption: A man with a suitcase on a beach looking at the ship in the ocean.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man and woman stand next to each other holding video game remotes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The boat is navigating through the urban area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bathroom in the orocess of being remodeled.\n', "Find me an everyday image that matches the given caption: A woman blow drying another woman's hair with a pink hair dyer.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 2/6000 [00:05<4:21:24,  2.61s/it]                                                  {'loss': 17.7575, 'grad_norm': 2086.921142578125, 'learning_rate': 2.0000000000000002e-07, 'epoch': 0.0}
  0%|          | 2/6000 [00:05<4:21:24,  2.61s/it][2025-11-13 01:31:03,056] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  16211,    553,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,   8968,    624],
        [151643, 151643, 151643,  ...,   1787,   3241,    624],
        [151643, 151643, 151643,  ...,   4815,    432,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people walk down a side walk as a train passes by.\n', 'Find me an everyday image that matches the given caption: The Big Ben Clock tower with two sides of it showing.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An elephant carrying a girl down a street.\n', 'Find me an everyday image that matches the given caption: A big pizza sits on a plate next to a bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of fruits that is under an umbrella.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people are shown standing in a classroom.\n', 'Find me an everyday image that matches the given caption: A cat relaxes on top of a bag.\n', 'Find me an everyday image that matches the given caption: A white dog is looking out of an open window.\n', 'Find me an everyday image that matches the given caption: Cat sitting in a window with curtains behind it.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAD6C0>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272FAD6F0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x359 at 0x7F3272FAD750>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F3272FAD9C0>], [<PIL.Image.Image image mode=RGB size=363x256 at 0x7F3272FAD9F0>], [<PIL.Image.Image image mode=RGB size=377x256 at 0x7F3272FADA20>], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272FADA80>], [None], [None], [None], [None]], 'pixel_values': [array([[ 0.44129676,  0.4558952 ,  0.4704936 , ...,  0.90875137,
         0.8945313 ,  0.8945313 ],
       [ 0.58728105,  0.58728105,  0.5726826 , ...,  0.90875137,
         0.90875137,  0.90875137],
       [ 0.5580842 ,  0.5580842 ,  0.5580842 , ...,  0.8945313 ,
         0.8945313 ,  0.8945313 ],
       ...,
       [-0.12804192, -0.1718372 , -0.12804192, ..., -0.7692165 ,
        -0.7692165 , -0.7692165 ],
       [ 0.07633615,  0.07633615,  0.07633615, ...,  0.68123037,
         0.6954504 ,  0.72389054],
       [ 0.07633615, -0.02585294, -0.09884507, ..., -0.61279577,
        -0.61279577, -0.61279577]], dtype=float32), array([[-0.4638057 , -0.59519154, -0.72657734, ..., -0.7692165 ,
        -0.74077636, -0.7265563 ],
       [-0.6681836 , -0.6681836 , -0.59519154, ...,  0.48214942,
         0.5816899 ,  0.6954504 ],
       [-0.6681836 , -0.5367978 , -0.43460885, ..., -0.5274753 ,
        -0.5559154 , -0.57013553],
       ...,
       [-1.2959161 , -1.2959161 , -1.2959161 , ..., -1.0393977 ,
        -1.0393977 , -1.0393977 ],
       [-1.2229239 , -1.2229239 , -1.2375224 , ..., -0.7692165 ,
        -0.7692165 , -0.78343654],
       [-1.2959161 , -1.2959161 , -1.3105145 , ..., -0.96829736,
        -0.9825174 , -0.9825174 ]], dtype=float32), None, None, array([[-1.6900735, -1.6900735, -1.6900735, ..., -1.3806794, -1.3806794,
        -1.3806794],
       [-1.6900735, -1.6900735, -1.6900735, ..., -1.3806794, -1.3806794,
        -1.3806794],
       [-1.6900735, -1.6900735, -1.6900735, ..., -1.3806794, -1.3806794,
        -1.3806794],
       ...,
       [-1.2375224, -1.2375224, -1.2813176, ..., -1.2526988, -1.2669188,
        -1.2811389],
       [-1.1791286, -1.193727 , -1.193727 , ..., -1.2100385, -1.1815984,
        -1.1673783],
       [-1.3251129, -1.3397113, -1.3105145, ..., -1.3380191, -1.4375596,
        -1.4517797]], dtype=float32), None, None, array([[-0.9163569 , -0.6973805 , -0.47840413, ...,  0.63857013,
         0.68123037,  0.6670103 ],
       [ 0.48509204,  0.36830464,  0.23691882, ...,  0.4537093 ,
         0.4963695 ,  0.5390297 ],
       [ 0.30991095,  0.29531252,  0.33910778, ...,  0.36838892,
         0.39682904,  0.39682904],
       ...,
       [-1.3105145 , -1.3251129 , -1.3251129 , ..., -1.2669188 ,
        -1.2526988 , -1.2669188 ],
       [-1.7922626 , -1.7922626 , -1.7776641 , ..., -1.4802198 ,
        -1.4659997 , -1.4659997 ],
       [-1.1353334 , -1.1499318 , -1.1645303 , ..., -1.4375596 ,
        -1.3664593 , -1.3237991 ]], dtype=float32), array([[ 0.95224166,  0.8792495 ,  0.9084464 , ...,  1.705075  ,
         1.8188357 ,  1.6624149 ],
       [ 1.2004149 ,  1.2442101 ,  1.2588086 , ...,  0.06976743,
        -0.14353354,  0.75233066],
       [-0.28862458, -0.303223  , -0.44920728, ...,  0.25462827,
         0.43948925,  0.6954504 ],
       ...,
       [-0.09884507, -0.12804192, -0.1718372 , ..., -0.3710546 ,
        -0.22885394, -0.14353354],
       [-0.6681836 , -0.59519154, -0.6389868 , ..., -0.20041381,
        -0.3710546 , -0.39949474],
       [-0.8141679 , -0.7119789 , -0.55139625, ..., -0.21463387,
        -0.18619375, -0.18619375]], dtype=float32), array([[-1.6462783 , -1.704672  , -1.018546  , ..., -1.3806794 ,
        -1.3380191 , -1.4233395 ],
       [-1.7776641 , -1.7922626 , -1.7922626 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-1.7338688 , -1.7484672 , -1.7192703 , ..., -1.4802198 ,
        -1.4802198 , -1.4233395 ],
       ...,
       [ 0.19312355,  0.17852512,  0.17852512, ..., -0.7265563 ,
        -0.6981161 , -0.7265563 ],
       [-0.31782144, -0.28862458, -0.303223  , ..., -1.2953589 ,
        -1.2100385 , -1.2669188 ],
       [-0.49300256, -0.405412  , -0.36161673, ..., -1.082058  ,
        -1.067838  , -1.1815984 ]], dtype=float32), None, array([[0.3537062 , 0.4704936 , 0.32450938, ..., 1.1078323 , 1.1789327 ,
        1.2784731 ],
       [0.3975015 , 0.32450938, 0.23691882, ..., 1.1220524 , 1.1647125 ,
        1.1078323 ],
       [0.5726826 , 0.58728105, 0.68947   , ..., 0.9940718 , 0.61013   ,
        0.61013   ],
       ...,
       [1.7259582 , 1.7697535 , 1.8281472 , ..., 2.0463567 , 2.0605767 ,
        2.0605767 ],
       [1.652966  , 1.5945723 , 1.5799739 , ..., 1.7761754 , 1.7192951 ,
        1.705075  ],
       [1.6091708 , 1.6821629 , 1.7113597 , ..., 1.8330555 , 1.6766349 ,
        1.6766349 ]], dtype=float32), None, None, None, None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 26, 18]]), None, None, array([[ 1, 28, 18]]), array([[ 1, 18, 26]]), array([[ 1, 18, 26]]), None, array([[ 1, 18, 28]]), None, None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people walk down a side walk as a train passes by.\n', 'Find me an everyday image that matches the given caption: The Big Ben Clock tower with two sides of it showing.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An elephant carrying a girl down a street.\n', 'Find me an everyday image that matches the given caption: A big pizza sits on a plate next to a bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of fruits that is under an umbrella.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people are shown standing in a classroom.\n', 'Find me an everyday image that matches the given caption: A cat relaxes on top of a bag.\n', 'Find me an everyday image that matches the given caption: A white dog is looking out of an open window.\n', 'Find me an everyday image that matches the given caption: Cat sitting in a window with curtains behind it.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 3/6000 [00:07<3:57:05,  2.37s/it]                                                  {'loss': 15.9394, 'grad_norm': 2291.291015625, 'learning_rate': 3.0000000000000004e-07, 'epoch': 0.0}
  0%|          | 3/6000 [00:07<3:57:05,  2.37s/it][2025-11-13 01:31:05,145] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,   2004,    624],
        [151643, 151643, 151643,  ...,    279,   3015,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,   6249,    624],
        [151643, 151643, 151643,  ...,    862,  20638,    624],
        [151643, 151643, 151643,  ...,    279,  16876,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: An image of a woman dancing with a prop.\n', 'Find me an everyday image that matches the given caption: A man and a dog on a stand up paddleboard in the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The dining room is painted yellow and has a table with chairs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A long bathroom with white walls and counters.\n', 'Find me an everyday image that matches the given caption: A woman is walking along a path holding an umbrella.\n', 'Find me an everyday image that matches the given caption: A picture with four different plates of food.\n', 'Find me an everyday image that matches the given caption: A open refrigerator with the doors open and food showing.\n', 'Find me an everyday image that matches the given caption: A woman wearing fast food worker attire and sitting beneath a multicolored umbrella waits for the train.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pink cell phone with numbers on the keys is sitting next to a green cell phone that is slid open.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a suit smiles and looks at the camera.\n', 'Find me an everyday image that matches the given caption: A young person sits outside with their laptop.\n', 'Find me an everyday image that matches the given caption: A young man is on his surf board on the waves.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272FAF370>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAF4C0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272FAF3D0>], [None], [<PIL.Image.Image image mode=RGB size=256x381 at 0x7F3272F27610>], [None], [None], [None]], 'pixel_values': [None, None, array([[-1.7922626 , -1.7922626 , -1.7776641 , ..., -0.5274753 ,
        -0.48481512, -0.51325524],
       [-1.7192703 , -1.7192703 , -1.7192703 , ..., -0.6412359 ,
        -0.86875695, -1.0536178 ],
       [-1.7776641 , -1.7630657 , -1.6900735 , ..., -0.4421549 ,
        -0.45637497, -0.47059506],
       ...,
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.31417432,
        -0.31417432, -0.31417432],
       [-1.7922626 , -1.7776641 , -1.7630657 , ..., -0.31417432,
        -0.31417432, -0.31417432],
       [-1.7630657 , -1.7630657 , -1.7630657 , ..., -0.31417432,
        -0.32839438, -0.32839438]], dtype=float32), None, array([[ 0.32450938,  0.30991095,  0.26611567, ..., -0.08665328,
        -0.5985757 , -0.18619375],
       [-0.5221994 , -0.60978997, -0.7557742 , ..., -0.08665328,
         0.48214942,  0.5390297 ],
       [-0.82876635, -1.018546  , -0.9017585 , ..., -0.17197368,
        -0.20041381, -0.20041381],
       ...,
       [-0.9163569 , -0.8579632 , -0.78497106, ...,  2.0890167 ,
         2.0890167 ,  2.0890167 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.0890167 ,
         2.074797  ,  2.074797  ],
       [ 1.9011393 ,  1.9011393 ,  1.9011393 , ...,  2.103237  ,
         2.103237  ,  2.103237  ]], dtype=float32), None, None, None, None, None, array([[-0.88716006, -0.88716006, -0.87256163, ...,  0.80921096,
         0.823431  ,  0.8376511 ],
       [-0.82876635, -0.82876635, -0.7995695 , ...,  0.9514116 ,
         0.9514116 ,  0.96563166],
       [-0.78497106, -0.78497106, -0.7703726 , ...,  0.8945313 ,
         0.8945313 ,  0.8945313 ],
       ...,
       [-1.1207349 , -1.5878845 , -1.5878845 , ..., -1.2953589 ,
        -1.1531583 , -1.067838  ],
       [-1.2229239 , -1.2959161 , -1.2667192 , ..., -0.20041381,
        -0.57013553, -1.0393977 ],
       [-1.2959161 , -1.2229239 , -1.1207349 , ..., -1.3806794 ,
        -1.4091195 , -1.4233395 ]], dtype=float32), None, array([[-1.7922626 , -1.7922626 , -1.7484672 , ..., -0.34261447,
        -0.34261447, -0.35683453],
       [-1.7192703 , -1.7338688 , -1.7630657 , ..., -0.3710546 ,
        -0.38527465, -0.39949474],
       [-1.7484672 , -1.7922626 , -1.7338688 , ...,  0.43948925,
         0.4252692 ,  0.38260898],
       ...,
       [ 1.4923834 ,  1.4923834 ,  1.5215802 , ..., -1.1815984 ,
        -1.4091195 , -1.3948994 ],
       [ 0.8354542 ,  0.85005265,  0.85005265, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.95224166,  0.9668401 ,  0.9814385 , ..., -1.4233395 ,
        -1.4091195 , -1.4659997 ]], dtype=float32), None, None, None], 'image_grid_thw': [None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, None, None, None, None, array([[ 1, 18, 28]]), None, array([[ 1, 28, 18]]), None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: An image of a woman dancing with a prop.\n', 'Find me an everyday image that matches the given caption: A man and a dog on a stand up paddleboard in the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The dining room is painted yellow and has a table with chairs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A long bathroom with white walls and counters.\n', 'Find me an everyday image that matches the given caption: A woman is walking along a path holding an umbrella.\n', 'Find me an everyday image that matches the given caption: A picture with four different plates of food.\n', 'Find me an everyday image that matches the given caption: A open refrigerator with the doors open and food showing.\n', 'Find me an everyday image that matches the given caption: A woman wearing fast food worker attire and sitting beneath a multicolored umbrella waits for the train.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pink cell phone with numbers on the keys is sitting next to a green cell phone that is slid open.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a suit smiles and looks at the camera.\n', 'Find me an everyday image that matches the given caption: A young person sits outside with their laptop.\n', 'Find me an everyday image that matches the given caption: A young man is on his surf board on the waves.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 4/6000 [00:09<3:46:04,  2.26s/it]                                                  {'loss': 16.4286, 'grad_norm': 1934.567138671875, 'learning_rate': 4.0000000000000003e-07, 'epoch': 0.0}
  0%|          | 4/6000 [00:09<3:46:04,  2.26s/it][2025-11-13 01:31:07,238] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,  11321,    624],
        [151643, 151643, 151643,  ...,  66284,   1479,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,   6249,    624],
        [151643, 151643, 151643,  ...,    264,   1841,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A red car is parked on the beach.\n', 'Find me an everyday image that matches the given caption: THERE IS AN IAMGE OF A CITY CARS PARKED.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sandwich made with some berries and some apple.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The dog is laying down on the couch.\n', "Find me an everyday image that matches the given caption: Two husky's hanging out of the car windows.\n", 'Find me an everyday image that matches the given caption: A close up of a  elephant statue.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A multi-room building presents a clock on its face and several chimneys.\n', 'Find me an everyday image that matches the given caption: Three people sitting and smiling for the camera.\n', 'Find me an everyday image that matches the given caption: A person on a snowboard jumps over a sign.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=316x256 at 0x7F3272FAD300>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAEEF0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF1C0>], [<PIL.Image.Image image mode=RGB size=409x256 at 0x7F3272FAC0A0>], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272FAEF20>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=455x256 at 0x7F3272FAE950>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E020>]], 'pixel_values': [None, None, array([[-1.2813176 , -1.2667192 , -1.2375224 , ...,  0.0839875 ,
         0.09820756,  0.09820756],
       [-1.0915381 , -1.0623412 , -1.0331444 , ..., -0.10087335,
        -0.34261447, -0.8545369 ],
       [-0.31782144, -0.303223  , -0.2740262 , ..., -0.01555296,
         0.09820756,  0.19774802],
       ...,
       [-1.2521207 , -1.1207349 , -0.88716006, ...,  0.7807708 ,
         0.8376511 ,  0.85187113],
       [ 0.9084464 ,  0.8354542 ,  1.0398322 , ...,  0.7381106 ,
         0.6954504 ,  0.8660912 ],
       [ 0.66027313,  0.7040684 ,  0.6310763 , ...,  0.7949909 ,
         0.8660912 ,  0.88031125]], dtype=float32), array([[ 0.33910778,  0.33910778,  0.33910778, ...,  1.3353534 ,
         1.3353534 ,  1.3353534 ],
       [ 0.38290307,  0.38290307,  0.36830464, ...,  1.3637935 ,
         1.3637935 ,  1.3637935 ],
       [ 0.30991095,  0.30991095,  0.30991095, ...,  1.3637935 ,
         1.3637935 ,  1.3637935 ],
       ...,
       [ 0.09093457,  0.04713918,  0.04713918, ..., -1.309579  ,
        -1.3237991 , -1.2811389 ],
       [-0.14264035, -0.09884507, -0.06964822, ..., -1.0536178 ,
        -0.9967375 , -0.9398572 ],
       [-0.09884507, -0.12804192, -0.12804192, ..., -1.2953589 ,
        -1.2669188 , -1.2242587 ]], dtype=float32), array([[-1.018546  , -1.018546  , -1.018546  , ...,  0.93719155,
         0.93719155,  0.9514116 ],
       [-0.96015227, -0.96015227, -0.9747507 , ...,  1.1220524 ,
         1.1362724 ,  1.1362724 ],
       [-0.9017585 , -0.9017585 , -0.9017585 , ...,  1.1647125 ,
         1.1931527 ,  1.2073728 ],
       ...,
       [-1.3543098 , -1.3835065 , -1.3835065 , ..., -0.95407724,
        -0.9967375 , -0.9967375 ],
       [-0.5805931 , -0.68278205, -0.6973805 , ..., -0.45637497,
        -0.48481512, -0.49903518],
       [-0.72657734, -0.7411758 , -0.7411758 , ..., -0.51325524,
        -0.5274753 , -0.5274753 ]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ...,  0.19774802,
         0.02710724, -0.10087335],
       [-1.6316798 , -1.6462783 , -1.6170814 , ..., -0.05821316,
        -0.02977302, -0.01555296],
       [-1.7776641 , -1.7338688 , -1.7776641 , ..., -0.2857342 ,
        -0.2857342 , -0.27151415],
       ...,
       [-0.78497106, -0.7557742 , -0.7411758 , ..., -1.1104981 ,
        -1.1104981 , -1.1104981 ],
       [-0.2740262 , -0.2740262 , -0.2740262 , ..., -0.81187665,
        -0.81187665, -0.81187665],
       [-0.5805931 , -0.68278205, -0.78497106, ..., -0.8260967 ,
        -0.81187665, -0.8403168 ]], dtype=float32), None, array([[ 1.1128243 ,  0.58728105, -0.5805931 , ...,  1.1362724 ,
         0.90875137,  0.29728848],
       [-1.6316798 , -1.6900735 , -1.7192703 , ...,  0.72389054,
         0.6243501 ,  0.05554737],
       [ 0.61647785, -0.09884507, -0.9309554 , ..., -0.25729406,
         0.11242763,  0.46792936],
       ...,
       [ 0.01794233, -0.04045137, -0.09884507, ..., -0.9398572 ,
        -0.96829736, -0.91141707],
       [-0.0550498 , -0.0550498 , -0.02585294, ..., -0.8260967 ,
        -0.8403168 , -0.7549964 ],
       [-0.04045137, -0.08424664, -0.0550498 , ..., -0.91141707,
        -0.86875695, -0.9398572 ]], dtype=float32), None, None, None, array([[ 1.4923834e+00,  1.6383677e+00,  1.5945723e+00, ...,
         5.6746984e-01,  3.1150854e-01,  4.2526919e-01],
       [ 1.2588086e+00,  1.2880055e+00,  1.3172023e+00, ...,
         6.2435007e-01,  7.2389054e-01,  1.1078323e+00],
       [ 1.3755959e+00,  1.1128243e+00,  8.6465108e-01, ...,
        -1.3328948e-03, -1.5552960e-02, -1.1509342e-01],
       ...,
       [-1.4419003e+00, -1.4564987e+00, -1.5440893e+00, ...,
        -3.8527465e-01, -5.8435565e-01, -6.5545595e-01],
       [-6.2438840e-01, -7.2657734e-01, -7.9956949e-01, ...,
        -3.9949474e-01, -3.9949474e-01, -3.8527465e-01],
       [-1.2667192e+00, -1.1645303e+00, -1.0623412e+00, ...,
        -4.2793486e-01, -4.8481512e-01, -5.2747530e-01]], dtype=float32), None, None, None, array([[ 1.7989503 ,  1.8281472 ,  1.8719424 , ...,  1.036732  ,
         1.5344343 ,  1.3780135 ],
       [ 1.3901944 ,  1.4193913 ,  1.1566195 , ...,  1.5059941 ,
         1.7192951 ,  1.5344343 ],
       [ 1.652966  ,  1.4485881 ,  1.3463992 , ...,  1.7335151 ,
         1.918376  ,  1.5913146 ],
       ...,
       [-0.0550498 , -0.04045137, -0.06964822, ...,  1.036732  ,
         1.036732  ,  1.036732  ],
       [ 1.2442101 ,  1.2442101 ,  1.2296118 , ...,  1.0936122 ,
         1.0936122 ,  1.0936122 ],
       [ 1.1566195 ,  1.1274228 ,  1.1274228 , ...,  0.96563166,
         0.9514116 ,  0.9514116 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 22]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 30]]), None, array([[ 1, 18, 18]]), None, None, None, array([[ 1, 18, 32]]), None, None, None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A red car is parked on the beach.\n', 'Find me an everyday image that matches the given caption: THERE IS AN IAMGE OF A CITY CARS PARKED.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sandwich made with some berries and some apple.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The dog is laying down on the couch.\n', "Find me an everyday image that matches the given caption: Two husky's hanging out of the car windows.\n", 'Find me an everyday image that matches the given caption: A close up of a  elephant statue.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A multi-room building presents a clock on its face and several chimneys.\n', 'Find me an everyday image that matches the given caption: Three people sitting and smiling for the camera.\n', 'Find me an everyday image that matches the given caption: A person on a snowboard jumps over a sign.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 5/6000 [00:11<3:36:36,  2.17s/it]                                                  {'loss': 16.9802, 'grad_norm': 1957.7220458984375, 'learning_rate': 5.000000000000001e-07, 'epoch': 0.0}
  0%|          | 5/6000 [00:11<3:36:36,  2.17s/it][2025-11-13 01:31:09,236] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,   8644,    624],
        [151643, 151643, 151643,  ...,  11699,   1495,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  18575,  11968,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A closeup view of a computer keyboard and a mouse.\n', 'Find me an everyday image that matches the given caption: A small kid with a brush sitting down.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An Air Canada passenger jet plane sits on a tarmac while airport workers pull baggage out of the plane.\n', 'Find me an everyday image that matches the given caption: A city view from behind a high way overpass.\n', 'Find me an everyday image that matches the given caption: A man hits a baseball with a bat while a group of spectators watch him.\n', 'Find me an everyday image that matches the given caption: A woman is holding a bowl of cereal while on her phone.\n', 'Find me an everyday image that matches the given caption: A airplane parked on the tarmac of an airport with workers walking around.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A white horse design on a orange plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAE3B0>], [<PIL.Image.Image image mode=RGB size=256x364 at 0x7F3272FADAE0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272FAEB00>], [<PIL.Image.Image image mode=RGB size=319x256 at 0x7F3272FAD180>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5E1A0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272B5E1D0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E200>], [<PIL.Image.Image image mode=RGB size=256x298 at 0x7F3272B5E2F0>]], 'pixel_values': [None, None, array([[0.52888733, 0.52888733, 0.52888733, ..., 1.477554  , 1.477554  ,
        1.477554  ],
       [0.6310763 , 0.6456747 , 0.67487156, ..., 1.5202142 , 1.5202142 ,
        1.5344343 ],
       [0.67487156, 0.68947   , 0.7040684 , ..., 1.705075  , 1.7192951 ,
        1.7192951 ],
       ...,
       [0.61647785, 0.6310763 , 0.6018794 , ..., 1.3353534 , 1.3637935 ,
        1.3922336 ],
       [0.42669836, 0.38290307, 0.41209993, ..., 1.0082918 , 1.0509521 ,
        1.036732  ],
       [0.58728105, 0.6018794 , 0.6456747 , ..., 1.0936122 , 1.0936122 ,
        1.1078323 ]], dtype=float32), array([[-1.5440893 , -1.5586877 , -1.5732862 , ..., -1.2100385 ,
        -1.2384787 , -1.2811389 ],
       [-1.5148925 , -1.5294908 , -1.5148925 , ..., -1.2526988 ,
        -1.2100385 , -1.1673783 ],
       [-1.6024829 , -1.6024829 , -1.6024829 , ..., -1.309579  ,
        -1.309579  , -1.2811389 ],
       ...,
       [ 1.273407  ,  1.2588086 ,  1.2442101 , ...,  1.6481948 ,
         1.6197547 ,  1.6055346 ],
       [ 0.2223204 ,  0.00334391, -0.11344349, ...,  1.3353534 ,
         1.690855  ,  1.7903955 ],
       [ 0.9668401 ,  0.95224166,  0.95224166, ...,  0.18352796,
         0.7807708 ,  1.2500329 ]], dtype=float32), None, None, None, None, None, array([[-0.303223  , -0.49300256,  0.49969047, ..., -1.1104981 ,
        -0.9967375 , -1.1247182 ],
       [-1.2667192 , -1.2521207 , -1.1499318 , ..., -0.7265563 ,
        -0.65545595, -0.6412359 ],
       [-1.5294908 , -1.5148925 , -1.4856956 , ..., -0.18619375,
        -0.31417432, -0.05821316],
       ...,
       [-1.0477428 , -0.9309554 , -0.7557742 , ..., -1.1104981 ,
        -1.1104981 , -1.2526988 ],
       [-0.65358526, -0.43460885, -0.88716006, ..., -1.1531583 ,
        -0.8403168 , -0.49903518],
       [-0.94555384, -0.9893491 , -1.193727  , ..., -0.05821316,
        -0.11509342,  0.19774802]], dtype=float32), array([[-1.7776641 , -1.7922626 , -1.7922626 , ..., -0.7549964 ,
        -0.8545369 , -1.0251776 ],
       [-1.5294908 , -1.6170814 , -1.6754751 , ..., -0.47059506,
        -0.4137148 , -0.5985757 ],
       [-1.0477428 , -1.2375224 , -1.3689082 , ..., -1.2811389 ,
        -1.2811389 , -1.2953589 ],
       ...,
       [-0.24482933, -0.28862458, -0.31782144, ..., -0.68389606,
        -0.68389606, -0.65545595],
       [-0.20103405, -0.21563247, -0.2302309 , ..., -0.68389606,
        -0.6981161 , -0.71233624],
       [-0.2302309 , -0.20103405, -0.18643562, ..., -0.65545595,
        -0.6270158 , -0.6270158 ]], dtype=float32), array([[0.17852512, 0.17852512, 0.19312355, ..., 1.7619553 , 1.7619553 ,
        1.7619553 ],
       [0.38290307, 0.38290307, 0.38290307, ..., 1.8188357 , 1.7903955 ,
        1.7761754 ],
       [0.95224166, 0.95224166, 0.95224166, ..., 1.7477353 , 1.7477353 ,
        1.7619553 ],
       ...,
       [0.66027313, 0.6456747 , 0.6456747 , ..., 0.8660912 , 0.8945313 ,
        0.93719155],
       [0.54348576, 0.6018794 , 0.6456747 , ..., 1.022512  , 0.9940718 ,
        0.9798517 ],
       [0.6018794 , 0.5142889 , 0.44129676, ..., 0.7807708 , 0.80921096,
        0.8376511 ]], dtype=float32), array([[-1.7192703 , -1.7192703 , -1.7192703 , ..., -1.2811389 ,
        -1.2953589 , -1.309579  ],
       [-1.6316798 , -1.6462783 , -1.6754751 , ..., -1.2242587 ,
        -1.2526988 , -1.1531583 ],
       [-1.6462783 , -1.6608766 , -1.6608766 , ..., -1.1104981 ,
        -1.082058  , -1.0962781 ],
       ...,
       [-0.2740262 , -0.39081356, -0.5221994 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-0.18643562, -0.2740262 , -0.405412  , ..., -1.4802198 ,
        -1.4659997 , -1.4659997 ],
       [-1.1791286 , -1.193727  , -1.193727  , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ]], dtype=float32), None, array([[-1.0477428 , -1.0915381 , -1.1061366 , ...,  0.46792936,
         0.46792936,  0.4963695 ],
       [-1.1499318 , -1.0623412 , -0.9893491 , ...,  0.5816899 ,
         0.6243501 ,  0.6243501 ],
       [-1.1499318 , -1.1353334 , -1.1353334 , ...,  0.8376511 ,
         0.7807708 ,  0.7381106 ],
       ...,
       [ 0.13472985,  0.30991095,  0.2807141 , ...,  0.7665507 ,
         0.75233066,  0.7096705 ],
       [-0.60978997, -0.5659947 , -0.50760096, ..., -0.07243322,
        -0.04399309,  0.02710724],
       [-0.25942776, -0.2302309 , -0.24482933, ..., -0.17197368,
        -0.18619375, -0.20041381]], dtype=float32), array([[-0.7995695 , -0.7703726 , -0.7119789 , ..., -0.38527465,
        -0.47059506, -0.49903518],
       [-0.33241987, -0.405412  , -0.47840413, ..., -0.5274753 ,
        -0.5274753 , -0.31417432],
       [-0.60978997, -0.59519154, -0.5367978 , ..., -0.29995427,
        -0.35683453, -0.35683453],
       ...,
       [-0.04045137, -0.04045137, -0.06964822, ...,  0.24040821,
         0.22618815,  0.22618815],
       [ 0.04713918, -0.0550498 , -0.14264035, ...,  0.21196808,
         0.16930789,  0.14086775],
       [-0.04045137, -0.11344349, -0.09884507, ...,  0.14086775,
         0.1266477 ,  0.33994877]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 24]]), array([[ 1, 26, 18]]), None, None, None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 22]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 22, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A closeup view of a computer keyboard and a mouse.\n', 'Find me an everyday image that matches the given caption: A small kid with a brush sitting down.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An Air Canada passenger jet plane sits on a tarmac while airport workers pull baggage out of the plane.\n', 'Find me an everyday image that matches the given caption: A city view from behind a high way overpass.\n', 'Find me an everyday image that matches the given caption: A man hits a baseball with a bat while a group of spectators watch him.\n', 'Find me an everyday image that matches the given caption: A woman is holding a bowl of cereal while on her phone.\n', 'Find me an everyday image that matches the given caption: A airplane parked on the tarmac of an airport with workers walking around.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A white horse design on a orange plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 6/6000 [00:13<3:32:27,  2.13s/it]                                                  {'loss': 18.5527, 'grad_norm': 1583.560546875, 'learning_rate': 6.000000000000001e-07, 'epoch': 0.0}
  0%|          | 6/6000 [00:13<3:32:27,  2.13s/it][2025-11-13 01:31:11,283] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    304,  11794,    624],
        [151643, 151643, 151643,  ...,   5164,    938,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   6422,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A bench is sitting by a forest covered in snow.\n', 'Find me an everyday image that matches the given caption: Multiple sheep crossing a road in front of a vehical.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A neighborhood intersection has stop painted on the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A gray striped young cat is hanging on to the toilet seat and stretched into the bowl to drink water.\n', 'Find me an everyday image that matches the given caption: Man looks at another man that is holding a Wii controller in his hands.\n', 'Find me an everyday image that matches the given caption: A group of people standing on snow skis in front of a lodge.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of brown tables with orange chairs under them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: It's necessary to hang out over the side to compensate for the wind blowing in the other direction.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A number of luggage bags on a floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF940>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAE320>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5F400>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=395x256 at 0x7F3272B5F3A0>], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272B5E170>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5DE10>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5F430>]], 'pixel_values': [None, None, array([[ 0.20772196, -0.08424664, -0.20103405, ...,  0.09820756,
         0.09820756, -0.2857342 ],
       [-0.7557742 , -0.60978997,  0.7040684 , ..., -0.42793486,
        -0.21463387, -0.21463387],
       [-0.9893491 , -0.8141679 , -0.44920728, ...,  0.18352796,
         0.48214942,  0.61013   ],
       ...,
       [ 0.29531252,  0.14932826,  0.16392669, ...,  1.0082918 ,
         1.1078323 ,  1.0793922 ],
       [-0.18643562, -0.15723877, -0.21563247, ..., -0.11509342,
        -0.08665328, -0.02977302],
       [-0.405412  , -0.68278205, -0.88716006, ...,  0.09820756,
        -0.05821316, -0.32839438]], dtype=float32), None, array([[ 0.9814385 ,  0.9814385 ,  0.9814385 , ...,  1.3637935 ,
         1.3637935 ,  1.3780135 ],
       [ 1.0544306 ,  1.0544306 ,  1.0398322 , ...,  1.3922336 ,
         1.3922336 ,  1.3922336 ],
       [ 1.0106354 ,  1.0106354 ,  1.0106354 , ...,  1.3922336 ,
         1.3922336 ,  1.4064537 ],
       ...,
       [-0.14264035, -0.12804192, -0.12804192, ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ],
       [-1.2083255 , -1.2959161 , -1.2813176 , ..., -1.4802198 ,
        -1.4659997 , -1.4659997 ],
       [-0.42001042, -0.43460885, -0.405412  , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-0.7703726 , -0.7703726 , -0.7703726 , ...,  1.4206737 ,
         1.4206737 ,  1.4206737 ],
       [-0.6243884 , -0.60978997, -0.60978997, ...,  1.3780135 ,
         1.3780135 ,  1.3922336 ],
       [-0.5367978 , -0.5367978 , -0.5221994 , ...,  1.5486543 ,
         1.5486543 ,  1.5486543 ],
       ...,
       [ 1.0544306 ,  0.61647785,  0.6456747 , ...,  1.705075  ,
         1.5202142 ,  1.4206737 ],
       [ 1.171218  ,  1.1420212 ,  1.1128243 , ...,  2.103237  ,
         2.074797  ,  1.463334  ],
       [ 0.9814385 ,  1.0544306 ,  1.1858164 , ...,  1.036732  ,
         0.7096705 ,  1.0936122 ]], dtype=float32), None, None, None, array([[-0.5221994 , -0.5221994 , -0.5221994 , ...,  0.8945313 ,
         0.8945313 ,  0.8945313 ],
       [-0.47840413, -0.47840413, -0.44920728, ...,  0.9229715 ,
         0.93719155,  0.93719155],
       [-0.42001042, -0.405412  , -0.405412  , ...,  1.2500329 ,
         1.2784731 ,  1.2926931 ],
       ...,
       [-0.11344349, -0.09884507, -0.21563247, ...,  0.24040821,
         0.18352796,  0.09820756],
       [-0.39081356, -0.5221994 , -0.5367978 , ..., -0.25729406,
        -0.15775362, -0.01555296],
       [-0.21563247, -0.25942776, -0.5367978 , ..., -0.42793486,
        -0.2857342 , -0.12931348]], dtype=float32), None, array([[-1.6608766, -1.6608766, -1.6608766, ..., -1.3522393, -1.3664593,
        -1.3806794],
       [-1.6316798, -1.6316798, -1.6024829, ..., -1.3522393, -1.3522393,
        -1.3522393],
       [-1.6024829, -1.6170814, -1.6316798, ..., -1.3522393, -1.2811389,
        -1.2384787],
       ...,
       [-1.1499318, -1.1061366, -1.1499318, ..., -1.3522393, -1.2953589,
        -1.2811389],
       [-1.2229239, -1.2521207, -1.2813176, ..., -1.1673783, -1.2669188,
        -1.309579 ],
       [-1.4710971, -1.5294908, -1.5586877, ..., -1.3380191, -1.3948994,
        -1.4802198]], dtype=float32), None, array([[-0.6681836 , -0.94555384, -0.8579632 , ...,  0.9514116 ,
         0.9798517 ,  0.96563166],
       [-0.18643562, -0.24482933, -0.303223  , ...,  1.0082918 ,
         0.90875137,  0.823431  ],
       [ 0.13472985, -0.59519154, -0.9163569 , ..., -0.91141707,
        -0.9256371 , -0.95407724],
       ...,
       [ 0.89384794,  0.95224166,  0.9084464 , ..., -0.39949474,
        -0.38527465, -0.3710546 ],
       [ 0.33910778,  0.38290307,  0.5142889 , ..., -0.81187665,
        -0.8403168 , -0.8403168 ],
       [ 0.8646511 ,  0.8792495 ,  0.8792495 , ...,  0.02710724,
        -0.01555296, -0.14353354]], dtype=float32), None, array([[-0.303223  , -0.303223  , -0.303223  , ...,  1.7335151 ,
         1.7335151 ,  1.7335151 ],
       [-0.28862458, -0.28862458, -0.2740262 , ...,  1.7903955 ,
         1.7903955 ,  1.7903955 ],
       [-0.1718372 , -0.1718372 , -0.1718372 , ...,  1.4917741 ,
         1.4917741 ,  1.477554  ],
       ...,
       [-1.4856956 , -1.4564987 , -1.4273019 , ..., -0.5274753 ,
        -0.51325524, -0.54169536],
       [ 0.44129676,  0.95224166,  1.0690291 , ..., -0.20041381,
        -0.08665328, -0.243074  ],
       [-1.1791286 , -1.1207349 , -1.0915381 , ..., -1.1531583 ,
        -1.1531583 , -1.1531583 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), None, None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A bench is sitting by a forest covered in snow.\n', 'Find me an everyday image that matches the given caption: Multiple sheep crossing a road in front of a vehical.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A neighborhood intersection has stop painted on the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A gray striped young cat is hanging on to the toilet seat and stretched into the bowl to drink water.\n', 'Find me an everyday image that matches the given caption: Man looks at another man that is holding a Wii controller in his hands.\n', 'Find me an everyday image that matches the given caption: A group of people standing on snow skis in front of a lodge.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of brown tables with orange chairs under them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: It's necessary to hang out over the side to compensate for the wind blowing in the other direction.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A number of luggage bags on a floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 7/6000 [00:15<3:29:03,  2.09s/it]                                                  {'loss': 17.8342, 'grad_norm': 2032.470703125, 'learning_rate': 7.000000000000001e-07, 'epoch': 0.0}
  0%|          | 7/6000 [00:15<3:29:03,  2.09s/it][2025-11-13 01:31:13,306] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  10074,   3589,    624],
        [151643, 151643, 151643,  ...,  16217,   4752,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,   6249,    624],
        [151643, 151643, 151643,  ...,   4158,   1803,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ["Find me an everyday image that matches the given caption: A teddy bear wearing a santa's hat amongst toys and Christmas items.\n", 'Find me an everyday image that matches the given caption: A bus is parked near a clock and tall building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a man that is standing in front of many doors.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: A cat resting it's head on a book next to a computer.\n", 'Find me an everyday image that matches the given caption: An ordinary kitchen with a stove and appliances.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A spotted dog sitting underneath the kitchen counter.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pair of men on a field play a game.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baby holding a toothbrush while smiling at the camera.\n', 'Find me an everyday image that matches the given caption: A black bear walking behind a white car.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272FAF3D0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5F070>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272B5DB40>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E020>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272B5E140>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5FF70>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272B5F490>], [None], [None]], 'pixel_values': [None, None, array([[ 1.098226  ,  1.1274228 ,  1.1274228 , ...,  1.3780135 ,
         1.3780135 ,  1.3922336 ],
       [ 1.098226  ,  1.0836275 ,  1.0544306 , ...,  1.3637935 ,
         1.3780135 ,  1.3780135 ],
       [ 1.1858164 ,  1.2004149 ,  1.2150133 , ...,  1.4348938 ,
         1.4348938 ,  1.4206737 ],
       ...,
       [ 0.10553299,  0.07633615,  0.0617376 , ...,  0.16930789,
         0.16930789,  0.16930789],
       [ 0.13472985,  0.13472985,  0.12013142, ..., -0.29995427,
         0.02710724,  0.18352796],
       [-0.06964822, -0.0550498 , -0.04045137, ...,  0.21196808,
         0.21196808,  0.21196808]], dtype=float32), None, array([[-1.7192703 , -1.7630657 , -1.7922626 , ..., -1.1247182 ,
        -1.0962781 , -0.9825174 ],
       [-1.6462783 , -1.6024829 , -1.4856956 , ..., -1.1389382 ,
        -1.1815984 , -1.2100385 ],
       [-1.5294908 , -1.5440893 , -1.3835065 , ..., -0.9967375 ,
        -0.9967375 , -0.96829736],
       ...,
       [-1.1061366 , -1.1061366 , -1.1353334 , ..., -0.882977  ,
        -0.96829736, -1.0536178 ],
       [-0.68278205, -0.5221994 , -0.4638057 , ..., -1.3522393 ,
        -1.2953589 , -1.2526988 ],
       [ 0.26611567, -0.2302309 , -0.5659947 , ..., -0.669676  ,
        -0.71233624, -0.71233624]], dtype=float32), array([[-0.20103405, -0.3470183 , -0.33241987, ..., -0.669676  ,
        -0.68389606, -0.6270158 ],
       [-0.25942776, -0.47840413, -0.5659947 , ..., -0.8545369 ,
        -0.58435565, -0.21463387],
       [-0.5805931 , -1.3251129 , -1.5294908 , ..., -1.2669188 ,
        -1.1389382 , -1.1247182 ],
       ...,
       [-1.3397113 , -1.2959161 , -1.4127034 , ..., -1.2953589 ,
        -1.3237991 , -1.3522393 ],
       [-1.2229239 , -1.2667192 , -1.3397113 , ..., -1.3237991 ,
        -1.3664593 , -1.3237991 ],
       [-1.1645303 , -1.1791286 , -1.1791286 , ..., -1.2953589 ,
        -1.2242587 , -1.1531583 ]], dtype=float32), None, None, array([[-1.6024829 , -1.6316798 , -1.5732862 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.6024829 , -1.5878845 , -1.5586877 , ..., -1.3664593 ,
        -1.3664593 , -1.3806794 ],
       [-1.5732862 , -1.6024829 , -1.6024829 , ..., -1.4375596 ,
        -1.4375596 , -1.4233395 ],
       ...,
       [ 0.0617376 ,  0.0617376 ,  0.0617376 , ..., -1.1531583 ,
        -1.1673783 , -1.1815984 ],
       [ 0.10553299,  0.10553299,  0.09093457, ..., -1.082058  ,
        -1.082058  , -1.0962781 ],
       [ 0.00334391,  0.00334391, -0.01125452, ..., -1.0962781 ,
        -1.1104981 , -1.1104981 ]], dtype=float32), None, array([[-0.0550498 , -0.06964822, -0.09884507, ...,  1.0793922 ,
         1.0509521 ,  1.036732  ],
       [-0.15723877, -0.09884507,  0.03254076, ...,  1.1647125 ,
         1.1362724 ,  1.1362724 ],
       [ 0.07633615,  0.12013142,  0.16392669, ...,  1.1789327 ,
         1.1362724 ,  1.1078323 ],
       ...,
       [-0.42001042, -0.43460885, -0.44920728, ..., -0.42793486,
        -0.4421549 , -0.47059506],
       [-0.5221994 , -0.5367978 , -0.5221994 , ..., -0.01555296,
        -0.00133289, -0.01555296],
       [-0.59519154, -0.60978997, -0.6243884 , ..., -0.243074  ,
        -0.243074  , -0.243074  ]], dtype=float32), array([[-0.20103405, -0.1718372 , -0.12804192, ..., -0.5274753 ,
        -0.51325524, -0.48481512],
       [ 0.23691882,  0.25151724,  0.26611567, ..., -0.34261447,
        -0.34261447, -0.32839438],
       [ 0.14932826,  0.17852512,  0.2223204 , ..., -0.4421549 ,
        -0.42793486, -0.39949474],
       ...,
       [-0.37621516, -0.3470183 , -0.3470183 , ..., -1.4091195 ,
        -1.4233395 , -1.4233395 ],
       [-0.5221994 , -0.5221994 , -0.5221994 , ..., -1.4517797 ,
        -1.4517797 , -1.4375596 ],
       [-0.4638057 , -0.4638057 , -0.47840413, ..., -1.4517797 ,
        -1.4517797 , -1.4375596 ]], dtype=float32), None, array([[ 1.652966  ,  1.652966  ,  1.652966  , ...,  2.0321364 ,
         2.0321364 ,  2.0321364 ],
       [ 1.7259582 ,  1.7551551 ,  1.7843518 , ...,  2.0463567 ,
         2.0463567 ,  2.0463567 ],
       [ 1.7989503 ,  1.7989503 ,  1.7989503 , ...,  2.0463567 ,
         2.0463567 ,  2.0463567 ],
       ...,
       [-0.8579632 , -0.5805931 , -0.42001042, ..., -0.5985757 ,
        -0.71233624, -0.8403168 ],
       [-0.88716006, -0.6973805 , -0.5805931 , ..., -0.71233624,
        -0.6981161 , -0.8545369 ],
       [-1.0769397 , -1.0039475 , -0.87256163, ..., -0.91141707,
        -0.9398572 , -0.96829736]], dtype=float32), None, None], 'image_grid_thw': [None, None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 24]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 28, 18]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ["Find me an everyday image that matches the given caption: A teddy bear wearing a santa's hat amongst toys and Christmas items.\n", 'Find me an everyday image that matches the given caption: A bus is parked near a clock and tall building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a man that is standing in front of many doors.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: A cat resting it's head on a book next to a computer.\n", 'Find me an everyday image that matches the given caption: An ordinary kitchen with a stove and appliances.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A spotted dog sitting underneath the kitchen counter.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pair of men on a field play a game.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baby holding a toothbrush while smiling at the camera.\n', 'Find me an everyday image that matches the given caption: A black bear walking behind a white car.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 8/6000 [00:17<3:25:49,  2.06s/it]                                                  {'loss': 19.1541, 'grad_norm': 1681.6556396484375, 'learning_rate': 8.000000000000001e-07, 'epoch': 0.0}
  0%|          | 8/6000 [00:17<3:25:49,  2.06s/it][2025-11-13 01:31:15,295] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    315,  11794,    624],
        [151643, 151643, 151643,  ...,   3283,   8592,    624],
        ...,
        [151643, 151643, 151643,  ...,   6176,   2070,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,  61607,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skier kicking up a spray of snow.\n', 'Find me an everyday image that matches the given caption: A long cement sidewalk on a city street.\n', "Find me an everyday image that matches the given caption: Tourists take a ride in a couch past the nation's capitol.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two pizza boxes sitting on a dining table, one of them left open.\n', 'Find me an everyday image that matches the given caption: Woman wearing a black coat and boots sitting on wooden bench.\n', 'Find me an everyday image that matches the given caption: A man standing on a field holding a catchers mitt.\n', 'Find me an everyday image that matches the given caption: A white bird has its mouth open by the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man and boy are standing in the middle of the living room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An older woman leaning up against a wall next to a clock.\n', 'Find me an everyday image that matches the given caption: Two horses standing on a lush green field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A toilet is in a medical setting with disposals and drawers.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5EFB0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5F520>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=479x256 at 0x7F3272B5C9A0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5F700>], [None], [None], [<PIL.Image.Image image mode=RGB size=361x256 at 0x7F3272B5FEE0>], [None]], 'pixel_values': [array([[1.3463992, 1.3463992, 1.3609976, ..., 1.705075 , 1.7192951,
        1.7192951],
       [1.4631865, 1.4631865, 1.4485881, ..., 1.875716 , 1.875716 ,
        1.875716 ],
       [1.4631865, 1.4631865, 1.4631865, ..., 1.8330555, 1.8472759,
        1.8472759],
       ...,
       [1.3901944, 1.3755959, 1.3609976, ..., 1.4917741, 1.477554 ,
        1.463334 ],
       [1.4193913, 1.4047928, 1.3901944, ..., 1.5059941, 1.4917741,
        1.5202142],
       [1.273407 , 1.273407 , 1.2588086, ..., 1.4064537, 1.3922336,
        1.3637935]], dtype=float32), None, None, None, array([[-0.68278205,  0.61647785,  0.93764323, ..., -1.2669188 ,
        -1.1815984 , -1.1531583 ],
       [-0.7557742 , -0.7557742 , -0.36161673, ..., -1.2100385 ,
        -1.2669188 , -1.082058  ],
       [-1.7192703 , -1.5732862 , -1.3397113 , ..., -1.2100385 ,
        -1.2811389 , -1.2384787 ],
       ...,
       [-1.4419003 , -1.5440893 , -1.5732862 , ..., -1.1389382 ,
        -1.1247182 , -1.1247182 ],
       [-0.82876635, -0.96015227, -1.0915381 , ..., -0.6270158 ,
        -0.7549964 , -0.95407724],
       [-1.2667192 , -1.2521207 , -1.3543098 , ..., -0.78343654,
        -0.68389606, -0.8545369 ]], dtype=float32), None, None, None, None, array([[-1.1791286 , -1.2813176 , -1.3835065 , ..., -0.9256371 ,
        -1.2384787 , -1.0109575 ],
       [-1.398105  , -1.018546  , -1.018546  , ...,  0.7381106 ,
         0.16930789, -0.3710546 ],
       [-1.0331444 , -1.1353334 , -0.87256163, ...,  0.1266477 ,
         0.0413273 , -0.18619375],
       ...,
       [ 1.4485881 ,  1.4631865 ,  1.4631865 , ...,  1.7619553 ,
         1.7477353 ,  1.7761754 ],
       [ 1.7113597 ,  1.2296118 ,  0.10553299, ...,  1.5344343 ,
         1.5059941 ,  1.5628744 ],
       [ 1.0398322 ,  1.3172023 ,  1.4923834 , ...,  1.7477353 ,
         1.7619553 ,  1.7761754 ]], dtype=float32), None, array([[-1.1353334 , -1.1353334 , -1.1353334 , ..., -0.9256371 ,
        -1.0536178 , -1.2953589 ],
       [-1.5878845 , -1.4856956 , -1.2813176 , ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ],
       [-1.4273019 , -1.3689082 , -1.4127034 , ..., -1.2669188 ,
        -1.2953589 , -1.3237991 ],
       ...,
       [-1.4564987 , -1.4564987 , -1.4564987 , ..., -0.10087335,
        -0.10087335, -0.10087335],
       [-0.59519154, -0.59519154, -0.59519154, ..., -0.17197368,
        -0.14353354, -0.11509342],
       [-0.6389868 , -0.6389868 , -0.6389868 , ..., -0.11509342,
        -0.12931348, -0.12931348]], dtype=float32), None, None, array([[-1.018546  , -0.9163569 , -0.7411758 , ..., -0.61279577,
        -0.5274753 , -0.6412359 ],
       [-1.0623412 , -1.018546  , -1.0769397 , ..., -0.54169536,
        -0.57013553, -0.48481512],
       [-0.94555384, -0.9163569 , -1.018546  , ..., -0.882977  ,
        -0.5274753 , -0.47059506],
       ...,
       [-1.193727  , -1.2083255 , -1.2229239 , ..., -0.4421549 ,
        -0.4137148 , -0.42793486],
       [-1.193727  , -1.193727  , -1.2521207 , ..., -0.54169536,
        -0.49903518, -0.47059506],
       [-1.2229239 , -1.2959161 , -1.3105145 , ..., -0.3710546 ,
        -0.3710546 , -0.51325524]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 34]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 26]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skier kicking up a spray of snow.\n', 'Find me an everyday image that matches the given caption: A long cement sidewalk on a city street.\n', "Find me an everyday image that matches the given caption: Tourists take a ride in a couch past the nation's capitol.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two pizza boxes sitting on a dining table, one of them left open.\n', 'Find me an everyday image that matches the given caption: Woman wearing a black coat and boots sitting on wooden bench.\n', 'Find me an everyday image that matches the given caption: A man standing on a field holding a catchers mitt.\n', 'Find me an everyday image that matches the given caption: A white bird has its mouth open by the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man and boy are standing in the middle of the living room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An older woman leaning up against a wall next to a clock.\n', 'Find me an everyday image that matches the given caption: Two horses standing on a lush green field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A toilet is in a medical setting with disposals and drawers.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  0%|          | 9/6000 [00:19<3:24:18,  2.05s/it]                                                  {'loss': 15.0142, 'grad_norm': 1604.4617919921875, 'learning_rate': 9.000000000000001e-07, 'epoch': 0.0}
  0%|          | 9/6000 [00:19<3:24:18,  2.05s/it][2025-11-13 01:31:17,311] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,   9278,    624],
        [151643, 151643, 151643,  ...,   3283,   4126,    624],
        [151643, 151643, 151643,  ...,    323,    803,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man making a face in the mirror.\n', 'Find me an everyday image that matches the given caption: A man with a rope tied to a cow.\n', 'Find me an everyday image that matches the given caption: A man who is looking at his reflection.\n', "Find me an everyday image that matches the given caption: A long silver and red train loading passengers onto it's side.\n", 'Find me an everyday image that matches the given caption: A bird with spread wings is on the sand.\n', 'Find me an everyday image that matches the given caption: Horizontal traffic light seen through tropical vegetation in a city center.\n', 'Find me an everyday image that matches the given caption: Food is on the counter including a glass of water, rice, vegetables, and more.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5EA40>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272FAC9A0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAEEF0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAD180>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FADAE0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272765F30>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272FAF4C0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272765E40>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272765FC0>], [None], [None], [None], [None], [None], [None], [None]], 'pixel_values': [array([[-0.6389868 , -0.6243884 , -0.59519154, ..., -0.5274753 ,
        -0.5274753 , -0.51325524],
       [-0.4638057 , -0.4638057 , -0.39081356, ..., -0.54169536,
        -0.5559154 , -0.5559154 ],
       [-0.9017585 , -0.8433648 , -0.7703726 , ..., -0.95407724,
        -0.9398572 , -0.9256371 ],
       ...,
       [ 0.17852512,  0.14932826,  0.13472985, ...,  0.14086775,
         0.1266477 ,  0.1266477 ],
       [ 0.58728105,  0.42669836,  0.26611567, ...,  0.06976743,
         0.05554737,  0.0413273 ],
       [ 0.4558952 ,  0.4704936 ,  0.4704936 , ..., -0.08665328,
        -0.11509342, -0.11509342]], dtype=float32), array([[ 0.54348576,  0.77706057,  1.0252337 , ..., -0.7265563 ,
        -0.68389606, -0.669676  ],
       [-0.8433648 , -0.88716006, -0.88716006, ..., -0.6270158 ,
        -0.61279577, -0.61279577],
       [-0.9163569 , -0.9163569 , -0.9017585 , ..., -0.669676  ,
        -0.669676  , -0.669676  ],
       ...,
       [-0.33241987, -0.3470183 , -0.3470183 , ..., -0.4421549 ,
        -0.45637497, -0.45637497],
       [-0.303223  , -0.303223  , -0.303223  , ..., -0.39949474,
        -0.4137148 , -0.42793486],
       [-0.405412  , -0.42001042, -0.43460885, ..., -0.5274753 ,
        -0.54169536, -0.54169536]], dtype=float32), array([[0.93764323, 0.95224166, 0.9668401 , ..., 1.2358129 , 1.2358129 ,
        1.2500329 ],
       [1.0690291 , 1.1128243 , 1.098226  , ..., 1.3780135 , 1.3922336 ,
        1.4064537 ],
       [0.93764323, 0.95224166, 0.9668401 , ..., 1.2500329 , 1.2500329 ,
        1.264253  ],
       ...,
       [0.3975015 , 0.3975015 , 0.3975015 , ..., 0.7665507 , 0.75233066,
        0.75233066],
       [0.42669836, 0.42669836, 0.42669836, ..., 0.8376511 , 0.823431  ,
        0.823431  ],
       [0.38290307, 0.36830464, 0.36830464, ..., 0.7381106 , 0.7381106 ,
        0.7381106 ]], dtype=float32), array([[ 1.5215802 ,  1.5215802 ,  1.5215802 , ...,  2.0321364 ,
         2.0321364 ,  2.0321364 ],
       [ 1.5215802 ,  1.5215802 ,  1.5361787 , ...,  2.0463567 ,
         2.0463567 ,  2.0463567 ],
       [ 1.5215802 ,  1.5215802 ,  1.5215802 , ...,  2.0321364 ,
         2.0321364 ,  2.0321364 ],
       ...,
       [ 1.6383677 ,  1.6237692 ,  1.6091708 , ...,  0.43948925,
         0.4963695 ,  0.5816899 ],
       [ 1.6675645 ,  1.6237692 ,  1.5945723 , ...,  0.8660912 ,
         0.68123037,  0.52480966],
       [ 0.6018794 ,  0.4704936 ,  0.33910778, ..., -1.4375596 ,
        -1.3806794 , -1.3522393 ]], dtype=float32), array([[-1.6754751 , -1.7192703 , -1.704672  , ..., -1.1104981 ,
        -1.1531583 , -1.0962781 ],
       [-1.398105  , -1.398105  , -1.3835065 , ..., -0.7692165 ,
        -0.78343654, -0.81187665],
       [-1.6754751 , -1.3397113 , -1.1353334 , ..., -0.5985757 ,
        -0.669676  , -0.74077636],
       ...,
       [-1.398105  , -1.5294908 , -1.500294  , ..., -0.51325524,
        -0.4421549 , -0.5985757 ],
       [-1.5148925 , -1.5294908 , -1.5440893 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ],
       [-0.72657734, -0.47840413, -0.7411758 , ..., -1.4091195 ,
        -1.3806794 , -1.3380191 ]], dtype=float32), array([[-1.2959161 , -1.193727  , -1.193727  , ..., -1.4517797 ,
        -1.4375596 , -1.4091195 ],
       [-1.2521207 , -1.2959161 , -1.3543098 , ..., -1.4517797 ,
        -1.4802198 , -1.4659997 ],
       [-1.1645303 , -1.1061366 , -1.018546  , ..., -1.4802198 ,
        -1.4091195 , -1.3522393 ],
       ...,
       [ 1.2880055 ,  1.2296118 ,  1.1566195 , ..., -0.48481512,
        -0.74077636, -1.1247182 ],
       [ 1.0398322 ,  1.0836275 ,  1.1420212 , ...,  0.06976743,
         0.06976743,  0.06976743],
       [ 1.0690291 ,  1.0106354 ,  0.9668401 , ..., -0.8260967 ,
        -1.2100385 , -1.3237991 ]], dtype=float32), array([[-0.65358526, -0.6681836 , -0.6681836 , ..., -0.4137148 ,
        -0.57013553, -0.9398572 ],
       [-1.1061366 , -1.1207349 , -1.1061366 , ..., -1.1815984 ,
        -1.1815984 , -1.1673783 ],
       [-0.9309554 , -0.8141679 , -0.6681836 , ..., -0.57013553,
        -0.42793486, -0.31417432],
       ...,
       [-0.44920728, -0.4638057 , -0.49300256, ..., -1.0393977 ,
        -1.0393977 , -1.0251776 ],
       [-0.55139625, -0.55139625, -0.5659947 , ..., -1.0251776 ,
        -0.9967375 , -1.0251776 ],
       [-0.6681836 , -0.6681836 , -0.6973805 , ..., -1.0962781 ,
        -1.1389382 , -1.1531583 ]], dtype=float32), array([[-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       ...,
       [-1.3251129, -1.3397113, -1.2959161, ..., -1.0251776, -1.0536178,
        -1.067838 ],
       [-1.6316798, -1.6462783, -1.6462783, ..., -1.2384787, -1.2526988,
        -1.2669188],
       [-1.6608766, -1.6900735, -1.6608766, ..., -1.3806794, -1.3806794,
        -1.4233395]], dtype=float32), array([[-0.09884507, -0.14264035, -0.1718372 , ...,  0.52480966,
         0.4963695 ,  0.4110491 ],
       [-0.14264035, -0.14264035, -0.08424664, ...,  0.33994877,
         0.3257286 ,  0.3257286 ],
       [-0.15723877, -0.14264035, -0.12804192, ...,  0.5390297 ,
         0.51058954,  0.4963695 ],
       ...,
       [-0.18643562, -0.1718372 , -0.15723877, ..., -0.11509342,
        -0.14353354, -0.15775362],
       [-0.2302309 , -0.21563247, -0.21563247, ..., -0.21463387,
        -0.243074  , -0.22885394],
       [-0.21563247, -0.21563247, -0.20103405, ..., -0.2857342 ,
        -0.2857342 , -0.29995427]], dtype=float32), None, None, None, None, None, None, None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, None, None, None, None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man making a face in the mirror.\n', 'Find me an everyday image that matches the given caption: A man with a rope tied to a cow.\n', 'Find me an everyday image that matches the given caption: A man who is looking at his reflection.\n', "Find me an everyday image that matches the given caption: A long silver and red train loading passengers onto it's side.\n", 'Find me an everyday image that matches the given caption: A bird with spread wings is on the sand.\n', 'Find me an everyday image that matches the given caption: Horizontal traffic light seen through tropical vegetation in a city center.\n', 'Find me an everyday image that matches the given caption: Food is on the counter including a glass of water, rice, vegetables, and more.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 10/6000 [00:21<3:27:09,  2.08s/it]                                                   {'loss': 18.3526, 'grad_norm': 1354.6689453125, 'learning_rate': 1.0000000000000002e-06, 'epoch': 0.0}
  0%|          | 10/6000 [00:21<3:27:09,  2.08s/it][2025-11-13 01:31:19,457] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    315,  79860,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person sitting in front of a plate of pancakes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is flying a kite on the beach shore.\n', 'Find me an everyday image that matches the given caption: Man sitting on last step in front of door while holding his phone.\n', 'Find me an everyday image that matches the given caption: Empty swimming pool with empty beds placed poolside.\n', 'Find me an everyday image that matches the given caption: A man talks on his phone with a can in his hand.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727662F0>], [None], [<PIL.Image.Image image mode=RGB size=419x256 at 0x7F32727657E0>], [<PIL.Image.Image image mode=RGB size=339x256 at 0x7F3272766200>], [<PIL.Image.Image image mode=RGB size=317x256 at 0x7F3272766380>], [<PIL.Image.Image image mode=RGB size=367x256 at 0x7F3272766290>], [<PIL.Image.Image image mode=RGB size=635x256 at 0x7F3272766230>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272766410>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272766320>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727662C0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727663B0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272766350>]], 'pixel_values': [array([[ 1.1274228 ,  1.1274228 ,  1.1420212 , ...,  1.7761754 ,
         1.7761754 ,  1.7335151 ],
       [ 1.1420212 ,  0.7040684 ,  0.33910778, ...,  1.2215928 ,
         0.6527902 ,  0.26884836],
       [ 1.2004149 ,  1.2004149 ,  1.2004149 , ...,  1.7619553 ,
         1.7619553 ,  1.7619553 ],
       ...,
       [-1.6462783 , -1.5878845 , -1.3835065 , ..., -1.1104981 ,
        -1.1247182 , -1.1247182 ],
       [-1.6608766 , -1.6316798 , -1.6316798 , ..., -0.74077636,
        -0.6981161 , -0.65545595],
       [-1.5586877 , -1.3543098 , -1.193727  , ..., -0.02977302,
         0.02710724,  0.01288717]], dtype=float32), None, array([[-0.01125452, -0.0550498 , -0.01125452, ..., -1.2526988 ,
        -1.2384787 , -1.2669188 ],
       [ 0.2223204 ,  0.38290307,  0.16392669, ..., -0.78343654,
        -0.7549964 , -0.8260967 ],
       [-1.1207349 , -1.1353334 , -1.1353334 , ..., -1.2669188 ,
        -1.2669188 , -1.2526988 ],
       ...,
       [-0.78497106, -0.87256163, -0.9893491 , ..., -0.7976566 ,
        -0.8403168 , -0.8545369 ],
       [-0.7411758 , -0.68278205, -0.7557742 , ..., -0.7976566 ,
        -0.81187665, -0.78343654],
       [-1.0769397 , -1.0039475 , -0.94555384, ..., -0.78343654,
        -0.8260967 , -0.8545369 ]], dtype=float32), array([[-1.0623412 , -1.0477428 , -1.018546  , ...,  0.01288717,
        -0.00133289,  0.0413273 ],
       [-0.65358526, -0.6389868 , -0.6389868 , ..., -0.39949474,
        -0.4421549 , -0.96829736],
       [-0.60978997, -0.60978997, -0.5805931 , ...,  0.38260898,
         0.4110491 ,  0.46792936],
       ...,
       [-0.82876635, -0.9309554 , -1.0623412 , ..., -0.74077636,
        -0.7549964 , -0.7692165 ],
       [-0.82876635, -0.8579632 , -0.9309554 , ..., -0.68389606,
        -0.7549964 , -0.81187665],
       [-1.1061366 , -1.0769397 , -1.018546  , ..., -0.91141707,
        -0.9398572 , -0.9398572 ]], dtype=float32), array([[-0.15723877, -0.1718372 , -0.18643562, ..., -0.17197368,
        -0.17197368, -0.18619375],
       [-0.3470183 , -0.3470183 , -0.33241987, ..., -0.3710546 ,
        -0.3710546 , -0.32839438],
       [-0.15723877, -0.15723877, -0.15723877, ...,  0.02710724,
         0.02710724,  0.02710724],
       ...,
       [-0.6973805 , -0.6243884 , -0.65358526, ..., -1.2100385 ,
        -1.2384787 ,  0.18352796],
       [-1.0477428 , -1.0477428 , -1.0915381 , ...,  1.6055346 ,
         1.6339747 ,  1.6339747 ],
       [-1.4127034 , -1.3397113 , -1.3397113 , ...,  1.5770944 ,
         1.6055346 ,  1.6624149 ]], dtype=float32), array([[-0.47840413, -0.49300256, -0.49300256, ...,  0.93719155,
         0.9514116 ,  0.9514116 ],
       [-0.5659947 , -0.5659947 , -0.5805931 , ...,  0.96563166,
         0.96563166,  0.9798517 ],
       [-0.5659947 , -0.5659947 , -0.5659947 , ...,  0.9798517 ,
         0.9798517 ,  0.9940718 ],
       ...,
       [-0.06964822, -0.09884507, -0.08424664, ..., -0.00133289,
         0.01288717,  0.01288717],
       [-0.0550498 , -0.06964822, -0.08424664, ...,  0.0413273 ,
         0.0413273 ,  0.05554737],
       [-0.06964822, -0.0550498 , -0.0550498 , ...,  0.3257286 ,
         0.38260898,  0.4252692 ]], dtype=float32), array([[ 1.8427455 ,  1.8427455 ,  1.8427455 , ...,  1.9325962 ,
         1.9325962 ,  1.9325962 ],
       [ 1.8427455 ,  1.8427455 ,  1.8427455 , ...,  2.0036962 ,
         2.0036962 ,  2.0036962 ],
       [ 1.7843518 ,  1.7843518 ,  1.7843518 , ...,  1.875716  ,
         1.8899357 ,  1.8899357 ],
       ...,
       [ 0.2223204 ,  0.26611567,  0.33910778, ..., -0.9825174 ,
        -1.0251776 , -0.6412359 ],
       [ 0.4558952 ,  0.4558952 ,  0.49969047, ..., -1.1958185 ,
        -1.0109575 , -1.0393977 ],
       [ 0.38290307,  0.41209993,  0.3975015 , ..., -1.1673783 ,
        -1.2669188 , -0.10087335]], dtype=float32), None, None, None, None, array([[-1.5878845 , -1.6024829 , -1.6024829 , ..., -1.2242587 ,
        -1.2100385 , -1.2100385 ],
       [-1.3689082 , -1.3835065 , -1.4710971 , ..., -1.309579  ,
        -1.2669188 , -1.2526988 ],
       [-1.3835065 , -1.3689082 , -1.3689082 , ..., -1.2242587 ,
        -1.1389382 , -1.082058  ],
       ...,
       [ 1.4485881 ,  1.4339896 ,  1.4339896 , ...,  1.4491138 ,
         1.3069133 ,  1.2073728 ],
       [ 1.4485881 ,  1.4485881 ,  1.4485881 , ..., -0.71233624,
        -0.74077636, -0.7692165 ],
       [ 1.3463992 ,  1.3172023 ,  1.3463992 , ..., -0.81187665,
        -0.8260967 , -0.8260967 ]], dtype=float32), array([[-4.6380571e-01, -4.4920728e-01,  2.2232039e-01, ...,
         2.9728848e-01,  2.5462827e-01, -1.4353354e-01],
       [-6.6818362e-01, -2.4482933e-01, -4.0541199e-01, ...,
        -1.5552960e-02, -2.2885394e-01, -1.3328948e-03],
       [-9.7475070e-01, -1.0769397e+00, -7.7037263e-01, ...,
         1.1647125e+00,  1.1647125e+00,  1.1504925e+00],
       ...,
       [ 1.7405566e+00,  1.8281472e+00,  1.8719424e+00, ...,
         5.5324978e-01,  7.6655072e-01,  8.3765107e-01],
       [ 9.8143852e-01,  1.0690291e+00,  1.1128243e+00, ...,
         2.0179167e+00,  1.9894764e+00,  1.9894764e+00],
       [ 1.4923834e+00,  1.4777850e+00,  1.4339896e+00, ...,
         1.9610363e+00,  1.9894764e+00,  2.0036962e+00]], dtype=float32), array([[ 0.71866685,  0.4704936 ,  0.04713918, ..., -0.57013553,
        -0.27151415, -0.5559154 ],
       [-0.55139625, -0.4638057 , -0.405412  , ..., -0.47059506,
        -0.35683453, -0.42793486],
       [-1.1207349 , -0.8579632 , -1.0915381 , ..., -0.6412359 ,
        -0.7692165 , -0.7549964 ],
       ...,
       [-1.7484672 , -1.5878845 , -1.0623412 , ..., -0.31417432,
        -0.22885394, -0.17197368],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4659997 ],
       [-1.7484672 , -1.7338688 , -1.7484672 , ..., -0.8403168 ,
         0.5816899 ,  1.7619553 ]], dtype=float32), array([[-1.4564987 , -1.4564987 , -1.4564987 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.5732862 , -1.6024829 , -1.6462783 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.4710971 , -1.4710971 , -1.4710971 , ..., -1.2953589 ,
        -1.2669188 , -1.2526988 ],
       ...,
       [-0.6243884 , -0.5805931 , -0.5659947 , ..., -1.3380191 ,
        -1.3380191 , -1.3380191 ],
       [-0.9747507 , -0.82876635, -0.7411758 , ..., -1.3664593 ,
        -1.3237991 , -1.3237991 ],
       [-0.49300256, -0.50760096, -0.5367978 , ..., -1.3380191 ,
        -1.3380191 , -1.3380191 ]], dtype=float32), array([[ 1.7405566 ,  1.5945723 ,  1.8719424 , ...,  1.1078323 ,
         1.5913146 ,  1.8188357 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.1316772 ,
         2.117457  ,  2.1316772 ],
       [ 1.8281472 ,  1.8427455 ,  1.8865409 , ...,  0.0839875 ,
         0.18352796,  0.19774802],
       ...,
       [ 0.25151724,  0.2807141 ,  0.26611567, ..., -0.57013553,
        -0.6981161 , -0.91141707],
       [ 0.76246214,  0.49969047,  0.26611567, ..., -1.1815984 ,
        -1.1247182 , -1.1247182 ],
       [ 1.1566195 ,  0.8646511 ,  0.5580842 , ..., -1.2526988 ,
        -1.2669188 , -1.2669188 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), None, array([[ 1, 18, 30]]), array([[ 1, 18, 24]]), array([[ 1, 18, 22]]), array([[ 1, 18, 26]]), array([[ 1, 18, 46]]), None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person sitting in front of a plate of pancakes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is flying a kite on the beach shore.\n', 'Find me an everyday image that matches the given caption: Man sitting on last step in front of door while holding his phone.\n', 'Find me an everyday image that matches the given caption: Empty swimming pool with empty beds placed poolside.\n', 'Find me an everyday image that matches the given caption: A man talks on his phone with a can in his hand.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 11/6000 [00:23<3:27:18,  2.08s/it]                                                   {'loss': 20.8442, 'grad_norm': 1772.1783447265625, 'learning_rate': 1.1e-06, 'epoch': 0.0}
  0%|          | 11/6000 [00:23<3:27:18,  2.08s/it][2025-11-13 01:31:21,533] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   3460,  19145,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  97982,  13647,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of military officials in an office setting cutting a large cake.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small black and blue bird standing on a wooden surface.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A set of four tooth brushes sitting next to each other.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A red headed woman runs and kicks a ball on a soccer field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat on a sofa is watching tv.\n', 'Find me an everyday image that matches the given caption: Man preforming stunt on skies on several slopes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man with a skateboard standing on top of a skateboard pipe.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272B5D720>], [None], [<PIL.Image.Image image mode=RGB size=308x256 at 0x7F3272B5F4F0>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272765B10>], [None], [<PIL.Image.Image image mode=RGB size=320x256 at 0x7F3272765B70>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272767B50>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272765720>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272767BB0>], [None], [<PIL.Image.Image image mode=RGB size=415x256 at 0x7F3272766440>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272766470>]], 'pixel_values': [array([[-0.31782144, -0.31782144, -0.303223  , ..., -0.74077636,
        -0.7265563 , -0.71233624],
       [-0.12804192, -0.12804192, -0.12804192, ..., -0.669676  ,
        -0.65545595, -0.65545595],
       [-0.11344349, -0.11344349, -0.09884507, ..., -0.669676  ,
        -0.65545595, -0.6412359 ],
       ...,
       [ 1.1274228 ,  1.1128243 ,  1.1128243 , ..., -0.10087335,
        -0.10087335, -0.10087335],
       [ 1.171218  ,  1.171218  ,  1.171218  , ..., -0.01555296,
        -0.04399309, -0.04399309],
       [ 1.1128243 ,  1.098226  ,  1.098226  , ..., -0.10087335,
        -0.10087335, -0.10087335]], dtype=float32), None, array([[-0.06964822, -0.06964822, -0.06964822, ...,  0.4110491 ,
         0.4110491 ,  0.43948925],
       [-0.36161673, -0.36161673, -0.49300256, ..., -0.04399309,
        -0.14353354, -0.17197368],
       [-0.5659947 , -0.47840413, -0.49300256, ..., -0.32839438,
        -0.57013553, -0.89719707],
       ...,
       [-0.6681836 , -0.6389868 , -0.42001042, ..., -0.00133289,
        -0.243074  , -0.38527465],
       [-0.68278205, -0.5659947 , -0.43460885, ..., -0.95407724,
        -0.7549964 , -0.6412359 ],
       [-0.04045137, -0.08424664,  0.03254076, ..., -0.12931348,
        -0.5559154 , -0.7265563 ]], dtype=float32), None, array([[-0.82876635, -0.8141679 , -0.78497106, ..., -0.8260967 ,
        -0.81187665, -0.8545369 ],
       [-0.78497106, -0.78497106, -0.7411758 , ..., -0.6270158 ,
        -0.6412359 , -0.6412359 ],
       [ 0.33910778,  0.3537062 ,  0.3537062 , ..., -1.3380191 ,
        -1.3522393 , -1.2526988 ],
       ...,
       [-0.9163569 , -0.9163569 , -0.87256163, ..., -1.1389382 ,
        -1.1247182 , -1.1247182 ],
       [-0.6681836 , -0.6681836 , -0.6389868 , ..., -1.1673783 ,
        -1.1389382 , -1.1673783 ],
       [-0.88716006, -0.88716006, -0.8141679 , ..., -1.0962781 ,
        -1.0393977 , -1.0109575 ]], dtype=float32), None, array([[-0.36161673, -0.36161673, -0.36161673, ...,  2.0036962 ,
         2.0036962 ,  2.0036962 ],
       [-0.24482933, -0.25942776, -0.25942776, ...,  2.0321364 ,
         2.0179167 ,  2.0179167 ],
       [-0.24482933, -0.24482933, -0.24482933, ...,  2.074797  ,
         2.074797  ,  2.074797  ],
       ...,
       [ 0.00334391, -0.02585294, -0.02585294, ...,  0.28306842,
         0.29728848,  0.26884836],
       [ 0.10553299,  0.10553299,  0.10553299, ...,  0.16930789,
         0.18352796,  0.21196808],
       [ 0.07633615,  0.07633615,  0.0617376 , ..., -0.11509342,
        -0.08665328, -0.04399309]], dtype=float32), array([[ 0.66027313,  0.6018794 ,  0.3975015 , ..., -0.14353354,
        -0.07243322, -0.10087335],
       [ 0.4704936 ,  0.41209993,  0.5726826 , ..., -0.04399309,
        -0.00133289, -0.01555296],
       [ 0.8646511 ,  0.77706057,  0.66027313, ..., -0.25729406,
        -0.25729406, -0.17197368],
       ...,
       [ 0.4704936 ,  0.7478637 ,  0.76246214, ..., -0.669676  ,
        -0.61279577, -0.7976566 ],
       [ 0.4704936 ,  0.58728105,  0.54348576, ...,  0.09820756,
         0.18352796, -0.02977302],
       [-0.01125452, -0.04045137, -0.01125452, ..., -0.243074  ,
        -0.32839438, -0.4137148 ]], dtype=float32), None, array([[ 0.12013142,  0.12013142,  0.13472985, ...,  1.7192951 ,
         1.7192951 ,  1.7192951 ],
       [ 0.16392669,  0.14932826,  0.07633615, ...,  1.7619553 ,
         1.7619553 ,  1.7761754 ],
       [ 0.23691882,  0.23691882,  0.23691882, ...,  1.7335151 ,
         1.7477353 ,  1.7477353 ],
       ...,
       [-0.5367978 , -0.3470183 , -0.405412  , ..., -0.07243322,
         0.21196808,  0.5390297 ],
       [ 0.19312355,  0.29531252,  0.58728105, ...,  1.0082918 ,
         1.5202142 ,  0.7665507 ],
       [-0.09884507,  0.30991095,  0.3975015 , ...,  0.6243501 ,
         0.96563166,  0.93719155]], dtype=float32), None, None, array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.082058  ,
        -1.082058  , -1.082058  ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.082058  ,
        -1.082058  , -1.082058  ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ...,  0.9798517 ,
         0.9940718 ,  1.0082918 ],
       ...,
       [-0.28862458, -0.24482933, -0.12804192, ..., -1.082058  ,
        -1.082058  , -1.082058  ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.082058  ,
        -1.082058  , -1.082058  ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.082058  ,
        -1.082058  , -1.082058  ]], dtype=float32), None, array([[-0.94555384, -1.018546  , -1.1061366 , ..., -1.0962781 ,
        -1.0962781 , -1.0962781 ],
       [-1.3397113 , -1.3543098 , -1.2813176 , ..., -1.0962781 ,
        -0.5985757 , -0.6412359 ],
       [-1.3397113 , -1.3689082 , -1.398105  , ..., -0.9256371 ,
        -0.95407724, -0.9967375 ],
       ...,
       [ 0.48509204,  0.48509204,  0.48509204, ...,  0.48214942,
         0.46792936,  0.4963695 ],
       [ 0.4704936 ,  0.48509204,  0.49969047, ...,  0.31150854,
         0.3257286 ,  0.31150854],
       [ 0.44129676,  0.44129676,  0.42669836, ...,  0.39682904,
         0.4252692 ,  0.4537093 ]], dtype=float32), array([[-0.405412  , -0.42001042, -0.37621516, ..., -0.14353354,
        -0.12931348, -0.07243322],
       [-0.50760096, -0.68278205, -0.6973805 , ...,  0.75233066,
         0.7381106 ,  0.72389054],
       [ 0.14932826,  0.16392669,  0.17852512, ...,  0.35416883,
         0.35416883,  0.36838892],
       ...,
       [-0.44920728, -0.47840413, -0.49300256, ..., -0.31417432,
        -0.29995427, -0.2857342 ],
       [-1.0623412 , -1.0769397 , -1.0769397 , ...,  0.24040821,
         0.31150854,  0.43948925],
       [-1.0039475 , -1.0039475 , -1.0039475 , ...,  0.31150854,
         0.38260898,  0.4252692 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 18]]), None, array([[ 1, 18, 22]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 22]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 18]]), None, array([[ 1, 18, 30]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of military officials in an office setting cutting a large cake.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small black and blue bird standing on a wooden surface.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A set of four tooth brushes sitting next to each other.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A red headed woman runs and kicks a ball on a soccer field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat on a sofa is watching tv.\n', 'Find me an everyday image that matches the given caption: Man preforming stunt on skies on several slopes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man with a skateboard standing on top of a skateboard pipe.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 12/6000 [00:26<3:29:01,  2.09s/it]                                                   {'loss': 18.1964, 'grad_norm': 1695.96142578125, 'learning_rate': 1.2000000000000002e-06, 'epoch': 0.0}
  0%|          | 12/6000 [00:26<3:29:01,  2.09s/it][2025-11-13 01:31:23,667] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    323,  14285,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  42613,  99127,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   3691,   7781,    624],
        [151643, 151643, 151643,  ...,    279,   5636,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A living room with wooden floors and walls.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two bathroom sinks under two mirrors next to paper towel dispenser.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man in the suit stands in the corner of the room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of fruits and vegetables laid out on the table.\n', 'Find me an everyday image that matches the given caption: Person with a red jacket skiing next to a building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy lays on top of a bunch of teddy bears.\n', 'Find me an everyday image that matches the given caption: A group of people on a flat land flying a kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a man dressed in a purple tie and black suit.\n', 'Find me an everyday image that matches the given caption: Outdoor market with lots of fruits on the side of the road.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=391x256 at 0x7F3272B5F280>], [None], [<PIL.Image.Image image mode=RGB size=415x256 at 0x7F32727676A0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272767880>], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272767820>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727677C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272767910>], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727678B0>], [None], [None]], 'pixel_values': [None, array([[ 1.8719424,  1.8719424,  1.8719424, ...,  1.7619553,  1.463334 ,
         1.1647125],
       [ 1.857344 ,  1.857344 ,  1.857344 , ...,  2.1316772,  1.918376 ,
         1.7761754],
       [ 1.8281472,  1.8281472,  1.8281472, ...,  2.0890167,  2.074797 ,
         2.074797 ],
       ...,
       [-1.500294 , -1.4273019, -1.398105 , ...,  1.5344343,  1.6055346,
         1.9468161],
       [ 1.6675645,  1.6821629,  1.5507771, ...,  1.5486543,  1.6624149,
         1.5202142],
       [ 1.5507771,  1.5361787,  1.5215802, ...,  1.036732 ,  1.6197547,
         2.145897 ]], dtype=float32), None, array([[ 0.26611567,  0.30991095,  0.3537062 , ...,  0.22618815,
         0.24040821,  0.29728848],
       [-0.15723877, -1.1499318 , -1.5440893 , ..., -0.01555296,
         0.28306842,  0.25462827],
       [ 0.4558952 ,  0.4558952 ,  0.44129676, ...,  0.4110491 ,
         0.39682904,  0.39682904],
       ...,
       [ 0.5726826 ,  0.6018794 ,  0.61647785, ..., -1.1673783 ,
        -1.1815984 , -1.1958185 ],
       [ 0.9230448 ,  0.89384794,  0.89384794, ..., -1.0962781 ,
        -1.0109575 , -0.9825174 ],
       [ 0.7040684 ,  0.66027313,  0.6310763 , ..., -0.7976566 ,
        -0.8260967 , -0.86875695]], dtype=float32), array([[-0.14264035, -0.14264035, -0.14264035, ..., -0.14353354,
        -0.12931348, -0.12931348],
       [-0.08424664, -0.08424664, -0.09884507, ..., -0.11509342,
        -0.11509342, -0.11509342],
       [-0.08424664, -0.08424664, -0.08424664, ..., -0.11509342,
        -0.11509342, -0.10087335],
       ...,
       [-0.18643562, -0.14264035,  0.01794233, ..., -0.34261447,
        -0.34261447, -0.34261447],
       [-0.42001042, -0.4638057 , -0.31782144, ..., -0.27151415,
        -0.4137148 , -0.45637497],
       [-0.2302309 , -0.21563247, -0.20103405, ..., -0.38527465,
        -0.29995427, -0.32839438]], dtype=float32), None, array([[ 0.52888733,  0.89384794,  0.52888733, ...,  1.4348938 ,
         1.463334  ,  1.5059941 ],
       [ 1.0690291 ,  1.0398322 ,  1.0252337 , ...,  1.3922336 ,
         1.1647125 ,  0.39682904],
       [ 0.58728105,  0.95224166,  1.0398322 , ...,  1.3780135 ,
         1.4348938 ,  1.4206737 ],
       ...,
       [ 0.8208558 ,  0.8354542 ,  0.8354542 , ...,  0.31150854,
         0.31150854,  0.31150854],
       [ 0.9230448 ,  0.95224166,  0.8792495 , ...,  0.24040821,
         0.29728848,  0.31150854],
       [ 1.098226  ,  1.1274228 ,  1.1274228 , ...,  0.05554737,
         0.01288717, -0.07243322]], dtype=float32), None, None, array([[ 0.49969047,  0.7332653 ,  0.89384794, ...,  0.63857013,
         0.5816899 ,  0.5532498 ],
       [ 0.8354542 ,  0.8062574 ,  1.1128243 , ...,  0.4537093 ,
         0.6954504 ,  0.7665507 ],
       [ 0.85005265,  0.71866685,  0.3537062 , ...,  1.3922336 ,
         1.3780135 ,  1.3069133 ],
       ...,
       [-1.3543098 , -1.3397113 , -1.3251129 , ..., -1.082058  ,
        -1.067838  , -1.0536178 ],
       [-1.5148925 , -1.5586877 , -1.4564987 , ..., -1.1389382 ,
        -1.1247182 , -1.1247182 ],
       [-1.3835065 , -1.3689082 , -1.3835065 , ..., -1.0536178 ,
        -1.0393977 , -1.0393977 ]], dtype=float32), array([[ 0.3537062 ,  0.3537062 ,  0.33910778, ...,  0.63857013,
         0.63857013,  0.63857013],
       [ 0.26611567,  0.26611567,  0.26611567, ...,  0.6243501 ,
         0.6243501 ,  0.6243501 ],
       [ 0.42669836,  0.42669836,  0.41209993, ...,  0.7949909 ,
         0.7807708 ,  0.7807708 ],
       ...,
       [ 0.26611567, -0.01125452, -0.2740262 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 0.19312355,  0.2223204 ,  0.20772196, ..., -0.65545595,
        -0.57013553, -0.49903518],
       [ 0.16392669, -0.06964822, -0.39081356, ...,  2.145897  ,
         2.145897  ,  2.145897  ]], dtype=float32), None, None, array([[ 1.9157377 ,  1.9303361 ,  1.9303361 , ..., -0.9398572 ,
        -1.2669188 , -1.3237991 ],
       [ 1.8427455 ,  1.9157377 ,  1.857344  , ..., -1.309579  ,
        -1.2811389 , -1.1673783 ],
       [ 1.9303361 ,  1.8865409 ,  1.1566195 , ..., -1.0393977 ,
        -0.68389606, -0.57013553],
       ...,
       [ 1.2296118 ,  1.2150133 ,  1.2296118 , ...,  1.7903955 ,
         2.0036962 ,  2.0463567 ],
       [ 1.1858164 ,  1.3463992 ,  1.1420212 , ...,  2.0605767 ,
         2.145897  ,  2.117457  ],
       [ 1.3026038 ,  1.3172023 ,  1.3172023 , ...,  2.145897  ,
         2.145897  ,  2.145897  ]], dtype=float32), None, None], 'image_grid_thw': [None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 30]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A living room with wooden floors and walls.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two bathroom sinks under two mirrors next to paper towel dispenser.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man in the suit stands in the corner of the room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of fruits and vegetables laid out on the table.\n', 'Find me an everyday image that matches the given caption: Person with a red jacket skiing next to a building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy lays on top of a bunch of teddy bears.\n', 'Find me an everyday image that matches the given caption: A group of people on a flat land flying a kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a man dressed in a purple tie and black suit.\n', 'Find me an everyday image that matches the given caption: Outdoor market with lots of fruits on the side of the road.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 13/6000 [00:28<3:27:36,  2.08s/it]                                                   {'loss': 18.0495, 'grad_norm': 2445.565185546875, 'learning_rate': 1.3e-06, 'epoch': 0.0}
  0%|          | 13/6000 [00:28<3:27:36,  2.08s/it][2025-11-13 01:31:25,718] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    458,  47898,    624],
        [151643, 151643, 151643,  ...,  83489,  15328,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   2070,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A man and a women kissing under an umbrella.\n', 'Find me an everyday image that matches the given caption: A group of people on a long canoe boat.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A blue glass vase with some flowers on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: View inside a large oven with two pans and the oven light on.\n', 'Find me an everyday image that matches the given caption: A group of ultimate frisbee players wearing green and orange.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A building clock tower with its establishment date on it.\n', 'Find me an everyday image that matches the given caption: The child sits on a skateboard next to another child holding a skateboard.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of little leaguers standing on top of a field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272766710>], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272765450>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272767850>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272766290>], [None], [None], [<PIL.Image.Image image mode=RGB size=455x256 at 0x7F3272B5E9B0>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272766E90>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272765F30>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272766BC0>]], 'pixel_values': [None, None, array([[-0.04045137, -0.01125452,  0.07633615, ..., -1.1815984 ,
        -0.9967375 , -1.0251776 ],
       [-0.68278205, -0.5367978 , -0.15723877, ..., -0.4421549 ,
        -0.47059506, -0.54169536],
       [-0.5367978 , -0.44920728, -0.3470183 , ..., -0.5274753 ,
        -0.5559154 , -0.58435565],
       ...,
       [-1.193727  , -1.193727  , -1.193727  , ..., -1.3806794 ,
        -1.3806794 , -1.3664593 ],
       [-1.2375224 , -1.2229239 , -1.2083255 , ..., -1.4091195 ,
        -1.3948994 , -1.3948994 ],
       [-1.193727  , -1.193727  , -1.2229239 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ]], dtype=float32), None, array([[-1.4419003 , -1.4419003 , -1.4419003 , ..., -1.3948994 ,
        -1.3948994 , -1.3806794 ],
       [-1.3689082 , -1.3689082 , -1.3543098 , ..., -1.4091195 ,
        -1.3806794 , -1.3806794 ],
       [-1.4419003 , -1.4419003 , -1.4419003 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       ...,
       [-0.9747507 , -0.9893491 , -0.9893491 , ..., -1.4802198 ,
        -1.4517797 , -1.4517797 ],
       [-0.88716006, -0.88716006, -0.88716006, ..., -1.4659997 ,
        -1.4802198 , -1.4802198 ],
       [-1.0477428 , -1.0623412 , -1.0623412 , ..., -1.4802198 ,
        -1.4659997 , -1.4802198 ]], dtype=float32), None, None, array([[ 0.26611567,  0.52888733, -0.04045137, ..., -1.2669188 ,
        -1.0962781 , -1.2669188 ],
       [-0.82876635, -0.9747507 , -0.87256163, ..., -1.0109575 ,
        -1.2384787 , -1.2669188 ],
       [-0.44920728, -0.6389868 , -0.6973805 , ..., -0.5559154 ,
        -0.7265563 , -1.1389382 ],
       ...,
       [-1.1499318 , -0.9309554 , -1.2083255 , ..., -1.0962781 ,
        -0.95407724, -0.96829736],
       [-0.96015227, -0.6681836 , -0.55139625, ..., -1.0962781 ,
        -1.067838  , -1.0109575 ],
       [-0.68278205, -0.7411758 , -0.6389868 , ..., -0.9825174 ,
        -1.2242587 , -1.1247182 ]], dtype=float32), array([[-0.6681836 , -0.6681836 , -0.6681836 , ...,  1.6481948 ,
         1.6481948 ,  1.6481948 ],
       [-0.6681836 , -0.68278205, -0.68278205, ...,  1.6481948 ,
         1.6481948 ,  1.6481948 ],
       [-0.68278205, -0.68278205, -0.68278205, ...,  1.690855  ,
         1.690855  ,  1.690855  ],
       ...,
       [ 0.6310763 ,  0.6456747 ,  0.6310763 , ...,  0.24040821,
         0.24040821,  0.26884836],
       [ 0.52888733,  0.49969047,  0.48509204, ...,  0.6670103 ,
         0.63857013,  0.6670103 ],
       [ 0.49969047,  0.5580842 ,  0.58728105, ...,  0.68123037,
         0.59590995,  0.56746984]], dtype=float32), None, None, array([[ 0.5142889 ,  0.5726826 ,  0.6456747 , ..., -1.2384787 ,
        -1.067838  , -0.9825174 ],
       [-1.1791286 , -1.1061366 , -1.0623412 , ..., -1.0393977 ,
        -1.0109575 , -0.9825174 ],
       [ 0.48509204,  0.5580842 ,  0.6456747 , ..., -1.082058  ,
        -1.1104981 , -1.1104981 ],
       ...,
       [-0.59519154, -0.60978997, -0.60978997, ..., -0.9967375 ,
        -0.7692165 , -0.669676  ],
       [-0.5221994 , -0.50760096, -0.5367978 , ..., -0.86875695,
        -1.2242587 , -1.3522393 ],
       [-0.68278205, -0.7411758 , -0.7411758 , ..., -0.7976566 ,
        -0.7692165 , -0.71233624]], dtype=float32), array([[ 0.13472985,  0.01794233, -0.01125452, ..., -0.3710546 ,
        -0.243074  ,  0.05554737],
       [-0.15723877, -0.5659947 , -0.9017585 , ...,  0.43948925,
         0.29728848,  0.09820756],
       [ 0.25151724,  0.19312355,  0.30991095, ...,  0.36838892,
         0.3257286 ,  0.26884836],
       ...,
       [-0.04045137, -0.09884507, -0.303223  , ..., -0.8260967 ,
        -0.882977  , -0.9398572 ],
       [-1.3105145 , -1.2229239 , -1.3835065 , ..., -0.8403168 ,
        -1.2669188 , -1.309579  ],
       [-0.1718372 , -0.15723877, -0.14264035, ..., -0.8403168 ,
        -0.81187665, -0.8260967 ]], dtype=float32), array([[ 0.9668401 ,  0.9668401 ,  0.9814385 , ...,  0.35416883,
         0.35416883,  0.33994877],
       [ 0.93764323,  0.9230448 ,  0.93764323, ...,  0.29728848,
         0.25462827,  0.22618815],
       [-0.04045137, -0.06964822, -0.09884507, ..., -0.48481512,
        -0.48481512, -0.45637497],
       ...,
       [-1.5294908 , -1.5294908 , -1.5440893 , ..., -0.91141707,
        -0.882977  , -0.882977  ],
       [-0.1718372 , -0.18643562, -0.20103405, ...,  0.39682904,
         0.38260898,  0.39682904],
       [-0.36161673, -0.39081356, -0.43460885, ...,  0.5532498 ,
         0.5816899 ,  0.5816899 ]], dtype=float32), None, array([[-1.4564987 , -1.4273019 , -1.4273019 , ..., -1.4233395 ,
        -1.4091195 , -1.4091195 ],
       [-1.704672  , -1.7192703 , -1.7192703 , ..., -1.3948994 ,
        -1.3664593 , -1.3522393 ],
       [-1.7484672 , -1.7192703 , -1.704672  , ..., -1.4091195 ,
        -1.4091195 , -1.3948994 ],
       ...,
       [ 0.30991095,  0.29531252,  0.2807141 , ...,  0.28306842,
         0.28306842,  0.26884836],
       [-1.2813176 , -0.6243884 ,  0.13472985, ..., -1.2811389 ,
        -1.3806794 , -1.3806794 ],
       [ 0.16392669,  0.13472985,  0.12013142, ..., -1.2953589 ,
        -1.2811389 , -1.2669188 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 32]]), array([[ 1, 18, 18]]), array([[ 1, 18, 18]]), None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A man and a women kissing under an umbrella.\n', 'Find me an everyday image that matches the given caption: A group of people on a long canoe boat.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A blue glass vase with some flowers on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: View inside a large oven with two pans and the oven light on.\n', 'Find me an everyday image that matches the given caption: A group of ultimate frisbee players wearing green and orange.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A building clock tower with its establishment date on it.\n', 'Find me an everyday image that matches the given caption: The child sits on a skateboard next to another child holding a skateboard.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of little leaguers standing on top of a field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 14/6000 [00:30<3:30:03,  2.11s/it]                                                   {'loss': 18.2524, 'grad_norm': 2928.020263671875, 'learning_rate': 1.4000000000000001e-06, 'epoch': 0.0}
  0%|          | 14/6000 [00:30<3:30:03,  2.11s/it][2025-11-13 01:31:27,880] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  39698,   1899,    624],
        [151643, 151643, 151643,  ...,   2409,   3241,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  13753,  20332,    624],
        [151643, 151643, 151643,  ...,    264,  12883,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Motor cycle riders in the city on a sunny day.\n', 'Find me an everyday image that matches the given caption: A well decorated living room with big window.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A double decker bus is parked on the cobblestones.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bathroom with a narrow toilet and hanging towels.\n', 'Find me an everyday image that matches the given caption: A pair of zebras standing in a fenced field.\n', 'Find me an everyday image that matches the given caption: Two remotes are on a side table by a couch.\n', 'Find me an everyday image that matches the given caption: A young boy smiles while holding yellow balls.\n', 'Find me an everyday image that matches the given caption: A man stands at a counter holding a beer.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277DED0>], [None], [<PIL.Image.Image image mode=RGB size=364x256 at 0x7F327277DF90>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272766230>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5F490>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277DF30>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327277DF60>], [<PIL.Image.Image image mode=RGB size=256x328 at 0x7F327277E020>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F327277DFC0>]], 'pixel_values': [None, None, array([[-1.6608766 , -1.6316798 , -1.6024829 , ..., -1.2811389 ,
        -1.2811389 , -1.2811389 ],
       [-1.6316798 , -1.6462783 , -1.6900735 , ..., -1.3237991 ,
        -1.2953589 , -1.2669188 ],
       [-1.6170814 , -1.6024829 , -1.5732862 , ..., -1.2669188 ,
        -1.2953589 , -1.3380191 ],
       ...,
       [ 1.0690291 ,  0.9668401 ,  0.95224166, ..., -0.17197368,
        -0.27151415, -0.31417432],
       [-0.01125452, -0.3470183 , -0.405412  , ..., -0.15775362,
         0.06976743,  0.14086775],
       [ 0.8646511 ,  0.9084464 ,  0.89384794, ...,  0.29728848,
         0.31150854,  0.35416883]], dtype=float32), None, array([[-0.59519154, -0.59519154, -0.55139625, ..., -0.08665328,
        -0.10087335, -0.10087335],
       [-0.7411758 , -0.6973805 , -0.6389868 , ..., -0.20041381,
        -0.20041381, -0.21463387],
       [ 0.71866685,  0.68947   ,  0.67487156, ..., -0.02977302,
        -0.00133289,  0.02710724],
       ...,
       [ 0.36830464,  0.3975015 ,  0.41209993, ..., -0.61279577,
        -0.669676  , -0.74077636],
       [ 0.5142889 ,  0.44129676,  0.41209993, ..., -0.10087335,
        -0.15775362, -0.18619375],
       [ 0.61647785,  0.54348576,  0.52888733, ...,  0.0839875 ,
         0.0413273 ,  0.02710724]], dtype=float32), array([[-1.2375224 , -1.0477428 , -1.3835065 , ..., -1.4517797 ,
        -1.4375596 , -1.4375596 ],
       [ 0.29531252, -0.87256163, -1.1061366 , ...,  0.06976743,
        -0.12931348, -0.15775362],
       [-1.7338688 , -1.7484672 , -1.7338688 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [-0.28862458, -0.24482933, -0.2302309 , ..., -0.20041381,
        -0.14353354, -0.15775362],
       [-0.2740262 , -0.24482933, -0.21563247, ..., -0.2857342 ,
        -0.35683453, -0.4137148 ],
       [-0.2302309 , -0.24482933, -0.303223  , ..., -0.5985757 ,
        -1.2242587 , -1.2953589 ]], dtype=float32), array([[-1.5148925 , -1.5148925 , -1.5294908 , ...,  0.5816899 ,
         0.5816899 ,  0.59590995],
       [-1.4856956 , -1.500294  , -1.5440893 , ...,  0.7096705 ,
         0.7381106 ,  0.7381106 ],
       [-1.5294908 , -1.5294908 , -1.5294908 , ...,  0.8376511 ,
         0.85187113,  0.85187113],
       ...,
       [-0.9893491 , -0.94555384, -0.9309554 , ..., -0.95407724,
        -0.96829736, -1.0251776 ],
       [-1.1353334 , -1.1207349 , -1.1353334 , ..., -1.0536178 ,
        -0.9967375 , -1.0251776 ],
       [-0.9017585 , -0.9893491 , -1.0915381 , ..., -1.0251776 ,
        -1.0251776 , -0.9256371 ]], dtype=float32), array([[ 1.1274228 ,  1.1274228 ,  1.098226  , ...,  0.7381106 ,
         0.72389054,  0.7096705 ],
       [ 0.8792495 ,  0.8792495 ,  0.9084464 , ...,  0.6954504 ,
         0.7381106 ,  0.7665507 ],
       [ 1.3026038 ,  1.3026038 ,  1.3026038 , ...,  0.6243501 ,
         0.63857013,  0.6527902 ],
       ...,
       [-1.4564987 , -1.4127034 , -1.3251129 , ..., -1.2100385 ,
        -0.68389606, -0.2857342 ],
       [-1.3543098 , -1.2229239 , -1.1061366 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-0.7119789 , -0.6389868 , -0.6681836 , ..., -0.61279577,
        -0.35683453, -0.29995427]], dtype=float32), array([[ 0.09093457,  0.09093457,  0.10553299, ...,  1.3495734 ,
         1.3637935 ,  1.3780135 ],
       [ 0.25151724,  0.26611567,  0.32450938, ...,  1.5344343 ,
         1.5628744 ,  1.5770944 ],
       [ 0.4704936 ,  0.4704936 ,  0.48509204, ...,  1.5202142 ,
         1.5344343 ,  1.5486543 ],
       ...,
       [ 0.38290307,  0.2223204 , -0.06964822, ..., -1.4091195 ,
        -1.4233395 , -1.4375596 ],
       [-1.4273019 , -1.1791286 , -0.88716006, ..., -0.12931348,
        -0.35683453, -0.54169536],
       [-0.43460885, -0.5221994 , -0.65358526, ..., -1.3806794 ,
        -1.4091195 , -1.4091195 ]], dtype=float32), array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.47059506,
        -0.31417432, -0.6412359 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       ...,
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.273407  ,  1.5653756 ,  1.7551551 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ]], dtype=float32), None, None, None, None, None, array([[-1.3251129 , -1.1791286 , -1.0623412 , ..., -0.78343654,
        -0.74077636, -0.71233624],
       [-1.2667192 , -1.2959161 , -1.2667192 , ..., -0.61279577,
        -0.57013553, -0.5274753 ],
       [-1.4419003 , -1.3543098 , -1.2229239 , ..., -0.78343654,
        -0.7692165 , -0.7549964 ],
       ...,
       [-1.3105145 , -1.3397113 , -1.3835065 , ..., -1.2953589 ,
        -1.2953589 , -1.2953589 ],
       [-1.5440893 , -1.5440893 , -1.5440893 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.5586877 , -1.5586877 , -1.5440893 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), array([[ 1, 24, 18]]), None, None, None, None, None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Motor cycle riders in the city on a sunny day.\n', 'Find me an everyday image that matches the given caption: A well decorated living room with big window.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A double decker bus is parked on the cobblestones.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bathroom with a narrow toilet and hanging towels.\n', 'Find me an everyday image that matches the given caption: A pair of zebras standing in a fenced field.\n', 'Find me an everyday image that matches the given caption: Two remotes are on a side table by a couch.\n', 'Find me an everyday image that matches the given caption: A young boy smiles while holding yellow balls.\n', 'Find me an everyday image that matches the given caption: A man stands at a counter holding a beer.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 15/6000 [00:32<3:26:41,  2.07s/it]                                                   {'loss': 14.3934, 'grad_norm': 2270.61181640625, 'learning_rate': 1.5e-06, 'epoch': 0.0}
  0%|          | 15/6000 [00:32<3:26:41,  2.07s/it][2025-11-13 01:31:29,877] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    389,    432,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  22174,   4935,    624],
        ...,
        [151643, 151643, 151643,  ...,   1817,   1008,    624],
        [151643, 151643, 151643,  ...,    264,  26148,    624],
        [151643, 151643, 151643,  ...,    285,  32031,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A collage with several artistic pictures on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A child sitting on a field near a soccer ball.\n', 'Find me an everyday image that matches the given caption: A sign at the intersection points the way to the walking trail.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cow is standing on a farm near a fence.\n', 'Find me an everyday image that matches the given caption: This is a normally busy bus depot in the city.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The horses are very close to each other.\n', 'Find me an everyday image that matches the given caption: A dog and a cat relax next to each other on a couch.\n', 'Find me an everyday image that matches the given caption: A large black dog standing next to a red frisbee.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272766380>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x263 at 0x7F32727649D0>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F327277F0A0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F280>], [<PIL.Image.Image image mode=RGB size=256x271 at 0x7F327277F190>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327277F130>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277F550>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F1C0>], [None], [None], [None]], 'pixel_values': [None, array([[ 0.7478637 ,  0.89384794,  1.1128243 , ..., -0.9256371 ,
        -0.91141707, -1.0109575 ],
       [-0.1718372 , -0.5805931 , -0.50760096, ...,  0.5390297 ,
         0.0839875 , -0.18619375],
       [ 1.2880055 ,  1.2588086 ,  1.1128243 , ..., -0.57013553,
         0.05554737,  0.16930789],
       ...,
       [-1.7776641 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7484672 , -1.7484672 , -1.7630657 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, None, array([[0.2223204 , 0.29531252, 0.29531252, ..., 0.6527902 , 0.63857013,
        0.6243501 ],
       [0.17852512, 0.19312355, 0.25151724, ..., 0.4963695 , 0.4963695 ,
        0.4963695 ],
       [0.4558952 , 0.2807141 , 0.4704936 , ..., 0.6954504 , 0.7381106 ,
        0.75233066],
       ...,
       [0.5726826 , 0.52888733, 0.58728105, ..., 0.8660912 , 0.88031125,
        0.90875137],
       [0.791659  , 0.76246214, 0.7478637 , ..., 0.9229715 , 1.0082918 ,
        0.9940718 ],
       [0.6018794 , 0.6018794 , 0.61647785, ..., 0.8945313 , 0.90875137,
        0.9940718 ]], dtype=float32), array([[ 1.5799739 ,  1.5799739 ,  1.5799739 , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       [ 1.5799739 ,  1.5799739 ,  1.5945723 , ...,  1.7192951 ,
         1.690855  ,  1.6624149 ],
       [ 1.5361787 ,  1.5361787 ,  1.5361787 , ..., -0.6981161 ,
        -0.78343654, -0.81187665],
       ...,
       [ 1.2004149 ,  1.2150133 ,  1.2296118 , ...,  1.6766349 ,
         1.6766349 ,  1.6766349 ],
       [ 1.3172023 ,  1.3172023 ,  1.3172023 , ...,  1.6624149 ,
         1.6766349 ,  1.6766349 ],
       [ 1.3318007 ,  1.3318007 ,  1.3463992 , ...,  1.7192951 ,
         1.7192951 ,  1.7192951 ]], dtype=float32), array([[0.13472985, 0.07633615, 0.03254076, ..., 0.43948925, 0.43948925,
        0.4252692 ],
       [0.6456747 , 0.66027313, 0.7332653 , ..., 0.35416883, 0.35416883,
        0.35416883],
       [0.13472985, 0.20772196, 0.13472985, ..., 0.7665507 , 0.7807708 ,
        0.80921096],
       ...,
       [0.14932826, 0.14932826, 0.14932826, ..., 0.29728848, 0.28306842,
        0.26884836],
       [0.23691882, 0.2223204 , 0.20772196, ..., 0.3257286 , 0.31150854,
        0.28306842],
       [0.09093457, 0.10553299, 0.10553299, ..., 0.22618815, 0.21196808,
        0.19774802]], dtype=float32), array([[ 1.3609976 ,  1.3755959 ,  1.2880055 , ..., -0.22885394,
         0.3257286 , -0.8403168 ],
       [ 0.09093457, -0.02585294,  0.03254076, ..., -0.95407724,
        -0.89719707, -0.8260967 ],
       [ 1.3318007 ,  1.3901944 ,  1.2880055 , ..., -0.17197368,
         0.22618815, -0.20041381],
       ...,
       [-1.6608766 , -1.6754751 , -1.6608766 , ..., -1.2811389 ,
        -1.2953589 , -1.309579  ],
       [-1.5732862 , -1.5732862 , -1.6754751 , ..., -1.2811389 ,
        -1.2669188 , -1.2669188 ],
       [-1.6462783 , -1.6754751 , -1.6900735 , ..., -1.3380191 ,
        -1.3522393 , -1.3522393 ]], dtype=float32), None, None, array([[ 1.8865409 ,  1.8865409 ,  1.8865409 , ...,  1.9894764 ,
         2.0179167 ,  2.0321364 ],
       [ 1.8865409 ,  1.8865409 ,  1.9157377 , ...,  0.19774802,
         1.264253  ,  2.145897  ],
       [ 1.8719424 ,  1.8719424 ,  1.8719424 , ...,  1.9894764 ,
         1.9894764 ,  2.0036962 ],
       ...,
       [-0.65358526, -0.65358526, -0.65358526, ..., -0.47059506,
        -0.45637497, -0.4421549 ],
       [-0.6389868 , -0.6389868 , -0.6389868 , ..., -0.42793486,
        -0.39949474, -0.39949474],
       [-0.68278205, -0.68278205, -0.68278205, ..., -0.4137148 ,
        -0.4137148 , -0.4137148 ]], dtype=float32), array([[-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.3948994 ,
        -1.3806794 , -1.3948994 ],
       [-1.7776641 , -1.7630657 , -1.7484672 , ..., -1.3948994 ,
        -1.4375596 , -1.4375596 ],
       [-1.1353334 , -1.1207349 , -1.1061366 , ..., -1.1531583 ,
        -1.1247182 , -1.1531583 ],
       ...,
       [-0.21563247, -0.21563247, -0.20103405, ..., -0.669676  ,
        -0.6981161 , -0.7265563 ],
       [-0.14264035, -0.14264035, -0.14264035, ..., -0.6270158 ,
        -0.6412359 , -0.669676  ],
       [-0.15723877, -0.15723877, -0.1718372 , ..., -0.68389606,
        -0.6981161 , -0.74077636]], dtype=float32), array([[-0.42001042, -0.4638057 , -0.5805931 , ..., -1.2811389 ,
        -1.2669188 , -1.2669188 ],
       [-0.44920728, -0.44920728, -0.31782144, ..., -1.0393977 ,
        -1.1673783 , -1.1531583 ],
       [-0.47840413, -0.65358526, -0.9309554 , ..., -0.48481512,
        -0.51325524, -0.5985757 ],
       ...,
       [-1.5148925 , -1.5294908 , -1.500294  , ..., -0.5274753 ,
        -0.5274753 , -0.5274753 ],
       [-0.9017585 , -0.87256163, -0.88716006, ...,  1.3637935 ,
         1.3495734 ,  1.3069133 ],
       [-0.88716006, -0.87256163, -0.82876635, ...,  1.1647125 ,
         1.1647125 ,  1.1647125 ]], dtype=float32), None, None, None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 18]]), array([[ 1, 18, 18]]), array([[ 1, 18, 24]]), array([[ 1, 20, 18]]), None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A collage with several artistic pictures on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A child sitting on a field near a soccer ball.\n', 'Find me an everyday image that matches the given caption: A sign at the intersection points the way to the walking trail.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cow is standing on a farm near a fence.\n', 'Find me an everyday image that matches the given caption: This is a normally busy bus depot in the city.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The horses are very close to each other.\n', 'Find me an everyday image that matches the given caption: A dog and a cat relax next to each other on a couch.\n', 'Find me an everyday image that matches the given caption: A large black dog standing next to a red frisbee.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 16/6000 [00:34<3:27:29,  2.08s/it]                                                   {'loss': 16.2924, 'grad_norm': 1718.4600830078125, 'learning_rate': 1.6000000000000001e-06, 'epoch': 0.0}
  0%|          | 16/6000 [00:34<3:27:29,  2.08s/it][2025-11-13 01:31:31,982] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    311,   1251,    624],
        [151643, 151643, 151643,  ...,   1251,  11435,    624],
        [151643, 151643, 151643,  ...,    389,    432,    624],
        ...,
        [151643, 151643, 151643,  ...,    806,  57309,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A white and orange van on street next to people.\n', 'Find me an everyday image that matches the given caption: A bus parked on a busy city street near people walking.\n', 'Find me an everyday image that matches the given caption: A refrigerator that has many pictures and magnets on it.\n', 'Find me an everyday image that matches the given caption: A piece of cake and for that are on a plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A refrigerator packed with lots of food and drinks.\n', 'Find me an everyday image that matches the given caption: Two people are standing under an umbrella together.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of friends on a boat watch a jet ski drive passed.\n', 'Find me an everyday image that matches the given caption: A woman leading a horse down a dirt road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in wedding party looking at his cellphone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327277F8E0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327277ED40>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277ED10>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327277EDD0>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277EFB0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F040>], [<PIL.Image.Image image mode=RGB size=256x382 at 0x7F327277EE60>]], 'pixel_values': [None, None, None, None, array([[ 0.49969047,  0.49969047,  0.49969047, ...,  0.7096705 ,
         0.7096705 ,  0.72389054],
       [ 0.54348576,  0.54348576,  0.6018794 , ...,  0.7381106 ,
         0.7381106 ,  0.7381106 ],
       [ 0.54348576,  0.54348576,  0.54348576, ...,  1.1220524 ,
         1.1220524 ,  1.1362724 ],
       ...,
       [-1.3251129 , -1.3105145 , -1.2813176 , ..., -1.0536178 ,
        -1.067838  , -1.0536178 ],
       [-1.398105  , -1.3543098 , -1.2375224 , ..., -1.1104981 ,
        -0.9967375 , -0.9825174 ],
       [-1.3251129 , -1.3105145 , -1.2521207 , ..., -1.0393977 ,
        -1.0109575 , -0.96829736]], dtype=float32), None, None, array([[ 0.33910778,  0.44129676,  0.5726826 , ..., -0.9256371 ,
        -0.86875695, -0.57013553],
       [ 0.68947   ,  0.5580842 ,  0.5142889 , ..., -0.669676  ,
        -0.5274753 , -0.38527465],
       [-0.2302309 , -0.2740262 , -0.28862458, ...,  1.0082918 ,
         0.9798517 ,  0.9798517 ],
       ...,
       [-1.4710971 , -1.3543098 , -1.4419003 , ...,  0.4252692 ,
         0.4110491 ,  0.4110491 ],
       [ 0.12013142, -0.60978997, -1.1645303 , ..., -1.0393977 ,
        -0.9967375 , -0.9825174 ],
       [-1.4273019 , -1.4127034 , -1.4856956 , ...,  0.31150854,
         0.25462827,  0.33994877]], dtype=float32), array([[-0.5367978 ,  0.19312355,  0.14932826, ...,  0.88031125,
         1.7477353 ,  1.477554  ],
       [ 0.29531252, -0.09884507,  0.0617376 , ...,  1.705075  ,
         2.074797  ,  2.103237  ],
       [ 1.1274228 ,  0.25151724, -0.21563247, ..., -0.22885394,
        -0.47059506, -0.8260967 ],
       ...,
       [-1.6024829 , -1.3543098 , -1.2229239 , ..., -1.4802198 ,
        -1.4802198 , -1.3664593 ],
       [ 0.20772196,  0.2807141 ,  0.66027313, ..., -0.2857342 ,
        -0.2857342 , -1.2811389 ],
       [ 0.09093457,  0.16392669,  0.25151724, ..., -0.48481512,
        -0.57013553, -0.669676  ]], dtype=float32), array([[-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.45637497,
        -0.45637497, -0.45637497],
       [-1.7776641 , -1.7922626 , -1.7922626 , ..., -0.42793486,
        -0.42793486, -0.42793486],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -0.39949474,
        -0.39949474, -0.39949474],
       ...,
       [ 1.6237692 ,  1.6237692 ,  1.6091708 , ...,  1.705075  ,
         1.7477353 ,  1.7903955 ],
       [ 1.5069818 ,  1.4923834 ,  1.5361787 , ...,  1.8472759 ,
         1.8472759 ,  1.875716  ],
       [ 1.477785  ,  1.477785  ,  1.4923834 , ...,  1.9752562 ,
         1.9468161 ,  1.918376  ]], dtype=float32), None, None, array([[ 0.6456747 ,  0.9668401 ,  1.0836275 , ...,  1.264253  ,
         1.3353534 ,  1.3495734 ],
       [ 0.8792495 ,  0.89384794,  0.9084464 , ...,  1.3922336 ,
         1.3495734 ,  1.3069133 ],
       [ 0.95224166,  0.99603695,  0.99603695, ...,  1.2926931 ,
         1.3069133 ,  1.2926931 ],
       ...,
       [-0.3470183 , -0.405412  , -0.405412  , ...,  0.26884836,
         0.26884836,  0.25462827],
       [ 0.5142889 ,  0.5142889 ,  0.4704936 , ..., -0.05821316,
         0.02710724,  0.25462827],
       [-0.0550498 , -0.04045137,  0.00334391, ..., -0.12931348,
        -0.08665328, -0.10087335]], dtype=float32), None, array([[ 1.8865409,  1.8865409,  1.8865409, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       [ 1.8865409,  1.8865409,  1.857344 , ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       [ 1.9157377,  1.9157377,  1.9157377, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       ...,
       [-1.5878845, -1.6462783, -1.6170814, ..., -1.3664593, -1.3380191,
        -1.3380191],
       [-1.2521207, -1.500294 , -1.6462783, ..., -1.2811389, -1.2100385,
        -1.2669188],
       [-1.4856956, -1.5294908, -1.6024829, ..., -0.9967375, -1.3380191,
        -1.4802198]], dtype=float32), array([[-0.6681836 , -1.2375224 , -1.7922626 , ..., -0.9967375 ,
        -0.96829736, -0.65545595],
       [-0.08424664,  0.2223204 , -0.43460885, ..., -0.31417432,
        -0.32839438, -1.1247182 ],
       [-0.36161673, -0.6681836 , -1.2083255 , ..., -0.7265563 ,
        -1.1104981 , -0.7976566 ],
       ...,
       [-1.7776641 , -1.7484672 , -1.7338688 , ..., -1.3522393 ,
        -1.3664593 , -1.3664593 ],
       [-1.5440893 , -1.5586877 , -1.6024829 , ..., -1.3806794 ,
        -1.3380191 , -1.3237991 ],
       [-1.6170814 , -1.6024829 , -1.6024829 , ..., -1.2953589 ,
        -1.2953589 , -1.2953589 ]], dtype=float32)], 'image_grid_thw': [None, None, None, None, array([[ 1, 18, 28]]), None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A white and orange van on street next to people.\n', 'Find me an everyday image that matches the given caption: A bus parked on a busy city street near people walking.\n', 'Find me an everyday image that matches the given caption: A refrigerator that has many pictures and magnets on it.\n', 'Find me an everyday image that matches the given caption: A piece of cake and for that are on a plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A refrigerator packed with lots of food and drinks.\n', 'Find me an everyday image that matches the given caption: Two people are standing under an umbrella together.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of friends on a boat watch a jet ski drive passed.\n', 'Find me an everyday image that matches the given caption: A woman leading a horse down a dirt road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in wedding party looking at his cellphone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 17/6000 [00:36<3:26:07,  2.07s/it]                                                   {'loss': 15.2764, 'grad_norm': 1359.9036865234375, 'learning_rate': 1.7000000000000002e-06, 'epoch': 0.0}
  0%|          | 17/6000 [00:36<3:26:07,  2.07s/it][2025-11-13 01:31:34,015] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   1045,  12408,    624],
        [151643, 151643, 151643,  ...,   4815,    432,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,   9104,  53244,    624],
        [151643, 151643, 151643,  ...,   4158,   1965,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A black truck a white barn and some trees.\n', 'Find me an everyday image that matches the given caption: A man talking in front of a photo of an orange sofa with black and white fence behind it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A fuzzy teddy bear sitting on top of a boulder.\n', 'Find me an everyday image that matches the given caption: A blender pitcher on the counter near a sink.\n', 'Find me an everyday image that matches the given caption: A man in a grey suit stands in the grass.\n', 'Find me an everyday image that matches the given caption: A white sink and toilet in a rest room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bear walks through a patch of bushes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An adorable dog stares out a window.\n', 'Find me an everyday image that matches the given caption: A tower with two clock faces and a weather vein.\n', 'Find me an everyday image that matches the given caption: Mobile phones and office supplies sitting on a white table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277FEE0>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277F940>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327277F0D0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F730>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277FF40>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272788F10>]], 'pixel_values': [None, None, array([[-1.6754751, -1.6754751, -1.6608766, ..., -1.4233395, -1.4233395,
        -1.4233395],
       [-1.5878845, -1.5732862, -1.3835065, ..., -1.3948994, -1.3948994,
        -1.3948994],
       [-1.7192703, -1.7192703, -1.7192703, ..., -1.1247182, -1.1389382,
        -1.1389382],
       ...,
       [-1.2521207, -1.2521207, -1.2521207, ..., -1.2100385, -1.2242587,
        -1.2384787],
       [-1.1061366, -1.1061366, -1.1061366, ..., -1.1247182, -1.1247182,
        -1.1389382],
       [-1.0623412, -1.0623412, -1.0769397, ..., -1.2384787, -1.2526988,
        -1.2669188]], dtype=float32), None, None, None, None, array([[-0.12804192, -0.11344349, -0.08424664, ...,  0.21196808,
         0.22618815,  0.22618815],
       [ 0.20772196,  0.20772196,  0.26611567, ...,  0.4110491 ,
         0.4110491 ,  0.4110491 ],
       [ 0.03254076,  0.03254076,  0.03254076, ...,  0.38260898,
         0.38260898,  0.36838892],
       ...,
       [ 1.2296118 ,  1.2296118 ,  1.2588086 , ...,  1.3495734 ,
         1.3495734 ,  1.3637935 ],
       [ 1.2296118 ,  1.2150133 ,  1.2004149 , ...,  1.2215928 ,
         1.1220524 ,  1.0082918 ],
       [ 1.2588086 ,  1.2296118 ,  1.2150133 , ...,  0.72389054,
         0.6954504 ,  0.75233066]], dtype=float32), None, array([[-1.704672  , -1.704672  , -1.704672  , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.6316798 , -1.6316798 , -1.5878845 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.6024829 , -1.6024829 , -1.5878845 , ..., -1.2526988 ,
        -1.2669188 , -1.309579  ],
       ...,
       [-1.6754751 , -1.6024829 , -1.500294  , ...,  0.6527902 ,
         0.68123037,  0.6954504 ],
       [-1.3543098 , -1.3689082 , -1.5294908 , ..., -0.89719707,
        -0.54169536, -0.5274753 ],
       [-0.65358526, -0.65358526, -0.6389868 , ...,  0.24040821,
         0.22618815,  0.14086775]], dtype=float32), array([[ 1.1128243 ,  1.1128243 ,  1.1128243 , ...,  1.3637935 ,
         1.3637935 ,  1.3780135 ],
       [ 0.9668401 ,  0.95224166,  0.9230448 , ...,  1.4491138 ,
         1.264253  ,  1.2500329 ],
       [ 1.0398322 ,  1.0398322 ,  1.0544306 , ...,  1.2358129 ,
         1.2358129 ,  1.2358129 ],
       ...,
       [-1.7192703 , -1.7192703 , -1.7192703 , ..., -1.4517797 ,
        -1.4659997 , -1.4659997 ],
       [-1.7776641 , -1.7776641 , -1.7630657 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-1.7192703 , -1.7338688 , -1.7338688 , ..., -1.4517797 ,
        -1.4659997 , -1.4659997 ]], dtype=float32), array([[ 0.5580842 ,  0.5726826 ,  0.5726826 , ...,  0.33994877,
         0.35416883,  0.35416883],
       [ 0.61647785,  0.6456747 ,  0.6018794 , ...,  0.29728848,
         0.3257286 ,  0.35416883],
       [ 0.71866685,  0.68947   ,  0.68947   , ...,  0.39682904,
         0.43948925,  0.46792936],
       ...,
       [ 0.48509204,  0.4704936 ,  0.4704936 , ...,  0.09820756,
         0.11242763,  0.1266477 ],
       [-0.09884507, -0.09884507, -0.11344349, ...,  0.01288717,
        -0.00133289, -0.00133289],
       [-0.11344349, -0.11344349, -0.11344349, ..., -0.05821316,
        -0.05821316, -0.05821316]], dtype=float32), None, None, None, array([[ 0.9230448 ,  0.85005265,  0.89384794, ..., -1.0251776 ,
        -1.0962781 , -1.1247182 ],
       [-0.7119789 ,  0.4704936 ,  0.36830464, ..., -0.61279577,
        -0.81187665, -0.9256371 ],
       [-1.2667192 , -1.1645303 , -1.0769397 , ..., -0.8403168 ,
        -0.8545369 , -0.8260967 ],
       ...,
       [ 1.4193913 ,  1.477785  ,  1.5361787 , ..., -0.05821316,
        -0.14353354, -0.21463387],
       [-1.4564987 , -1.5440893 , -1.5440893 , ...,  0.31150854,
         0.06976743,  0.0413273 ],
       [ 0.30991095,  1.1420212 ,  1.1566195 , ..., -0.74077636,
        -0.6981161 ,  0.52480966]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 28]]), None, None, None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A black truck a white barn and some trees.\n', 'Find me an everyday image that matches the given caption: A man talking in front of a photo of an orange sofa with black and white fence behind it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A fuzzy teddy bear sitting on top of a boulder.\n', 'Find me an everyday image that matches the given caption: A blender pitcher on the counter near a sink.\n', 'Find me an everyday image that matches the given caption: A man in a grey suit stands in the grass.\n', 'Find me an everyday image that matches the given caption: A white sink and toilet in a rest room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bear walks through a patch of bushes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An adorable dog stares out a window.\n', 'Find me an everyday image that matches the given caption: A tower with two clock faces and a weather vein.\n', 'Find me an everyday image that matches the given caption: Mobile phones and office supplies sitting on a white table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 18/6000 [00:38<3:24:35,  2.05s/it]                                                   {'loss': 12.3648, 'grad_norm': 1478.78466796875, 'learning_rate': 1.8000000000000001e-06, 'epoch': 0.0}
  0%|          | 18/6000 [00:38<3:24:35,  2.05s/it][2025-11-13 01:31:36,027] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  43096,  11839,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A girl holds a banana in a banana holder.\n', 'Find me an everyday image that matches the given caption: A couch that has some cats on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A light gray vase and some purple red and yellow flowers.\n', 'Find me an everyday image that matches the given caption: There are some baseball players standing in a green field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dish with cooked broccoli, beef, and peanuts in sauce.\n', 'Find me an everyday image that matches the given caption: Black and white image of a man sitting on a bench looking at the ground.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog running across a beach next to the ocean.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=369x256 at 0x7F327277F910>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272767880>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272766BC0>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272765F30>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272767AF0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272766710>], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F327278A500>], [<PIL.Image.Image image mode=RGB size=256x379 at 0x7F3272788460>], [<PIL.Image.Image image mode=RGB size=319x256 at 0x7F327278A620>]], 'pixel_values': [array([[ 0.04713918, -0.21563247, -0.55139625, ...,  1.1931527 ,
         1.2500329 ,  1.3211333 ],
       [ 1.4631865 ,  1.6383677 ,  1.6091708 , ...,  1.3637935 ,
         1.3637935 ,  1.3495734 ],
       [ 0.20772196,  0.10553299,  0.03254076, ...,  1.1078323 ,
         1.1931527 ,  1.2073728 ],
       ...,
       [-0.42001042,  0.0617376 , -0.3470183 , ...,  0.8945313 ,
         0.36838892, -0.20041381],
       [ 1.6383677 ,  1.477785  ,  1.5069818 , ...,  0.31150854,
         0.33994877,  0.3257286 ],
       [ 0.20772196,  0.04713918,  0.26611567, ...,  0.3257286 ,
         0.18352796,  0.6670103 ]], dtype=float32), array([[ 0.20772196,  0.26611567,  0.2807141 , ...,  1.1078323 ,
         1.0936122 ,  1.0936122 ],
       [ 0.8062574 ,  0.791659  ,  0.85005265, ...,  0.8945313 ,
         0.59590995,  0.4252692 ],
       [ 0.42669836,  0.4558952 ,  0.36830464, ...,  1.3211333 ,
         1.3353534 ,  1.3495734 ],
       ...,
       [-0.8433648 , -0.8141679 , -0.68278205, ..., -0.04399309,
         0.35416883,  0.43948925],
       [-0.44920728, -0.25942776, -0.2302309 , ..., -0.9825174 ,
        -0.9967375 , -0.9967375 ],
       [-0.88716006, -0.88716006, -0.87256163, ..., -0.32839438,
         0.05554737,  0.15508783]], dtype=float32), None, None, array([[-1.2667192 , -1.2521207 , -1.2375224 , ..., -0.9398572 ,
        -1.0536178 , -1.1104981 ],
       [-1.6170814 , -1.6170814 , -1.4710971 , ..., -0.96829736,
        -0.7549964 , -0.5559154 ],
       [-0.7557742 , -0.9893491 , -1.1645303 , ...,  0.36838892,
         0.24040821,  0.19774802],
       ...,
       [-0.5221994 , -0.50760096, -0.7557742 , ..., -1.3380191 ,
        -1.0536178 , -0.8403168 ],
       [ 0.8792495 ,  0.9230448 ,  0.89384794, ..., -1.4802198 ,
        -1.4802198 , -1.4517797 ],
       [-0.7557742 , -0.42001042, -0.12804192, ..., -0.7692165 ,
        -0.6981161 , -0.669676  ]], dtype=float32), None, None, array([[ 1.2013142e-01,  1.3472985e-01,  1.4932826e-01, ...,
         1.1242763e-01,  1.1242763e-01,  1.4086775e-01],
       [ 2.6611567e-01,  2.8071409e-01,  3.0991095e-01, ...,
         2.4040821e-01,  2.6884836e-01,  2.8306842e-01],
       [ 9.0934567e-02,  9.0934567e-02,  1.0553299e-01, ...,
        -1.5552960e-02, -1.3328948e-03,  1.2887171e-02],
       ...,
       [-1.3543098e+00, -1.3251129e+00, -1.3689082e+00, ...,
        -1.2811389e+00, -1.2811389e+00, -1.2811389e+00],
       [-1.2083255e+00, -1.3835065e+00, -1.4419003e+00, ...,
        -1.3806794e+00, -1.3664593e+00, -1.3522393e+00],
       [-1.5294908e+00, -1.5440893e+00, -1.5440893e+00, ...,
        -8.1187665e-01, -8.8297701e-01, -9.3985718e-01]], dtype=float32), None, None, array([[ 0.7040684 ,  0.7040684 ,  0.68947   , ...,  0.0413273 ,
         0.0413273 ,  0.02710724],
       [ 0.71866685,  0.68947   ,  0.68947   , ..., -0.07243322,
        -0.08665328, -0.10087335],
       [ 0.71866685,  0.71866685,  0.71866685, ...,  0.0413273 ,
         0.0413273 ,  0.02710724],
       ...,
       [ 0.8792495 ,  0.8792495 ,  0.8792495 , ...,  2.0605767 ,
         2.0605767 ,  2.0605767 ],
       [ 0.9814385 ,  0.9668401 ,  0.95224166, ...,  2.0321364 ,
         2.0321364 ,  2.0321364 ],
       [ 0.9084464 ,  0.8646511 ,  0.8792495 , ...,  2.0890167 ,
         2.074797  ,  2.074797  ]], dtype=float32), array([[-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.7338688 , -1.7338688 , -1.7192703 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-1.7630657 , -1.7630657 , -1.7630657 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       ...,
       [-0.6973805 , -0.7119789 , -0.7411758 , ..., -0.669676  ,
        -0.669676  , -0.669676  ],
       [-0.7995695 , -0.7995695 , -0.8141679 , ..., -0.74077636,
        -0.71233624, -0.6981161 ],
       [-0.8141679 , -0.82876635, -0.82876635, ..., -0.74077636,
        -0.74077636, -0.7549964 ]], dtype=float32), None, array([[-1.398105  , -1.4127034 , -1.5294908 , ..., -1.4091195 ,
        -1.4233395 , -1.3948994 ],
       [-1.2667192 , -1.3689082 , -1.2521207 , ..., -1.309579  ,
        -1.3237991 , -1.3380191 ],
       [-1.5148925 , -1.4127034 , -1.3397113 , ..., -1.3380191 ,
        -1.3522393 , -1.3237991 ],
       ...,
       [-0.8433648 , -0.8579632 , -0.88716006, ..., -1.4375596 ,
        -1.4375596 , -1.4375596 ],
       [-0.6389868 , -0.6681836 , -0.6973805 , ..., -1.3522393 ,
        -1.3664593 , -1.3806794 ],
       [-1.0039475 , -1.018546  , -1.018546  , ..., -1.3664593 ,
        -1.3948994 , -1.3948994 ]], dtype=float32), array([[ 0.09093457,  0.38290307,  0.44129676, ..., -1.3522393 ,
        -1.3806794 , -1.3664593 ],
       [ 0.38290307,  0.41209993,  0.4704936 , ..., -1.2811389 ,
        -1.2526988 , -1.2526988 ],
       [ 0.52888733,  1.9011393 ,  1.9303361 , ..., -0.669676  ,
        -0.6981161 , -0.71233624],
       ...,
       [-1.5294908 , -1.4564987 , -1.3835065 , ...,  2.117457  ,
         2.145897  ,  0.7807708 ],
       [-1.1645303 , -1.1791286 , -1.1791286 , ...,  0.7807708 ,
         0.7807708 ,  0.7807708 ],
       [-1.2521207 , -1.2521207 , -1.2667192 , ...,  0.68123037,
         0.9229715 ,  0.18352796]], dtype=float32), array([[ 1.8281472 ,  1.8865409 ,  1.7697535 , ..., -0.05821316,
         0.05554737,  0.14086775],
       [ 1.857344  ,  1.9157377 ,  1.8719424 , ..., -0.42793486,
        -0.49903518, -0.6270158 ],
       [ 1.7259582 ,  1.6967614 ,  1.6383677 , ..., -0.21463387,
        -0.34261447, -0.4137148 ],
       ...,
       [ 0.3975015 ,  0.52888733,  0.58728105, ...,  1.8472759 ,
         1.7761754 ,  1.9041561 ],
       [ 0.13472985,  0.13472985,  0.29531252, ...,  1.7619553 ,
         1.7619553 ,  1.875716  ],
       [-0.25942776, -0.33241987, -0.39081356, ...,  1.8188357 ,
         1.8614956 ,  1.9041561 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 26]]), array([[ 1, 24, 18]]), None, None, array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), array([[ 1, 18, 22]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A girl holds a banana in a banana holder.\n', 'Find me an everyday image that matches the given caption: A couch that has some cats on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A light gray vase and some purple red and yellow flowers.\n', 'Find me an everyday image that matches the given caption: There are some baseball players standing in a green field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dish with cooked broccoli, beef, and peanuts in sauce.\n', 'Find me an everyday image that matches the given caption: Black and white image of a man sitting on a bench looking at the ground.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog running across a beach next to the ocean.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 19/6000 [00:40<3:23:16,  2.04s/it]                                                   {'loss': 13.2906, 'grad_norm': 2090.529296875, 'learning_rate': 1.9000000000000002e-06, 'epoch': 0.0}
  0%|          | 19/6000 [00:40<3:23:16,  2.04s/it][2025-11-13 01:31:38,038] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,   3460,  36897,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man sitting on a bench looking down.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog with a toy in its mouth while running across a beach.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small white and black sheep with a spot on it.\n', 'Find me an everyday image that matches the given caption: A street with many passersby, cars, and a large monument.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327278ABF0>], [<PIL.Image.Image image mode=RGB size=353x256 at 0x7F327278AB90>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278AEC0>], [None], [<PIL.Image.Image image mode=RGB size=423x256 at 0x7F327278AC80>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327278AC20>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277EEC0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278AF50>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278ACE0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278AFE0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278AE60>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327278B070>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327278AEF0>]], 'pixel_values': [array([[ 0.66027313,  0.71866685,  0.8792495 , ...,  0.1266477 ,
         0.0839875 ,  0.46792936],
       [-0.36161673, -0.20103405, -0.303223  , ...,  0.85187113,
         1.264253  ,  1.3211333 ],
       [ 0.2807141 ,  0.26611567,  0.67487156, ...,  0.5532498 ,
         0.7096705 ,  0.7807708 ],
       ...,
       [-0.5221994 , -0.9747507 , -0.94555384, ..., -1.0251776 ,
        -1.0251776 , -1.082058  ],
       [-0.8141679 , -0.55139625, -0.49300256, ..., -0.8260967 ,
        -0.89719707, -0.91141707],
       [-1.018546  , -1.1061366 , -1.3689082 , ..., -1.0109575 ,
        -0.9825174 , -0.96829736]], dtype=float32), array([[-1.2083255 , -1.193727  , -1.193727  , ..., -0.4421549 ,
        -0.4421549 , -0.4421549 ],
       [-1.2083255 , -1.2083255 , -1.2083255 , ..., -0.4421549 ,
        -0.4421549 , -0.4421549 ],
       [-1.1353334 , -1.1499318 , -1.1499318 , ..., -0.39949474,
        -0.39949474, -0.39949474],
       ...,
       [ 0.4558952 ,  0.44129676,  0.44129676, ..., -0.7976566 ,
        -0.8403168 , -0.7265563 ],
       [ 0.6310763 ,  0.68947   ,  0.61647785, ..., -0.31417432,
        -0.34261447, -0.38527465],
       [ 0.66027313,  0.61647785,  0.5142889 , ..., -0.42793486,
        -0.45637497, -0.48481512]], dtype=float32), array([[ 0.44129676,  0.44129676,  0.44129676, ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 0.4558952 ,  0.4558952 ,  0.4558952 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 0.5726826 ,  0.5726826 ,  0.5726826 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       ...,
       [-1.5586877 , -1.5732862 , -1.5732862 , ..., -1.2384787 ,
        -1.2384787 , -1.2526988 ],
       [-1.6462783 , -1.6608766 , -1.6754751 , ..., -1.2384787 ,
        -1.2526988 , -1.1958185 ],
       [-1.6316798 , -1.6316798 , -1.6316798 , ..., -1.2100385 ,
        -1.2100385 , -1.2100385 ]], dtype=float32), None, array([[ 1.3463992 ,  1.4923834 ,  1.4485881 , ...,  1.4491138 ,
         1.4491138 ,  1.2926931 ],
       [ 1.5653756 ,  1.4923834 ,  1.5215802 , ...,  1.3069133 ,
         1.3637935 ,  1.3922336 ],
       [ 0.9814385 ,  1.1274228 ,  1.2442101 , ..., -0.2857342 ,
        -0.2857342 , -0.2857342 ],
       ...,
       [-1.1499318 , -1.1645303 , -1.1645303 , ..., -0.8545369 ,
        -0.86875695, -0.882977  ],
       [-0.65358526, -0.6389868 , -0.60978997, ..., -0.22885394,
        -0.27151415, -0.3710546 ],
       [-0.5805931 , -0.6389868 , -0.6973805 , ..., -0.669676  ,
        -0.65545595, -0.65545595]], dtype=float32), None, array([[ 1.8135487 ,  1.8135487 ,  1.8427455 , ...,  0.05554737,
         0.11242763,  0.1266477 ],
       [ 1.8865409 ,  1.857344  ,  1.9011393 , ..., -0.11509342,
        -0.21463387, -0.11509342],
       [ 1.8281472 ,  1.6091708 ,  0.07633615, ...,  0.96563166,
         1.1078323 ,  1.2215928 ],
       ...,
       [ 1.3172023 ,  1.4047928 ,  1.477785  , ...,  1.6197547 ,
         2.074797  ,  2.074797  ],
       [-1.6754751 , -1.6900735 , -1.704672  , ...,  2.103237  ,
         2.1316772 ,  2.145897  ],
       [-0.88716006, -0.6243884 , -0.11344349, ...,  2.0321364 ,
         2.145897  ,  2.0321364 ]], dtype=float32), array([[ 0.89384794,  0.89384794,  0.9084464 , ...,  0.8945313 ,
         0.88031125,  0.8660912 ],
       [ 1.0690291 ,  1.0690291 ,  1.0398322 , ...,  0.9798517 ,
         0.9798517 ,  0.9940718 ],
       [ 0.25151724,  0.25151724,  0.25151724, ...,  0.4963695 ,
         0.52480966,  0.4963695 ],
       ...,
       [ 0.30991095,  0.29531252,  0.29531252, ...,  0.39682904,
         0.26884836, -0.05821316],
       [ 0.5580842 ,  0.54348576,  0.54348576, ...,  0.8376511 ,
         0.823431  ,  0.7807708 ],
       [ 0.41209993,  0.38290307,  0.44129676, ...,  0.7949909 ,
         0.7949909 ,  0.7949909 ]], dtype=float32), array([[ 0.8646511 ,  0.8646511 ,  0.8646511 , ...,  0.63857013,
         0.63857013,  0.63857013],
       [ 0.9084464 ,  0.9084464 ,  0.8792495 , ...,  0.6670103 ,
         0.6670103 ,  0.68123037],
       [ 0.8062574 ,  0.85005265,  0.8792495 , ...,  0.6954504 ,
         0.61013   ,  0.48214942],
       ...,
       [-1.4856956 , -1.2521207 , -1.2959161 , ..., -0.27151415,
        -0.54169536, -0.7265563 ],
       [ 0.20772196,  0.23691882,  0.29531252, ...,  0.7096705 ,
         0.6954504 ,  0.6527902 ],
       [ 0.42669836,  0.36830464,  0.23691882, ...,  0.6527902 ,
         0.4963695 ,  0.26884836]], dtype=float32), array([[-1.1499318 , -1.2959161 , -1.1353334 , ..., -1.2526988 ,
        -1.2242587 , -1.2384787 ],
       [-0.8579632 , -1.0331444 , -0.87256163, ..., -1.0393977 ,
        -1.1104981 , -1.1958185 ],
       [-1.0915381 , -0.65358526, -0.6973805 , ..., -0.04399309,
        -0.7265563 , -0.68389606],
       ...,
       [-0.09884507, -0.08424664, -0.08424664, ..., -0.61279577,
        -0.6270158 , -0.61279577],
       [-0.15723877, -0.18643562, -0.18643562, ..., -0.5274753 ,
        -0.5985757 , -0.58435565],
       [-0.2302309 , -0.20103405, -0.14264035, ..., -0.51325524,
        -0.54169536, -0.61279577]], dtype=float32), array([[1.9011393, 1.9011393, 1.9011393, ..., 2.117457 , 2.117457 ,
        2.117457 ],
       [1.9157377, 1.9157377, 1.9157377, ..., 2.1316772, 2.1316772,
        2.1316772],
       [1.9157377, 1.9157377, 1.9157377, ..., 2.117457 , 2.117457 ,
        2.117457 ],
       ...,
       [1.6675645, 1.6821629, 1.7259582, ..., 2.103237 , 2.117457 ,
        2.117457 ],
       [1.6967614, 1.7259582, 1.6967614, ..., 2.103237 , 2.0890167,
        2.145897 ],
       [1.9157377, 1.9011393, 1.8865409, ..., 2.0605767, 2.074797 ,
        2.103237 ]], dtype=float32), array([[ 1.2880055 ,  1.3609976 ,  1.4923834 , ..., -1.309579  ,
        -1.2953589 , -1.309579  ],
       [-1.4127034 , -1.2375224 , -1.193727  , ..., -1.3522393 ,
        -1.3380191 , -1.3522393 ],
       [-0.21563247, -0.18643562, -0.08424664, ...,  0.90875137,
         0.8945313 ,  0.85187113],
       ...,
       [-0.28862458, -0.1718372 , -0.1718372 , ...,  0.11242763,
         0.05554737,  0.0839875 ],
       [ 0.03254076,  0.04713918,  0.10553299, ...,  0.24040821,
         0.02710724,  0.01288717],
       [-0.303223  ,  0.01794233,  0.03254076, ...,  0.21196808,
         0.36838892,  0.0839875 ]], dtype=float32), None, None, array([[-0.7557742 , -0.68278205, -0.6243884 , ..., -1.0393977 ,
        -1.1247182 , -1.082058  ],
       [-0.78497106, -0.7703726 , -0.7703726 , ..., -1.082058  ,
        -1.0962781 , -1.0962781 ],
       [-0.6973805 , -0.7411758 , -0.82876635, ..., -1.3237991 ,
        -1.3664593 , -1.1815984 ],
       ...,
       [ 0.61647785,  0.6310763 ,  0.67487156, ...,  0.06976743,
         0.05554737,  0.05554737],
       [ 0.68947   ,  0.71866685,  0.7478637 , ..., -0.07243322,
        -0.07243322, -0.07243322],
       [ 0.58728105,  0.7332653 ,  0.8062574 , ..., -0.12931348,
        -0.17197368, -0.20041381]], dtype=float32), array([[ 1.7551551 ,  1.7551551 ,  1.7405566 , ...,  1.3922336 ,
         1.1078323 ,  1.0936122 ],
       [ 1.273407  ,  1.8281472 ,  1.8427455 , ...,  1.3495734 ,
         1.3495734 ,  1.3637935 ],
       [ 1.7551551 ,  1.7551551 ,  1.7551551 , ...,  1.3922336 ,
         1.4064537 ,  1.0651721 ],
       ...,
       [-0.47840413, -0.94555384, -1.3105145 , ..., -1.1958185 ,
        -1.2242587 , -1.0251776 ],
       [-0.08424664,  0.07633615,  0.12013142, ..., -0.7976566 ,
        -0.6412359 , -0.4421549 ],
       [-0.28862458, -0.2302309 , -0.09884507, ..., -0.5985757 ,
        -0.74077636, -0.7549964 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 24, 18]]), array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 30]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]]), array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man sitting on a bench looking down.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog with a toy in its mouth while running across a beach.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small white and black sheep with a spot on it.\n', 'Find me an everyday image that matches the given caption: A street with many passersby, cars, and a large monument.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 20/6000 [00:42<3:26:18,  2.07s/it]                                                   {'loss': 14.5342, 'grad_norm': 2981.646484375, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.0}
  0%|          | 20/6000 [00:42<3:26:18,  2.07s/it][2025-11-13 01:31:40,181] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  39698,   1899,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    518,   3729,    624],
        [151643, 151643, 151643,  ...,  21633,  11929,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People playing in a large park on a beautiful sunny day.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The person is putting a pan into the oven.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sign a street a green car and a person with a black umbrella.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is some tomatoes and onions in a bowl near a portable burner.\n', 'Find me an everyday image that matches the given caption: A closeup photo of a sheep, with other sheep in the background.\n', 'Find me an everyday image that matches the given caption: A close up of a teddy bear in a red t-shirt.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of boys playing in a field at night.\n', 'Find me an everyday image that matches the given caption: A narrow street has numerous blue pointing signs.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=385x256 at 0x7F327278BDF0>], [None], [<PIL.Image.Image image mode=RGB size=256x387 at 0x7F327278BD90>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278BDC0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278BE80>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327278BE20>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327278BE50>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F327278BF10>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327278BEB0>], [None], [None]], 'pixel_values': [array([[-1.3689082 , -1.3689082 , -1.3689082 , ..., -0.9398572 ,
        -0.95407724, -0.9398572 ],
       [-1.3689082 , -1.3543098 , -1.398105  , ..., -0.91141707,
        -0.9256371 , -0.95407724],
       [-1.0769397 , -1.0915381 , -1.0915381 , ..., -1.0536178 ,
        -1.067838  , -1.082058  ],
       ...,
       [-1.2375224 , -1.2667192 , -1.2667192 , ..., -0.882977  ,
        -0.86875695, -0.882977  ],
       [-0.9163569 , -0.87256163, -0.8433648 , ..., -0.58435565,
        -0.61279577, -0.61279577],
       [-0.94555384, -0.9309554 , -0.94555384, ..., -0.6412359 ,
        -0.6270158 , -0.57013553]], dtype=float32), None, array([[-0.9163569 , -0.9309554 , -0.96015227, ..., -0.86875695,
        -0.882977  , -0.89719707],
       [-0.7557742 , -0.6681836 , -0.5367978 , ..., -1.0536178 ,
        -1.0536178 , -1.067838  ],
       [-0.7411758 , -0.7411758 , -0.7557742 , ..., -1.0109575 ,
        -0.9967375 , -1.0109575 ],
       ...,
       [-1.0769397 , -1.0915381 , -1.0769397 , ..., -1.1815984 ,
        -1.1958185 , -1.1815984 ],
       [-0.9309554 , -0.94555384, -0.94555384, ..., -1.1673783 ,
        -1.1958185 , -1.1958185 ],
       [-1.1499318 , -1.1353334 , -1.1061366 , ..., -1.067838  ,
        -1.067838  , -1.082058  ]], dtype=float32), None, array([[ 1.4339896 ,  1.4631865 ,  1.4485881 , ...,  1.705075  ,
         1.690855  ,  1.6766349 ],
       [ 1.4047928 ,  1.4047928 ,  1.4485881 , ...,  1.2358129 ,
         1.2215928 ,  1.2784731 ],
       [ 1.6383677 ,  1.6383677 ,  1.6383677 , ...,  1.4348938 ,
         0.7949909 ,  1.022512  ],
       ...,
       [-1.193727  , -1.193727  , -1.193727  , ..., -0.9825174 ,
        -0.9825174 , -0.9967375 ],
       [-1.2229239 , -1.0039475 , -0.78497106, ..., -0.95407724,
        -0.9825174 , -0.95407724],
       [-1.0623412 , -1.0477428 , -1.0623412 , ..., -0.882977  ,
        -0.86875695, -0.8545369 ]], dtype=float32), None, array([[-1.3543098 , -1.2521207 , -1.1791286 , ..., -0.6412359 ,
        -0.68389606, -0.6981161 ],
       [-0.6243884 , -1.0915381 , -1.0477428 , ..., -1.0393977 ,
        -1.0109575 , -1.0109575 ],
       [-1.2083255 , -1.2521207 , -1.2959161 , ..., -1.2526988 ,
        -1.2384787 , -1.1247182 ],
       ...,
       [-0.6243884 , -0.8141679 , -0.82876635, ..., -0.5985757 ,
        -0.58435565, -0.58435565],
       [-0.88716006, -0.9309554 , -1.0039475 , ...,  0.80921096,
         0.7949909 ,  0.7807708 ],
       [-0.96015227, -0.88716006, -0.9309554 , ...,  0.6527902 ,
         0.63857013,  0.6243501 ]], dtype=float32), array([[-0.49300256, -0.44920728, -0.43460885, ..., -0.5559154 ,
        -0.57013553, -0.5274753 ],
       [-0.37621516, -0.39081356, -0.37621516, ..., -0.38527465,
        -0.3710546 , -0.3710546 ],
       [-0.47840413, -0.47840413, -0.49300256, ..., -0.58435565,
        -0.5274753 , -0.48481512],
       ...,
       [ 0.5580842 ,  0.5726826 ,  0.5726826 , ..., -0.08665328,
        -0.08665328, -0.10087335],
       [ 0.67487156,  0.66027313,  0.66027313, ..., -0.05821316,
        -0.08665328, -0.11509342],
       [ 0.58728105,  0.58728105,  0.58728105, ..., -0.20041381,
        -0.18619375, -0.18619375]], dtype=float32), array([[1.6675645 , 1.477785  , 1.4485881 , ..., 1.7761754 , 1.8188357 ,
        1.6339747 ],
       [1.6675645 , 1.6237692 , 1.6237692 , ..., 2.145897  , 2.1316772 ,
        2.0890167 ],
       [1.477785  , 1.4193913 , 1.1420212 , ..., 1.5628744 , 1.6055346 ,
        1.5059941 ],
       ...,
       [0.8792495 , 0.9084464 , 1.1566195 , ..., 0.36838892, 0.6670103 ,
        0.823431  ],
       [1.3609976 , 1.4193913 , 1.5361787 , ..., 0.51058954, 0.4963695 ,
        0.3257286 ],
       [1.273407  , 0.9668401 , 1.2588086 , ..., 0.5532498 , 0.6243501 ,
        0.56746984]], dtype=float32), array([[-1.6462783 , -1.6462783 , -1.6462783 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.6754751 , -1.6754751 , -1.6754751 , ..., -1.3948994 ,
        -1.3522393 , -1.2526988 ],
       [-1.704672  , -1.6900735 , -1.6900735 , ..., -0.8403168 ,
        -0.81187665, -0.81187665],
       ...,
       [ 1.2150133 ,  1.171218  ,  1.1858164 , ..., -1.0962781 ,
        -1.1673783 , -1.2242587 ],
       [ 1.4923834 ,  1.4631865 ,  1.4485881 , ..., -0.81187665,
        -0.4421549 , -0.20041381],
       [ 1.0106354 ,  0.9084464 ,  0.8646511 , ...,  1.7903955 ,
         1.8046155 ,  1.8046155 ]], dtype=float32), None, None, None, array([[ 1.1274228 ,  1.1274228 ,  1.1274228 , ...,  1.4348938 ,
         1.4491138 ,  1.4348938 ],
       [ 1.171218  ,  1.171218  ,  1.1420212 , ...,  1.4917741 ,
         1.4917741 ,  1.4917741 ],
       [ 1.2004149 ,  1.2004149 ,  1.2004149 , ...,  0.5532498 ,
         0.29728848,  0.35416883],
       ...,
       [-0.87256163, -0.9017585 , -0.82876635, ..., -1.2242587 ,
        -1.067838  , -0.95407724],
       [-0.7703726 , -0.72657734, -0.59519154, ..., -0.9256371 ,
        -0.9967375 , -1.0962781 ],
       [-0.6243884 , -0.6973805 , -0.8433648 , ..., -1.2100385 ,
        -1.1815984 , -1.1673783 ]], dtype=float32), None, None], 'image_grid_thw': [array([[ 1, 18, 28]]), None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), array([[ 1, 28, 18]]), array([[ 1, 18, 18]]), None, None, None, array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People playing in a large park on a beautiful sunny day.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The person is putting a pan into the oven.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sign a street a green car and a person with a black umbrella.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is some tomatoes and onions in a bowl near a portable burner.\n', 'Find me an everyday image that matches the given caption: A closeup photo of a sheep, with other sheep in the background.\n', 'Find me an everyday image that matches the given caption: A close up of a teddy bear in a red t-shirt.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of boys playing in a field at night.\n', 'Find me an everyday image that matches the given caption: A narrow street has numerous blue pointing signs.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 21/6000 [00:44<3:26:57,  2.08s/it]                                                   {'loss': 12.331, 'grad_norm': 1767.5299072265625, 'learning_rate': 2.1000000000000002e-06, 'epoch': 0.0}
  0%|          | 21/6000 [00:44<3:26:57,  2.08s/it][2025-11-13 01:31:42,282] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    315,  12408,    624],
        [151643, 151643, 151643,  ...,   6176,  92384,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The television is turned off next the brown china cabinet.\n', 'Find me an everyday image that matches the given caption: A mirror shot of a big red bus traveling.\n', 'Find me an everyday image that matches the given caption: Drinks and dessert at a restaurant with friends.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close-up of the Seagull standing on the beach and ocean.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A downhill skier is racing against the clock.\n', 'Find me an everyday image that matches the given caption: A woman sits on a window ledge while talking on the phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two giraffes standing next to each other under a group of trees.\n', 'Find me an everyday image that matches the given caption: Some purple irises are in a green vase.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277EDD0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272788460>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F3272789C60>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x289 at 0x7F327278B190>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278B670>], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272788F10>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B100>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F327278AD40>], [None], [None]], 'pixel_values': [array([[-1.7922626 , -1.7484672 , -1.6316798 , ...,  0.7949909 ,
         0.72389054,  0.5816899 ],
       [-1.7922626 , -1.7776641 , -1.704672  , ...,  0.59590995,
         0.4963695 ,  0.4537093 ],
       [-1.1791286 , -1.3835065 , -0.96015227, ..., -0.42793486,
        -0.71233624, -1.067838  ],
       ...,
       [-0.65358526, -0.6389868 , -0.65358526, ..., -0.89719707,
        -0.882977  , -0.8545369 ],
       [-0.21563247, -0.2740262 , -0.37621516, ..., -0.5274753 ,
        -0.5985757 , -0.74077636],
       [-0.36161673, -0.39081356, -0.39081356, ..., -0.45637497,
        -0.4421549 , -0.42793486]], dtype=float32), array([[-0.24482933, -0.21563247, -0.20103405, ..., -0.35683453,
        -0.6981161 , -0.86875695],
       [-0.2740262 , -0.6681836 , -0.8579632 , ..., -0.10087335,
        -0.20041381, -0.243074  ],
       [-0.31782144, -0.42001042, -0.43460885, ..., -0.7976566 ,
        -0.7976566 , -0.7976566 ],
       ...,
       [ 0.42669836,  1.1566195 ,  1.477785  , ..., -0.81187665,
        -0.78343654, -0.7976566 ],
       [-0.68278205, -0.6973805 , -0.6973805 , ..., -1.0251776 ,
        -1.0536178 , -1.0536178 ],
       [-0.68278205, -0.6681836 , -0.68278205, ..., -1.082058  ,
        -1.082058  , -1.0251776 ]], dtype=float32), array([[ 1.2150133 ,  1.8135487 ,  1.4485881 , ...,  0.85187113,
         0.9940718 ,  1.6624149 ],
       [ 1.273407  ,  1.171218  ,  0.93764323, ..., -0.42793486,
        -1.0393977 , -0.882977  ],
       [ 1.6383677 ,  1.5945723 ,  1.477785  , ...,  1.8188357 ,
         1.7761754 ,  1.7335151 ],
       ...,
       [-1.6900735 , -1.7338688 , -1.7338688 , ..., -1.4802198 ,
        -1.309579  , -1.3664593 ],
       [-1.6754751 , -1.6316798 , -1.6170814 , ..., -1.3948994 ,
        -1.4375596 , -1.4517797 ],
       [-0.9747507 , -0.9893491 , -1.018546  , ..., -1.4659997 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, None, None, array([[ 0.17852512,  0.17852512,  0.17852512, ...,  1.2500329 ,
         1.2500329 ,  1.2500329 ],
       [ 0.17852512,  0.17852512,  0.16392669, ...,  1.2073728 ,
         1.2073728 ,  1.2073728 ],
       [ 0.2223204 ,  0.2223204 ,  0.2223204 , ...,  1.2500329 ,
         1.2500329 ,  1.2500329 ],
       ...,
       [-0.6389868 , -0.6389868 , -0.68278205, ..., -1.0109575 ,
        -1.0251776 , -0.96829736],
       [-1.3543098 , -1.2959161 , -1.3689082 , ..., -0.9256371 ,
        -0.882977  , -0.89719707],
       [-1.0039475 , -1.0039475 , -1.018546  , ..., -1.1104981 ,
        -1.0109575 , -0.9825174 ]], dtype=float32), None, array([[-0.72657734, -0.47840413, -0.8141679 , ..., -0.8545369 ,
        -0.9256371 , -0.9398572 ],
       [-0.7703726 , -0.3470183 , -0.28862458, ..., -0.58435565,
        -0.669676  , -0.5985757 ],
       [-1.4856956 , -1.1353334 , -0.4638057 , ..., -0.882977  ,
        -0.86875695, -0.8545369 ],
       ...,
       [ 0.791659  ,  0.8646511 ,  0.9668401 , ..., -0.5559154 ,
        -0.58435565, -0.61279577],
       [-0.49300256, -0.44920728, -0.42001042, ..., -0.74077636,
        -0.7265563 , -0.6981161 ],
       [-0.37621516, -0.37621516, -0.37621516, ..., -0.7265563 ,
        -0.7549964 , -0.7976566 ]], dtype=float32), None, None, array([[-0.68278205, -0.68278205, -0.68278205, ...,  0.19774802,
         0.19774802,  0.19774802],
       [-0.4638057 , -0.4638057 , -0.44920728, ...,  0.26884836,
         0.29728848,  0.33994877],
       [-0.68278205, -0.65358526, -0.6389868 , ...,  0.29728848,
         0.31150854,  0.31150854],
       ...,
       [ 1.2880055 ,  1.2880055 ,  1.2880055 , ...,  1.705075  ,
         1.705075  ,  1.690855  ],
       [ 1.2442101 ,  1.2442101 ,  1.2442101 , ...,  1.6624149 ,
         1.6624149 ,  1.6481948 ],
       [ 1.2442101 ,  1.2150133 ,  1.2150133 , ...,  1.690855  ,
         1.690855  ,  1.690855  ]], dtype=float32), array([[ 0.54348576,  0.16392669, -0.49300256, ..., -1.4375596 ,
        -1.4802198 , -1.4233395 ],
       [ 0.07633615,  0.26611567,  0.66027313, ..., -1.2953589 ,
        -1.3806794 , -1.4233395 ],
       [ 0.4704936 ,  0.5726826 ,  0.19312355, ..., -1.2242587 ,
        -1.3948994 , -1.3948994 ],
       ...,
       [-0.7557742 , -0.78497106, -0.8141679 , ...,  0.85187113,
         0.7665507 ,  0.63857013],
       [-1.0623412 , -1.018546  , -1.0477428 , ..., -1.2669188 ,
        -1.3522393 , -1.3664593 ],
       [ 1.0836275 ,  0.99603695,  1.0690291 , ...,  0.9940718 ,
         1.0082918 ,  1.036732  ]], dtype=float32), array([[ 0.68947   ,  0.77706057,  0.8792495 , ...,  2.074797  ,
         2.0605767 ,  2.0605767 ],
       [ 0.19312355,  0.17852512,  0.16392669, ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.8281472 ,  1.8135487 ,  1.8135487 , ...,  2.0890167 ,
         2.103237  ,  2.117457  ],
       ...,
       [-0.36161673,  0.5580842 ,  0.58728105, ..., -1.3806794 ,
        -1.4233395 , -1.4802198 ],
       [ 0.36830464,  0.38290307,  0.26611567, ..., -1.4375596 ,
        -1.3806794 , -1.0962781 ],
       [-1.3105145 , -1.3835065 , -1.4710971 , ..., -1.4233395 ,
        -1.3664593 , -1.3664593 ]], dtype=float32), None, None], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None, None, None, array([[ 1, 20, 18]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The television is turned off next the brown china cabinet.\n', 'Find me an everyday image that matches the given caption: A mirror shot of a big red bus traveling.\n', 'Find me an everyday image that matches the given caption: Drinks and dessert at a restaurant with friends.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close-up of the Seagull standing on the beach and ocean.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A downhill skier is racing against the clock.\n', 'Find me an everyday image that matches the given caption: A woman sits on a window ledge while talking on the phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two giraffes standing next to each other under a group of trees.\n', 'Find me an everyday image that matches the given caption: Some purple irises are in a green vase.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 22/6000 [00:46<3:28:11,  2.09s/it]                                                   {'loss': 11.3213, 'grad_norm': 1898.874267578125, 'learning_rate': 2.2e-06, 'epoch': 0.0}
  0%|          | 22/6000 [00:46<3:28:11,  2.09s/it][2025-11-13 01:31:44,392] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,  11794,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  67439,  11321,    624],
        ...,
        [151643, 151643, 151643,  ...,    806,   1968,    624],
        [151643, 151643, 151643,  ...,   7149,  19818,    624],
        [151643, 151643, 151643,  ...,  16217,   4752,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A little girl wearing pink and gray standing on skis in the snow.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Some lounge chairs are arranged on the sandy beach.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bus stopped in a snowy fenced in yard.\n', 'Find me an everyday image that matches the given caption: Some birds are flying around in a field.\n', 'Find me an everyday image that matches the given caption: People standing at a bar, eating appetizers and drinking wine.\n', 'Find me an everyday image that matches the given caption: A dining room with a table and microwave.\n', 'Find me an everyday image that matches the given caption: A man is standing with his hands in his pockets while a woman with a purple hat is holding an umbrella over his head.\n', 'Find me an everyday image that matches the given caption: A truck holding a couch on top with safety ties.\n', 'Find me an everyday image that matches the given caption: A red fire hydrant looms in front of a tall building.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=328x256 at 0x7F327278BAC0>], [None], [<PIL.Image.Image image mode=RGB size=256x455 at 0x7F327278BFA0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278BEE0>], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F327278AEC0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278AC80>], [<PIL.Image.Image image mode=RGB size=297x256 at 0x7F327278BF40>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327278A500>], [None], [None], [None], [None], [None], [None], [None]], 'pixel_values': [None, array([[-1.2229239 , -1.5294908 , -1.7630657 , ...,  0.6670103 ,
         0.05554737,  0.11242763],
       [-1.6170814 , -1.6316798 , -1.7338688 , ..., -0.51325524,
        -0.51325524, -0.5274753 ],
       [-1.7776641 , -1.7922626 , -1.7922626 , ...,  0.31150854,
         0.25462827,  0.24040821],
       ...,
       [-0.02585294,  0.01794233,  0.01794233, ..., -1.3522393 ,
        -1.4659997 , -1.4802198 ],
       [-0.04045137, -0.11344349, -0.12804192, ..., -1.4375596 ,
        -1.4233395 , -1.4802198 ],
       [ 0.0617376 ,  0.07633615,  0.04713918, ..., -1.4802198 ,
        -1.3380191 , -1.4802198 ]], dtype=float32), None, array([[-1.5732862, -1.5732862, -1.5586877, ..., -1.0251776, -1.0393977,
        -1.0393977],
       [-1.4419003, -1.4273019, -1.4273019, ..., -0.9398572, -1.0393977,
        -1.1673783],
       [-1.5294908, -1.5586877, -1.5732862, ..., -1.1104981, -1.1958185,
        -1.2384787],
       ...,
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.1673783, -1.1673783,
        -1.1673783],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.1531583, -1.1673783,
        -1.1673783],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.1673783, -1.1673783,
        -1.1673783]], dtype=float32), array([[ 0.38290307,  0.44129676,  0.52888733, ..., -1.0393977 ,
        -0.9825174 , -0.9398572 ],
       [ 0.66027313,  0.6456747 ,  0.67487156, ..., -0.78343654,
        -0.81187665, -0.8260967 ],
       [-0.06964822, -0.06964822, -0.09884507, ..., -1.4375596 ,
        -1.3948994 , -1.4233395 ],
       ...,
       [ 0.5142889 ,  0.52888733,  0.5142889 , ..., -1.1389382 ,
        -1.1673783 , -1.1815984 ],
       [ 0.54348576,  0.52888733,  0.52888733, ..., -1.1673783 ,
        -1.1958185 , -1.2100385 ],
       [ 0.36830464,  0.38290307,  0.3537062 , ..., -1.2100385 ,
        -1.2384787 , -1.2669188 ]], dtype=float32), array([[-0.14264035, -0.14264035, -0.14264035, ...,  0.16930789,
         0.16930789,  0.16930789],
       [-0.12804192, -0.12804192, -0.12804192, ...,  0.16930789,
         0.16930789,  0.16930789],
       [-0.08424664, -0.08424664, -0.08424664, ...,  0.14086775,
         0.14086775,  0.14086775],
       ...,
       [-0.6389868 , -0.6389868 , -0.6243884 , ..., -0.39949474,
        -0.4421549 , -0.48481512],
       [ 0.2223204 ,  0.20772196,  0.19312355, ...,  0.6670103 ,
         0.6527902 ,  0.63857013],
       [ 0.03254076,  0.00334391, -0.02585294, ...,  0.5816899 ,
         0.5532498 ,  0.4963695 ]], dtype=float32), array([[-0.7411758 , -0.15723877, -0.65358526, ..., -1.2242587 ,
        -1.1247182 , -1.082058  ],
       [-0.49300256, -0.47840413, -0.43460885, ..., -0.9825174 ,
        -0.7549964 , -0.65545595],
       [-0.96015227, -0.9017585 , -0.7995695 , ..., -1.4091195 ,
        -1.3664593 , -1.2384787 ],
       ...,
       [-1.3543098 , -1.3543098 , -1.2229239 , ..., -1.4233395 ,
        -1.067838  , -1.0393977 ],
       [-1.2375224 , -1.1791286 , -1.1791286 , ..., -1.1247182 ,
        -1.3522393 , -1.3237991 ],
       [-1.0915381 , -1.1645303 , -0.9893491 , ..., -1.3380191 ,
        -1.4802198 , -1.1815984 ]], dtype=float32), array([[ 1.4631865e+00,  9.2304480e-01,  9.9603695e-01, ...,
        -3.5683453e-01, -2.8573421e-01, -1.2931348e-01],
       [ 1.4631865e+00,  1.4339896e+00,  1.3755959e+00, ...,
         5.5547368e-02,  5.5547368e-02,  6.9767430e-02],
       [ 1.7989503e+00,  1.2296118e+00,  1.1274228e+00, ...,
        -1.3328948e-03, -1.5552960e-02, -2.9773025e-02],
       ...,
       [-7.9956949e-01, -1.1499318e+00, -1.5148925e+00, ...,
        -3.7105459e-01, -2.9995427e-01, -1.0087335e-01],
       [ 7.7706057e-01,  9.0844637e-01,  8.9384794e-01, ...,
         1.3495734e+00,  1.3211333e+00,  1.3069133e+00],
       [-7.8497106e-01, -7.5577420e-01, -7.1197891e-01, ...,
         1.4206737e+00,  1.4775540e+00,  1.4775540e+00]], dtype=float32), array([[-1.2667192 , -1.1207349 , -1.018546  , ..., -1.3237991 ,
        -1.4659997 , -1.2526988 ],
       [-1.4564987 , -1.4419003 , -1.4127034 , ..., -0.9825174 ,
        -0.78343654, -0.54169536],
       [-1.500294  , -1.4419003 , -1.4564987 , ...,  0.36838892,
         0.24040821,  0.14086775],
       ...,
       [-0.14264035, -0.12804192, -0.14264035, ..., -0.78343654,
        -0.8260967 , -0.8545369 ],
       [-0.1718372 , -0.21563247, -0.24482933, ..., -0.78343654,
        -0.7265563 , -0.86875695],
       [-0.3470183 , -0.31782144, -0.303223  , ..., -0.8545369 ,
        -0.8403168 , -0.8545369 ]], dtype=float32), None, None, None, None, None, None, None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), None, array([[ 1, 32, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 22]]), array([[ 1, 18, 28]]), None, None, None, None, None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A little girl wearing pink and gray standing on skis in the snow.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Some lounge chairs are arranged on the sandy beach.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bus stopped in a snowy fenced in yard.\n', 'Find me an everyday image that matches the given caption: Some birds are flying around in a field.\n', 'Find me an everyday image that matches the given caption: People standing at a bar, eating appetizers and drinking wine.\n', 'Find me an everyday image that matches the given caption: A dining room with a table and microwave.\n', 'Find me an everyday image that matches the given caption: A man is standing with his hands in his pockets while a woman with a purple hat is holding an umbrella over his head.\n', 'Find me an everyday image that matches the given caption: A truck holding a couch on top with safety ties.\n', 'Find me an everyday image that matches the given caption: A red fire hydrant looms in front of a tall building.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 23/6000 [00:48<3:27:04,  2.08s/it]                                                   {'loss': 11.118, 'grad_norm': 1619.904052734375, 'learning_rate': 2.3000000000000004e-06, 'epoch': 0.0}
  0%|          | 23/6000 [00:48<3:27:04,  2.08s/it][2025-11-13 01:31:46,443] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   4158,  31912,    624],
        [151643, 151643, 151643,  ...,   3460,  21430,    624],
        [151643, 151643, 151643,  ...,    279,   4845,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  30232,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,   6869,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A sheepdog tending to his flock of white sheep.\n', 'Find me an everyday image that matches the given caption: A guy is ready to cut his cake with a large knife.\n', 'Find me an everyday image that matches the given caption: A bedroom with a chandalier and a canopy for the bed.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is at a desk typing at a computer.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a silver train pulled into the station.\n', 'Find me an everyday image that matches the given caption: A KITCHEN WITH A SINK AND APPLIANCES.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A row of wine glasses on a wooden table.\n', 'Find me an everyday image that matches the given caption: A large kitchen with stainless steel appliances and a wooden floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Skier on a sunny day coming down a slope.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The sculptures next to the potted plant are decorated with fur and hair.\n'], 'images': [[None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277EF80>], [<PIL.Image.Image image mode=RGB size=373x256 at 0x7F327277DFF0>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727B7190>], [None], [None], [<PIL.Image.Image image mode=RGB size=373x256 at 0x7F32727B71F0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727B7220>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727B7250>], [None]], 'pixel_values': [None, None, None, array([[-8.43364775e-01, -7.41175771e-01, -5.65994680e-01, ...,
         6.97674304e-02, -2.97730248e-02, -7.54996419e-01],
       [-1.03314435e+00, -1.39810503e+00, -1.06234121e+00, ...,
        -4.84815121e-01, -4.84815121e-01, -4.99035180e-01],
       [-4.34608847e-01, -2.59427756e-01, -1.13443494e-01, ...,
         2.40408212e-01,  2.54628271e-01, -5.82131557e-02],
       ...,
       [-1.45649874e+00, -1.39810503e+00, -1.39810503e+00, ...,
         4.96369511e-01,  4.82149422e-01,  4.96369511e-01],
       [ 3.53706211e-01,  3.24509382e-01,  2.95312524e-01, ...,
         2.71072350e-02, -1.33289478e-03, -1.55529603e-02],
       [ 2.51517236e-01,  1.93123549e-01,  1.78525120e-01, ...,
        -7.24332184e-02, -7.24332184e-02, -2.97730248e-02]], dtype=float32), array([[-0.02585294, -0.02585294, -0.02585294, ...,  0.25462827,
         0.25462827,  0.25462827],
       [ 0.00334391, -0.04045137, -0.08424664, ...,  0.3257286 ,
         0.3257286 ,  0.31150854],
       [-0.06964822, -0.06964822, -0.06964822, ...,  0.29728848,
         0.29728848,  0.31150854],
       ...,
       [ 1.5945723 ,  1.6383677 ,  1.7843518 , ...,  1.9610363 ,
         1.9468161 ,  1.9468161 ],
       [ 1.8281472 ,  1.8427455 ,  1.857344  , ...,  1.6339747 ,
         1.6339747 ,  1.6481948 ],
       [ 1.8135487 ,  1.857344  ,  1.8865409 , ...,  1.9325962 ,
         1.9610363 ,  1.9752562 ]], dtype=float32), None, array([[-1.13443494e-01, -1.13443494e-01, -9.88450721e-02, ...,
        -2.97730248e-02, -1.55529603e-02, -1.33289478e-03],
       [ 3.25407572e-02,  3.25407572e-02,  4.71391827e-02, ...,
         2.71072350e-02,  4.13273014e-02,  4.13273014e-02],
       [ 9.09345672e-02,  9.09345672e-02,  9.09345672e-02, ...,
         8.39874968e-02,  1.12427630e-01,  1.40867755e-01],
       ...,
       [-1.67547512e+00, -1.66087663e+00, -1.66087663e+00, ...,
        -1.35223925e+00, -1.35223925e+00, -1.35223925e+00],
       [-1.67547512e+00, -1.71927035e+00, -1.74846721e+00, ...,
        -1.33801913e+00, -1.38067937e+00, -1.39489937e+00],
       [-1.63167977e+00, -1.63167977e+00, -1.63167977e+00, ...,
        -1.30957901e+00, -1.26691878e+00, -1.28113890e+00]], dtype=float32), None, None, array([[ 0.8792495 ,  0.8792495 ,  0.8792495 , ...,  1.875716  ,
         1.875716  ,  1.875716  ],
       [ 0.9084464 ,  0.9084464 ,  0.9230448 , ...,  1.8614956 ,
         1.8614956 ,  1.8614956 ],
       [ 0.99603695,  0.99603695,  0.99603695, ...,  1.8046155 ,
         1.8046155 ,  1.8046155 ],
       ...,
       [-0.25942776, -0.11344349,  0.12013142, ...,  0.5532498 ,
         0.24040821,  0.56746984],
       [ 0.8646511 ,  0.93764323,  0.99603695, ...,  0.8376511 ,
         0.29728848,  0.61013   ],
       [ 0.41209993,  0.30991095,  0.2223204 , ...,  0.80921096,
         0.4537093 ,  0.1266477 ]], dtype=float32), None, None, array([[ 1.3463992 ,  1.3755959 ,  1.3318007 , ...,  1.7192951 ,
         1.705075  ,  1.690855  ],
       [ 1.2004149 ,  0.791659  ,  0.3975015 , ...,  1.8330555 ,
         1.8046155 ,  1.7619553 ],
       [ 0.8354542 ,  0.85005265,  0.76246214, ...,  1.8330555 ,
         1.7477353 ,  1.6055346 ],
       ...,
       [-0.6243884 , -0.6243884 , -0.6243884 , ..., -0.68389606,
        -0.669676  , -0.669676  ],
       [-0.72657734, -0.8433648 , -0.9163569 , ..., -0.58435565,
        -0.61279577, -0.5985757 ],
       [-0.82876635, -0.82876635, -0.82876635, ..., -0.6270158 ,
        -0.61279577, -0.65545595]], dtype=float32), None, array([[ 0.5726826 ,  0.58728105,  0.6018794 , ...,  0.48214942,
         0.4963695 ,  0.51058954],
       [ 0.76246214,  0.76246214,  0.7478637 , ...,  0.5532498 ,
         0.5390297 ,  0.5390297 ],
       [ 0.68947   ,  0.68947   ,  0.7040684 , ..., -0.20041381,
         0.14086775,  0.4110491 ],
       ...,
       [-1.4564987 , -1.4564987 , -1.4564987 , ..., -0.15775362,
         0.05554737,  0.06976743],
       [-1.2813176 , -1.2959161 , -1.3105145 , ..., -0.7692165 ,
        -0.74077636, -0.74077636],
       [-1.3689082 , -1.3543098 , -1.3397113 , ..., -0.8260967 ,
        -0.8403168 , -0.86875695]], dtype=float32), None], 'image_grid_thw': [None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 26]]), None, array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 26]]), None, None, array([[ 1, 24, 18]]), None, array([[ 1, 24, 18]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A sheepdog tending to his flock of white sheep.\n', 'Find me an everyday image that matches the given caption: A guy is ready to cut his cake with a large knife.\n', 'Find me an everyday image that matches the given caption: A bedroom with a chandalier and a canopy for the bed.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is at a desk typing at a computer.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a silver train pulled into the station.\n', 'Find me an everyday image that matches the given caption: A KITCHEN WITH A SINK AND APPLIANCES.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A row of wine glasses on a wooden table.\n', 'Find me an everyday image that matches the given caption: A large kitchen with stainless steel appliances and a wooden floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Skier on a sunny day coming down a slope.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The sculptures next to the potted plant are decorated with fur and hair.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  0%|          | 24/6000 [00:51<3:32:53,  2.14s/it]                                                   {'loss': 11.341, 'grad_norm': 1869.10400390625, 'learning_rate': 2.4000000000000003e-06, 'epoch': 0.0}
  0%|          | 24/6000 [00:51<3:32:53,  2.14s/it][2025-11-13 01:31:48,723] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  22854,    646,    624],
        [151643, 151643, 151643,  ...,   5567,  28709,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    448,  47885,    624],
        [151643, 151643, 151643,  ...,   1008,   3108,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A toilet bowl is sitting next to a small orange trash can.\n', 'Find me an everyday image that matches the given caption: A very small bathroom with two toilet paper holders.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A striped cat laying upside down on a down comforter,.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man on a surfboard rides a wave.\n', 'Find me an everyday image that matches the given caption: A stop sign and no right run sign in a big city.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large white horse and bird in a grass field.\n', 'Find me an everyday image that matches the given caption: A cat stands on a shelf inside a refrigerator.\n', 'Find me an everyday image that matches the given caption: Many adults are in a classroom with laptops.\n', 'Find me an everyday image that matches the given caption: A big black bear running across the street to get to the other side.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x385 at 0x7F327278AC20>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727B7F40>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B6980>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B6500>], [<PIL.Image.Image image mode=RGB size=256x337 at 0x7F32727B6BF0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727B7F10>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x260 at 0x7F32727B6CB0>]], 'pixel_values': [None, None, array([[ 0.42669836,  0.42669836,  0.42669836, ...,  1.2500329 ,
         1.2358129 ,  1.2358129 ],
       [ 0.30991095,  0.29531252,  0.23691882, ...,  1.2358129 ,
         1.2358129 ,  1.2358129 ],
       [ 0.4558952 ,  0.4558952 ,  0.4558952 , ...,  1.2926931 ,
         1.2926931 ,  1.2784731 ],
       ...,
       [-1.0915381 , -1.0623412 , -0.9893491 , ..., -0.882977  ,
        -0.9256371 , -0.89719707],
       [-1.0331444 , -0.9893491 , -0.9163569 , ..., -0.89719707,
        -0.9256371 , -0.9398572 ],
       [-0.9893491 , -0.9893491 , -0.9893491 , ..., -0.9967375 ,
        -1.0251776 , -1.0251776 ]], dtype=float32), None, array([[-1.6754751 , -1.6608766 , -1.6462783 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7192703 , -1.6316798 , -1.500294  , ..., -1.4233395 ,
        -1.2526988 , -1.2669188 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.3948994 ,
        -1.3522393 , -1.3806794 ],
       ...,
       [-0.37621516, -0.50760096, -0.59519154, ..., -1.3380191 ,
        -1.3948994 , -1.2953589 ],
       [-0.5221994 ,  0.01794233, -0.2740262 , ..., -1.2242587 ,
        -1.3522393 , -1.4659997 ],
       [-0.8433648 , -0.68278205, -0.55139625, ..., -1.3948994 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-0.7995695 , -0.7995695 , -0.7995695 , ..., -0.4137148 ,
        -0.42793486, -0.39949474],
       [-0.78497106, -0.7995695 , -0.7703726 , ..., -0.29995427,
        -0.2857342 , -0.2857342 ],
       [-0.55139625, -0.5659947 , -0.55139625, ..., -0.29995427,
        -0.29995427, -0.32839438],
       ...,
       [-0.6973805 , -1.1791286 , -1.2375224 , ..., -1.0109575 ,
        -1.0109575 , -1.0109575 ],
       [-0.8433648 , -0.8579632 , -0.8433648 , ..., -1.0251776 ,
        -1.1104981 , -1.1958185 ],
       [-1.193727  , -1.1645303 , -1.193727  , ..., -1.082058  ,
        -1.1247182 , -1.1531583 ]], dtype=float32), None, None, array([[-1.2375224e+00, -1.0331444e+00, -9.3095541e-01, ...,
        -1.1958185e+00, -1.2669188e+00, -1.1389382e+00],
       [-8.1416792e-01, -9.8934913e-01, -8.8716006e-01, ...,
        -9.3985718e-01, -8.9719707e-01, -8.8297701e-01],
       [-7.5577420e-01, -1.0477428e+00, -1.3981050e+00, ...,
        -1.0109575e+00, -8.2609671e-01, -8.5453689e-01],
       ...,
       [ 5.7268262e-01,  7.0406842e-01,  5.7268262e-01, ...,
        -1.5775362e-01, -4.3993089e-02, -1.4353354e-01],
       [ 2.8071409e-01,  2.9531252e-01,  2.5151724e-01, ...,
        -1.3328948e-03,  1.2887171e-02, -5.8213156e-02],
       [-6.9648221e-02, -6.9648221e-02, -2.5852945e-02, ...,
        -1.1509342e-01, -1.0087335e-01, -2.1463387e-01]], dtype=float32), array([[ 1.6383677 ,  1.6383677 ,  1.6383677 , ...,  1.9468161 ,
         1.9610363 ,  1.9610363 ],
       [ 1.6967614 ,  1.6967614 ,  1.7113597 , ...,  1.9894764 ,
         1.9894764 ,  1.9894764 ],
       [ 1.7113597 ,  1.7113597 ,  1.7113597 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       ...,
       [-1.7484672 , -1.7922626 , -1.7922626 , ..., -0.45637497,
        -1.1247182 , -1.4802198 ],
       [-1.4127034 , -1.3543098 , -1.4710971 , ...,  0.61013   ,
         0.61013   ,  0.5816899 ],
       [ 0.29531252,  0.5580842 ,  0.6310763 , ...,  0.3257286 ,
         0.26884836,  0.15508783]], dtype=float32), array([[-0.9309554 , -0.78497106, -0.60978997, ..., -0.7265563 ,
        -0.74077636, -0.78343654],
       [-0.5367978 , -0.55139625, -0.6389868 , ..., -0.6270158 ,
        -0.61279577, -0.5985757 ],
       [-0.5221994 , -0.50760096, -0.49300256, ..., -0.68389606,
        -0.65545595, -0.6412359 ],
       ...,
       [ 0.16392669,  0.16392669,  0.13472985, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.14932826,  0.13472985,  0.14932826, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-0.303223  , -0.4638057 , -0.55139625, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, None, None, None, array([[ 0.42669836,  0.42669836,  0.42669836, ...,  0.88031125,
         0.88031125,  0.88031125],
       [ 0.49969047,  0.49969047,  0.49969047, ...,  0.8945313 ,
         0.8945313 ,  0.8945313 ],
       [ 0.5726826 ,  0.5726826 ,  0.5726826 , ...,  0.88031125,
         0.88031125,  0.8945313 ],
       ...,
       [ 1.5361787 ,  1.5945723 ,  1.6237692 , ..., -0.49903518,
        -0.5274753 , -0.669676  ],
       [ 1.6237692 ,  1.9303361 ,  1.9011393 , ..., -0.11509342,
         0.22618815,  0.6243501 ],
       [ 1.6091708 ,  1.6383677 ,  1.7113597 , ..., -0.51325524,
        -0.29995427, -0.12931348]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 28, 18]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 28, 18]]), None, None, None, None, array([[ 1, 18, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A toilet bowl is sitting next to a small orange trash can.\n', 'Find me an everyday image that matches the given caption: A very small bathroom with two toilet paper holders.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A striped cat laying upside down on a down comforter,.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man on a surfboard rides a wave.\n', 'Find me an everyday image that matches the given caption: A stop sign and no right run sign in a big city.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large white horse and bird in a grass field.\n', 'Find me an everyday image that matches the given caption: A cat stands on a shelf inside a refrigerator.\n', 'Find me an everyday image that matches the given caption: Many adults are in a classroom with laptops.\n', 'Find me an everyday image that matches the given caption: A big black bear running across the street to get to the other side.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 25/6000 [00:53<3:34:16,  2.15s/it]                                                   {'loss': 12.3456, 'grad_norm': 2597.664306640625, 'learning_rate': 2.5e-06, 'epoch': 0.0}
  0%|          | 25/6000 [00:53<3:34:16,  2.15s/it][2025-11-13 01:31:50,912] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   5636,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There are some signs and banners by a road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sandwich and some other foods on a white plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: They look like they are standing too close together to be throwing a frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A room full of antic toys and dolls with clothing.\n', 'Find me an everyday image that matches the given caption: A brown horse grazing in a grassy field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=342x256 at 0x7F32727B7EB0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727B7040>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727B5AB0>], [<PIL.Image.Image image mode=RGB size=357x256 at 0x7F32727B6F50>], [None], [<PIL.Image.Image image mode=RGB size=507x256 at 0x7F32727B6FB0>], [None], [<PIL.Image.Image image mode=RGB size=403x256 at 0x7F32727B6F20>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B4C10>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B7130>], [<PIL.Image.Image image mode=RGB size=256x364 at 0x7F32727B6D70>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278B190>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727B4940>]], 'pixel_values': [array([[-1.6462783 , -1.6316798 , -1.6170814 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.704672  , -1.7192703 , -1.6900735 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.2813176 , -1.398105  , -1.5294908 , ..., -1.2100385 ,
        -1.2242587 , -1.2669188 ],
       ...,
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.2242587 ,
        -1.2669188 , -1.2669188 ],
       [-1.3251129 , -1.3105145 , -1.3105145 , ..., -0.27151415,
        -0.27151415, -0.25729406],
       [-1.4856956 , -1.5148925 , -1.5294908 , ..., -0.5985757 ,
        -0.5985757 , -0.5985757 ]], dtype=float32), array([[-1.3543098 , -1.3543098 , -1.2667192 , ..., -0.95407724,
        -0.78343654, -0.9398572 ],
       [ 0.41209993,  0.00334391, -0.303223  , ...,  1.2073728 ,
         1.3495734 ,  0.4537093 ],
       [-0.15723877,  0.04713918, -0.28862458, ..., -0.25729406,
        -0.25729406, -0.2857342 ],
       ...,
       [ 0.7478637 ,  0.5142889 ,  0.85005265, ...,  0.7949909 ,
         0.63857013,  0.9798517 ],
       [ 0.52888733,  0.44129676,  0.52888733, ..., -0.81187665,
        -0.45637497, -0.4421549 ],
       [ 0.32450938,  0.5726826 ,  0.7478637 , ...,  0.31150854,
         0.46792936,  0.63857013]], dtype=float32), None, array([[-0.8433648 , -0.9163569 , -0.8579632 , ..., -0.01555296,
         0.11242763, -0.17197368],
       [-0.60978997, -0.65358526, -0.7995695 , ...,  0.31150854,
        -0.00133289, -0.10087335],
       [-0.72657734, -0.9017585 , -0.9747507 , ..., -0.14353354,
        -0.05821316, -0.01555296],
       ...,
       [-0.49300256, -0.49300256, -0.44920728, ..., -0.4421549 ,
        -0.4421549 , -0.47059506],
       [-0.55139625, -0.59519154, -0.6243884 , ..., -0.68389606,
        -0.7549964 , -0.74077636],
       [-0.72657734, -0.88716006, -1.0769397 , ..., -1.1104981 ,
        -0.9825174 , -1.0251776 ]], dtype=float32), array([[-0.09884507, -0.37621516,  0.2223204 , ..., -0.5985757 ,
        -0.58435565, -0.57013553],
       [-0.9893491 , -0.87256163, -0.7703726 , ...,  1.2215928 ,
         1.0936122 ,  1.0936122 ],
       [-1.018546  , -1.0039475 , -1.018546  , ...,  0.01288717,
         0.26884836,  0.24040821],
       ...,
       [ 0.42669836,  0.44129676,  0.42669836, ..., -0.12931348,
        -0.14353354, -0.11509342],
       [-0.303223  , -0.31782144, -0.31782144, ..., -0.01555296,
        -0.00133289, -0.00133289],
       [-0.39081356, -0.4638057 , -0.4638057 , ..., -0.18619375,
        -0.15775362, -0.12931348]], dtype=float32), None, array([[-0.5221994 , -0.47840413, -0.24482933, ..., -0.35683453,
        -0.29995427, -0.3710546 ],
       [-0.5805931 , -0.60978997, -0.6389868 , ..., -0.4137148 ,
        -0.4421549 , -0.51325524],
       [-0.6243884 , -0.7557742 , -0.44920728, ..., -0.5559154 ,
        -0.58435565, -0.51325524],
       ...,
       [ 0.00334391, -0.11344349, -0.20103405, ..., -0.12931348,
        -0.29995427, -0.45637497],
       [-0.60978997, -0.42001042, -0.39081356, ...,  0.02710724,
         0.05554737, -0.05821316],
       [-0.5221994 , -0.59519154, -0.8433648 , ..., -0.27151415,
        -0.11509342, -0.05821316]], dtype=float32), None, array([[-0.9893491 , -0.9163569 , -0.9163569 , ..., -0.71233624,
        -0.65545595, -0.7692165 ],
       [-0.87256163, -0.8433648 , -0.7411758 , ..., -0.39949474,
        -0.45637497, -0.42793486],
       [-0.33241987, -0.49300256, -0.55139625, ..., -0.9256371 ,
        -0.91141707, -0.81187665],
       ...,
       [ 1.5799739 ,  1.5069818 ,  1.4047928 , ...,  1.1931527 ,
         1.2215928 ,  1.2358129 ],
       [-0.01125452, -0.0550498 , -1.0039475 , ...,  0.88031125,
         0.8660912 ,  0.90875137],
       [ 0.8062574 ,  0.9084464 ,  1.1274228 , ...,  1.0793922 ,
         1.1220524 ,  1.1362724 ]], dtype=float32), array([[-1.1061366 , -1.2229239 , -1.018546  , ..., -0.49903518,
        -0.32839438, -0.25729406],
       [ 0.13472985,  0.16392669,  0.12013142, ..., -1.2811389 ,
        -1.2526988 , -1.1815984 ],
       [-0.88716006, -0.8433648 , -0.7411758 , ...,  1.9325962 ,
         1.9325962 ,  1.9468161 ],
       ...,
       [ 0.48509204,  0.4558952 ,  0.4704936 , ...,  1.0793922 ,
         1.0651721 ,  1.0651721 ],
       [ 0.4704936 ,  0.4704936 ,  0.4558952 , ...,  1.264253  ,
         1.2784731 ,  1.2500329 ],
       [ 0.4558952 ,  0.42669836,  0.42669836, ...,  1.0651721 ,
         1.0509521 ,  1.0509521 ]], dtype=float32), None, None, array([[ 1.8135487 ,  1.8135487 ,  1.8281472 , ...,  2.117457  ,
         2.145897  ,  2.145897  ],
       [ 1.4193913 ,  1.4485881 ,  1.4631865 , ...,  1.9325962 ,
         1.9610363 ,  1.9752562 ],
       [ 1.7697535 ,  1.7843518 ,  1.7989503 , ...,  1.875716  ,
         1.875716  ,  1.918376  ],
       ...,
       [-0.303223  , -0.55139625, -0.8433648 , ..., -0.8545369 ,
        -0.78343654, -0.6981161 ],
       [ 0.14932826,  0.04713918, -0.0550498 , ..., -1.1104981 ,
        -0.86875695, -0.48481512],
       [ 0.44129676,  0.5142889 ,  0.3537062 , ..., -0.71233624,
        -0.7549964 , -0.81187665]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [ 0.41209993,  0.49969047,  0.36830464, ...,  1.0082918 ,
         1.264253  ,  1.4917741 ],
       [ 0.49969047,  0.32450938,  0.19312355, ...,  1.4917741 ,
         1.477554  ,  1.477554  ],
       [-0.11344349, -0.06964822, -0.43460885, ...,  1.2500329 ,
         1.3922336 ,  1.2358129 ]], dtype=float32), array([[-1.0331444 , -1.2229239 , -1.2813176 , ...,  0.4963695 ,
         1.0936122 ,  1.3637935 ],
       [-0.7995695 , -0.68278205, -0.6681836 , ...,  1.4064537 ,
         1.3922336 ,  1.3922336 ],
       [ 0.76246214,  0.76246214,  0.7478637 , ...,  0.25462827,
         0.35416883,  0.80921096],
       ...,
       [-0.6243884 , -0.6243884 , -0.6243884 , ..., -0.47059506,
        -0.45637497, -0.45637497],
       [-0.6681836 , -0.65358526, -0.6389868 , ..., -0.49903518,
        -0.48481512, -0.4421549 ],
       [-0.6389868 , -0.65358526, -0.65358526, ..., -0.49903518,
        -0.47059506, -0.45637497]], dtype=float32), array([[-0.20103405, -0.02585294, -0.11344349, ..., -0.07243322,
        -0.08665328,  0.05554737],
       [-0.06964822,  0.01794233,  0.16392669, ..., -0.48481512,
        -0.4137148 , -0.2857342 ],
       [ 0.6018794 ,  0.49969047,  0.17852512, ..., -0.4137148 ,
        -0.51325524, -0.38527465],
       ...,
       [ 0.93764323,  0.9230448 ,  0.89384794, ...,  0.75233066,
         0.72389054,  0.5532498 ],
       [ 1.273407  ,  1.3609976 ,  1.4339896 , ...,  0.0839875 ,
         0.02710724,  0.21196808],
       [ 1.477785  ,  1.273407  ,  1.2442101 , ...,  0.31150854,
         0.3257286 ,  0.72389054]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 26]]), None, array([[ 1, 18, 36]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 26, 18]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There are some signs and banners by a road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sandwich and some other foods on a white plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: They look like they are standing too close together to be throwing a frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A room full of antic toys and dolls with clothing.\n', 'Find me an everyday image that matches the given caption: A brown horse grazing in a grassy field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 26/6000 [00:55<3:35:03,  2.16s/it]                                                   {'loss': 10.3309, 'grad_norm': 1632.1063232421875, 'learning_rate': 2.6e-06, 'epoch': 0.0}
  0%|          | 26/6000 [00:55<3:35:03,  2.16s/it][2025-11-13 01:31:53,091] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,  43096,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,   7206,  11873,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A little girl wearing purple shorts holds a banana.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A motorcycle with a sold ribbon on it at a bike show.\n', 'Find me an everyday image that matches the given caption: A dog sitting on a couch looking forward.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A horse crossing a street near a field and trees.\n', 'Find me an everyday image that matches the given caption: A man laying in bed with a metal head board.\n', 'Find me an everyday image that matches the given caption: An old locomotive on display at a museum.\n', 'Find me an everyday image that matches the given caption: A couple of boats traveling down a river.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The two men are grinning in a room full of electronic equipment.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A PERSON IS STANDING NEXT TO A RED TRUCK ON THE BEACH.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727B66B0>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727B6AD0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272789450>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=486x256 at 0x7F32727B42E0>], [None], [<PIL.Image.Image image mode=RGB size=408x256 at 0x7F32727B6F80>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C4700>], [<PIL.Image.Image image mode=RGB size=327x256 at 0x7F32727C46A0>]], 'pixel_values': [None, array([[-1.5440893 , -1.5294908 , -1.500294  , ...,  0.823431  ,
         0.823431  ,  0.823431  ],
       [-1.3251129 , -1.3105145 , -1.3397113 , ...,  0.80921096,
         0.7949909 ,  0.7949909 ],
       [-1.2521207 , -1.2521207 , -1.2521207 , ...,  0.85187113,
         0.8376511 ,  0.8376511 ],
       ...,
       [-1.5878845 , -1.6024829 , -1.6024829 , ..., -0.61279577,
        -0.61279577, -0.5985757 ],
       [-1.5294908 , -1.5294908 , -1.5586877 , ..., -0.4421549 ,
        -0.4421549 , -0.45637497],
       [-1.5148925 , -1.5586877 , -1.6170814 , ..., -0.86875695,
        -0.8545369 , -0.8545369 ]], dtype=float32), array([[-0.9893491 , -0.9893491 , -0.9893491 , ...,  0.6527902 ,
         0.6527902 ,  0.6527902 ],
       [-0.9893491 , -0.9893491 , -0.9747507 , ...,  0.6954504 ,
         0.6954504 ,  0.6954504 ],
       [-0.94555384, -0.94555384, -0.94555384, ...,  0.7096705 ,
         0.7096705 ,  0.7096705 ],
       ...,
       [-0.47840413, -0.39081356, -0.31782144, ..., -0.29995427,
        -0.25729406, -0.21463387],
       [-0.25942776, -0.24482933, -0.1718372 , ..., -0.48481512,
        -0.48481512, -0.4137148 ],
       [-0.49300256, -0.49300256, -0.43460885, ..., -0.5274753 ,
        -0.48481512, -0.42793486]], dtype=float32), None, None, array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.2100385 ,
        -1.0393977 , -0.9398572 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -0.9825174 ,
        -0.9825174 , -0.96829736],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -0.8260967 ,
        -0.91141707, -1.0536178 ],
       ...,
       [-0.2302309 , -0.36161673, -0.2302309 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 1.1128243 ,  1.1566195 ,  1.1566195 , ..., -1.3948994 ,
        -1.4375596 , -1.4802198 ],
       [-0.47840413, -0.303223  , -0.2740262 , ..., -1.4802198 ,
        -1.4517797 , -1.4517797 ]], dtype=float32), None, None, None, None, array([[ 0.52888733,  0.67487156,  0.6310763 , ...,  1.5486543 ,
         1.4348938 ,  1.4064537 ],
       [ 0.29531252,  0.25151724,  0.25151724, ...,  1.2073728 ,
         1.5486543 ,  1.5770944 ],
       [-0.2740262 , -0.18643562, -0.08424664, ...,  0.18352796,
         0.22618815,  0.8660912 ],
       ...,
       [ 0.16392669,  0.20772196,  0.25151724, ...,  0.38260898,
         0.21196808,  0.38260898],
       [ 0.30991095,  0.14932826,  0.14932826, ...,  0.7807708 ,
         0.6954504 ,  0.52480966],
       [ 0.2223204 ,  0.33910778,  0.3975015 , ...,  0.26884836,
         0.4537093 ,  0.6527902 ]], dtype=float32), None, array([[-1.1791286 , -1.1353334 , -1.0769397 , ...,  0.14086775,
        -0.02977302, -0.25729406],
       [-0.5659947 , -0.5367978 , -0.50760096, ..., -1.2242587 ,
        -1.2100385 , -1.1815984 ],
       [ 0.8792495 ,  0.7040684 ,  0.8208558 , ...,  1.264253  ,
         1.2358129 ,  1.2358129 ],
       ...,
       [-1.2229239 , -1.2521207 , -1.2813176 , ..., -1.2669188 ,
        -1.2953589 , -1.3237991 ],
       [ 0.10553299,  0.0617376 ,  0.03254076, ..., -1.2384787 ,
        -1.2526988 , -1.2242587 ],
       [-0.9309554 , -0.9309554 , -0.9893491 , ..., -1.3237991 ,
        -1.3522393 , -1.3522393 ]], dtype=float32), None, array([[ 0.77706057,  0.8646511 ,  1.0252337 , ...,  1.8046155 ,
         1.875716  ,  1.918376  ],
       [ 0.8208558 ,  0.8792495 ,  1.0398322 , ...,  1.9610363 ,
         1.9325962 ,  1.875716  ],
       [ 0.8208558 ,  0.791659  ,  0.7478637 , ...,  1.5059941 ,
         1.2215928 ,  1.264253  ],
       ...,
       [-0.405412  , -0.42001042, -0.43460885, ...,  0.31150854,
         0.18352796,  0.11242763],
       [-0.15723877, -0.01125452,  0.03254076, ...,  0.7096705 ,
         0.56746984,  0.5390297 ],
       [-0.20103405, -0.25942776, -0.303223  , ...,  0.29728848,
         0.28306842,  0.36838892]], dtype=float32), array([[-1.4856956 , -1.4856956 , -1.5732862 , ..., -0.08665328,
        -0.6412359 , -0.9825174 ],
       [-1.5440893 , -1.5586877 , -1.5440893 , ..., -0.8260967 ,
        -0.86875695, -1.1104981 ],
       [-1.1499318 , -0.8141679 , -0.31782144, ..., -0.8545369 ,
        -0.6981161 , -0.48481512],
       ...,
       [ 0.6456747 ,  1.0106354 ,  1.0544306 , ...,  0.4963695 ,
         0.72389054,  0.823431  ],
       [-1.1499318 , -1.0477428 , -0.88716006, ...,  1.6055346 ,
         1.5059941 ,  1.1504925 ],
       [ 0.2807141 ,  0.29531252,  0.26611567, ..., -0.01555296,
         0.46792936, -0.25729406]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 18]]), None, None, None, None, array([[ 1, 18, 34]]), None, array([[ 1, 18, 30]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A little girl wearing purple shorts holds a banana.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A motorcycle with a sold ribbon on it at a bike show.\n', 'Find me an everyday image that matches the given caption: A dog sitting on a couch looking forward.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A horse crossing a street near a field and trees.\n', 'Find me an everyday image that matches the given caption: A man laying in bed with a metal head board.\n', 'Find me an everyday image that matches the given caption: An old locomotive on display at a museum.\n', 'Find me an everyday image that matches the given caption: A couple of boats traveling down a river.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The two men are grinning in a room full of electronic equipment.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A PERSON IS STANDING NEXT TO A RED TRUCK ON THE BEACH.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  0%|          | 27/6000 [00:57<3:30:19,  2.11s/it]                                                   {'loss': 7.6685, 'grad_norm': 2398.309326171875, 'learning_rate': 2.7000000000000004e-06, 'epoch': 0.0}
  0%|          | 27/6000 [00:57<3:30:19,  2.11s/it][2025-11-13 01:31:55,082] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,   6010,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   1059,   4540,    624],
        ...,
        [151643, 151643, 151643,  ...,  89773,  16301,    624],
        [151643, 151643, 151643,  ...,   9500,   3054,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A little girl with a frisbe points into the distance.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young woman stands on the sidewalk looking at her phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man tossing a blue and white frisbee near a lake.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Bearded man wearing blue teeshirt, holding bunch of non-ripe banannas in hand as well as what appears to be carrot tops on top of the banannas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cel phone laying open on a table with reflections from the phone shinning on the table.\n', 'Find me an everyday image that matches the given caption: Person on skies going down a slope covered in snow.\n', 'Find me an everyday image that matches the given caption: There is naan with some other food on it on the plate.\n', 'Find me an everyday image that matches the given caption: Two people on skies stand on the side of a snowy mountain.\n', 'Find me an everyday image that matches the given caption: Items on a bed in a hotel room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=409x256 at 0x7F32727B7190>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727B74F0>], [<PIL.Image.Image image mode=RGB size=256x389 at 0x7F32727B6530>], [<PIL.Image.Image image mode=RGB size=256x504 at 0x7F32727B71C0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6DA0>], [None], [<PIL.Image.Image image mode=RGB size=393x256 at 0x7F32727C53C0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727C6E90>]], 'pixel_values': [None, array([[ 1.273407  ,  1.273407  ,  1.2588086 , ...,  0.06976743,
         0.0839875 ,  0.11242763],
       [ 1.3463992 ,  1.3172023 ,  1.3026038 , ...,  0.06976743,
         0.06976743,  0.06976743],
       [ 1.4193913 ,  1.4193913 ,  1.4047928 , ..., -0.02977302,
        -0.02977302, -0.01555296],
       ...,
       [-1.0477428 , -1.0623412 , -1.0623412 , ..., -0.882977  ,
        -0.8545369 , -0.882977  ],
       [-1.193727  , -1.2229239 , -1.3105145 , ..., -0.96829736,
        -0.96829736, -0.96829736],
       [-1.1207349 , -1.1353334 , -1.1353334 , ..., -0.9967375 ,
        -1.0109575 , -0.96829736]], dtype=float32), None, array([[ 0.99603695,  0.99603695,  1.0106354 , ...,  1.7477353 ,
         1.7619553 ,  1.7761754 ],
       [ 1.2004149 ,  1.2004149 ,  1.2004149 , ...,  1.9041561 ,
         1.9041561 ,  1.918376  ],
       [ 1.1566195 ,  1.1566195 ,  1.171218  , ...,  1.705075  ,
         1.7335151 ,  1.7192951 ],
       ...,
       [ 0.3537062 ,  0.30991095,  0.2807141 , ...,  0.25462827,
         0.18352796,  0.0839875 ],
       [ 0.26611567,  0.25151724,  0.25151724, ...,  0.24040821,
         0.19774802,  0.19774802],
       [-0.02585294, -0.04045137, -0.01125452, ..., -0.21463387,
        -0.22885394, -0.22885394]], dtype=float32), array([[-0.25942776, -0.31782144, -0.3470183 , ..., -0.39949474,
        -0.4137148 , -0.42793486],
       [-0.31782144, -0.33241987, -0.3470183 , ...,  2.0605767 ,
         1.8188357 ,  1.690855  ],
       [-0.09884507, -0.11344349, -0.11344349, ...,  0.33994877,
         0.26884836,  0.19774802],
       ...,
       [-1.2229239 , -0.8433648 , -0.9747507 , ..., -1.2811389 ,
        -0.74077636, -0.5274753 ],
       [-0.96015227, -1.0623412 , -1.0623412 , ..., -0.8403168 ,
        -0.68389606, -0.6270158 ],
       [-1.0915381 , -1.1207349 , -0.7557742 , ..., -0.9398572 ,
        -0.65545595, -0.6412359 ]], dtype=float32), array([[1.8427455 , 1.8427455 , 1.8427455 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [1.8427455 , 1.8427455 , 1.857344  , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [1.8427455 , 1.8427455 , 1.8427455 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       ...,
       [0.6310763 , 0.66027313, 0.68947   , ..., 0.61013   , 0.68123037,
        0.6954504 ],
       [1.098226  , 1.1274228 , 1.1566195 , ..., 0.4252692 , 0.33994877,
        0.26884836],
       [1.3172023 , 1.3609976 , 1.4193913 , ..., 0.3257286 , 0.35416883,
        0.35416883]], dtype=float32), None, array([[ 0.12013142,  0.13472985,  0.16392669, ..., -1.1104981 ,
        -1.1247182 , -1.1247182 ],
       [ 0.44129676,  0.4704936 ,  0.49969047, ..., -1.0962781 ,
        -1.1247182 , -1.1389382 ],
       [-1.2083255 , -1.193727  , -1.1645303 , ..., -1.1104981 ,
        -1.0962781 , -1.082058  ],
       ...,
       [-0.43460885, -0.42001042, -0.37621516, ..., -0.10087335,
        -0.00133289,  0.0413273 ],
       [-0.65358526, -0.7119789 , -0.68278205, ..., -0.4137148 ,
        -0.38527465, -0.38527465],
       [-0.36161673, -0.31782144, -0.25942776, ..., -0.29995427,
        -0.25729406, -0.20041381]], dtype=float32), None, array([[ 1.2588086 ,  1.2150133 ,  1.4485881 , ...,  1.022512  ,
         1.0793922 ,  1.0936122 ],
       [ 0.58728105,  0.93764323,  0.6018794 , ...,  1.5628744 ,
         1.5628744 ,  1.5913146 ],
       [ 0.30991095,  0.36830464,  0.4558952 , ...,  0.15508783,
         0.11242763,  0.22618815],
       ...,
       [-0.0550498 , -0.0550498 , -0.0550498 , ...,  0.18352796,
         0.19774802,  0.21196808],
       [-0.11344349, -0.11344349, -0.11344349, ...,  0.28306842,
         0.21196808,  0.14086775],
       [-0.1718372 , -0.18643562, -0.18643562, ...,  0.14086775,
         0.11242763,  0.16930789]], dtype=float32), None, None, None, None, None, array([[ 0.5580842 ,  0.25151724,  0.16392669, ...,  2.145897  ,
         2.145897  ,  2.074797  ],
       [-0.72657734, -0.6973805 , -0.68278205, ...,  1.7619553 ,
         1.463334  ,  0.8945313 ],
       [ 0.85005265,  1.0544306 ,  1.171218  , ...,  2.117457  ,
         2.117457  ,  2.117457  ],
       ...,
       [ 0.07633615,  0.04713918, -0.04045137, ...,  0.01288717,
        -0.15775362,  0.31150854],
       [-0.42001042, -0.87256163, -0.96015227, ..., -0.8545369 ,
        -0.29995427,  0.02710724],
       [-0.04045137,  0.10553299,  0.00334391, ..., -0.25729406,
        -0.15775362,  0.39682904]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 30]]), None, array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), array([[ 1, 36, 18]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), None, None, None, None, None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A little girl with a frisbe points into the distance.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young woman stands on the sidewalk looking at her phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man tossing a blue and white frisbee near a lake.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Bearded man wearing blue teeshirt, holding bunch of non-ripe banannas in hand as well as what appears to be carrot tops on top of the banannas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cel phone laying open on a table with reflections from the phone shinning on the table.\n', 'Find me an everyday image that matches the given caption: Person on skies going down a slope covered in snow.\n', 'Find me an everyday image that matches the given caption: There is naan with some other food on it on the plate.\n', 'Find me an everyday image that matches the given caption: Two people on skies stand on the side of a snowy mountain.\n', 'Find me an everyday image that matches the given caption: Items on a bed in a hotel room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  0%|          | 28/6000 [00:59<3:36:54,  2.18s/it]                                                   {'loss': 7.2008, 'grad_norm': 3348.115966796875, 'learning_rate': 2.8000000000000003e-06, 'epoch': 0.0}
  0%|          | 28/6000 [00:59<3:36:54,  2.18s/it][2025-11-13 01:31:57,426] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  45589,  76154,    624],
        [151643, 151643, 151643,  ...,  39698,   1899,    624],
        [151643, 151643, 151643,  ...,   6303,  12884,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    315,   1251,    624],
        [151643, 151643, 151643,  ...,   2163,    432,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: BUSY CITY STREET VERY COLORFUL WITH ALL THE VEHICLES.\n', 'Find me an everyday image that matches the given caption: Wildlife  in zoo enclosures resting and grazing on sunny day.\n', 'Find me an everyday image that matches the given caption: Two small planes flying in the clear blue sky.\n', 'Find me an everyday image that matches the given caption: A group of cows in a stall eating hay.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A computer desk with highlighted papers all over it.\n', 'Find me an everyday image that matches the given caption: A buffet side table with three pies in a three tiered pie container and two cakes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A single train car stopped at a small station.\n', 'Find me an everyday image that matches the given caption: A motorcycle is standing near a decaying building wall, window, and close-line with several clothing items hanging.\n', 'Find me an everyday image that matches the given caption: An orange and white cat is lying on a white couch.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a suite and tie in a group of people.\n', 'Find me an everyday image that matches the given caption: A red fire hydrant that has overgrowing grass and weeds around it.\n'], 'images': [[None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727B6D70>], [None], [None], [<PIL.Image.Image image mode=RGB size=340x256 at 0x7F32727C7550>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7460>], [<PIL.Image.Image image mode=RGB size=326x256 at 0x7F32727B6F20>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B7130>], [None], [None]], 'pixel_values': [None, None, None, None, array([[-0.7995695 , -0.8433648 , -0.9017585 , ..., -0.91141707,
        -0.7976566 , -0.4421549 ],
       [-0.42001042, -0.7557742 , -0.94555384, ..., -0.39949474,
        -0.71233624, -0.96829736],
       [-0.59519154, -0.9017585 , -0.9893491 , ..., -0.35683453,
        -0.22885394,  0.11242763],
       ...,
       [-0.2740262 , -0.18643562, -0.0550498 , ..., -0.12931348,
        -0.18619375, -0.243074  ],
       [-0.5805931 , -0.7703726 , -0.88716006, ..., -0.2857342 ,
        -0.2857342 , -0.47059506],
       [-0.7703726 , -0.72657734, -0.6973805 , ..., -0.71233624,
        -0.5559154 , -0.78343654]], dtype=float32), None, None, array([[ 1.2588086 ,  1.2588086 ,  1.273407  , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       [ 1.3609976 ,  1.3609976 ,  1.3609976 , ...,  1.8899357 ,
         1.9752562 ,  1.5486543 ],
       [ 1.2880055 ,  1.3026038 ,  1.3026038 , ...,  1.9325962 ,
         1.9325962 ,  1.9325962 ],
       ...,
       [-0.78497106, -0.7995695 , -0.7703726 , ..., -1.2100385 ,
        -1.2100385 , -1.2100385 ],
       [-1.1061366 , -1.1207349 , -1.1353334 , ..., -1.1247182 ,
        -1.1247182 , -1.1104981 ],
       [-1.1791286 , -1.1791286 , -1.1645303 , ..., -1.0536178 ,
        -1.0536178 , -1.0536178 ]], dtype=float32), array([[-1.2229239 , -1.1791286 , -1.1499318 , ..., -1.082058  ,
        -0.95407724, -0.9256371 ],
       [-1.3689082 , -1.3689082 , -1.2667192 , ..., -1.1531583 ,
        -1.1815984 , -1.2100385 ],
       [-0.94555384, -0.94555384, -0.94555384, ..., -1.0109575 ,
        -1.0393977 , -1.0393977 ],
       ...,
       [-0.5367978 , -0.5221994 , -0.5367978 , ..., -0.54169536,
        -0.5274753 , -0.49903518],
       [ 0.16392669,  0.16392669,  0.17852512, ..., -0.8403168 ,
        -0.8260967 , -0.81187665],
       [ 0.12013142,  0.09093457,  0.0617376 , ..., -0.7692165 ,
        -0.7692165 , -0.7549964 ]], dtype=float32), array([[-1.4273019 , -1.3543098 , -1.500294  , ..., -1.2384787 ,
        -1.3664593 , -1.3664593 ],
       [-0.9747507 , -0.96015227, -0.88716006, ..., -0.7692165 ,
        -0.7976566 , -0.5559154 ],
       [-1.1645303 ,  0.09093457,  0.6310763 , ..., -1.0536178 ,
        -1.0536178 , -1.0536178 ],
       ...,
       [ 0.7040684 ,  0.5580842 ,  0.3975015 , ..., -0.7549964 ,
        -0.7549964 , -0.71233624],
       [-0.12804192, -0.09884507, -0.09884507, ..., -0.4421549 ,
        -0.57013553, -0.57013553],
       [-0.06964822, -0.0550498 , -0.06964822, ...,  0.56746984,
         0.5816899 ,  0.6954504 ]], dtype=float32), None, None, None, array([[-0.44920728, -0.44920728, -0.4638057 , ...,  0.4252692 ,
         0.4252692 ,  0.39682904],
       [-0.49300256, -0.49300256, -0.5221994 , ...,  0.38260898,
         0.38260898,  0.38260898],
       [-0.55139625, -0.55139625, -0.55139625, ...,  0.4252692 ,
         0.4537093 ,  0.4537093 ],
       ...,
       [ 0.01794233,  0.04713918,  0.01794233, ...,  1.875716  ,
         1.875716  ,  1.875716  ],
       [ 1.5069818 ,  1.5069818 ,  1.5069818 , ...,  0.9798517 ,
         0.9798517 ,  0.96563166],
       [ 1.5069818 ,  1.5069818 ,  1.5069818 , ...,  0.9514116 ,
         0.9514116 ,  0.9514116 ]], dtype=float32), None, None], 'image_grid_thw': [None, None, None, None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: BUSY CITY STREET VERY COLORFUL WITH ALL THE VEHICLES.\n', 'Find me an everyday image that matches the given caption: Wildlife  in zoo enclosures resting and grazing on sunny day.\n', 'Find me an everyday image that matches the given caption: Two small planes flying in the clear blue sky.\n', 'Find me an everyday image that matches the given caption: A group of cows in a stall eating hay.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A computer desk with highlighted papers all over it.\n', 'Find me an everyday image that matches the given caption: A buffet side table with three pies in a three tiered pie container and two cakes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A single train car stopped at a small station.\n', 'Find me an everyday image that matches the given caption: A motorcycle is standing near a decaying building wall, window, and close-line with several clothing items hanging.\n', 'Find me an everyday image that matches the given caption: An orange and white cat is lying on a white couch.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a suite and tie in a group of people.\n', 'Find me an everyday image that matches the given caption: A red fire hydrant that has overgrowing grass and weeds around it.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  0%|          | 29/6000 [01:01<3:33:58,  2.15s/it]                                                   {'loss': 7.6589, 'grad_norm': 3597.352783203125, 'learning_rate': 2.9e-06, 'epoch': 0.0}
  0%|          | 29/6000 [01:01<3:33:58,  2.15s/it][2025-11-13 01:31:59,500] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  20638,  18495,    624],
        [151643, 151643, 151643,  ...,    279,   9396,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,  11794,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people sitting at desk using laptop computers.\n', 'Find me an everyday image that matches the given caption: A red lighthouse on the shore of the sea.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An extra long bus is driving through the city.\n', 'Find me an everyday image that matches the given caption: A woman standing on the street checking her phone.\n', 'Find me an everyday image that matches the given caption: A kitchen with tile back splash and granite counters.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young child standing next to a large box.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A groups of skiers and snowboarders standing in the snow.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727B71F0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C45E0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C6EF0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C5360>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C70A0>], [<PIL.Image.Image image mode=RGB size=387x256 at 0x7F32727C6FB0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6F20>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C4A00>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C4700>], [None]], 'pixel_values': [array([[-1.0623412 , -0.9309554 , -0.7557742 , ...,  0.28306842,
         0.21196808,  0.19774802],
       [-0.6389868 , -0.44920728, -0.28862458, ...,  0.15508783,
         0.11242763,  0.05554737],
       [-0.68278205, -0.6973805 , -0.7411758 , ...,  0.39682904,
         0.36838892,  0.36838892],
       ...,
       [ 0.42669836,  0.41209993,  0.3975015 , ..., -0.3710546 ,
        -0.45637497, -0.47059506],
       [-0.31782144, -0.3470183 , -0.3470183 , ...,  0.15508783,
         0.18352796,  0.14086775],
       [-0.14264035, -0.14264035, -0.11344349, ..., -0.14353354,
        -0.22885394, -0.27151415]], dtype=float32), None, None, array([[-1.6754751, -1.6754751, -1.6754751, ..., -1.4375596, -1.4375596,
        -1.4375596],
       [-1.6754751, -1.6754751, -1.6754751, ..., -1.4375596, -1.4375596,
        -1.4375596],
       [-1.6754751, -1.6754751, -1.6754751, ..., -1.4233395, -1.4233395,
        -1.4233395],
       ...,
       [-1.7338688, -1.7338688, -1.7338688, ..., -1.4233395, -1.4233395,
        -1.4233395],
       [-1.7192703, -1.7192703, -1.7192703, ..., -1.4233395, -1.4233395,
        -1.4233395],
       [-1.6900735, -1.6900735, -1.6900735, ..., -1.4233395, -1.4233395,
        -1.4233395]], dtype=float32), array([[-0.60978997, -0.5659947 , -0.50760096, ..., -0.15775362,
        -0.14353354, -0.12931348],
       [-0.01125452,  0.01794233,  0.01794233, ..., -0.02977302,
        -0.05821316, -0.10087335],
       [-0.55139625, -0.5659947 , -0.5805931 , ..., -0.20041381,
        -0.18619375, -0.17197368],
       ...,
       [-1.3397113 , -1.3397113 , -1.3397113 , ..., -1.4091195 ,
        -1.3948994 , -1.3948994 ],
       [-1.6462783 , -1.6462783 , -1.6170814 , ..., -1.2384787 ,
        -1.1815984 , -1.1815984 ],
       [-1.4419003 , -1.4419003 , -1.4710971 , ..., -1.2384787 ,
        -1.2384787 , -1.2384787 ]], dtype=float32), array([[ 0.8354542 ,  0.85005265,  0.8646511 , ..., -0.3710546 ,
        -0.57013553, -0.5559154 ],
       [ 0.8208558 ,  0.77706057,  0.7040684 , ..., -0.8260967 ,
        -0.7549964 , -0.7265563 ],
       [ 0.93764323,  0.93764323,  0.99603695, ...,  0.19774802,
         0.29728848,  0.56746984],
       ...,
       [ 1.3463992 ,  1.3318007 ,  1.3318007 , ...,  1.4206737 ,
         1.4064537 ,  1.4064537 ],
       [ 1.3609976 ,  1.3609976 ,  1.3609976 , ...,  1.4064537 ,
         1.4206737 ,  1.4206737 ],
       [ 1.3755959 ,  1.3609976 ,  1.3609976 , ...,  1.3211333 ,
         1.3069133 ,  1.3069133 ]], dtype=float32), None, None, None, array([[-0.78497106, -0.7995695 , -0.7995695 , ..., -0.8260967 ,
        -0.8545369 , -0.86875695],
       [-0.7703726 , -0.78497106, -0.7557742 , ..., -0.882977  ,
        -0.86875695, -0.86875695],
       [-0.6243884 , -0.60978997, -0.6389868 , ..., -0.65545595,
        -0.65545595, -0.669676  ],
       ...,
       [-0.36161673, -0.3470183 , -0.39081356, ...,  0.48214942,
         0.7096705 ,  1.0936122 ],
       [ 1.4339896 ,  1.1566195 ,  0.5580842 , ...,  0.38260898,
         0.38260898,  0.39682904],
       [-0.5221994 , -0.5367978 , -0.5367978 , ...,  0.5532498 ,
         0.5532498 ,  0.5390297 ]], dtype=float32), array([[ 0.58728105,  0.5726826 ,  0.52888733, ..., -0.17197368,
        -0.04399309, -0.07243322],
       [ 0.791659  ,  0.4704936 ,  0.791659  , ..., -0.49903518,
        -0.47059506, -0.48481512],
       [-0.4638057 , -0.6973805 , -0.6389868 , ...,  0.1266477 ,
         0.19774802,  0.19774802],
       ...,
       [-0.39081356, -0.24482933, -0.15723877, ..., -1.1815984 ,
        -1.1389382 , -1.1104981 ],
       [ 0.13472985,  0.04713918, -0.02585294, ...,  0.43948925,
        -0.00133289, -0.12931348],
       [-1.0477428 , -0.9747507 , -0.82876635, ..., -0.32839438,
        -0.3710546 , -0.3710546 ]], dtype=float32), array([[-0.02585294, -0.02585294,  0.00334391, ..., -1.3237991 ,
        -1.309579  , -1.2953589 ],
       [ 0.3537062 ,  0.36830464,  0.38290307, ..., -1.2242587 ,
        -1.2526988 , -1.2526988 ],
       [ 0.44129676,  0.44129676,  0.41209993, ..., -1.2669188 ,
        -1.2384787 , -1.1958185 ],
       ...,
       [ 0.9668401 ,  0.99603695,  0.9814385 , ..., -1.1104981 ,
        -1.1389382 , -1.1389382 ],
       [ 0.61647785,  0.6456747 ,  0.68947   , ..., -1.082058  ,
        -1.0251776 , -1.0251776 ],
       [ 0.7478637 ,  0.77706057,  0.7478637 , ..., -1.1247182 ,
        -1.1531583 , -1.1958185 ]], dtype=float32), None, array([[-0.87256163, -0.82876635, -0.7995695 , ..., -0.01555296,
        -0.02977302, -0.02977302],
       [-0.6973805 , -0.68278205, -0.78497106, ...,  0.33994877,
         0.14086775,  0.15508783],
       [-0.7119789 , -0.5805931 , -0.6973805 , ..., -0.12931348,
        -0.17197368, -0.12931348],
       ...,
       [-0.78497106, -0.78497106, -0.7995695 , ...,  0.14086775,
        -0.22885394, -0.49903518],
       [-0.6681836 , -0.68278205, -0.7557742 , ...,  0.14086775,
         0.11242763,  0.19774802],
       [-0.42001042, -0.06964822,  0.03254076, ...,  0.06976743,
        -0.21463387, -0.10087335]], dtype=float32), array([[-1.2813176 , -1.3105145 , -1.3835065 , ..., -1.2953589 ,
        -1.2526988 , -1.2242587 ],
       [-0.47840413, -0.5367978 , -0.6389868 , ..., -1.2384787 ,
        -1.2384787 , -1.2384787 ],
       [-1.3397113 , -1.4564987 , -1.4564987 , ...,  1.3922336 ,
         1.3211333 ,  1.264253  ],
       ...,
       [-1.3105145 , -1.3105145 , -1.3251129 , ...,  0.06976743,
         0.06976743,  0.05554737],
       [-0.7119789 , -0.7557742 , -0.78497106, ...,  0.22618815,
         0.16930789,  0.11242763],
       [-0.8433648 , -0.87256163, -0.8579632 , ...,  0.25462827,
         0.26884836,  0.28306842]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 28]]), None, None, array([[ 1, 28, 18]]), array([[ 1, 28, 18]]), array([[ 1, 24, 18]]), None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people sitting at desk using laptop computers.\n', 'Find me an everyday image that matches the given caption: A red lighthouse on the shore of the sea.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An extra long bus is driving through the city.\n', 'Find me an everyday image that matches the given caption: A woman standing on the street checking her phone.\n', 'Find me an everyday image that matches the given caption: A kitchen with tile back splash and granite counters.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young child standing next to a large box.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A groups of skiers and snowboarders standing in the snow.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  0%|          | 30/6000 [01:03<3:30:04,  2.11s/it]                                                   {'loss': 6.2037, 'grad_norm': 2272.344482421875, 'learning_rate': 3e-06, 'epoch': 0.01}
  0%|          | 30/6000 [01:03<3:30:04,  2.11s/it][2025-11-13 01:32:01,522] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    419,  10300,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  16301,    624],
        [151643, 151643, 151643,  ...,    279,  22854,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two different transit trains can be seen in this photograph.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Four people standing around a computer on a table next to drink machines.\n', 'Find me an everyday image that matches the given caption: A barber gives a haircut to a client while a photographer takes pictures.\n', 'Find me an everyday image that matches the given caption: Two home made pizzas set on wooden serving platters.\n', 'Find me an everyday image that matches the given caption: A man swings his bat as he runs while a hand reaches to catch the ball behind him.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman sitting on a horse in a saddle.\n', 'Find me an everyday image that matches the given caption: A train parked next to a fence on a road up a mountain.\n', 'Find me an everyday image that matches the given caption: The bear is trying to get a hold of the trash.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x325 at 0x7F327277EF80>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C6CE0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7340>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C74F0>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6EC0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7040>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C7B20>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C6E00>]], 'pixel_values': [array([[-1.0331444 , -1.0039475 , -0.9747507 , ..., -1.3664593 ,
        -1.3522393 , -1.309579  ],
       [-0.7557742 , -0.7411758 , -0.72657734, ..., -1.1958185 ,
        -1.1531583 , -1.1389382 ],
       [-1.0915381 , -1.0769397 , -1.0477428 , ..., -1.309579  ,
        -1.2669188 , -1.2811389 ],
       ...,
       [-1.1061366 , -1.1061366 , -1.1207349 , ..., -1.3380191 ,
        -1.3522393 , -1.3664593 ],
       [-1.1061366 , -1.0769397 , -1.1207349 , ..., -1.3664593 ,
        -1.3948994 , -1.3806794 ],
       [-1.2521207 , -1.2667192 , -1.193727  , ..., -1.2100385 ,
        -1.1815984 , -1.1389382 ]], dtype=float32), None, array([[-0.87256163, -0.87256163, -0.87256163, ...,  1.5486543 ,
         1.5486543 ,  1.5486543 ],
       [-0.8433648 , -0.8433648 , -0.8579632 , ...,  1.5913146 ,
         1.5913146 ,  1.5770944 ],
       [-0.78497106, -0.78497106, -0.78497106, ...,  1.6055346 ,
         1.6055346 ,  1.6055346 ],
       ...,
       [-0.06964822, -0.33241987, -0.36161673, ..., -0.25729406,
        -0.29995427, -0.32839438],
       [-0.6681836 , -0.6681836 , -0.6681836 , ..., -0.68389606,
        -0.669676  , -0.65545595],
       [-0.7557742 , -0.7411758 , -0.6681836 , ..., -0.8545369 ,
        -0.81187665, -0.669676  ]], dtype=float32), array([[-0.68278205, -0.68278205, -0.6973805 , ...,  0.63857013,
         0.63857013,  0.6243501 ],
       [-0.7411758 , -0.7411758 , -0.7119789 , ...,  0.61013   ,
         0.61013   ,  0.59590995],
       [-0.7119789 , -0.7119789 , -0.7119789 , ...,  0.63857013,
         0.61013   ,  0.6243501 ],
       ...,
       [-0.82876635, -1.2083255 , -1.3543098 , ..., -0.42793486,
        -0.95407724, -0.81187665],
       [-1.6316798 , -1.6608766 , -1.7484672 , ...,  1.7761754 ,
         1.7761754 ,  1.7903955 ],
       [-1.6024829 , -1.1061366 , -1.2959161 , ...,  1.2073728 ,
         1.0793922 ,  1.1078323 ]], dtype=float32), array([[-0.9163569 , -0.9163569 , -0.9017585 , ..., -0.5559154 ,
        -0.5559154 , -0.54169536],
       [-0.7703726 , -0.7703726 , -0.7703726 , ..., -0.47059506,
        -0.45637497, -0.4421549 ],
       [-0.88716006, -0.88716006, -0.87256163, ..., -0.5559154 ,
        -0.5559154 , -0.54169536],
       ...,
       [-1.4273019 , -1.4419003 , -1.4419003 , ..., -1.2526988 ,
        -1.2526988 , -1.2669188 ],
       [-1.0623412 , -1.0623412 , -1.0769397 , ..., -1.0962781 ,
        -1.067838  , -1.0536178 ],
       [-1.1645303 , -1.1791286 , -1.193727  , ..., -1.1104981 ,
        -1.1247182 , -1.1247182 ]], dtype=float32), None, None, None, None, array([[ 1.8135487 ,  1.8135487 ,  1.8135487 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.8427455 ,  1.8427455 ,  1.857344  , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.8719424 ,  1.8719424 ,  1.8719424 , ...,  2.117457  ,
         2.117457  ,  2.117457  ],
       ...,
       [-0.82876635, -0.8579632 , -0.87256163, ...,  0.72389054,
         0.93719155,  1.9610363 ],
       [-0.68278205, -0.47840413,  0.2223204 , ...,  1.9468161 ,
         1.9610363 ,  2.103237  ],
       [-0.39081356,  0.03254076,  0.6456747 , ...,  0.18352796,
         0.28306842,  0.72389054]], dtype=float32), array([[-0.72657734, -0.72657734, -0.7119789 , ..., -0.34261447,
        -0.32839438, -0.32839438],
       [-0.5659947 , -0.5659947 , -0.55139625, ..., -0.18619375,
        -0.17197368, -0.15775362],
       [-0.6389868 , -0.6389868 , -0.6243884 , ..., -0.27151415,
        -0.25729406, -0.243074  ],
       ...,
       [-1.0039475 , -0.9893491 , -0.9893491 , ..., -0.89719707,
        -0.91141707, -0.9256371 ],
       [-0.78497106, -0.78497106, -0.7995695 , ..., -0.74077636,
        -0.7549964 , -0.7692165 ],
       [-0.88716006, -0.88716006, -0.88716006, ..., -0.89719707,
        -0.91141707, -0.91141707]], dtype=float32), array([[-1.4127034 , -1.4273019 , -1.4273019 , ..., -1.3664593 ,
        -1.3237991 , -1.2669188 ],
       [-1.3835065 , -1.3543098 , -1.3397113 , ..., -1.0536178 ,
        -1.1673783 , -1.1104981 ],
       [-1.3105145 , -1.3251129 , -1.3543098 , ..., -1.2953589 ,
        -1.2811389 , -1.2526988 ],
       ...,
       [-0.59519154, -0.6243884 , -0.59519154, ...,  0.19774802,
        -0.01555296, -0.38527465],
       [-0.55139625, -0.59519154, -0.88716006, ..., -0.71233624,
        -0.71233624, -0.7692165 ],
       [-0.88716006, -0.5367978 , -0.15723877, ..., -1.0251776 ,
        -1.067838  , -1.082058  ]], dtype=float32), None, None, None, array([[ 1.3901944 ,  1.5507771 ,  1.6091708 , ...,  1.7903955 ,
         1.7903955 ,  1.8188357 ],
       [ 1.3172023 ,  1.0690291 ,  0.68947   , ...,  1.8188357 ,
         1.8188357 ,  1.8046155 ],
       [ 0.38290307,  0.42669836,  0.49969047, ...,  1.9325962 ,
         1.8899357 ,  1.875716  ],
       ...,
       [-0.72657734, -0.72657734, -0.6973805 , ...,  0.36838892,
        -0.05821316, -0.4421549 ],
       [ 0.0617376 , -0.0550498 ,  0.04713918, ...,  0.16930789,
         0.15508783,  0.14086775],
       [-0.09884507, -0.28862458, -0.31782144, ...,  0.18352796,
         0.0413273 , -0.21463387]], dtype=float32)], 'image_grid_thw': [array([[ 1, 24, 18]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, None, None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two different transit trains can be seen in this photograph.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Four people standing around a computer on a table next to drink machines.\n', 'Find me an everyday image that matches the given caption: A barber gives a haircut to a client while a photographer takes pictures.\n', 'Find me an everyday image that matches the given caption: Two home made pizzas set on wooden serving platters.\n', 'Find me an everyday image that matches the given caption: A man swings his bat as he runs while a hand reaches to catch the ball behind him.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman sitting on a horse in a saddle.\n', 'Find me an everyday image that matches the given caption: A train parked next to a fence on a road up a mountain.\n', 'Find me an everyday image that matches the given caption: The bear is trying to get a hold of the trash.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 31/6000 [01:05<3:26:33,  2.08s/it]                                                   {'loss': 4.8338, 'grad_norm': 1439.0753173828125, 'learning_rate': 3.1000000000000004e-06, 'epoch': 0.01}
  1%|          | 31/6000 [01:05<3:26:33,  2.08s/it][2025-11-13 01:32:03,521] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    448,  12590,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plane flies  within some dark storm clouds.\n', 'Find me an everyday image that matches the given caption: A female tennis player hits a unseen ball on coart.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A street post with blue street signs but in another language.\n', 'Find me an everyday image that matches the given caption: People playing a game on a television screen during an event.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people posing outside with dogs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=455x256 at 0x7F32727C7820>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7AF0>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727C7280>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6DA0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x385 at 0x7F32727C53C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7850>], [<PIL.Image.Image image mode=RGB size=256x340 at 0x7F32727C71F0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C6E90>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DA800>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DA710>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DA7D0>]], 'pixel_values': [array([[-1.6024829 , -1.6024829 , -1.6024829 , ..., -0.58435565,
        -0.58435565, -0.61279577],
       [-1.6462783 , -1.6316798 , -1.5586877 , ..., -0.47059506,
        -0.4137148 , -0.35683453],
       [-1.0331444 , -1.0039475 , -0.9747507 , ...,  0.9229715 ,
         1.4491138 ,  1.7477353 ],
       ...,
       [-0.50760096, -0.49300256, -0.49300256, ...,  0.22618815,
         0.28306842,  0.21196808],
       [-0.44920728, -0.47840413, -0.49300256, ...,  0.05554737,
         0.05554737,  0.06976743],
       [-0.49300256, -0.49300256, -0.49300256, ..., -0.04399309,
        -0.04399309, -0.04399309]], dtype=float32), array([[-1.0039475 , -1.0039475 , -0.96015227, ...,  2.1316772 ,
         2.145897  ,  2.145897  ],
       [-0.0550498 , -0.01125452,  0.03254076, ...,  0.5816899 ,
         0.36838892,  0.19774802],
       [-0.7557742 , -0.72657734, -0.7411758 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       ...,
       [-1.2375224 , -1.2959161 , -1.3689082 , ...,  0.4537093 ,
         0.3257286 ,  0.16930789],
       [-0.8141679 , -1.018546  , -1.0915381 , ..., -0.38527465,
        -0.7549964 , -0.8545369 ],
       [-1.5440893 , -1.6462783 , -1.5148925 , ..., -1.0536178 ,
        -1.1247182 , -1.0536178 ]], dtype=float32), array([[-0.25942776, -0.25942776, -0.2740262 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [-0.31782144, -0.36161673, -0.37621516, ...,  2.0179167 ,
         2.0036962 ,  1.9610363 ],
       [ 1.9303361 ,  1.9157377 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       ...,
       [-1.5732862 , -1.5732862 , -0.15723877, ...,  0.63857013,
         0.93719155,  0.6527902 ],
       [-1.2959161 , -1.2959161 , -1.2959161 , ..., -1.2953589 ,
        -1.3522393 , -1.3664593 ],
       [-1.3543098 , -1.3543098 , -1.3543098 , ..., -1.3664593 ,
        -1.3806794 , -1.3806794 ]], dtype=float32), array([[-1.4127034 , -1.193727  , -1.1499318 , ..., -0.9256371 ,
        -0.7692165 , -0.34261447],
       [-0.4638057 , -0.49300256, -0.47840413, ...,  0.19774802,
         0.19774802,  0.21196808],
       [-1.5878845 , -1.5732862 , -1.5586877 , ..., -0.01555296,
        -0.04399309, -0.02977302],
       ...,
       [-0.49300256, -0.50760096, -0.47840413, ..., -0.35683453,
        -0.4137148 , -0.47059506],
       [-1.0331444 , -1.1207349 , -1.1207349 , ..., -0.54169536,
        -0.58435565, -0.47059506],
       [-0.59519154, -0.5805931 , -0.68278205, ..., -0.6412359 ,
        -0.58435565, -0.57013553]], dtype=float32), None, None, array([[-0.8433648 , -0.8433648 , -0.8433648 , ..., -0.45637497,
        -0.4421549 , -0.4421549 ],
       [-0.78497106, -0.88716006, -1.0769397 , ..., -0.8545369 ,
        -0.31417432,  0.16930789],
       [-0.36161673, -0.37621516, -0.37621516, ..., -0.34261447,
        -0.35683453, -0.35683453],
       ...,
       [ 0.42669836,  0.44129676,  0.4558952 , ...,  0.35416883,
         0.35416883,  0.35416883],
       [ 0.30991095,  0.29531252,  0.30991095, ...,  0.15508783,
         0.14086775,  0.09820756],
       [ 0.32450938,  0.32450938,  0.30991095, ...,  0.02710724,
        -0.00133289, -0.00133289]], dtype=float32), array([[ 1.8427455 ,  1.8427455 ,  1.8427455 , ...,  2.074797  ,
         2.074797  ,  2.074797  ],
       [ 1.8135487 ,  1.8135487 ,  1.8427455 , ...,  2.074797  ,
         2.074797  ,  2.074797  ],
       [ 1.8427455 ,  1.8427455 ,  1.8427455 , ...,  2.074797  ,
         2.074797  ,  2.074797  ],
       ...,
       [-0.9893491 , -0.9747507 , -1.0039475 , ..., -0.78343654,
        -0.7549964 , -0.74077636],
       [-1.6170814 , -1.6024829 , -1.5878845 , ..., -1.2953589 ,
        -1.3237991 , -1.309579  ],
       [-1.5294908 , -1.4856956 , -1.4856956 , ..., -0.9967375 ,
        -0.9967375 , -1.0109575 ]], dtype=float32), array([[ 1.7989503 ,  1.8427455 ,  1.8281472 , ...,  0.16930789,
         0.31150854,  0.51058954],
       [ 1.857344  ,  1.857344  ,  1.8427455 , ..., -0.38527465,
        -0.25729406, -0.07243322],
       [ 1.4923834 ,  1.4485881 ,  1.4631865 , ...,  1.9041561 ,
         1.9041561 ,  1.918376  ],
       ...,
       [ 1.7697535 ,  1.7259582 ,  1.7259582 , ..., -0.91141707,
        -0.9398572 , -0.95407724],
       [ 1.4193913 ,  1.171218  ,  0.66027313, ..., -0.6270158 ,
        -0.65545595, -0.65545595],
       [-0.18643562, -0.24482933, -0.24482933, ..., -0.882977  ,
        -0.95407724, -1.0109575 ]], dtype=float32), array([[-0.78497106, -0.8141679 , -0.8433648 , ..., -0.8545369 ,
        -0.7549964 , -0.61279577],
       [-0.303223  ,  0.07633615, -0.20103405, ..., -0.9256371 ,
        -1.0393977 , -0.81187665],
       [-0.55139625, -0.4638057 , -0.65358526, ..., -0.39949474,
        -0.58435565, -0.45637497],
       ...,
       [-0.65358526, -0.60978997, -0.6243884 , ..., -0.51325524,
        -0.51325524, -0.4137148 ],
       [ 1.2004149 ,  1.098226  ,  1.098226  , ...,  1.4206737 ,
         1.4491138 ,  1.4917741 ],
       [-0.8579632 , -0.65358526, -0.33241987, ...,  1.3495734 ,
         1.3637935 ,  1.3495734 ]], dtype=float32), None, None, array([[ 0.54348576,  0.54348576,  0.54348576, ...,  1.9325962 ,
         1.9468161 ,  1.9468161 ],
       [ 0.54348576,  0.54348576,  0.5580842 , ...,  1.9752562 ,
         1.9752562 ,  1.9752562 ],
       [ 0.5726826 ,  0.5726826 ,  0.5726826 , ...,  1.9752562 ,
         1.9752562 ,  1.9752562 ],
       ...,
       [-1.0623412 , -1.1353334 , -1.193727  , ..., -1.2100385 ,
        -1.2384787 , -1.309579  ],
       [-1.4273019 , -1.4856956 , -1.5586877 , ..., -1.082058  ,
        -1.0393977 , -1.0393977 ],
       [-1.6024829 , -1.5732862 , -1.5586877 , ..., -1.1531583 ,
        -1.1531583 , -1.1389382 ]], dtype=float32), None, array([[ 0.48509204,  0.4558952 ,  0.42669836, ..., -0.22885394,
        -0.11509342, -0.10087335],
       [ 0.42669836,  0.42669836,  0.44129676, ..., -0.22885394,
        -0.12931348, -0.15775362],
       [ 0.25151724,  0.26611567,  0.26611567, ..., -0.31417432,
        -0.2857342 , -0.2857342 ],
       ...,
       [ 0.16392669,  0.16392669,  0.26611567, ..., -0.01555296,
         0.05554737,  0.28306842],
       [ 0.23691882,  0.2223204 ,  0.49969047, ..., -0.02977302,
        -0.15775362,  0.21196808],
       [ 0.26611567,  0.42669836,  0.25151724, ...,  0.43948925,
         0.11242763,  0.36838892]], dtype=float32), array([[ 6.0187942e-01,  6.0187942e-01,  6.3107628e-01, ...,
        -1.5775362e-01, -1.5775362e-01, -1.4353354e-01],
       [ 9.8143852e-01,  9.9603695e-01,  1.0252337e+00, ...,
        -2.9773025e-02, -4.3993089e-02, -4.3993089e-02],
       [ 8.2085580e-01,  8.5005265e-01,  8.9384794e-01, ...,
        -1.5552960e-02, -2.9773025e-02, -1.3328948e-03],
       ...,
       [-1.7630657e+00, -1.7484672e+00, -1.7046720e+00, ...,
        -1.2669188e+00, -1.1673783e+00, -1.0962781e+00],
       [-5.9519154e-01, -6.6818362e-01, -8.8716006e-01, ...,
        -1.4517797e+00, -1.3806794e+00, -1.4091195e+00],
       [-1.7338688e+00, -1.6900735e+00, -1.6754751e+00, ...,
        -1.2953589e+00, -1.2811389e+00, -1.2811389e+00]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 32]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plane flies  within some dark storm clouds.\n', 'Find me an everyday image that matches the given caption: A female tennis player hits a unseen ball on coart.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A street post with blue street signs but in another language.\n', 'Find me an everyday image that matches the given caption: People playing a game on a television screen during an event.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people posing outside with dogs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 32/6000 [01:08<3:26:47,  2.08s/it]                                                   {'loss': 7.1648, 'grad_norm': 2298.510498046875, 'learning_rate': 3.2000000000000003e-06, 'epoch': 0.01}
  1%|          | 32/6000 [01:08<3:26:47,  2.08s/it][2025-11-13 01:32:05,607] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    389,    432,    624],
        [151643, 151643, 151643,  ...,  31415,   5473,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bronze statue holding an umbrella in a square.\n', 'Find me an everyday image that matches the given caption: Two people in kayaks on a Swift River.\n', 'Find me an everyday image that matches the given caption: A child sits on a pony, being led by a person.\n', 'Find me an everyday image that matches the given caption: A group of people are attending a celebration.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people are wrapping silverware from baskets.\n', 'Find me an everyday image that matches the given caption: An old photo of a man with a big beard.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A lone person sits on a snow covered bench with two snowboards leaning on it.\n', 'Find me an everyday image that matches the given caption: A male in a bright shirt and shorts with a white hat on a tennis court.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272FADAB0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAE140>], [<PIL.Image.Image image mode=RGB size=456x256 at 0x7F3272FAE230>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAC0D0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF340>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAD150>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF760>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF820>], [None], [None]], 'pixel_values': [array([[ 0.8792495 ,  0.9084464 ,  0.9230448 , ...,  0.4252692 ,
         0.36838892,  0.3257286 ],
       [ 0.8062574 ,  0.8062574 ,  0.77706057, ...,  0.22618815,
         0.22618815,  0.24040821],
       [-1.6608766 , -1.6170814 , -1.500294  , ..., -0.89719707,
        -0.91141707, -0.95407724],
       ...,
       [ 1.2588086 ,  1.2588086 ,  1.2442101 , ...,  1.9468161 ,
         1.9325962 ,  1.918376  ],
       [ 0.9084464 ,  0.8354542 ,  1.0398322 , ...,  1.918376  ,
         1.918376  ,  1.9325962 ],
       [ 1.2150133 ,  1.2150133 ,  1.2296118 , ...,  1.9041561 ,
         1.8899357 ,  1.8614956 ]], dtype=float32), array([[-1.6170814e+00, -1.0331444e+00, -1.1061366e+00, ...,
         2.1316772e+00,  2.1316772e+00,  2.1316772e+00],
       [-1.0623412e+00, -1.0769397e+00, -1.0623412e+00, ...,
         2.1032369e+00,  2.1032369e+00,  2.1032369e+00],
       [-1.1499318e+00,  1.3901944e+00,  1.8427455e+00, ...,
        -2.9995427e-01, -2.9995427e-01, -3.1417432e-01],
       ...,
       [-2.4482933e-01, -2.4482933e-01, -2.4482933e-01, ...,
        -1.3328948e-03,  1.2500329e+00, -7.6921648e-01],
       [-2.4482933e-01, -2.5942776e-01, -2.5942776e-01, ...,
        -7.5499642e-01, -7.2655630e-01, -7.1233624e-01],
       [-2.5942776e-01, -2.5942776e-01, -2.4482933e-01, ...,
        -7.5499642e-01, -6.5545595e-01, -1.3380191e+00]], dtype=float32), array([[ 0.6018794 ,  0.6018794 ,  0.6018794 , ...,  0.9229715 ,
         0.93719155,  0.9514116 ],
       [ 0.66027313,  0.66027313,  0.66027313, ...,  0.9798517 ,
         0.9798517 ,  1.0082918 ],
       [ 0.61647785,  0.6310763 ,  0.6456747 , ...,  0.9514116 ,
         0.9514116 ,  0.96563166],
       ...,
       [-1.3543098 , -1.4127034 , -1.4856956 , ..., -0.74077636,
        -0.74077636, -0.6981161 ],
       [-0.42001042, -0.49300256, -0.4638057 , ..., -0.9967375 ,
        -1.0251776 , -1.082058  ],
       [-0.33241987, -0.20103405, -0.303223  , ..., -1.3806794 ,
        -1.2953589 , -1.309579  ]], dtype=float32), array([[ 0.5580842 ,  0.5580842 ,  0.5726826 , ...,  1.6339747 ,
         1.6481948 ,  1.6624149 ],
       [ 0.71866685,  0.71866685,  0.7478637 , ...,  1.7619553 ,
         1.7335151 ,  1.7192951 ],
       [ 0.7332653 ,  0.7478637 ,  0.76246214, ...,  1.8899357 ,
         1.9468161 ,  1.9325962 ],
       ...,
       [ 0.8354542 ,  0.8208558 ,  0.76246214, ..., -0.81187665,
        -0.8403168 , -0.8545369 ],
       [ 0.13472985,  0.09093457,  0.03254076, ..., -0.65545595,
        -0.669676  , -0.669676  ],
       [-0.06964822, -0.11344349, -0.14264035, ..., -0.7265563 ,
        -0.7265563 , -0.74077636]], dtype=float32), array([[ 1.7843518 ,  1.7843518 ,  1.7843518 , ...,  1.9894764 ,
         1.9468161 ,  2.117457  ],
       [ 1.7405566 ,  1.7697535 ,  1.7989503 , ..., -1.4802198 ,
        -1.4802198 , -1.4233395 ],
       [ 1.7843518 ,  1.7843518 ,  1.7843518 , ...,  1.9894764 ,
         1.9325962 ,  1.3353534 ],
       ...,
       [-1.7776641 , -0.9747507 , -0.09884507, ...,  2.0036962 ,
         2.0036962 ,  2.0036962 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ...,  1.8899357 ,
         1.8899357 ,  2.0036962 ],
       [ 0.2223204 ,  1.0398322 ,  1.5507771 , ...,  2.0036962 ,
         2.0036962 ,  2.0036962 ]], dtype=float32), None, None, None, None, array([[ 1.4923834 ,  1.4923834 ,  1.4923834 , ...,  2.0463567 ,
         2.0463567 ,  2.0463567 ],
       [ 1.5069818 ,  1.5069818 ,  1.5069818 , ...,  2.0463567 ,
         2.0463567 ,  2.0463567 ],
       [ 1.5361787 ,  1.5361787 ,  1.5361787 , ...,  2.074797  ,
         2.074797  ,  2.074797  ],
       ...,
       [ 0.2223204 ,  0.03254076,  0.16392669, ...,  0.39682904,
         0.4110491 ,  0.4537093 ],
       [ 0.19312355, -0.11344349, -0.14264035, ...,  0.46792936,
         0.3257286 ,  0.26884836],
       [ 0.19312355,  0.09093457,  0.01794233, ...,  0.4252692 ,
         0.4963695 ,  0.43948925]], dtype=float32), None, None, array([[1.4485881, 1.4485881, 1.4485881, ..., 1.5628744, 1.5628744,
        1.5628744],
       [1.4339896, 1.4339896, 1.4339896, ..., 1.5202142, 1.5059941,
        1.5059941],
       [1.2588086, 1.2588086, 1.2588086, ..., 1.1931527, 1.2215928,
        1.2215928],
       ...,
       [1.7259582, 1.7259582, 1.7259582, ..., 2.0463567, 2.0463567,
        2.0463567],
       [1.7697535, 1.7405566, 1.7259582, ..., 2.0463567, 2.0605767,
        2.0605767],
       [1.7989503, 1.7989503, 1.7843518, ..., 2.0605767, 2.074797 ,
        2.074797 ]], dtype=float32), array([[-0.2302309 , -0.2302309 , -0.21563247, ...,  0.52480966,
         0.5390297 ,  0.5390297 ],
       [-0.1718372 , -0.1718372 , -0.18643562, ...,  0.6527902 ,
         0.6527902 ,  0.6527902 ],
       [-0.1718372 , -0.1718372 , -0.1718372 , ...,  0.51058954,
         0.51058954,  0.52480966],
       ...,
       [-0.78497106, -0.7703726 , -0.78497106, ..., -0.42793486,
        -0.4421549 , -0.4421549 ],
       [-0.8433648 , -0.8433648 , -0.8433648 , ..., -0.4137148 ,
        -0.42793486, -0.42793486],
       [-0.88716006, -0.9017585 , -0.9017585 , ..., -0.47059506,
        -0.47059506, -0.47059506]], dtype=float32), None, None], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 32]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bronze statue holding an umbrella in a square.\n', 'Find me an everyday image that matches the given caption: Two people in kayaks on a Swift River.\n', 'Find me an everyday image that matches the given caption: A child sits on a pony, being led by a person.\n', 'Find me an everyday image that matches the given caption: A group of people are attending a celebration.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people are wrapping silverware from baskets.\n', 'Find me an everyday image that matches the given caption: An old photo of a man with a big beard.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A lone person sits on a snow covered bench with two snowboards leaning on it.\n', 'Find me an everyday image that matches the given caption: A male in a bright shirt and shorts with a white hat on a tennis court.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 33/6000 [01:10<3:24:28,  2.06s/it]                                                   {'loss': 4.3253, 'grad_norm': 1561.7119140625, 'learning_rate': 3.3000000000000006e-06, 'epoch': 0.01}
  1%|          | 33/6000 [01:10<3:24:28,  2.06s/it][2025-11-13 01:32:07,610] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bird is standing on a plank overlooking the beach.\n', 'Find me an everyday image that matches the given caption: A man that is standing on top of a motorcycle.\n', 'Find me an everyday image that matches the given caption: There is a man sitting on a bench listening to music.\n', 'Find me an everyday image that matches the given caption: A stop sign out on a gravel road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large jet flying through a blue cloudy sky.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a wet suit carrying a surfboard by some rocks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272767B50>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5EBC0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5F790>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=320x256 at 0x7F3272B5DAE0>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5C910>], [<PIL.Image.Image image mode=RGB size=256x342 at 0x7F3272764EE0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727648B0>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272B5C640>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272B5E1D0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278BF10>]], 'pixel_values': [array([[-1.5878845 , -1.5586877 , -1.5440893 , ..., -1.067838  ,
        -1.0393977 , -1.0536178 ],
       [-1.4856956 , -1.7192703 , -1.7192703 , ..., -0.7976566 ,
        -0.5559154 , -0.51325524],
       [-1.5586877 , -1.5878845 , -1.5878845 , ..., -0.91141707,
        -0.882977  , -0.882977  ],
       ...,
       [ 0.10553299,  0.10553299,  0.10553299, ..., -0.04399309,
        -0.05821316, -0.05821316],
       [-0.01125452,  0.01794233,  0.03254076, ...,  0.0839875 ,
         0.06976743,  0.0413273 ],
       [ 0.12013142,  0.12013142,  0.10553299, ..., -0.17197368,
        -0.20041381, -0.21463387]], dtype=float32), array([[1.9303361 , 1.9303361 , 1.9303361 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [1.9303361 , 1.9303361 , 1.9303361 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [1.9303361 , 1.9303361 , 1.9303361 , ..., 1.6055346 , 1.6055346 ,
        1.6339747 ],
       ...,
       [0.8208558 , 0.9230448 , 0.99603695, ..., 0.75233066, 0.7665507 ,
        0.7665507 ],
       [0.5726826 , 0.58728105, 0.5726826 , ..., 0.7807708 , 0.7949909 ,
        0.85187113],
       [0.5580842 , 0.5142889 , 0.5142889 , ..., 0.88031125, 0.88031125,
        0.88031125]], dtype=float32), array([[-1.2229239 , -1.2667192 , -1.3105145 , ..., -1.0536178 ,
        -1.0251776 , -0.9967375 ],
       [-1.4273019 , -1.5148925 , -1.7192703 , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.3105145 , -1.3397113 , -1.3689082 , ..., -0.9967375 ,
        -1.0109575 , -0.9825174 ],
       ...,
       [ 0.07633615, -0.06964822, -0.14264035, ..., -0.14353354,
        -0.14353354, -0.12931348],
       [-0.01125452, -0.04045137,  0.03254076, ...,  0.16930789,
         0.14086775,  0.0839875 ],
       [ 0.01794233, -0.01125452, -0.15723877, ..., -0.17197368,
        -0.21463387, -0.243074  ]], dtype=float32), None, None, None, None, array([[-1.7922626 , -1.7922626 , -1.7776641 , ...,  0.21196808,
         0.19774802,  0.21196808],
       [-1.6900735 , -1.6754751 , -1.6754751 , ...,  0.4252692 ,
         0.39682904,  0.43948925],
       [-1.6900735 , -1.7338688 , -1.7484672 , ...,  0.21196808,
         0.25462827,  0.24040821],
       ...,
       [ 0.7478637 ,  0.66027313,  0.61647785, ..., -0.07243322,
        -0.01555296,  0.11242763],
       [ 0.0617376 ,  0.00334391, -0.0550498 , ..., -0.243074  ,
        -0.22885394, -0.05821316],
       [-0.9017585 , -0.88716006, -0.9163569 , ..., -0.05821316,
         0.0413273 ,  0.11242763]], dtype=float32), None, array([[-0.405412  , -0.405412  , -0.39081356, ...,  0.43948925,
         0.4537093 ,  0.46792936],
       [-0.31782144, -0.303223  , -0.2740262 , ...,  0.52480966,
         0.52480966,  0.5390297 ],
       [ 0.85005265,  0.8646511 ,  0.8646511 , ...,  1.022512  ,
         1.0936122 ,  1.0082918 ],
       ...,
       [-1.398105  , -1.4127034 , -1.4273019 , ..., -1.0251776 ,
        -1.067838  , -1.1104981 ],
       [-1.3251129 , -1.3397113 , -1.3543098 , ..., -1.082058  ,
        -0.86875695, -0.86875695],
       [-1.4273019 , -1.4127034 , -1.4127034 , ..., -1.1389382 ,
        -1.1531583 , -1.1673783 ]], dtype=float32), array([[-0.9017585 , -0.6389868 ,  0.7478637 , ..., -0.8545369 ,
        -1.1673783 , -1.2100385 ],
       [-1.193727  , -1.2521207 , -1.2667192 , ..., -0.20041381,
         0.823431  ,  0.7665507 ],
       [-1.0331444 , -0.9747507 , -0.8433648 , ...,  0.90875137,
        -0.81187665, -1.1958185 ],
       ...,
       [-0.88716006, -0.8141679 , -0.96015227, ...,  2.0321364 ,
         2.0463567 ,  2.0605767 ],
       [ 1.1274228 ,  1.7405566 ,  1.7989503 , ...,  0.823431  ,
         0.8376511 ,  0.7665507 ],
       [ 1.7843518 ,  1.7697535 ,  1.7697535 , ...,  2.0036962 ,
         1.9894764 ,  1.9894764 ]], dtype=float32), array([[ 0.5726826 ,  0.6456747 ,  0.7040684 , ..., -0.21463387,
        -0.12931348, -0.05821316],
       [ 0.791659  ,  0.7040684 ,  0.6310763 , ...,  1.3637935 ,
         0.4963695 , -0.95407724],
       [ 0.7332653 ,  0.6018794 ,  0.54348576, ..., -0.45637497,
        -0.61279577, -0.669676  ],
       ...,
       [-0.5805931 , -0.65358526, -0.31782144, ..., -0.2857342 ,
        -0.49903518, -0.5985757 ],
       [ 0.8354542 ,  0.8354542 ,  0.9084464 , ...,  0.24040821,
         0.28306842,  0.25462827],
       [ 0.5580842 ,  0.8354542 ,  0.61647785, ...,  0.02710724,
        -0.25729406, -0.05821316]], dtype=float32), None, array([[-1.704672  , -1.7484672 , -1.7192703 , ..., -1.1958185 ,
        -1.2100385 , -1.2384787 ],
       [-1.2813176 , -1.5732862 , -1.6900735 , ..., -1.1673783 ,
        -1.2669188 , -1.2953589 ],
       [-1.5294908 , -1.5440893 , -1.5586877 , ..., -1.082058  ,
        -1.1104981 , -0.89719707],
       ...,
       [ 1.6967614 ,  1.6821629 ,  1.6821629 , ...,  1.8614956 ,
         1.8472759 ,  1.8472759 ],
       [ 0.93764323,  0.9084464 ,  0.8792495 , ..., -0.71233624,
        -0.6981161 , -0.7549964 ],
       [ 1.5507771 ,  1.5069818 ,  1.4485881 , ..., -0.9256371 ,
        -0.81187665, -0.7692165 ]], dtype=float32), array([[ 1.477785  ,  1.477785  ,  1.477785  , ...,  2.103237  ,
         2.117457  ,  2.117457  ],
       [ 1.5507771 ,  1.5507771 ,  1.5799739 , ...,  2.103237  ,
         2.103237  ,  2.103237  ],
       [ 1.6237692 ,  1.6237692 ,  1.6383677 , ...,  2.117457  ,
         2.0890167 ,  2.0890167 ],
       ...,
       [-0.5805931 , -0.5805931 , -0.5221994 , ..., -1.0393977 ,
        -1.1104981 , -1.1389382 ],
       [-0.6389868 , -0.60978997, -0.6389868 , ..., -1.2242587 ,
        -1.1958185 , -1.067838  ],
       [-0.6973805 , -0.60978997, -0.5221994 , ..., -1.1673783 ,
        -1.0536178 , -1.082058  ]], dtype=float32), array([[-1.4127034 , -1.3397113 , -1.2813176 , ..., -1.2669188 ,
        -1.2669188 , -1.2811389 ],
       [-0.8579632 , -0.88716006, -0.9017585 , ..., -0.9825174 ,
        -0.9256371 , -0.95407724],
       [-0.9017585 , -1.0039475 , -1.2083255 , ..., -0.9967375 ,
        -1.1389382 , -1.2384787 ],
       ...,
       [-0.6681836 , -0.68278205, -0.68278205, ..., -0.9256371 ,
        -0.9398572 , -0.9398572 ],
       [-0.60978997, -0.6681836 , -0.68278205, ..., -1.0109575 ,
        -1.0109575 , -1.0109575 ],
       [-0.7411758 , -0.7411758 , -0.7411758 , ..., -0.9825174 ,
        -0.9967375 , -1.0109575 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 22]]), None, array([[ 1, 24, 18]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bird is standing on a plank overlooking the beach.\n', 'Find me an everyday image that matches the given caption: A man that is standing on top of a motorcycle.\n', 'Find me an everyday image that matches the given caption: There is a man sitting on a bench listening to music.\n', 'Find me an everyday image that matches the given caption: A stop sign out on a gravel road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large jet flying through a blue cloudy sky.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a wet suit carrying a surfboard by some rocks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 34/6000 [01:11<3:21:46,  2.03s/it]                                                   {'loss': 4.8051, 'grad_norm': 1120.6064453125, 'learning_rate': 3.4000000000000005e-06, 'epoch': 0.01}
  1%|          | 34/6000 [01:12<3:21:46,  2.03s/it][2025-11-13 01:32:09,570] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,  98119,    624],
        [151643, 151643, 151643,  ...,  17545,  12060,    624],
        [151643, 151643, 151643,  ...,  19507,   2070,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   3168,  84561,    624],
        [151643, 151643, 151643,  ...,  12711,    389,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A girl wearing green is flying a kite.\n', 'Find me an everyday image that matches the given caption: A man surfs in a small gray wave.\n', 'Find me an everyday image that matches the given caption: A baseball player standing in a field on a baseball field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog sits on grass next to a fire hydrant while a person holds a leash and a bag filled with dog poop.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A keyboard, mouse and monitor screen on the table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog jumping on a frisbee in a yard.\n', 'Find me an everyday image that matches the given caption: The boy is running as he tries to fly his kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People are walking down street with umbrellas over their heads while cars are riding down the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: THERE IS A CITY BUS ON THE STREET.\n', "Find me an everyday image that matches the given caption: A little toy car has it's lights on.\n"], 'images': [[None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C6DA0>], [None], [<PIL.Image.Image image mode=RGB size=422x256 at 0x7F3272FADC30>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C7280>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C7850>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C71F0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C6E90>], [None], [None]], 'pixel_values': [None, None, None, array([[-0.15723877, -0.15723877, -0.14264035, ...,  0.96563166,
         0.96563166,  0.9798517 ],
       [ 0.00334391,  0.00334391,  0.01794233, ...,  1.0509521 ,
         1.0509521 ,  1.0509521 ],
       [-0.06964822, -0.06964822, -0.0550498 , ...,  0.93719155,
         0.93719155,  0.9514116 ],
       ...,
       [ 0.6018794 ,  0.6018794 ,  0.6018794 , ...,  1.5059941 ,
         1.4917741 ,  1.477554  ],
       [ 0.6310763 ,  0.5142889 ,  0.52888733, ...,  1.3780135 ,
         1.4206737 ,  1.4348938 ],
       [ 0.52888733,  0.52888733,  0.52888733, ...,  1.3780135 ,
         1.3637935 ,  1.3495734 ]], dtype=float32), None, array([[-1.398105  , -1.4127034 , -1.4273019 , ..., -0.669676  ,
        -0.6412359 , -0.669676  ],
       [-1.398105  , -1.398105  , -1.3251129 , ...,  0.63857013,
         0.6954504 ,  0.3257286 ],
       [-1.4710971 , -1.4856956 , -1.4710971 , ...,  1.463334  ,
         1.5344343 ,  1.8614956 ],
       ...,
       [-0.55139625, -0.55139625, -0.5659947 , ...,  0.19774802,
         0.18352796,  0.18352796],
       [-0.5367978 , -0.5367978 , -0.55139625, ...,  0.14086775,
         0.14086775,  0.14086775],
       [-0.6681836 , -0.6681836 , -0.68278205, ...,  0.05554737,
         0.0413273 ,  0.02710724]], dtype=float32), None, array([[ 0.71866685,  0.7040684 ,  0.7040684 , ..., -0.6270158 ,
        -0.6270158 , -0.6270158 ],
       [ 0.7332653 ,  0.7332653 ,  0.68947   , ..., -0.61279577,
        -0.61279577, -0.61279577],
       [-0.7995695 , -0.78497106, -0.7703726 , ..., -0.5985757 ,
        -0.5985757 , -0.5985757 ],
       ...,
       [-0.6389868 , -0.65358526, -0.68278205, ..., -0.74077636,
        -0.8403168 , -0.9967375 ],
       [-0.7557742 , -0.7703726 , -0.7703726 , ..., -0.9825174 ,
        -0.71233624, -0.7549964 ],
       [-0.50760096, -0.44920728, -0.36161673, ..., -1.2242587 ,
        -1.2526988 , -1.2100385 ]], dtype=float32), None, None, array([[-0.49300256, -0.5659947 , -0.6973805 , ..., -0.5559154 ,
        -0.57013553, -0.669676  ],
       [-0.72657734, -0.8141679 , -0.7703726 , ..., -0.61279577,
        -0.61279577, -0.54169536],
       [-0.5367978 , -0.49300256, -0.50760096, ..., -0.5274753 ,
        -0.5559154 , -0.58435565],
       ...,
       [-1.7630657 , -1.7630657 , -1.7630657 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ]], dtype=float32), None, array([[-1.193727  , -1.3251129 , -1.3397113 , ..., -0.68389606,
        -0.61279577, -0.58435565],
       [-0.7995695 , -0.88716006, -1.1207349 , ..., -0.669676  ,
        -0.8545369 , -0.7976566 ],
       [-0.9017585 , -0.9893491 , -0.82876635, ..., -0.6981161 ,
        -0.6412359 , -0.7549964 ],
       ...,
       [-0.06964822, -0.11344349, -0.18643562, ..., -0.18619375,
        -0.39949474, -0.27151415],
       [ 0.12013142, -0.06964822, -0.06964822, ...,  0.14086775,
        -0.14353354, -0.01555296],
       [-0.33241987, -0.2740262 , -0.2302309 , ..., -0.01555296,
        -0.04399309,  0.02710724]], dtype=float32), array([[ 6.8946999e-01,  6.8946999e-01,  6.8946999e-01, ...,
         2.1174569e+00,  2.1032369e+00,  2.1174569e+00],
       [ 7.4786371e-01,  7.7706057e-01,  8.2085580e-01, ...,
         2.0890167e+00,  2.0747969e+00,  2.0747969e+00],
       [ 9.0844637e-01,  9.0844637e-01,  9.0844637e-01, ...,
         2.0890167e+00,  2.0890167e+00,  2.0890167e+00],
       ...,
       [-6.0978997e-01, -6.5358526e-01, -4.2001042e-01, ...,
        -1.2931348e-01, -3.9949474e-01, -5.1325524e-01],
       [-4.6380571e-01, -2.0103405e-01, -4.0541199e-01, ...,
        -3.2839438e-01, -1.7197368e-01,  2.5462827e-01],
       [-2.5852945e-02, -1.2804192e-01, -4.6380571e-01, ...,
        -2.9995427e-01, -1.7197368e-01, -1.3328948e-03]], dtype=float32), None, None], 'image_grid_thw': [None, None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 30]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A girl wearing green is flying a kite.\n', 'Find me an everyday image that matches the given caption: A man surfs in a small gray wave.\n', 'Find me an everyday image that matches the given caption: A baseball player standing in a field on a baseball field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog sits on grass next to a fire hydrant while a person holds a leash and a bag filled with dog poop.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A keyboard, mouse and monitor screen on the table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog jumping on a frisbee in a yard.\n', 'Find me an everyday image that matches the given caption: The boy is running as he tries to fly his kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People are walking down street with umbrellas over their heads while cars are riding down the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: THERE IS A CITY BUS ON THE STREET.\n', "Find me an everyday image that matches the given caption: A little toy car has it's lights on.\n"], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 35/6000 [01:14<3:22:35,  2.04s/it]                                                   {'loss': 4.3059, 'grad_norm': 883.871337890625, 'learning_rate': 3.5e-06, 'epoch': 0.01}
  1%|          | 35/6000 [01:14<3:22:35,  2.04s/it][2025-11-13 01:32:11,635] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,   6249,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  16301,   2088,    624],
        [151643, 151643, 151643,  ...,  17113,    700,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black dog is looking into the camera.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of people and a man holding the reigns of a horse.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A very big pretty white building with a clock.\n', 'Find me an everyday image that matches the given caption: A baby laying on its belly in front of a laptop.\n', 'Find me an everyday image that matches the given caption: The front of a silver gray car with a small cat laying in front of a tire.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A red toothbrush with toothpaste over a sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Giraffes live in a large sandy area close to a mountain range.\n', 'Find me an everyday image that matches the given caption: A lady standing by a table with a variety of food laid out.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAFA60>], [<PIL.Image.Image image mode=RGB size=406x256 at 0x7F3272FAD150>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7820>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C6CE0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C6950>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C4700>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=320x256 at 0x7F32727C7B20>], [None], [<PIL.Image.Image image mode=RGB size=331x256 at 0x7F32727C53C0>], [None], [None]], 'pixel_values': [array([[ 0.03254076, -0.36161673, -0.68278205, ...,  0.02710724,
         0.18352796,  0.21196808],
       [-1.2521207 , -1.2813176 , -1.1207349 , ..., -1.3237991 ,
        -1.2953589 , -1.0536178 ],
       [-1.500294  , -1.3835065 , -1.2667192 , ..., -0.35683453,
        -0.18619375, -0.01555296],
       ...,
       [ 0.36830464,  0.33910778,  0.2807141 , ..., -0.18619375,
        -0.14353354, -0.04399309],
       [ 0.17852512,  0.17852512,  0.2223204 , ..., -0.02977302,
        -0.02977302,  0.0413273 ],
       [ 0.14932826,  0.20772196,  0.30991095, ..., -0.14353354,
        -0.11509342, -0.05821316]], dtype=float32), array([[ 1.6237692 ,  1.6967614 ,  1.7697535 , ..., -0.32839438,
        -0.20041381, -0.17197368],
       [ 1.8719424 ,  1.8427455 ,  1.8135487 , ...,  0.21196808,
         0.38260898,  0.4110491 ],
       [ 1.8281472 ,  1.9157377 ,  1.857344  , ..., -0.58435565,
        -0.25729406, -0.2857342 ],
       ...,
       [ 1.857344  ,  1.8865409 ,  1.8427455 , ...,  2.0321364 ,
         2.0036962 ,  1.9894764 ],
       [ 1.5653756 ,  1.5799739 ,  1.5653756 , ...,  1.8330555 ,
         1.8330555 ,  1.8330555 ],
       [ 1.9011393 ,  1.8865409 ,  1.8719424 , ...,  1.3780135 ,
         1.3211333 ,  1.3211333 ]], dtype=float32), None, array([[ 1.5653756e+00,  1.5653756e+00,  1.5653756e+00, ...,
         2.0890167e+00,  2.0890167e+00,  2.0747969e+00],
       [ 1.4777850e+00,  1.4777850e+00,  1.4485881e+00, ...,
         2.0463567e+00,  2.0463567e+00,  2.0605767e+00],
       [ 1.4193913e+00,  1.4193913e+00,  1.4193913e+00, ...,
         2.0463567e+00,  2.0463567e+00,  2.0463567e+00],
       ...,
       [-9.0175849e-01, -8.4336478e-01, -8.2876635e-01, ...,
        -2.9995427e-01, -2.7151415e-01, -2.1463387e-01],
       [-8.5796320e-01, -8.5796320e-01, -8.5796320e-01, ...,
        -2.4307400e-01, -2.4307400e-01, -2.5729406e-01],
       [-5.0760096e-01, -4.3460885e-01, -4.2001042e-01, ...,
         9.8207563e-02,  6.9767430e-02, -1.3328948e-03]], dtype=float32), array([[ 0.6456747 ,  0.6456747 ,  0.6456747 , ...,  0.6527902 ,
         0.6527902 ,  0.6527902 ],
       [ 0.66027313,  0.66027313,  0.67487156, ...,  0.59590995,
         0.59590995,  0.59590995],
       [ 0.58728105,  0.58728105,  0.6018794 , ...,  0.59590995,
         0.59590995,  0.59590995],
       ...,
       [-1.0331444 , -1.0331444 , -1.0331444 , ..., -1.3948994 ,
        -1.4091195 , -1.4375596 ],
       [-0.9017585 , -0.88716006, -0.87256163, ..., -0.86875695,
        -0.8545369 , -0.8260967 ],
       [-0.96015227, -0.94555384, -0.9747507 , ..., -1.0109575 ,
        -1.0393977 , -1.0536178 ]], dtype=float32), array([[-0.21563247, -0.24482933, -0.2740262 , ...,  0.21196808,
         0.33994877,  0.35416883],
       [-0.31782144, -0.25942776, -0.28862458, ..., -0.61279577,
        -0.6270158 , -0.68389606],
       [ 0.54348576,  0.54348576,  0.52888733, ..., -0.15775362,
        -0.2857342 , -0.2857342 ],
       ...,
       [-0.3470183 , -0.20103405, -0.303223  , ..., -0.7976566 ,
        -0.71233624, -0.5985757 ],
       [-0.39081356, -0.31782144, -0.2740262 , ..., -0.4421549 ,
        -0.45637497, -0.5985757 ],
       [-1.1061366 , -0.9163569 , -0.87256163, ..., -0.47059506,
        -0.38527465, -0.38527465]], dtype=float32), None, array([[-1.7776641, -1.7776641, -1.7776641, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7776641, -1.7776641, -1.7630657, ..., -1.4802198, -1.4802198,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4802198, -1.4802198,
        -1.4802198],
       ...,
       [-1.7630657, -1.7630657, -1.7630657, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.5586877, -1.5440893, -1.5878845, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7484672, -1.7484672, -1.7484672, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), None, None, None, array([[-0.5221994 , -0.50760096, -0.42001042, ..., -0.21463387,
         0.0413273 ,  0.11242763],
       [-0.1718372 , -0.1718372 , -0.20103405, ..., -0.10087335,
        -0.39949474, -0.5274753 ],
       [-0.59519154, -0.5221994 , -0.55139625, ..., -0.07243322,
        -0.08665328, -0.15775362],
       ...,
       [ 0.5142889 ,  0.5142889 ,  0.5142889 , ...,  0.48214942,
         0.51058954,  0.56746984],
       [ 0.66027313,  0.6310763 ,  0.6018794 , ...,  0.35416883,
         0.39682904,  0.4252692 ],
       [ 0.6018794 ,  0.6018794 ,  0.6310763 , ...,  0.38260898,
         0.4110491 ,  0.43948925]], dtype=float32), None, array([[-1.4127034 , -1.4127034 , -1.398105  , ..., -1.1247182 ,
        -1.1104981 , -1.1104981 ],
       [-1.2667192 , -1.2521207 , -1.2375224 , ..., -1.0251776 ,
        -1.0109575 , -0.9967375 ],
       [-1.4856956 , -1.4856956 , -1.4856956 , ..., -1.2526988 ,
        -1.2384787 , -1.2242587 ],
       ...,
       [-1.5148925 , -1.5294908 , -1.5294908 , ..., -1.2811389 ,
        -1.2811389 , -1.2811389 ],
       [-0.2302309 , -0.7703726 , -1.1061366 , ..., -1.3380191 ,
        -1.3522393 , -1.3522393 ],
       [-1.5148925 , -1.5148925 , -1.5148925 , ..., -0.42793486,
        -0.3710546 , -0.34261447]], dtype=float32), None, None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 22]]), None, array([[ 1, 18, 24]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black dog is looking into the camera.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of people and a man holding the reigns of a horse.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A very big pretty white building with a clock.\n', 'Find me an everyday image that matches the given caption: A baby laying on its belly in front of a laptop.\n', 'Find me an everyday image that matches the given caption: The front of a silver gray car with a small cat laying in front of a tire.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A red toothbrush with toothpaste over a sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Giraffes live in a large sandy area close to a mountain range.\n', 'Find me an everyday image that matches the given caption: A lady standing by a table with a variety of food laid out.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 36/6000 [01:16<3:20:58,  2.02s/it]                                                   {'loss': 4.8779, 'grad_norm': 1180.735595703125, 'learning_rate': 3.6000000000000003e-06, 'epoch': 0.01}
  1%|          | 36/6000 [01:16<3:20:58,  2.02s/it][2025-11-13 01:32:13,613] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,   6422,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  14029,    624],
        ...,
        [151643, 151643, 151643,  ...,   1495,  13918,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   8592,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A narrow white room with a white mattress on the floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple pose in the kitchen set of a studio.\n', 'Find me an everyday image that matches the given caption: A group of people with backpacks and umbrellas.\n', 'Find me an everyday image that matches the given caption: A show of a trash next to a grassland.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A clock between two pictures of kittens and a picture of a horse.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two office workers engaged in a computer task.\n', 'Find me an everyday image that matches the given caption: A blue and white food truck and some people standing around.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The  brown and white horse is walking in the road.\n', 'Find me an everyday image that matches the given caption: A silver and blue train traveling down tracks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Stores, people, street signs and cars on a street.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F327277E0B0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277DAB0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278B3D0>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F327278BF10>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B190>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327278A7A0>], [None]], 'pixel_values': [None, array([[-1.3251129 , -1.3251129 , -1.3251129 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.3251129 , -1.3251129 , -1.3105145 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.3105145 , -1.3105145 , -1.3105145 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       ...,
       [ 1.6675645 ,  1.5361787 ,  1.3609976 , ..., -0.01555296,
         0.01288717,  0.21196808],
       [ 1.4631865 ,  1.3463992 ,  1.2588086 , ..., -0.05821316,
        -0.07243322, -0.02977302],
       [ 1.1274228 ,  1.1274228 ,  1.1420212 , ...,  0.01288717,
        -0.04399309,  0.14086775]], dtype=float32), None, None, None, array([[ 0.8646511 ,  0.8354542 ,  0.8208558 , ..., -1.3380191 ,
        -1.309579  , -1.2526988 ],
       [ 0.9084464 ,  0.89384794,  0.9230448 , ..., -0.7549964 ,
        -0.882977  , -0.9967375 ],
       [ 0.0617376 ,  0.04713918,  0.0617376 , ..., -1.2100385 ,
        -1.1104981 , -1.0109575 ],
       ...,
       [ 1.857344  ,  1.9011393 ,  1.8865409 , ..., -0.78343654,
        -1.2242587 , -1.4802198 ],
       [ 1.8865409 ,  1.9011393 ,  1.9157377 , ..., -0.8260967 ,
        -0.86875695, -0.9256371 ],
       [ 1.8719424 ,  1.5507771 ,  1.5069818 , ..., -0.9967375 ,
        -0.9967375 , -0.95407724]], dtype=float32), None, array([[-0.14264035, -0.12804192, -0.18643562, ..., -1.0536178 ,
        -0.8403168 , -0.6412359 ],
       [-0.11344349, -0.02585294,  0.0617376 , ..., -0.7976566 ,
        -0.58435565, -0.71233624],
       [-0.15723877, -0.12804192, -0.11344349, ..., -0.7692165 ,
        -1.0536178 , -0.9967375 ],
       ...,
       [ 0.4704936 ,  0.42669836,  0.38290307, ..., -0.78343654,
        -0.669676  , -0.669676  ],
       [-0.7119789 , -0.87256163, -0.78497106, ..., -0.7265563 ,
        -0.8260967 , -0.882977  ],
       [-0.6681836 , -0.6681836 , -0.60978997, ..., -0.9256371 ,
        -0.68389606, -0.669676  ]], dtype=float32), array([[-0.28862458, -0.28862458, -0.303223  , ...,  0.1266477 ,
         0.14086775,  0.15508783],
       [-0.24482933, -0.21563247, -0.15723877, ...,  0.19774802,
         0.19774802,  0.21196808],
       [-0.08424664, -0.08424664, -0.08424664, ..., -0.58435565,
        -0.6412359 , -0.5274753 ],
       ...,
       [-0.5805931 , -0.4638057 , -0.88716006, ..., -1.4802198 ,
        -1.309579  , -1.0536178 ],
       [-0.50760096, -0.44920728, -0.4638057 , ..., -1.2526988 ,
        -1.1389382 , -1.3664593 ],
       [-1.0915381 , -0.8579632 , -0.7411758 , ..., -0.96829736,
        -0.51325524, -0.7265563 ]], dtype=float32), None, None, array([[ 1.0252337 ,  1.0252337 ,  1.0252337 , ...,  1.9325962 ,
         1.9610363 ,  2.0605767 ],
       [ 0.9668401 ,  0.9668401 ,  1.0106354 , ..., -0.71233624,
        -0.5985757 , -0.61279577],
       [ 1.4631865 ,  1.4631865 ,  1.4485881 , ...,  1.8472759 ,
         1.6339747 ,  1.1647125 ],
       ...,
       [-0.60978997, -0.5221994 , -0.50760096, ..., -0.4137148 ,
        -0.58435565, -0.7976566 ],
       [-0.6389868 , -1.2229239 , -1.4710971 , ..., -0.51325524,
        -0.32839438, -0.29995427],
       [-0.60978997, -0.9893491 , -0.6389868 , ..., -0.91141707,
        -0.96829736, -0.669676  ]], dtype=float32), None, None, array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [ 0.791659  ,  1.0836275 ,  1.5945723 , ...,  0.8660912 ,
         0.88031125,  0.9229715 ],
       [ 1.8135487 ,  1.7989503 ,  1.6675645 , ...,  1.2500329 ,
         0.823431  ,  0.25462827],
       [-0.405412  , -0.15723877,  0.7478637 , ...,  0.4252692 ,
         0.4537093 ,  0.52480966]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 28, 18]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A narrow white room with a white mattress on the floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple pose in the kitchen set of a studio.\n', 'Find me an everyday image that matches the given caption: A group of people with backpacks and umbrellas.\n', 'Find me an everyday image that matches the given caption: A show of a trash next to a grassland.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A clock between two pictures of kittens and a picture of a horse.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two office workers engaged in a computer task.\n', 'Find me an everyday image that matches the given caption: A blue and white food truck and some people standing around.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The  brown and white horse is walking in the road.\n', 'Find me an everyday image that matches the given caption: A silver and blue train traveling down tracks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Stores, people, street signs and cars on a street.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 37/6000 [01:18<3:19:38,  2.01s/it]                                                   {'loss': 4.4092, 'grad_norm': 897.214599609375, 'learning_rate': 3.7e-06, 'epoch': 0.01}
  1%|          | 37/6000 [01:18<3:19:38,  2.01s/it][2025-11-13 01:32:15,604] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  16158,   4766,    624],
        [151643, 151643, 151643,  ...,    264,  14068,    624],
        [151643, 151643, 151643,  ...,    264,  81512,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   2978,    685,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Two soldiers and a bear are standing near a portal potty with a man dressed as a chicken inside.\n', 'Find me an everyday image that matches the given caption: A snow skier in a blue jacket is doing a trick.\n', 'Find me an everyday image that matches the given caption: A man and a lady holding up a racket.\n', 'Find me an everyday image that matches the given caption: A group of people sitting around a table with clutter on top of it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A suitcase packed full of various types of food.\n', 'Find me an everyday image that matches the given caption: People run around while a frisbee flies through the air.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A tennis player pauses during a game in a public tennis court.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young baby has fallen asleep with a stuffed bear.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Array of personal affects including a gun, wallet, watch, keys and other paraphernalia.\n'], 'images': [[None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=400x256 at 0x7F32727C6E30>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C6FB0>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5EBC0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5DAE0>], [None], [<PIL.Image.Image image mode=RGB size=256x349 at 0x7F3272B5EFB0>], [None], [<PIL.Image.Image image mode=RGB size=338x256 at 0x7F3272B5EE30>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E1D0>], [None]], 'pixel_values': [None, None, None, None, array([[ 1.7551551 ,  1.7551551 ,  1.7551551 , ...,  1.9752562 ,
         1.9752562 ,  1.9752562 ],
       [ 1.7259582 ,  1.7259582 ,  1.7113597 , ...,  1.9610363 ,
         1.9610363 ,  1.9752562 ],
       [ 1.652966  ,  1.652966  ,  1.652966  , ...,  1.9468161 ,
         1.9468161 ,  1.9468161 ],
       ...,
       [-0.01125452, -0.01125452, -0.01125452, ...,  0.4110491 ,
         0.4252692 ,  0.48214942],
       [-0.08424664, -0.0550498 ,  0.03254076, ...,  0.06976743,
        -0.08665328, -0.18619375],
       [ 0.07633615,  0.01794233, -0.0550498 , ..., -0.22885394,
        -0.05821316, -0.12931348]], dtype=float32), array([[ 1.8865409 ,  1.8719424 ,  1.8281472 , ..., -0.5985757 ,
        -0.7976566 , -0.882977  ],
       [-1.3543098 , -1.2813176 , -1.1645303 , ..., -0.7692165 ,
        -0.81187665, -0.8403168 ],
       [ 1.9157377 ,  1.8865409 ,  1.8719424 , ..., -0.51325524,
        -0.5274753 , -0.7692165 ],
       ...,
       [-1.4710971 , -1.4564987 , -1.4564987 , ..., -1.2384787 ,
        -1.2526988 , -1.2526988 ],
       [-1.4127034 , -1.4127034 , -1.4127034 , ..., -1.2811389 ,
        -1.2526988 , -1.2384787 ],
       [-1.2375224 , -1.1207349 , -1.1791286 , ..., -1.2811389 ,
        -1.2242587 , -1.2242587 ]], dtype=float32), None, None, array([[0.42669836, 0.42669836, 0.44129676, ..., 0.9514116 , 0.96563166,
        0.96563166],
       [0.54348576, 0.54348576, 0.5580842 , ..., 1.022512  , 1.022512  ,
        1.036732  ],
       [0.49969047, 0.49969047, 0.5142889 , ..., 0.9798517 , 0.9798517 ,
        0.9940718 ],
       ...,
       [0.5726826 , 0.5580842 , 0.5580842 , ..., 0.75233066, 0.72389054,
        0.72389054],
       [0.54348576, 0.54348576, 0.54348576, ..., 0.7381106 , 0.72389054,
        0.72389054],
       [0.4704936 , 0.4704936 , 0.4704936 , ..., 0.6243501 , 0.61013   ,
        0.61013   ]], dtype=float32), array([[0.7332653 , 0.7332653 , 0.7478637 , ..., 1.5913146 , 1.5913146 ,
        1.6055346 ],
       [0.8062574 , 0.8062574 , 0.8354542 , ..., 1.690855  , 1.705075  ,
        1.7192951 ],
       [0.7332653 , 0.7478637 , 0.7478637 , ..., 1.6339747 , 1.6339747 ,
        1.6481948 ],
       ...,
       [0.48509204, 0.48509204, 0.4704936 , ..., 1.2073728 , 1.1789327 ,
        1.1789327 ],
       [0.5142889 , 0.5142889 , 0.5142889 , ..., 1.3495734 , 1.3353534 ,
        1.3353534 ],
       [0.49969047, 0.52888733, 0.52888733, ..., 1.2500329 , 1.2500329 ,
        1.2500329 ]], dtype=float32), None, array([[-0.6973805 , -0.6973805 , -0.6973805 , ...,  1.4206737 ,
         1.4206737 ,  1.4206737 ],
       [-0.7119789 , -0.7119789 , -0.7119789 , ...,  1.3922336 ,
         1.3922336 ,  1.3780135 ],
       [-0.7119789 , -0.7119789 , -0.7119789 , ...,  1.3780135 ,
         1.3780135 ,  1.3637935 ],
       ...,
       [-0.37621516, -0.3470183 , -0.28862458, ...,  0.01288717,
        -0.25729406, -0.6412359 ],
       [-0.11344349, -0.08424664, -0.04045137, ..., -0.8545369 ,
        -0.8260967 , -0.8403168 ],
       [ 0.10553299, -0.14264035, -0.33241987, ..., -0.9825174 ,
        -0.91141707, -0.7976566 ]], dtype=float32), None, array([[0.30991095, 0.30991095, 0.30991095, ..., 0.4252692 , 0.4252692 ,
        0.4252692 ],
       [0.3537062 , 0.3537062 , 0.36830464, ..., 0.43948925, 0.4537093 ,
        0.4537093 ],
       [0.5726826 , 0.5726826 , 0.5726826 , ..., 0.59590995, 0.59590995,
        0.59590995],
       ...,
       [1.652966  , 1.652966  , 1.652966  , ..., 1.9325962 , 1.9468161 ,
        1.9468161 ],
       [1.6091708 , 1.5799739 , 1.6237692 , ..., 1.7903955 , 1.7903955 ,
        1.7761754 ],
       [1.652966  , 1.6383677 , 1.6237692 , ..., 1.8472759 , 1.8899357 ,
        1.8899357 ]], dtype=float32), array([[1.9157377 , 1.9157377 , 1.9157377 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [1.9157377 , 1.9157377 , 1.9157377 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [1.7697535 , 1.7843518 , 1.7989503 , ..., 0.38260898, 0.4110491 ,
        0.48214942],
       ...,
       [0.8208558 , 0.791659  , 0.76246214, ..., 0.7807708 , 0.8376511 ,
        0.8945313 ],
       [0.54348576, 0.5726826 , 0.54348576, ..., 0.7096705 , 0.61013   ,
        0.59590995],
       [0.66027313, 0.7332653 , 0.85005265, ..., 1.022512  , 0.9798517 ,
        0.9514116 ]], dtype=float32), None], 'image_grid_thw': [None, None, None, None, array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Two soldiers and a bear are standing near a portal potty with a man dressed as a chicken inside.\n', 'Find me an everyday image that matches the given caption: A snow skier in a blue jacket is doing a trick.\n', 'Find me an everyday image that matches the given caption: A man and a lady holding up a racket.\n', 'Find me an everyday image that matches the given caption: A group of people sitting around a table with clutter on top of it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A suitcase packed full of various types of food.\n', 'Find me an everyday image that matches the given caption: People run around while a frisbee flies through the air.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A tennis player pauses during a game in a public tennis court.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young baby has fallen asleep with a stuffed bear.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Array of personal affects including a gun, wallet, watch, keys and other paraphernalia.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 38/6000 [01:19<3:18:40,  2.00s/it]                                                   {'loss': 4.6068, 'grad_norm': 1527.58154296875, 'learning_rate': 3.8000000000000005e-06, 'epoch': 0.01}
  1%|          | 38/6000 [01:19<3:18:40,  2.00s/it][2025-11-13 01:32:17,567] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  44647,    705,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,  16359,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  23946,    624],
        [151643, 151643, 151643,  ...,    279,   6010,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: An old grey pickup truck is parked in front of a white house with pillars holding the porch up.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A muddy gray elephant laying in the grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A wii controller next to various small figurines.\n', 'Find me an everyday image that matches the given caption: A group of people laugh while sitting around a table looking at an open laptop.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of kids standing under a kite flying in the sky.\n', "Find me an everyday image that matches the given caption: A bunch of someone's personal belonging laying out on newspaper.\n", 'Find me an everyday image that matches the given caption: A young person is about to drink something.\n', 'Find me an everyday image that matches the given caption: A wooden table holding a white plate with cake on it.\n', 'Find me an everyday image that matches the given caption: Black and white photograph of pedestrians in an alley.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person in an orange snow suit on skis riding down a hill.\n', 'Find me an everyday image that matches the given caption: A white cat sitting on a beach looking into the distance.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727B5AB0>], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272B5E7A0>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5D330>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272766590>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727648B0>]], 'pixel_values': [None, array([[-1.704672  , -1.704672  , -1.704672  , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-1.704672  , -1.704672  , -1.6900735 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-1.6900735 , -1.6900735 , -1.6900735 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       ...,
       [-1.3397113 , -1.3689082 , -1.4127034 , ..., -0.74077636,
        -0.74077636, -0.7549964 ],
       [-1.500294  , -1.500294  , -1.5148925 , ..., -1.3522393 ,
        -1.3380191 , -1.3806794 ],
       [-1.704672  , -1.6900735 , -1.500294  , ..., -0.9967375 ,
        -1.0536178 , -1.082058  ]], dtype=float32), None, array([[-1.5294908 , -1.5294908 , -1.5586877 , ..., -1.1531583 ,
        -1.1531583 , -1.1531583 ],
       [-1.5878845 , -1.6024829 , -1.5878845 , ..., -1.0962781 ,
        -1.0962781 , -1.067838  ],
       [-1.5148925 , -1.5148925 , -1.500294  , ..., -1.1104981 ,
        -1.0962781 , -1.082058  ],
       ...,
       [-0.9309554 , -0.9893491 , -1.0331444 , ..., -0.89719707,
        -0.8403168 , -0.86875695],
       [-0.7995695 , -0.7995695 , -0.7557742 , ..., -0.96829736,
        -0.78343654, -0.74077636],
       [-0.8433648 , -0.8141679 , -0.7995695 , ..., -0.96829736,
        -0.9825174 , -0.8260967 ]], dtype=float32), None, None, array([[ 1.3026038 ,  1.3172023 ,  1.3463992 , ...,  1.6624149 ,
         1.6624149 ,  1.6624149 ],
       [ 1.6237692 ,  1.6091708 ,  1.5945723 , ...,  1.7761754 ,
         1.7761754 ,  1.7903955 ],
       [ 1.4047928 ,  1.3901944 ,  1.3755959 , ...,  1.5486543 ,
         1.5628744 ,  1.5628744 ],
       ...,
       [-1.0915381 , -1.1207349 , -1.1353334 , ..., -0.882977  ,
        -0.86875695, -0.8403168 ],
       [-1.0477428 , -1.018546  , -0.94555384, ..., -0.669676  ,
        -0.58435565, -0.5985757 ],
       [-1.1207349 , -1.0769397 , -1.0477428 , ..., -0.7976566 ,
        -0.8545369 , -0.8260967 ]], dtype=float32), None, None, None, None, None, array([[-0.4638057 , -0.5221994 , -0.5221994 , ..., -0.89719707,
        -1.0109575 , -0.9967375 ],
       [-0.50760096, -0.31782144, -0.47840413, ..., -0.95407724,
        -1.0393977 , -1.1247182 ],
       [-0.04045137, -0.08424664, -0.1718372 , ..., -0.7692165 ,
        -0.81187665, -0.7692165 ],
       ...,
       [-0.303223  , -0.14264035, -0.0550498 , ..., -0.9825174 ,
        -1.1815984 , -1.1958185 ],
       [-0.39081356, -0.4638057 , -0.24482933, ..., -0.86875695,
        -1.0536178 , -1.0393977 ],
       [ 0.01794233, -0.02585294, -0.0550498 , ..., -0.7549964 ,
        -1.0251776 , -0.882977  ]], dtype=float32), None, None, array([[-0.21563247,  0.4558952 , -0.09884507, ...,  0.15508783,
         0.9514116 , -0.6270158 ],
       [-1.1061366 , -0.88716006, -1.0769397 , ..., -1.0962781 ,
        -1.1389382 , -1.067838  ],
       [-1.2083255 , -1.4127034 , -1.6608766 , ...,  0.6243501 ,
         0.31150854,  0.36838892],
       ...,
       [ 0.89384794,  0.68947   ,  0.2223204 , ..., -0.38527465,
        -0.17197368, -0.2857342 ],
       [ 0.44129676,  0.3537062 ,  0.30991095, ...,  0.05554737,
         0.05554737,  0.0413273 ],
       [ 0.58728105,  0.5726826 ,  0.33910778, ..., -0.54169536,
        -0.49903518, -0.65545595]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), None, None, None, None, None, array([[ 1, 18, 28]]), None, None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: An old grey pickup truck is parked in front of a white house with pillars holding the porch up.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A muddy gray elephant laying in the grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A wii controller next to various small figurines.\n', 'Find me an everyday image that matches the given caption: A group of people laugh while sitting around a table looking at an open laptop.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of kids standing under a kite flying in the sky.\n', "Find me an everyday image that matches the given caption: A bunch of someone's personal belonging laying out on newspaper.\n", 'Find me an everyday image that matches the given caption: A young person is about to drink something.\n', 'Find me an everyday image that matches the given caption: A wooden table holding a white plate with cake on it.\n', 'Find me an everyday image that matches the given caption: Black and white photograph of pedestrians in an alley.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person in an orange snow suit on skis riding down a hill.\n', 'Find me an everyday image that matches the given caption: A white cat sitting on a beach looking into the distance.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 39/6000 [01:22<3:20:46,  2.02s/it]                                                   {'loss': 4.2767, 'grad_norm': 939.187744140625, 'learning_rate': 3.900000000000001e-06, 'epoch': 0.01}
  1%|          | 39/6000 [01:22<3:20:46,  2.02s/it][2025-11-13 01:32:19,647] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    806,  97982,    624],
        [151643, 151643, 151643,  ...,   1045,  15294,    624],
        ...,
        [151643, 151643, 151643,  ...,  17545,  27292,    624],
        [151643, 151643, 151643,  ...,    279,  14852,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man with a hat on riding his skateboard.\n', 'Find me an everyday image that matches the given caption: A window a white bunk bed and some shoes.\n', 'Find me an everyday image that matches the given caption: Variety of things sprawled on top of a newspaper.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Pizza with white sauce, tomato and basil on a plate.\n', 'Find me an everyday image that matches the given caption: Two very cute giraffes touching nose to nose.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two children are practicing on a tennis court.\n', 'Find me an everyday image that matches the given caption: A cutting board with a pizza on top and knife.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Night scene of a party outside showing man on a bike and a blender on the ground.\n', 'Find me an everyday image that matches the given caption: Various types of electronics equipment on a gray cloth.\n', 'Find me an everyday image that matches the given caption: A man standing at a urinal in the bathroom.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=302x256 at 0x7F327277F730>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F1F0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327277DFF0>], [None], [None], [<PIL.Image.Image image mode=RGB size=347x256 at 0x7F3272FACE50>], [None], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272B5F190>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5F850>]], 'pixel_values': [array([[-0.37621516, -0.1718372 ,  0.95224166, ..., -0.45637497,
        -0.5985757 , -0.89719707],
       [-0.24482933, -0.2302309 , -0.06964822, ..., -0.6412359 ,
        -1.309579  , -0.51325524],
       [-0.5221994 ,  0.16392669,  0.6310763 , ..., -1.4517797 ,
        -1.3380191 , -1.1958185 ],
       ...,
       [-1.2813176 , -1.500294  , -1.5440893 , ..., -1.1673783 ,
        -1.2526988 , -1.2100385 ],
       [-1.5732862 , -1.6754751 , -0.5221994 , ..., -1.067838  ,
        -1.4091195 , -0.9398572 ],
       [-1.4127034 , -1.7484672 , -1.398105  , ..., -1.067838  ,
        -1.0962781 , -1.1531583 ]], dtype=float32), None, None, None, array([[-0.7557742 , -0.7119789 , -0.6681836 , ..., -0.21463387,
        -0.27151415, -0.25729406],
       [-0.7119789 , -0.72657734, -0.68278205, ..., -0.25729406,
        -0.25729406, -0.243074  ],
       [-0.7119789 , -0.6389868 , -0.6243884 , ...,  2.0463567 ,
         2.0463567 ,  2.0463567 ],
       ...,
       [ 1.0690291 ,  1.098226  ,  1.098226  , ...,  1.3780135 ,
         1.3637935 ,  1.3922336 ],
       [ 1.0398322 ,  1.0398322 ,  1.0398322 , ...,  0.4110491 ,
         0.35416883,  0.35416883],
       [ 1.0544306 ,  1.1128243 ,  1.1128243 , ...,  0.31150854,
         0.31150854,  0.29728848]], dtype=float32), array([[-1.6170814, -1.6170814, -1.6170814, ..., -1.4375596, -1.4375596,
        -1.4375596],
       [-1.6170814, -1.6170814, -1.6170814, ..., -1.4517797, -1.4375596,
        -1.4091195],
       [-1.7338688, -1.7338688, -1.7338688, ..., -1.309579 , -1.309579 ,
        -1.309579 ],
       ...,
       [-1.018546 , -1.018546 , -1.018546 , ..., -1.1815984, -1.1815984,
        -1.1815984],
       [-1.0477428, -1.0477428, -1.0477428, ..., -1.1958185, -1.1815984,
        -1.1815984],
       [-1.0623412, -1.0623412, -1.0623412, ..., -1.2100385, -1.2100385,
        -1.2100385]], dtype=float32), None, None, array([[-1.500294 , -1.500294 , -1.5440893, ..., -1.0536178, -1.2384787,
        -1.3664593],
       [-1.4419003, -1.4419003, -1.3397113, ..., -1.309579 , -1.3380191,
        -1.3522393],
       [-1.6608766, -1.7630657, -1.6900735, ..., -1.0109575, -1.2384787,
        -1.1531583],
       ...,
       [-1.4419003, -1.4564987, -1.4564987, ..., -1.1815984, -1.1673783,
        -1.1531583],
       [-1.0623412, -1.0623412, -1.0769397, ..., -0.8545369, -0.882977 ,
        -0.9256371],
       [-1.3251129, -1.3397113, -1.3397113, ..., -1.1673783, -1.1531583,
        -1.1389382]], dtype=float32), None, None, array([[ 0.12013142,  0.16392669,  0.03254076, ..., -0.31417432,
        -0.31417432, -0.2857342 ],
       [ 0.2223204 ,  0.20772196,  0.30991095, ..., -0.243074  ,
        -0.21463387, -0.20041381],
       [ 0.07633615,  0.09093457,  0.10553299, ..., -0.32839438,
        -0.3710546 , -0.25729406],
       ...,
       [-0.37621516, -0.37621516, -0.43460885, ..., -0.8545369 ,
        -0.8403168 , -0.8403168 ],
       [-0.55139625, -0.60978997, -0.5805931 , ..., -1.0393977 ,
        -1.0393977 , -1.067838  ],
       [-0.24482933, -0.24482933, -0.33241987, ..., -0.96829736,
        -1.0109575 , -1.0393977 ]], dtype=float32), None, None, None, array([[-1.6608766, -1.6608766, -1.6608766, ..., -1.4091195, -1.4091195,
        -1.4091195],
       [-1.6608766, -1.6608766, -1.6608766, ..., -1.4659997, -1.4659997,
        -1.4802198],
       [-1.6608766, -1.6608766, -1.6608766, ..., -1.4091195, -1.4091195,
        -1.4091195],
       ...,
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4517797, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7922626, -1.7922626, ..., -1.4517797, -1.4659997,
        -1.4659997]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 22]]), None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man with a hat on riding his skateboard.\n', 'Find me an everyday image that matches the given caption: A window a white bunk bed and some shoes.\n', 'Find me an everyday image that matches the given caption: Variety of things sprawled on top of a newspaper.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Pizza with white sauce, tomato and basil on a plate.\n', 'Find me an everyday image that matches the given caption: Two very cute giraffes touching nose to nose.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two children are practicing on a tennis court.\n', 'Find me an everyday image that matches the given caption: A cutting board with a pizza on top and knife.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Night scene of a party outside showing man on a bike and a blender on the ground.\n', 'Find me an everyday image that matches the given caption: Various types of electronics equipment on a gray cloth.\n', 'Find me an everyday image that matches the given caption: A man standing at a urinal in the bathroom.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 40/6000 [01:24<3:21:03,  2.02s/it]                                                   {'loss': 4.5585, 'grad_norm': 609.8814697265625, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.01}
  1%|          | 40/6000 [01:24<3:21:03,  2.02s/it][2025-11-13 01:32:21,672] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,  16359,    624],
        [151643, 151643, 151643,  ...,    389,    432,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  24650,    624],
        [151643, 151643, 151643,  ...,  22174,   5795,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A couple of cows that are on the grass.\n', 'Find me an everyday image that matches the given caption: A small mexican style pizza with bacon and sour cream on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A green pool with at least 20 different stop lights on it.\n', 'Find me an everyday image that matches the given caption: Farm vehicles parked in front of a building.\n', 'Find me an everyday image that matches the given caption: A baseball player at bat with a catcher and umpire behind him and people watching from the stands.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man holding a white and red kite on beach.\n', 'Find me an everyday image that matches the given caption: A grey and a tan cat laying on a big piece of luggage.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young girl reaches her hand above an uncooked pepperoni pizza.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There are three buses parked behind a fence.\n', 'Find me an everyday image that matches the given caption: A person in a purple uniform and a person in a red uniform in front of a soccer goal.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272B5EFB0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x312 at 0x7F32727C6FB0>], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727B4CA0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F460>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C6DA0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C45E0>], [None], [None]], 'pixel_values': [None, None, array([[-1.3397113 , -1.3397113 , -1.3397113 , ...,  0.5816899 ,
         0.5816899 ,  0.5816899 ],
       [-1.3543098 , -1.3543098 , -1.3543098 , ...,  0.90875137,
         0.8376511 ,  0.7949909 ],
       [-1.3251129 , -1.3251129 , -1.3251129 , ...,  0.68123037,
         0.7381106 ,  0.7665507 ],
       ...,
       [-0.68278205, -0.72657734, -0.78497106, ...,  0.9798517 ,
         1.0936122 ,  1.1931527 ],
       [-0.09884507,  0.04713918,  0.29531252, ..., -0.58435565,
         0.68123037,  1.1220524 ],
       [ 0.61647785,  0.54348576,  0.4704936 , ...,  1.036732  ,
         1.1078323 ,  1.1220524 ]], dtype=float32), None, None, None, array([[1.3172023, 1.3318007, 1.3609976, ..., 1.8188357, 1.8188357,
        1.8046155],
       [1.5069818, 1.5361787, 1.5361787, ..., 1.8188357, 1.8188357,
        1.8188357],
       [1.4485881, 1.4485881, 1.4631865, ..., 1.8046155, 1.705075 ,
        1.7192951],
       ...,
       [1.5215802, 1.5361787, 1.5361787, ..., 1.8330555, 1.8188357,
        1.8188357],
       [1.5215802, 1.5215802, 1.5361787, ..., 1.8472759, 1.875716 ,
        1.8899357],
       [1.5361787, 1.5361787, 1.5361787, ..., 1.875716 , 1.9325962,
        1.9894764]], dtype=float32), None, None, array([[-0.96015227, -0.96015227, -0.96015227, ..., -0.51325524,
        -0.48481512, -0.48481512],
       [-0.49300256, -0.04045137,  0.0617376 , ..., -0.6981161 ,
        -0.74077636, -0.54169536],
       [-0.9163569 , -0.9163569 , -0.8141679 , ..., -0.38527465,
        -0.42793486, -0.38527465],
       ...,
       [-1.018546  , -1.0039475 , -0.9747507 , ..., -0.6270158 ,
        -0.669676  , -0.5985757 ],
       [-0.96015227, -0.9747507 , -0.96015227, ..., -0.669676  ,
        -0.6981161 , -0.6412359 ],
       [-1.018546  , -1.0331444 , -1.0331444 , ..., -0.669676  ,
        -0.7549964 , -0.81187665]], dtype=float32), None, array([[ 0.17852512, -0.2302309 ,  0.03254076, ..., -0.18619375,
        -0.05821316, -0.11509342],
       [ 0.20772196,  0.33910778,  0.54348576, ..., -0.14353354,
        -0.15775362, -0.18619375],
       [ 0.58728105,  0.71866685,  0.8062574 , ..., -0.32839438,
        -0.2857342 , -0.54169536],
       ...,
       [-0.68278205, -0.3470183 , -0.44920728, ..., -1.082058  ,
        -0.74077636, -0.8260967 ],
       [ 0.2807141 , -0.36161673, -0.08424664, ..., -1.4659997 ,
        -1.2526988 , -1.1673783 ],
       [-0.87256163, -0.8433648 , -0.8141679 , ...,  0.22618815,
         0.02710724, -0.243074  ]], dtype=float32), array([[1.1274228 , 1.1274228 , 1.1274228 , ..., 1.2215928 , 1.2215928 ,
        1.2215928 ],
       [1.1420212 , 1.1420212 , 1.1420212 , ..., 1.2073728 , 1.2073728 ,
        1.2073728 ],
       [1.2004149 , 1.2004149 , 1.2004149 , ..., 1.2500329 , 1.2500329 ,
        1.2500329 ],
       ...,
       [0.41209993, 0.3975015 , 0.38290307, ..., 0.19774802, 0.18352796,
        0.18352796],
       [0.3537062 , 0.33910778, 0.33910778, ..., 0.28306842, 0.25462827,
        0.25462827],
       [0.36830464, 0.36830464, 0.3537062 , ..., 0.14086775, 0.1266477 ,
        0.1266477 ]], dtype=float32), array([[ 0.03254076,  0.32450938,  0.5726826 , ...,  0.9798517 ,
         0.93719155,  0.85187113],
       [ 0.49969047,  0.48509204,  0.4558952 , ...,  1.5202142 ,
         1.5628744 ,  1.6197547 ],
       [-0.01125452,  0.17852512,  0.54348576, ...,  0.93719155,
         0.9940718 ,  0.9514116 ],
       ...,
       [-1.5878845 , -1.5294908 , -1.5148925 , ..., -0.42793486,
        -0.54169536, -0.68389606],
       [-0.8433648 , -0.7557742 , -0.5367978 , ...,  0.11242763,
         0.16930789,  0.28306842],
       [-0.6243884 , -0.5805931 , -0.5367978 , ...,  0.29728848,
         0.3257286 ,  0.4110491 ]], dtype=float32), None, None], 'image_grid_thw': [None, None, array([[ 1, 18, 18]]), None, None, None, array([[ 1, 22, 18]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A couple of cows that are on the grass.\n', 'Find me an everyday image that matches the given caption: A small mexican style pizza with bacon and sour cream on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A green pool with at least 20 different stop lights on it.\n', 'Find me an everyday image that matches the given caption: Farm vehicles parked in front of a building.\n', 'Find me an everyday image that matches the given caption: A baseball player at bat with a catcher and umpire behind him and people watching from the stands.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man holding a white and red kite on beach.\n', 'Find me an everyday image that matches the given caption: A grey and a tan cat laying on a big piece of luggage.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young girl reaches her hand above an uncooked pepperoni pizza.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There are three buses parked behind a fence.\n', 'Find me an everyday image that matches the given caption: A person in a purple uniform and a person in a red uniform in front of a soccer goal.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 41/6000 [01:26<3:18:05,  1.99s/it]                                                   {'loss': 3.6409, 'grad_norm': 908.76171875, 'learning_rate': 4.1e-06, 'epoch': 0.01}
  1%|          | 41/6000 [01:26<3:18:05,  1.99s/it][2025-11-13 01:32:23,597] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   3265,   5239,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   6176,  13638,    624],
        [151643, 151643, 151643,  ...,     88,  54872,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: A woman is holding up a cell phone that shows a person's nose in close-up.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man smiling holding up his purple tie.\n', "Find me an everyday image that matches the given caption: A woman's hands tying a belt around her waist.\n", "Find me an everyday image that matches the given caption: A bookshelf filled with books in front of a bed in a children's room.\n", 'Find me an everyday image that matches the given caption: A living room with toys on the floor and photographs on the walls.\n', 'Find me an everyday image that matches the given caption: Non-fried doughnuts in a Chinese bakery with English and Chinese signage.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small girl has a hot dog and a drink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A zebra standing next to a lush green forest.\n', 'Find me an everyday image that matches the given caption: A bunch of bananas on a leafy stalk.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C7430>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C4E20>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3274FEA650>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3274FE8700>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277EDD0>], [<PIL.Image.Image image mode=RGB size=427x256 at 0x7F327277EFB0>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327277ED40>], [None], [None]], 'pixel_values': [array([[-0.6973805 , -0.8141679 , -1.018546  , ..., -0.5985757 ,
        -0.5559154 , -0.4421549 ],
       [-0.11344349,  0.17852512, -0.18643562, ..., -0.51325524,
        -0.61279577, -0.68389606],
       [-0.28862458, -0.0550498 , -0.1718372 , ..., -0.6270158 ,
        -0.57013553, -0.48481512],
       ...,
       [-1.3251129 , -1.3397113 , -1.3397113 , ..., -1.3380191 ,
        -1.3522393 , -1.3380191 ],
       [-1.5586877 , -1.6024829 , -1.6316798 , ..., -1.2384787 ,
        -1.2811389 , -1.3380191 ],
       [-1.500294  , -1.4856956 , -1.4856956 , ..., -1.3380191 ,
        -1.3522393 , -1.3664593 ]], dtype=float32), None, array([[ 1.0690291 ,  1.0690291 ,  1.0690291 , ..., -0.29995427,
        -0.39949474, -0.4421549 ],
       [ 0.9814385 ,  0.791659  ,  0.791659  , ..., -0.2857342 ,
        -0.29995427, -0.4137148 ],
       [ 1.2442101 ,  1.1858164 ,  1.0836275 , ...,  1.2784731 ,
         1.2358129 ,  1.2073728 ],
       ...,
       [-0.02585294, -0.02585294, -0.01125452, ..., -0.6412359 ,
        -0.65545595, -0.65545595],
       [-0.5659947 , -0.5659947 , -0.5805931 , ..., -0.51325524,
        -0.5274753 , -0.54169536],
       [-0.6681836 , -0.6681836 , -0.68278205, ..., -0.68389606,
        -0.6981161 , -0.6981161 ]], dtype=float32), array([[ 0.30991095,  0.76246214,  1.6091708 , ...,  0.59590995,
         0.29728848,  0.88031125],
       [ 1.8427455 ,  1.9011393 ,  1.9303361 , ...,  2.117457  ,
         2.117457  ,  1.022512  ],
       [-0.5659947 , -0.7557742 , -0.87256163, ..., -0.5274753 ,
        -0.6412359 , -0.49903518],
       ...,
       [ 0.66027313,  0.58728105,  0.66027313, ..., -0.17197368,
        -0.12931348, -0.07243322],
       [ 1.1128243 ,  1.0544306 ,  0.85005265, ..., -0.57013553,
        -0.48481512, -0.49903518],
       [ 1.098226  ,  1.1274228 ,  1.1420212 , ..., -0.32839438,
        -0.4137148 , -0.5274753 ]], dtype=float32), None, None, None, None, None, array([[ 0.14932826,  0.07633615,  0.0617376 , ..., -0.96829736,
        -1.0251776 , -1.0536178 ],
       [ 0.6018794 ,  0.8062574 ,  0.76246214, ...,  1.5913146 ,
         1.705075  ,  1.5913146 ],
       [ 0.00334391,  0.01794233,  0.04713918, ..., -1.0251776 ,
        -0.9967375 , -1.082058  ],
       ...,
       [-1.1645303 , -1.2083255 , -1.193727  , ..., -1.0109575 ,
        -1.0393977 , -1.0536178 ],
       [-0.96015227, -0.94555384, -0.9309554 , ..., -0.91141707,
        -0.86875695, -0.91141707],
       [-1.0039475 , -0.9747507 , -1.0039475 , ..., -0.9398572 ,
        -0.9256371 , -0.89719707]], dtype=float32), array([[ 1.9011393 ,  1.9011393 ,  1.9011393 , ...,  2.117457  ,
         2.117457  ,  2.117457  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.103237  ,
         2.0463567 ,  2.0036962 ],
       [ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  0.7096705 ,
         0.38260898,  0.1266477 ],
       ...,
       [-1.5294908 , -1.5586877 , -1.6170814 , ..., -1.2669188 ,
        -1.2811389 , -1.2669188 ],
       [-1.0039475 , -1.0331444 , -1.1207349 , ..., -1.3380191 ,
        -1.3948994 , -1.3806794 ],
       [-0.6681836 , -0.5805931 , -0.50760096, ..., -1.1958185 ,
        -1.1958185 , -1.1389382 ]], dtype=float32), array([[ 0.71866685,  0.71866685,  0.71866685, ...,  0.22618815,
         0.16930789,  0.15508783],
       [ 0.29531252,  0.2807141 ,  0.2807141 , ..., -0.25729406,
        -0.32839438, -0.3710546 ],
       [ 0.5142889 ,  0.54348576,  0.5580842 , ...,  0.4537093 ,
         0.4537093 ,  0.4252692 ],
       ...,
       [ 1.0398322 ,  1.0544306 ,  1.1420212 , ..., -1.0109575 ,
        -1.0251776 , -1.0109575 ],
       [ 1.0106354 ,  0.99603695,  0.9814385 , ..., -1.0393977 ,
        -1.0393977 , -1.0393977 ],
       [ 0.9668401 ,  0.9668401 ,  0.9668401 , ..., -0.95407724,
        -0.96829736, -0.9967375 ]], dtype=float32), None, array([[-0.9309554 , -0.82876635, -0.68278205, ...,  0.11242763,
        -0.04399309, -0.14353354],
       [-0.5221994 , -0.42001042, -0.37621516, ..., -0.14353354,
         0.05554737,  0.0413273 ],
       [-1.0477428 , -0.9309554 , -0.7411758 , ...,  0.19774802,
        -0.04399309, -0.38527465],
       ...,
       [ 1.652966  ,  1.6675645 ,  1.6675645 , ...,  0.0839875 ,
         0.02710724, -0.17197368],
       [-0.68278205, -0.9309554 , -0.82876635, ..., -0.54169536,
        -0.45637497, -0.54169536],
       [-0.5659947 , -0.44920728, -0.43460885, ..., -0.4421549 ,
        -0.58435565, -0.5559154 ]], dtype=float32), None, None], 'image_grid_thw': [array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), None, None, None, None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 30]]), None, array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: A woman is holding up a cell phone that shows a person's nose in close-up.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man smiling holding up his purple tie.\n', "Find me an everyday image that matches the given caption: A woman's hands tying a belt around her waist.\n", "Find me an everyday image that matches the given caption: A bookshelf filled with books in front of a bed in a children's room.\n", 'Find me an everyday image that matches the given caption: A living room with toys on the floor and photographs on the walls.\n', 'Find me an everyday image that matches the given caption: Non-fried doughnuts in a Chinese bakery with English and Chinese signage.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small girl has a hot dog and a drink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A zebra standing next to a lush green forest.\n', 'Find me an everyday image that matches the given caption: A bunch of bananas on a leafy stalk.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 42/6000 [01:27<3:16:51,  1.98s/it]                                                   {'loss': 3.3586, 'grad_norm': 512.5773315429688, 'learning_rate': 4.2000000000000004e-06, 'epoch': 0.01}
  1%|          | 42/6000 [01:27<3:16:51,  1.98s/it][2025-11-13 01:32:25,548] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   4158,   2498,    624],
        [151643, 151643, 151643,  ...,    279,   2070,    624],
        ...,
        [151643, 151643, 151643,  ...,   6303,   3015,    624],
        [151643, 151643, 151643,  ...,    279,   4910,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two decorative, plastic, black flowers in a white stand.\n', 'Find me an everyday image that matches the given caption: A bunch of giraffes out on the field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two giraffes stand next to each other and look the same direction.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The two people are riding an elephant with an umbrella.\n', 'Find me an everyday image that matches the given caption: A large air-force plant sitting on a dirt field.\n', 'Find me an everyday image that matches the given caption: A child with a backpack underneath an umbrella.\n', 'Find me an everyday image that matches the given caption: A group of sail boats are lined up on the blue water.\n', 'Find me an everyday image that matches the given caption: A man moving on the skateboard on the ground.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727B71C0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727B6F50>], [None], [<PIL.Image.Image image mode=RGB size=307x256 at 0x7F32727B7910>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B5AB0>], [<PIL.Image.Image image mode=RGB size=325x256 at 0x7F32727B61A0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B6680>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B6800>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B6980>]], 'pixel_values': [array([[-1.0039475 , -1.018546  , -1.0477428 , ...,  1.5344343 ,
         1.5486543 ,  1.5486543 ],
       [-1.1791286 , -1.1791286 , -1.1645303 , ...,  1.5486543 ,
         1.5486543 ,  1.5486543 ],
       [-0.9309554 , -0.9309554 , -0.9309554 , ...,  1.5628744 ,
         1.5486543 ,  1.5628744 ],
       ...,
       [-1.2813176 , -1.3689082 , -1.3835065 , ..., -0.86875695,
        -0.86875695, -0.86875695],
       [-1.4127034 , -1.4273019 , -1.4419003 , ..., -0.6412359 ,
        -0.6981161 , -0.7265563 ],
       [-1.4127034 , -1.4127034 , -1.4273019 , ..., -0.9825174 ,
        -0.9967375 , -1.0109575 ]], dtype=float32), None, None, array([[-0.44920728, -0.5221994 , -0.5221994 , ..., -0.8403168 ,
        -0.8403168 , -0.8403168 ],
       [-0.4638057 , -0.43460885, -0.405412  , ..., -0.8403168 ,
        -0.8403168 , -0.8403168 ],
       [-0.5221994 , -0.5221994 , -0.50760096, ..., -0.89719707,
        -0.882977  , -0.8545369 ],
       ...,
       [-0.12804192, -0.15723877, -0.15723877, ...,  0.61013   ,
         0.59590995,  0.5816899 ],
       [ 0.42669836,  0.4558952 ,  0.4704936 , ...,  1.022512  ,
         0.9940718 ,  0.9798517 ],
       [ 0.38290307,  0.38290307,  0.36830464, ...,  1.0936122 ,
         1.0936122 ,  1.0936122 ]], dtype=float32), None, array([[ 1.1420212 ,  1.1420212 ,  1.1420212 , ...,  2.0036962 ,
         2.0036962 ,  2.0036962 ],
       [ 1.1566195 ,  1.1566195 ,  1.2004149 , ...,  2.0036962 ,
         2.0036962 ,  2.0179167 ],
       [ 1.1128243 ,  1.1128243 ,  1.1128243 , ...,  1.9325962 ,
         1.9325962 ,  1.9325962 ],
       ...,
       [-0.21563247, -0.18643562, -0.25942776, ..., -1.0393977 ,
        -0.882977  , -0.78343654],
       [-0.8579632 , -0.2740262 , -0.39081356, ..., -0.5274753 ,
        -0.38527465, -0.54169536],
       [-0.8579632 , -1.193727  , -1.1499318 , ..., -0.95407724,
        -0.5274753 , -0.22885394]], dtype=float32), array([[-0.9017585 , -0.8141679 , -0.7995695 , ..., -0.8545369 ,
        -0.7976566 , -0.74077636],
       [-0.7119789 , -0.7119789 , -0.8433648 , ..., -0.7549964 ,
        -0.86875695, -1.0109575 ],
       [-0.9017585 , -0.9163569 , -1.0039475 , ..., -0.8545369 ,
        -0.9825174 , -0.7976566 ],
       ...,
       [-0.24482933, -0.25942776, -0.303223  , ..., -0.35683453,
        -0.4421549 , -0.54169536],
       [-0.3470183 , -0.303223  , -0.2740262 , ..., -0.49903518,
        -0.51325524, -0.4137148 ],
       [-0.36161673, -0.37621516, -0.405412  , ..., -0.54169536,
        -0.49903518, -0.38527465]], dtype=float32), array([[ 1.273407  ,  1.2150133 ,  1.1566195 , ..., -1.4802198 ,
        -1.4802198 , -1.4375596 ],
       [ 1.0106354 ,  0.93764323,  0.95224166, ..., -1.4375596 ,
        -1.4659997 , -1.4659997 ],
       [ 1.1128243 ,  1.1274228 ,  1.171218  , ..., -1.4375596 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [ 0.42669836,  0.6018794 ,  1.0836275 , ...,  0.43948925,
         0.24040821,  0.16930789],
       [ 0.41209993,  0.6310763 ,  1.2150133 , ...,  0.29728848,
         0.33994877,  0.4110491 ],
       [ 1.5799739 ,  1.5215802 ,  1.5361787 , ...,  0.26884836,
         0.28306842,  0.28306842]], dtype=float32), array([[-0.24482933, -0.21563247, -0.1718372 , ...,  0.51058954,
         0.52480966,  0.5390297 ],
       [ 0.10553299,  0.12013142,  0.09093457, ...,  0.7096705 ,
         0.7381106 ,  0.75233066],
       [ 0.23691882,  0.25151724,  0.26611567, ...,  0.5532498 ,
         0.59590995,  0.6243501 ],
       ...,
       [-0.42001042, -0.65358526, -0.42001042, ..., -1.0536178 ,
        -0.9967375 , -0.9398572 ],
       [ 0.44129676,  0.29531252,  0.17852512, ...,  1.3922336 ,
         1.4206737 ,  1.3069133 ],
       [ 1.4339896 ,  1.1274228 ,  0.67487156, ..., -0.6270158 ,
        -0.58435565, -0.54169536]], dtype=float32), array([[-0.18643562, -0.31782144, -0.7703726 , ...,  0.4252692 ,
         0.4110491 ,  0.39682904],
       [-0.20103405,  0.00334391, -0.06964822, ...,  0.6243501 ,
         0.6527902 ,  0.6954504 ],
       [ 0.42669836,  0.42669836,  0.41209993, ...,  0.43948925,
         0.43948925,  0.46792936],
       ...,
       [-0.25942776, -0.31782144, -0.3470183 , ..., -1.1815984 ,
        -1.1958185 , -1.2242587 ],
       [-0.09884507, -0.08424664, -0.08424664, ..., -1.2100385 ,
        -1.1673783 , -1.067838  ],
       [-0.42001042, -0.44920728, -0.44920728, ..., -1.082058  ,
        -1.082058  , -1.067838  ]], dtype=float32), None, None, None, None, None, array([[-0.6681836 , -0.6681836 , -0.7703726 , ..., -0.39949474,
        -0.45637497, -0.45637497],
       [-1.3397113 , -1.4710971 , -1.4564987 , ..., -0.31417432,
        -0.243074  , -0.29995427],
       [-0.9017585 , -1.0039475 , -1.0331444 , ..., -0.5559154 ,
        -0.3710546 , -0.38527465],
       ...,
       [-1.0039475 , -1.0331444 , -1.0477428 , ..., -0.8545369 ,
        -0.7692165 , -0.7265563 ],
       [-0.94555384, -0.9893491 , -1.0331444 , ..., -0.669676  ,
        -0.71233624, -0.81187665],
       [-1.0915381 , -1.0623412 , -1.0331444 , ..., -0.9256371 ,
        -0.9256371 , -0.89719707]], dtype=float32)], 'image_grid_thw': [array([[ 1, 28, 18]]), None, None, array([[ 1, 18, 18]]), None, array([[ 1, 18, 22]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, None, None, None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two decorative, plastic, black flowers in a white stand.\n', 'Find me an everyday image that matches the given caption: A bunch of giraffes out on the field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two giraffes stand next to each other and look the same direction.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The two people are riding an elephant with an umbrella.\n', 'Find me an everyday image that matches the given caption: A large air-force plant sitting on a dirt field.\n', 'Find me an everyday image that matches the given caption: A child with a backpack underneath an umbrella.\n', 'Find me an everyday image that matches the given caption: A group of sail boats are lined up on the blue water.\n', 'Find me an everyday image that matches the given caption: A man moving on the skateboard on the ground.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 43/6000 [01:30<3:28:09,  2.10s/it]                                                   {'loss': 4.0508, 'grad_norm': 568.3474731445312, 'learning_rate': 4.3e-06, 'epoch': 0.01}
  1%|          | 43/6000 [01:30<3:28:09,  2.10s/it][2025-11-13 01:32:27,916] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    838,  10707,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   1045,   9331,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Skateboarder doing a trick at a skate-park competition.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baby with a bottle is sitting in the refrigerator.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A herd of elephants drinking water in the river.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black and white clock a street sign and some cars.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C7850>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C46A0>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327277F460>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F327277F970>], [<PIL.Image.Image image mode=RGB size=312x256 at 0x7F32727B4CA0>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F32727B42E0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B6D70>], [None], [<PIL.Image.Image image mode=RGB size=411x256 at 0x7F3272765450>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272764EE0>], [<PIL.Image.Image image mode=RGB size=426x256 at 0x7F3272766590>], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272765F30>], [None], [<PIL.Image.Image image mode=RGB size=394x256 at 0x7F3272766650>]], 'pixel_values': [array([[-1.2229239 , -1.2229239 , -1.2229239 , ...,  1.2358129 ,
         1.2358129 ,  1.2358129 ],
       [-1.2229239 , -1.2229239 , -1.2083255 , ...,  1.2358129 ,
         1.2500329 ,  1.2500329 ],
       [-1.1645303 , -1.1645303 , -1.1645303 , ...,  1.2784731 ,
         1.2784731 ,  1.2784731 ],
       ...,
       [-1.2229239 , -1.3251129 , -1.0039475 , ..., -0.96829736,
        -1.0251776 , -1.082058  ],
       [-0.82876635, -0.5805931 , -0.5659947 , ...,  0.28306842,
         0.33994877,  0.31150854],
       [-0.49300256, -0.42001042, -0.42001042, ...,  0.31150854,
         0.35416883,  0.39682904]], dtype=float32), array([[-0.8141679 , -0.82876635, -0.8579632 , ...,  0.9229715 ,
         1.3495734 ,  1.7761754 ],
       [ 0.48509204,  0.89384794,  1.2150133 , ...,  2.0605767 ,
         2.0890167 ,  1.7619553 ],
       [ 0.6310763 ,  0.5580842 ,  0.7478637 , ...,  0.52480966,
         0.52480966,  0.5816899 ],
       ...,
       [ 0.07633615,  0.07633615,  0.04713918, ..., -0.7549964 ,
        -0.7692165 , -0.7692165 ],
       [ 0.19312355,  0.17852512,  0.16392669, ..., -0.7692165 ,
        -0.78343654, -0.7976566 ],
       [-0.08424664, -0.12804192, -0.12804192, ..., -0.78343654,
        -0.78343654, -0.78343654]], dtype=float32), None, array([[-0.44920728, -0.4638057 , -0.47840413, ..., -0.51325524,
        -0.5274753 , -0.5274753 ],
       [-0.5221994 , -0.5221994 , -0.55139625, ..., -0.61279577,
        -0.6270158 , -0.6270158 ],
       [-0.42001042, -0.42001042, -0.42001042, ..., -0.49903518,
        -0.49903518, -0.51325524],
       ...,
       [-0.96015227, -0.96015227, -0.96015227, ..., -0.81187665,
        -0.8260967 , -0.8260967 ],
       [-0.49300256, -0.5367978 , -0.49300256, ...,  0.11242763,
         0.28306842,  0.26884836],
       [-1.0769397 , -1.1207349 , -1.0915381 , ..., -0.81187665,
        -0.7976566 , -0.78343654]], dtype=float32), array([[-1.0331444 , -0.7703726 ,  0.41209993, ...,  1.6481948 ,
         1.4491138 ,  1.4917741 ],
       [-0.15723877,  0.2807141 ,  0.44129676, ...,  1.2784731 ,
         1.3780135 ,  1.3637935 ],
       [-0.7557742 , -0.78497106, -0.8141679 , ..., -0.18619375,
        -0.18619375, -0.18619375],
       ...,
       [ 0.5580842 ,  0.5580842 ,  0.5580842 , ...,  0.28306842,
         0.28306842,  0.28306842],
       [ 0.42669836,  0.44129676,  0.42669836, ...,  0.4110491 ,
         0.4110491 ,  0.39682904],
       [ 0.5726826 ,  0.58728105,  0.5726826 , ...,  0.33994877,
         0.33994877,  0.33994877]], dtype=float32), array([[-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.65545595,
        -0.6270158 , -0.58435565],
       [-1.7922626 , -1.7922626 , -1.7630657 , ..., -0.48481512,
        -0.5559154 , -0.669676  ],
       [-0.49300256, -0.5221994 , -0.50760096, ..., -0.81187665,
        -0.7549964 , -0.669676  ],
       ...,
       [ 1.1858164 ,  1.2296118 ,  1.2150133 , ...,  0.48214942,
         0.52480966,  0.56746984],
       [ 0.9814385 ,  0.99603695,  1.0106354 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.9668401 ,  0.9668401 ,  0.95224166, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-1.0769397 , -1.0769397 , -1.0769397 , ..., -0.58435565,
        -0.58435565, -0.57013553],
       [-1.018546  , -1.0331444 , -1.018546  , ..., -0.51325524,
        -0.51325524, -0.51325524],
       [-1.0915381 , -1.1061366 , -1.1061366 , ..., -0.65545595,
        -0.65545595, -0.65545595],
       ...,
       [ 0.8208558 ,  0.8208558 ,  0.8208558 , ...,  1.3069133 ,
         1.1504925 ,  1.1078323 ],
       [ 0.42669836,  0.42669836,  0.41209993, ...,  1.3922336 ,
         1.3922336 ,  1.3922336 ],
       [ 0.42669836,  0.42669836,  0.42669836, ...,  1.4206737 ,
         1.3637935 ,  1.3637935 ]], dtype=float32), array([[-1.500294  , -1.1061366 , -1.3105145 , ..., -0.7549964 ,
        -0.07243322, -0.10087335],
       [ 1.7551551 ,  1.9303361 ,  1.9011393 , ..., -0.9825174 ,
        -1.1389382 , -1.1815984 ],
       [ 0.71866685,  0.66027313,  0.0617376 , ..., -1.1815984 ,
        -1.3237991 , -1.4802198 ],
       ...,
       [-1.6462783 , -1.6170814 , -1.6462783 , ..., -0.7549964 ,
        -0.81187665, -0.8545369 ],
       [-0.68278205, -0.72657734, -0.7995695 , ..., -0.7549964 ,
        -1.1673783 , -1.3948994 ],
       [-1.0477428 , -1.2959161 , -1.4564987 , ..., -1.2242587 ,
        -1.1815984 , -1.1247182 ]], dtype=float32), None, array([[ 1.9157377 ,  1.9157377 ,  1.9157377 , ..., -1.082058  ,
        -1.2953589 , -1.2526988 ],
       [ 1.9011393 ,  1.857344  ,  1.8865409 , ...,  0.38260898,
        -1.1531583 , -1.3522393 ],
       [-0.96015227, -0.94555384, -0.7703726 , ..., -0.74077636,
        -0.74077636, -0.95407724],
       ...,
       [-0.28862458, -0.37621516, -0.44920728, ..., -0.2857342 ,
        -0.32839438, -0.35683453],
       [-0.68278205, -0.6389868 , -0.60978997, ..., -0.14353354,
        -0.10087335, -0.12931348],
       [-0.5367978 , -0.5367978 , -0.5367978 , ..., -0.11509342,
        -0.14353354, -0.22885394]], dtype=float32), array([[1.8135487 , 1.8135487 , 1.6967614 , ..., 2.145897  , 2.145897  ,
        2.0890167 ],
       [1.857344  , 1.857344  , 1.8865409 , ..., 2.145897  , 2.145897  ,
        2.0890167 ],
       [1.5361787 , 1.3609976 , 1.3609976 , ..., 1.9894764 , 2.0890167 ,
        2.074797  ],
       ...,
       [0.8646511 , 0.8354542 , 0.8792495 , ..., 0.8945313 , 0.8376511 ,
        0.80921096],
       [0.68947   , 0.791659  , 0.8792495 , ..., 0.52480966, 0.6243501 ,
        0.6954504 ],
       [0.8208558 , 0.8208558 , 0.77706057, ..., 0.85187113, 0.8376511 ,
        0.8376511 ]], dtype=float32), array([[0.16392669, 0.16392669, 0.16392669, ..., 0.52480966, 0.52480966,
        0.52480966],
       [0.20772196, 0.20772196, 0.2223204 , ..., 0.56746984, 0.56746984,
        0.56746984],
       [0.2807141 , 0.2807141 , 0.2807141 , ..., 0.56746984, 0.56746984,
        0.5816899 ],
       ...,
       [1.2296118 , 1.2150133 , 1.2150133 , ..., 0.29728848, 0.25462827,
        0.25462827],
       [1.2880055 , 1.2880055 , 1.273407  , ..., 0.3257286 , 0.35416883,
        0.33994877],
       [1.2004149 , 1.1858164 , 1.1858164 , ..., 0.21196808, 0.16930789,
        0.16930789]], dtype=float32), None, array([[ 1.857344  ,  1.9303361 ,  1.857344  , ..., -0.45637497,
        -0.4421549 , -0.42793486],
       [ 1.9157377 ,  1.9303361 ,  1.9011393 , ..., -0.42793486,
        -0.42793486, -0.4421549 ],
       [ 1.9157377 ,  1.8865409 ,  1.8865409 , ...,  0.7665507 ,
         0.8376511 ,  0.90875137],
       ...,
       [-1.7776641 , -1.7776641 , -1.7776641 , ...,  2.0605767 ,
         2.145897  ,  2.103237  ],
       [-1.7922626 , -1.7922626 , -1.7776641 , ...,  2.0463567 ,
         2.0463567 ,  2.0321364 ],
       [-1.7922626 , -1.7776641 , -1.7776641 , ...,  1.9752562 ,
         1.9894764 ,  1.9325962 ]], dtype=float32), None, array([[-1.5294908 , -1.5440893 , -1.5586877 , ..., -1.4091195 ,
        -1.3948994 , -1.4091195 ],
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.2669188 ,
        -1.1815984 , -1.2100385 ],
       [-1.4710971 , -1.5294908 , -1.5294908 , ..., -1.4517797 ,
        -1.3522393 , -1.2669188 ],
       ...,
       [ 1.0252337 ,  1.0690291 ,  1.1128243 , ...,  0.4963695 ,
         0.4963695 ,  0.4963695 ],
       [ 0.66027313,  0.68947   ,  0.7332653 , ...,  0.51058954,
         0.51058954,  0.52480966],
       [ 0.49969047,  0.5142889 ,  0.52888733, ...,  0.24040821,
         0.25462827,  0.26884836]], dtype=float32)], 'image_grid_thw': [array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 22]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 30]]), array([[ 1, 18, 28]]), array([[ 1, 18, 30]]), None, array([[ 1, 18, 18]]), None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Skateboarder doing a trick at a skate-park competition.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baby with a bottle is sitting in the refrigerator.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A herd of elephants drinking water in the river.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black and white clock a street sign and some cars.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 44/6000 [01:32<3:29:04,  2.11s/it]                                                   {'loss': 3.4746, 'grad_norm': 886.4266967773438, 'learning_rate': 4.4e-06, 'epoch': 0.01}
  1%|          | 44/6000 [01:32<3:29:04,  2.11s/it][2025-11-13 01:32:30,042] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,  17951,    624],
        [151643, 151643, 151643,  ...,   5561,   3607,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A train passes under a waiting station for passengers.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman leaning up against the side of a building.\n', 'Find me an everyday image that matches the given caption: Small red plane flying next to motorcycle rider in urban area.\n', 'Find me an everyday image that matches the given caption: Baseball pitcher stands on mound in preparatory pose.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An old tower has two clocks on its facade.\n', 'Find me an everyday image that matches the given caption: A train traveling along a store line near the ocean.\n', 'Find me an everyday image that matches the given caption: A man with a bandanna on serving himself food.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=326x256 at 0x7F327277F8B0>], [<PIL.Image.Image image mode=RGB size=445x256 at 0x7F32727C53C0>], [<PIL.Image.Image image mode=RGB size=256x385 at 0x7F32727C45E0>], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727648B0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272767A90>], [<PIL.Image.Image image mode=RGB size=453x256 at 0x7F32727C4700>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=340x256 at 0x7F32727DA860>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8460>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x377 at 0x7F32727DAD40>]], 'pixel_values': [array([[-0.82876635, -0.72657734, -0.2302309 , ..., -1.4233395 ,
        -1.1958185 , -0.51325524],
       [-0.21563247, -0.12804192, -0.33241987, ..., -0.81187665,
        -0.8403168 , -0.8403168 ],
       [-1.193727  , -0.8579632 , -0.15723877, ..., -1.2526988 ,
        -1.2811389 , -1.1958185 ],
       ...,
       [ 0.41209993,  0.3975015 ,  0.38290307, ...,  1.1789327 ,
         1.1789327 ,  1.1931527 ],
       [ 1.1274228 ,  1.098226  ,  1.1128243 , ...,  1.3780135 ,
         1.4206737 ,  1.4491138 ],
       [ 1.0106354 ,  1.0398322 ,  1.0544306 , ...,  1.3922336 ,
         1.3922336 ,  1.3922336 ]], dtype=float32), array([[ 1.652966  ,  1.652966  ,  1.652966  , ...,  1.7192951 ,
         1.7192951 ,  1.7192951 ],
       [ 1.652966  ,  1.652966  ,  1.652966  , ...,  1.705075  ,
         1.705075  ,  1.705075  ],
       [ 1.477785  ,  1.5215802 ,  1.5945723 , ...,  1.6624149 ,
         1.5770944 ,  1.7903955 ],
       ...,
       [-1.4127034 , -1.398105  , -1.500294  , ..., -0.243074  ,
        -0.17197368, -0.32839438],
       [-0.5367978 , -0.55139625, -0.6389868 , ..., -1.1104981 ,
        -1.3948994 , -1.2526988 ],
       [-1.7338688 , -1.7192703 , -1.5878845 , ..., -0.12931348,
        -0.57013553, -0.4137148 ]], dtype=float32), array([[-0.39081356, -0.39081356, -0.37621516, ..., -0.32839438,
        -0.31417432, -0.31417432],
       [-0.28862458, -0.28862458, -0.2740262 , ..., -0.17197368,
        -0.14353354, -0.14353354],
       [-0.2740262 , -0.2740262 , -0.25942776, ..., -0.21463387,
        -0.20041381, -0.18619375],
       ...,
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, array([[-1.6024829 , -1.6024829 , -1.6024829 , ..., -1.1815984 ,
        -1.1247182 , -1.0962781 ],
       [-1.5878845 , -1.5878845 , -1.5732862 , ..., -1.0962781 ,
        -1.1104981 , -1.1104981 ],
       [-1.6608766 , -1.6462783 , -1.6462783 , ..., -1.3664593 ,
        -1.3664593 , -1.3664593 ],
       ...,
       [ 0.54348576,  0.49969047,  0.44129676, ..., -0.17197368,
        -0.18619375, -0.17197368],
       [ 0.32450938,  0.32450938,  0.32450938, ..., -0.2857342 ,
        -0.2857342 , -0.29995427],
       [ 0.29531252,  0.29531252,  0.29531252, ..., -0.34261447,
        -0.34261447, -0.32839438]], dtype=float32), array([[-0.39081356, -0.28862458, -0.36161673, ..., -0.6412359 ,
        -0.58435565, -0.51325524],
       [-0.33241987, -0.3470183 , -0.31782144, ..., -0.7549964 ,
        -0.6981161 , -0.5274753 ],
       [-0.9163569 , -0.88716006, -0.87256163, ...,  0.1266477 ,
         0.11242763,  0.0839875 ],
       ...,
       [ 0.36830464,  0.36830464,  0.36830464, ...,  0.56746984,
         0.52480966,  0.46792936],
       [ 0.3975015 ,  0.38290307,  0.36830464, ...,  0.63857013,
         0.6243501 ,  0.6243501 ],
       [ 0.36830464,  0.3975015 ,  0.3975015 , ...,  0.52480966,
         0.4963695 ,  0.4537093 ]], dtype=float32), array([[-0.60978997, -0.60978997, -0.60978997, ...,  0.16930789,
         0.16930789,  0.16930789],
       [-0.50760096, -0.49300256, -0.44920728, ...,  0.22618815,
         0.22618815,  0.24040821],
       [-0.50760096, -0.50760096, -0.50760096, ...,  0.26884836,
         0.25462827,  0.25462827],
       ...,
       [-1.5586877 , -0.9893491 , -0.24482933, ..., -0.9825174 ,
        -1.2526988 , -1.4375596 ],
       [-1.2083255 , -1.2375224 , -0.9747507 , ..., -1.4517797 ,
        -1.4802198 , -1.3380191 ],
       [-1.0769397 , -1.3835065 , -1.5878845 , ..., -1.4802198 ,
        -1.2384787 , -0.61279577]], dtype=float32), None, None, None, array([[-1.7922626, -1.7922626, -1.7922626, ..., -1.4659997, -1.4659997,
        -1.4517797],
       [-1.7630657, -1.7776641, -1.7630657, ..., -1.4659997, -1.4517797,
        -1.4091195],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       ...,
       [-1.0623412, -1.0915381, -1.1353334, ..., -1.1531583, -1.1815984,
        -1.2100385],
       [-1.1499318, -1.1645303, -1.1791286, ..., -1.2811389, -1.2953589,
        -1.2526988],
       [-1.1499318, -1.1499318, -1.1207349, ..., -1.3522393, -1.3522393,
        -1.3522393]], dtype=float32), array([[ 0.26611567,  0.12013142,  0.19312355, ..., -0.22885394,
        -0.243074  , -0.243074  ],
       [-1.3397113 , -1.3105145 , -1.2667192 , ..., -0.17197368,
        -0.25729406, -0.2857342 ],
       [ 0.33910778,  0.36830464,  0.36830464, ...,  0.14086775,
        -0.22885394, -0.54169536],
       ...,
       [ 1.8281472 ,  1.7259582 ,  1.6383677 , ...,  0.9940718 ,
         0.9798517 ,  0.96563166],
       [ 1.6967614 ,  1.6967614 ,  1.6967614 , ...,  1.0509521 ,
         1.036732  ,  1.036732  ],
       [ 1.652966  ,  1.6237692 ,  1.6383677 , ...,  1.0651721 ,
         1.0509521 ,  1.036732  ]], dtype=float32), None, None, None, array([[-1.7776641 , -1.7192703 , -1.6608766 , ..., -1.1531583 ,
        -1.2953589 , -1.2669188 ],
       [-1.6024829 , -1.6608766 , -1.7922626 , ..., -1.4659997 ,
        -1.4659997 , -1.4091195 ],
       [-1.7630657 , -1.7776641 , -1.6170814 , ..., -1.082058  ,
        -0.9825174 , -1.1247182 ],
       ...,
       [ 0.26611567,  0.26611567, -0.09884507, ..., -0.243074  ,
        -0.29995427, -0.39949474],
       [-0.31782144,  0.01794233,  0.20772196, ..., -0.32839438,
        -0.3710546 , -0.32839438],
       [ 0.0617376 , -0.02585294,  0.00334391, ..., -0.38527465,
        -0.35683453, -0.34261447]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 32]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 32]]), None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 26, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A train passes under a waiting station for passengers.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman leaning up against the side of a building.\n', 'Find me an everyday image that matches the given caption: Small red plane flying next to motorcycle rider in urban area.\n', 'Find me an everyday image that matches the given caption: Baseball pitcher stands on mound in preparatory pose.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An old tower has two clocks on its facade.\n', 'Find me an everyday image that matches the given caption: A train traveling along a store line near the ocean.\n', 'Find me an everyday image that matches the given caption: A man with a bandanna on serving himself food.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 45/6000 [01:34<3:26:38,  2.08s/it]                                                   {'loss': 3.3923, 'grad_norm': 365.0244445800781, 'learning_rate': 4.5e-06, 'epoch': 0.01}
  1%|          | 45/6000 [01:34<3:26:38,  2.08s/it][2025-11-13 01:32:32,068] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    304,    432,    624],
        [151643, 151643, 151643,  ...,   1045,  12711,    624],
        [151643, 151643, 151643,  ...,   6176,  10855,    624],
        ...,
        [151643, 151643, 151643,  ...,    304,  88255,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A wooden bowl with some fruit in it.\n', 'Find me an everyday image that matches the given caption: A kitchen with a lot counters and windows and some lights.\n', 'Find me an everyday image that matches the given caption: A little dog looks out the window of a green truck.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Three people using their laptop on a chair.\n', 'Find me an everyday image that matches the given caption: A man walking next to an elephant on a green field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A fire house with lots of fire trucks parked inside of it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Several sheep standing inside a fenced in pasture.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5DAE0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B190>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272B5EBC0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5D330>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF9A0>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272FAD120>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277DCF0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277F1F0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F327277ED40>]], 'pixel_values': [None, None, None, array([[-1.0623412 , -1.0769397 , -1.1353334 , ..., -0.42793486,
        -0.6412359 , -0.71233624],
       [-1.2521207 , -1.2083255 , -1.1207349 , ..., -1.1815984 ,
        -1.067838  , -0.89719707],
       [-1.0769397 , -1.0623412 , -1.0623412 , ...,  0.4110491 ,
         0.4537093 ,  0.4963695 ],
       ...,
       [-1.3105145 , -1.3105145 , -1.3105145 , ...,  0.48214942,
         0.48214942,  0.48214942],
       [-1.2959161 , -1.2813176 , -1.2667192 , ...,  0.4110491 ,
         0.4110491 ,  0.4110491 ],
       [-1.2959161 , -1.2959161 , -1.2959161 , ...,  0.35416883,
         0.31150854,  0.33994877]], dtype=float32), array([[-1.3105145 , -1.4127034 , -1.3543098 , ..., -1.4375596 ,
        -1.4233395 , -1.4091195 ],
       [-1.2229239 , -1.0623412 , -0.8579632 , ..., -1.3664593 ,
        -1.3522393 , -1.3522393 ],
       [-1.3689082 , -1.3835065 , -1.3835065 , ..., -1.4233395 ,
        -1.4659997 , -1.4802198 ],
       ...,
       [-1.1353334 , -1.1499318 , -1.1499318 , ..., -1.2526988 ,
        -1.3664593 , -1.3806794 ],
       [-0.9893491 , -0.9893491 , -0.9747507 , ..., -1.4375596 ,
        -1.2953589 , -1.3948994 ],
       [-0.72657734, -1.2375224 , -0.7995695 , ..., -1.1531583 ,
        -1.2100385 , -1.2669188 ]], dtype=float32), array([[-0.24482933, -0.24482933, -0.20103405, ..., -0.49903518,
        -0.54169536, -0.5559154 ],
       [ 0.52888733,  0.4704936 ,  0.49969047, ..., -0.6412359 ,
        -0.65545595, -0.65545595],
       [-0.20103405, -0.21563247, -0.20103405, ...,  0.75233066,
         0.7665507 ,  0.75233066],
       ...,
       [-1.0477428 , -1.1061366 , -1.2083255 , ..., -1.0536178 ,
        -1.067838  , -1.082058  ],
       [-0.47840413, -0.37621516, -0.31782144, ..., -1.0109575 ,
        -1.0109575 , -1.0109575 ],
       [-0.3470183 , -0.31782144, -0.37621516, ..., -1.082058  ,
        -1.082058  , -1.082058  ]], dtype=float32), array([[ 0.25151724,  0.23691882,  0.23691882, ...,  0.9514116 ,
         0.9514116 ,  0.96563166],
       [ 0.38290307,  0.3975015 ,  0.36830464, ...,  1.036732  ,
         1.0509521 ,  1.0509521 ],
       [ 0.2223204 ,  0.2223204 ,  0.20772196, ...,  0.90875137,
         0.90875137,  0.9229715 ],
       ...,
       [-0.24482933, -0.2740262 , -0.303223  , ..., -0.4137148 ,
        -0.39949474, -0.38527465],
       [-0.31782144, -0.25942776, -0.25942776, ..., -0.2857342 ,
        -0.243074  , -0.27151415],
       [-0.36161673, -0.3470183 , -0.3470183 , ..., -0.45637497,
        -0.51325524, -0.5274753 ]], dtype=float32), None, None, array([[-1.6462783 , -1.6462783 , -1.6316798 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.4856956 , -1.4710971 , -1.4856956 , ..., -1.3664593 ,
        -1.3664593 , -1.3664593 ],
       [-1.6462783 , -1.6462783 , -1.6462783 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       ...,
       [ 0.32450938,  0.2807141 ,  0.29531252, ..., -0.6412359 ,
        -0.68389606, -0.65545595],
       [ 0.32450938,  0.32450938,  0.32450938, ..., -0.5274753 ,
        -0.51325524, -0.49903518],
       [ 0.2807141 ,  0.2807141 ,  0.32450938, ..., -0.58435565,
        -0.6412359 , -0.65545595]], dtype=float32), array([[ 0.32450938,  0.4558952 ,  0.54348576, ..., -1.0536178 ,
        -1.067838  , -1.1104981 ],
       [ 0.66027313,  0.58728105,  0.42669836, ..., -1.1958185 ,
        -1.2242587 , -1.2242587 ],
       [ 0.3537062 ,  0.44129676,  0.5142889 , ..., -1.2669188 ,
        -1.0962781 , -1.0251776 ],
       ...,
       [ 1.0836275 ,  1.0252337 ,  0.9814385 , ..., -0.882977  ,
        -1.0109575 , -0.95407724],
       [-0.49300256, -0.96015227, -1.018546  , ..., -0.51325524,
        -0.4421549 , -0.35683453],
       [-1.0915381 , -1.0915381 , -1.0623412 , ..., -0.39949474,
        -0.3710546 , -0.42793486]], dtype=float32), None, array([[-1.0769397 , -1.1645303 , -1.1645303 , ..., -0.34261447,
        -0.81187665, -0.9825174 ],
       [-1.0623412 , -1.2959161 , -1.398105  , ..., -0.95407724,
        -1.0536178 , -1.0962781 ],
       [-1.2521207 , -1.2813176 , -0.82876635, ...,  0.16930789,
        -1.0536178 , -0.49903518],
       ...,
       [-1.3835065 , -1.2959161 , -1.2083255 , ..., -0.81187665,
        -0.81187665, -0.81187665],
       [-1.4564987 , -1.4710971 , -1.500294  , ..., -1.1104981 ,
        -1.0962781 , -1.082058  ],
       [-1.2959161 , -1.2083255 , -1.1207349 , ..., -0.7976566 ,
        -0.78343654, -0.7976566 ]], dtype=float32), None, array([[ 0.66027313,  0.66027313,  0.66027313, ...,  0.9798517 ,
         0.9798517 ,  0.9798517 ],
       [ 0.7478637 ,  0.7332653 ,  0.7478637 , ...,  0.9798517 ,
         0.9798517 ,  0.9798517 ],
       [ 0.67487156,  0.66027313,  0.6456747 , ...,  0.93719155,
         0.93719155,  0.93719155],
       ...,
       [-1.1207349 , -1.0915381 , -0.7995695 , ..., -1.2242587 ,
        -1.2669188 , -1.2953589 ],
       [-1.5732862 , -1.7922626 , -1.4273019 , ..., -1.4517797 ,
        -1.4517797 , -1.4091195 ],
       [-1.7922626 , -1.6024829 , -1.6754751 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ]], dtype=float32), array([[-0.42001042, -0.37621516, -0.01125452, ..., -0.95407724,
        -0.9825174 , -0.91141707],
       [-0.11344349, -0.15723877, -0.18643562, ..., -0.9825174 ,
        -1.1673783 , -1.3806794 ],
       [-0.72657734, -0.59519154, -0.21563247, ..., -1.0962781 ,
        -1.2384787 , -0.9256371 ],
       ...,
       [ 0.4558952 ,  0.3537062 ,  0.26611567, ...,  0.0839875 ,
         0.09820756, -0.12931348],
       [-0.24482933,  0.3537062 ,  0.5142889 , ...,  0.02710724,
         0.14086775, -0.12931348],
       [ 0.38290307,  0.3975015 ,  0.32450938, ...,  0.36838892,
         0.1266477 ,  0.18352796]], dtype=float32)], 'image_grid_thw': [None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A wooden bowl with some fruit in it.\n', 'Find me an everyday image that matches the given caption: A kitchen with a lot counters and windows and some lights.\n', 'Find me an everyday image that matches the given caption: A little dog looks out the window of a green truck.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Three people using their laptop on a chair.\n', 'Find me an everyday image that matches the given caption: A man walking next to an elephant on a green field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A fire house with lots of fire trucks parked inside of it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Several sheep standing inside a fenced in pasture.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 46/6000 [01:36<3:26:17,  2.08s/it]                                                   {'loss': 3.201, 'grad_norm': 231.3098602294922, 'learning_rate': 4.600000000000001e-06, 'epoch': 0.01}
  1%|          | 46/6000 [01:36<3:26:17,  2.08s/it][2025-11-13 01:32:34,146] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  22502,  15983,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  89773,  13638,    624],
        ...,
        [151643, 151643, 151643,  ...,   8592,   1841,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,   4910,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A woman smiles above an enormous pizza slice.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A boy is about to walk into the snowy forest.\n', 'Find me an everyday image that matches the given caption: A couple of beautiful women walking down street holding umbrellas.\n', 'Find me an everyday image that matches the given caption: A twin bed in a bedroom with all white walls.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A beautiful woman in a wedding dress cutting cake with her husband.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A very cute cat laying in a very small sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman stands under an umbrella near a street sign.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A single-edged knife with a black handle lying on the ground.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C7430>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C6E00>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327278A7A0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272788E80>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727D9660>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DB160>], [None], [<PIL.Image.Image image mode=RGB size=326x256 at 0x7F32727D9FC0>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DAD70>], [None]], 'pixel_values': [None, array([[-1.7338688 , -1.7776641 , -1.7630657 , ..., -1.0251776 ,
        -1.0109575 , -1.082058  ],
       [-1.3543098 , -1.3397113 , -1.6316798 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7338688 , -1.7922626 , -1.7776641 , ..., -1.0251776 ,
        -1.0109575 , -1.0109575 ],
       ...,
       [ 0.12013142,  0.12013142,  0.20772196, ...,  0.24040821,
         0.18352796,  0.1266477 ],
       [-0.11344349, -0.28862458, -0.37621516, ...,  0.9940718 ,
         1.036732  ,  1.0082918 ],
       [ 0.3975015 ,  0.4558952 ,  0.33910778, ...,  0.18352796,
        -0.10087335, -0.42793486]], dtype=float32), None, None, None, array([[ 1.0252337 ,  1.0252337 ,  1.0252337 , ...,  0.59590995,
         0.06976743, -0.29995427],
       [ 1.0398322 ,  1.0544306 ,  1.0690291 , ..., -0.5559154 ,
        -0.61279577, -0.68389606],
       [ 1.0252337 ,  1.0398322 ,  1.0690291 , ..., -0.74077636,
        -0.7976566 , -0.89719707],
       ...,
       [-1.6754751 , -1.6608766 , -1.6608766 , ..., -1.0393977 ,
        -1.0393977 , -1.0536178 ],
       [-1.7192703 , -1.7192703 , -1.7192703 , ..., -1.3664593 ,
        -1.3664593 , -1.3664593 ],
       [-1.6754751 , -1.6608766 , -1.6316798 , ..., -1.3237991 ,
        -1.309579  , -1.2953589 ]], dtype=float32), array([[-0.8141679 , -0.47840413,  0.03254076, ...,  1.3922336 ,
         1.4064537 ,  1.4348938 ],
       [ 1.3026038 ,  1.2880055 ,  1.3463992 , ...,  1.2784731 ,
         1.2500329 ,  1.2073728 ],
       [ 1.098226  ,  1.1274228 ,  1.1420212 , ...,  1.3922336 ,
         1.4348938 ,  1.4348938 ],
       ...,
       [ 0.6456747 ,  0.61647785,  0.52888733, ..., -1.1104981 ,
        -1.0962781 , -1.1247182 ],
       [ 0.4558952 ,  0.48509204,  0.4704936 , ..., -1.1389382 ,
        -1.1815984 , -1.1247182 ],
       [ 0.5580842 ,  0.54348576,  0.58728105, ..., -1.1531583 ,
        -1.1389382 , -1.1673783 ]], dtype=float32), array([[-0.6973805 , -0.6973805 , -0.6973805 , ..., -0.34261447,
        -0.32839438, -0.31417432],
       [-0.6389868 , -0.6389868 , -0.6243884 , ..., -0.29995427,
        -0.29995427, -0.29995427],
       [-0.5659947 , -0.5659947 , -0.5659947 , ..., -0.15775362,
        -0.14353354, -0.14353354],
       ...,
       [-1.4856956 , -1.5586877 , -1.6462783 , ..., -1.4517797 ,
        -1.4375596 , -1.4233395 ],
       [-1.5294908 , -1.5294908 , -1.5294908 , ..., -1.4802198 ,
        -1.4375596 , -1.4375596 ],
       [-1.5732862 , -1.5878845 , -1.6024829 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ]], dtype=float32), array([[ 1.8719424 ,  1.8719424 ,  1.8719424 , ..., -0.86875695,
        -0.74077636, -0.669676  ],
       [ 1.857344  ,  1.857344  ,  1.8719424 , ..., -0.51325524,
        -0.5274753 , -0.48481512],
       [ 1.857344  ,  1.857344  ,  1.857344  , ..., -0.4137148 ,
        -0.48481512, -0.49903518],
       ...,
       [-0.87256163, -0.9163569 , -0.8433648 , ...,  1.6339747 ,
         1.6197547 ,  1.6197547 ],
       [-1.193727  , -1.0769397 , -0.9893491 , ...,  1.6766349 ,
         1.6339747 ,  1.6197547 ],
       [-0.9017585 , -1.0623412 , -0.9893491 , ...,  1.6624149 ,
         1.690855  ,  1.690855  ]], dtype=float32), None, array([[-0.20103405, -0.42001042,  0.07633615, ...,  0.6243501 ,
         0.72389054,  0.7949909 ],
       [ 0.6018794 ,  0.66027313,  0.61647785, ...,  0.52480966,
         0.48214942,  0.43948925],
       [ 0.71866685,  0.6456747 ,  0.76246214, ...,  0.8376511 ,
         0.80921096,  0.7807708 ],
       ...,
       [ 0.8062574 ,  0.791659  ,  0.89384794, ...,  1.1504925 ,
         1.1220524 ,  1.1362724 ],
       [-1.6024829 , -1.6754751 , -1.6608766 , ...,  0.06976743,
         0.0839875 ,  0.06976743],
       [ 0.6310763 ,  1.3463992 ,  1.7405566 , ...,  0.16930789,
         0.19774802,  0.19774802]], dtype=float32), None, array([[-0.50760096, -0.50760096, -0.50760096, ..., -0.27151415,
        -0.2857342 , -0.2857342 ],
       [-0.47840413, -0.44920728, -0.405412  , ..., -0.29995427,
        -0.29995427, -0.31417432],
       [-0.42001042, -0.43460885, -0.44920728, ..., -0.22885394,
        -0.243074  , -0.243074  ],
       ...,
       [-1.2229239 , -1.2229239 , -1.2229239 , ..., -1.2100385 ,
        -1.1531583 , -1.1389382 ],
       [-1.3251129 , -1.2959161 , -1.2959161 , ..., -1.1815984 ,
        -1.1531583 , -1.1389382 ],
       [-1.2813176 , -1.2959161 , -1.3105145 , ..., -1.1389382 ,
        -1.1247182 , -1.1389382 ]], dtype=float32), None, array([[ 0.30991095,  0.3975015 ,  0.41209993, ..., -0.04399309,
        -0.14353354, -0.3710546 ],
       [ 0.41209993,  0.41209993,  0.52888733, ..., -0.39949474,
        -0.02977302,  0.01288717],
       [ 0.58728105, -0.0550498 , -0.2302309 , ..., -1.1247182 ,
        -0.9967375 , -1.082058  ],
       ...,
       [-1.2229239 , -1.2083255 , -1.1791286 , ...,  1.1789327 ,
         1.3495734 ,  1.2784731 ],
       [ 0.01794233, -0.09884507, -0.20103405, ..., -1.4233395 ,
        -1.3806794 , -1.4375596 ],
       [-1.1791286 , -1.2667192 , -1.193727  , ...,  1.0936122 ,
         1.1078323 ,  1.1789327 ]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 18]]), None, array([[ 1, 24, 18]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A woman smiles above an enormous pizza slice.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A boy is about to walk into the snowy forest.\n', 'Find me an everyday image that matches the given caption: A couple of beautiful women walking down street holding umbrellas.\n', 'Find me an everyday image that matches the given caption: A twin bed in a bedroom with all white walls.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A beautiful woman in a wedding dress cutting cake with her husband.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A very cute cat laying in a very small sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman stands under an umbrella near a street sign.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A single-edged knife with a black handle lying on the ground.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 47/6000 [01:38<3:30:14,  2.12s/it]                                                   {'loss': 3.4353, 'grad_norm': 262.4537658691406, 'learning_rate': 4.7e-06, 'epoch': 0.01}
  1%|          | 47/6000 [01:38<3:30:14,  2.12s/it][2025-11-13 01:32:36,370] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  19309,    624],
        ...,
        [151643, 151643, 151643,  ...,    315,  70653,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  73549,   6556,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A boy peeling a carrot over a sink.\n', 'Find me an everyday image that matches the given caption: A man is holding a video game steering wheel.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A very pretty red boat on some calm water.\n', 'Find me an everyday image that matches the given caption: A red and grey fire hydrant by the snow.\n', 'Find me an everyday image that matches the given caption: Two open-roofed bus for sightseeing tours stops on the road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A meal with meat, vegetables and rice.\n', 'Find me an everyday image that matches the given caption: This "No Parking" sign can\'t possibly be missed.\n', 'Find me an everyday image that matches the given caption: A group of people riding on the backs of motorcycles.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The Route 41 bus makes its rounds on a cloudy morning.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B6800>], [<PIL.Image.Image image mode=RGB size=342x256 at 0x7F3272F27760>], [None], [None], [<PIL.Image.Image image mode=RGB size=360x256 at 0x7F3274FEA650>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB9A0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x314 at 0x7F32727DB040>], [<PIL.Image.Image image mode=RGB size=367x256 at 0x7F32727DAD40>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=319x256 at 0x7F32727DA1A0>], [None]], 'pixel_values': [array([[-0.6389868 , -0.96015227, -0.7557742 , ..., -0.35683453,
        -0.5985757 , -0.39949474],
       [-0.87256163, -0.59519154, -0.8433648 , ..., -0.02977302,
        -0.31417432, -0.48481512],
       [ 0.13472985,  0.19312355, -0.25942776, ..., -0.7692165 ,
        -0.45637497, -0.15775362],
       ...,
       [-0.50760096, -0.31782144,  0.29531252, ..., -0.39949474,
        -0.243074  , -0.42793486],
       [ 0.0617376 ,  0.44129676,  0.32450938, ..., -1.0393977 ,
        -1.0109575 , -1.0536178 ],
       [ 0.33910778,  0.32450938,  0.33910778, ..., -0.32839438,
        -1.067838  , -0.61279577]], dtype=float32), array([[ 1.4047928 ,  1.4193913 ,  1.4193913 , ...,  1.9468161 ,
         1.9468161 ,  1.9468161 ],
       [ 1.5215802 ,  1.5361787 ,  1.5215802 , ...,  1.7192951 ,
         1.7192951 ,  1.7335151 ],
       [ 1.7259582 ,  1.7259582 ,  1.7259582 , ...,  1.6766349 ,
         1.690855  ,  1.705075  ],
       ...,
       [-0.88716006, -0.9309554 , -0.94555384, ..., -0.74077636,
        -0.74077636, -0.68389606],
       [-0.9017585 , -0.88716006, -0.88716006, ..., -0.61279577,
        -0.65545595, -0.6981161 ],
       [-0.9163569 , -0.9163569 , -0.94555384, ..., -0.8403168 ,
        -0.8545369 , -0.91141707]], dtype=float32), None, None, array([[-1.3689082 , -1.3543098 , -1.3689082 , ..., -0.6270158 ,
        -0.74077636, -0.8260967 ],
       [-0.8579632 , -0.7557742 , -0.59519154, ..., -0.89719707,
        -0.9967375 , -1.0962781 ],
       [-0.9893491 , -1.018546  , -1.0331444 , ..., -0.81187665,
        -0.8260967 , -0.9825174 ],
       ...,
       [-1.4419003 , -1.4127034 , -1.3835065 , ..., -0.89719707,
        -0.9256371 , -0.9256371 ],
       [ 0.41209993,  0.48509204,  0.44129676, ..., -0.38527465,
        -0.61279577, -0.6412359 ],
       [ 0.7332653 ,  0.8062574 ,  0.77706057, ...,  0.14086775,
         0.15508783,  0.15508783]], dtype=float32), array([[-0.12804192, -0.11344349, -0.08424664, ...,  0.8945313 ,
         0.88031125,  0.8660912 ],
       [-0.12804192, -0.15723877, -0.25942776, ...,  0.80921096,
         0.823431  ,  0.8376511 ],
       [-0.15723877, -0.1718372 , -0.1718372 , ...,  1.0793922 ,
         1.0793922 ,  1.0793922 ],
       ...,
       [-0.20103405, -0.2302309 , -0.21563247, ...,  0.02710724,
         0.02710724,  0.02710724],
       [-0.09884507, -0.11344349, -0.12804192, ..., -0.2857342 ,
        -0.2857342 , -0.29995427],
       [-0.11344349, -0.14264035, -0.14264035, ..., -0.29995427,
        -0.31417432, -0.31417432]], dtype=float32), None, None, None, array([[-0.18643562, -0.14264035,  0.89384794, ..., -1.3664593 ,
        -1.4233395 , -1.309579  ],
       [-1.6754751 , -1.7338688 , -1.6900735 , ..., -1.3664593 ,
        -1.4091195 , -1.4233395 ],
       [-1.0915381 , -0.37621516, -0.37621516, ...,  0.16930789,
        -0.6270158 , -1.3948994 ],
       ...,
       [-1.5440893 , -1.5732862 , -1.6170814 , ...,  0.24040821,
         0.29728848,  0.29728848],
       [ 1.4631865 ,  1.4485881 ,  1.3755959 , ...,  0.25462827,
         0.24040821,  0.21196808],
       [-0.59519154, -0.55139625, -0.47840413, ...,  0.24040821,
         0.24040821,  0.25462827]], dtype=float32), array([[-1.7484672 , -1.7338688 , -1.7338688 , ...,  1.2500329 ,
         1.3069133 ,  1.3353534 ],
       [-1.7338688 , -1.7922626 , -1.7484672 , ...,  0.9940718 ,
         0.9229715 ,  0.9229715 ],
       [-0.04045137,  0.13472985,  0.3975015 , ...,  0.05554737,
        -0.17197368, -0.27151415],
       ...,
       [ 0.23691882,  0.30991095,  0.38290307, ...,  0.63857013,
         0.61013   ,  0.5816899 ],
       [ 0.44129676,  0.42669836,  0.3537062 , ...,  0.63857013,
         0.4252692 ,  0.35416883],
       [ 0.13472985,  0.17852512,  0.16392669, ...,  0.4537093 ,
         0.43948925,  0.29728848]], dtype=float32), None, None, None, array([[-1.0331444 , -1.018546  , -1.018546  , ..., -1.4233395 ,
        -1.4375596 , -1.4517797 ],
       [-0.8579632 , -0.82876635, -0.7995695 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.1645303 , -1.1645303 , -1.1645303 , ..., -1.4375596 ,
        -1.4517797 , -1.4802198 ],
       ...,
       [-1.2667192 , -1.4564987 , -1.500294  , ..., -1.0109575 ,
        -0.9256371 , -0.89719707],
       [-1.4564987 , -1.3397113 , -1.2667192 , ..., -0.78343654,
        -0.6412359 , -0.7692165 ],
       [-1.5294908 , -1.5148925 , -1.5294908 , ..., -1.0251776 ,
        -1.0251776 , -1.0109575 ]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 26]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 22, 18]]), array([[ 1, 18, 26]]), None, None, None, array([[ 1, 18, 22]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A boy peeling a carrot over a sink.\n', 'Find me an everyday image that matches the given caption: A man is holding a video game steering wheel.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A very pretty red boat on some calm water.\n', 'Find me an everyday image that matches the given caption: A red and grey fire hydrant by the snow.\n', 'Find me an everyday image that matches the given caption: Two open-roofed bus for sightseeing tours stops on the road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A meal with meat, vegetables and rice.\n', 'Find me an everyday image that matches the given caption: This "No Parking" sign can\'t possibly be missed.\n', 'Find me an everyday image that matches the given caption: A group of people riding on the backs of motorcycles.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The Route 41 bus makes its rounds on a cloudy morning.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 48/6000 [01:40<3:27:32,  2.09s/it]                                                   {'loss': 3.2466, 'grad_norm': 720.4677124023438, 'learning_rate': 4.800000000000001e-06, 'epoch': 0.01}
  1%|          | 48/6000 [01:40<3:27:32,  2.09s/it][2025-11-13 01:32:38,382] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  29388,    432,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two little sheep are on a grassy field.\n', "Find me an everyday image that matches the given caption: A very tall clock tower with a clock on each of it's visible sides.\n", 'Find me an everyday image that matches the given caption: Two zebras in an open field with grass.\n', 'Find me an everyday image that matches the given caption: The yellow fire hydrant is on the curb as cars pass by.\n', 'Find me an everyday image that matches the given caption: Two hands are holding a cellphone and typing.\n', 'Find me an everyday image that matches the given caption: A plane flying through a clear blue sky.\n', 'Find me an everyday image that matches the given caption: A banana, almonds, yogurt and chocolate pudding by a blender.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plate with a dessert cake and some fruit beside it.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=342x256 at 0x7F3272765450>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBF70>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DBFA0>], [None], [None], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x339 at 0x7F32727DB640>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DAF50>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D92D0>], [<PIL.Image.Image image mode=RGB size=357x256 at 0x7F32727D82B0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727B61A0>], [None]], 'pixel_values': [array([[ 0.2223204 ,  0.2223204 ,  0.23691882, ..., -0.243074  ,
        -0.20041381, -0.20041381],
       [ 0.36830464,  0.3537062 ,  0.32450938, ..., -0.18619375,
        -0.20041381, -0.18619375],
       [ 0.30991095,  0.30991095,  0.32450938, ..., -0.22885394,
        -0.20041381, -0.18619375],
       ...,
       [-0.8579632 , -0.8433648 , -0.78497106, ..., -1.1531583 ,
        -1.1247182 , -1.1247182 ],
       [-0.8141679 , -0.8141679 , -0.8141679 , ..., -1.1958185 ,
        -1.2100385 , -1.2100385 ],
       [-0.6973805 , -0.6973805 , -0.7119789 , ..., -1.1958185 ,
        -1.1958185 , -1.1815984 ]], dtype=float32), array([[-1.5148925 , -1.5294908 , -1.5440893 , ..., -1.1673783 ,
        -1.1531583 , -1.1389382 ],
       [-1.4710971 , -1.4710971 , -1.4710971 , ..., -1.2100385 ,
        -1.1958185 , -1.1673783 ],
       [-1.398105  , -1.4127034 , -1.4273019 , ..., -1.1958185 ,
        -1.1815984 , -1.1815984 ],
       ...,
       [-0.33241987, -0.37621516, -0.37621516, ..., -0.20041381,
        -0.243074  , -0.21463387],
       [-0.303223  , -0.303223  , -0.303223  , ..., -0.31417432,
        -0.32839438, -0.32839438],
       [-0.303223  , -0.303223  , -0.303223  , ..., -0.2857342 ,
        -0.29995427, -0.29995427]], dtype=float32), array([[ 0.16392669,  0.16392669,  0.16392669, ...,  1.036732  ,
         1.036732  ,  1.0509521 ],
       [ 0.25151724,  0.25151724,  0.25151724, ...,  1.0651721 ,
         1.0651721 ,  1.0651721 ],
       [ 0.19312355,  0.19312355,  0.19312355, ...,  0.96563166,
         0.96563166,  0.96563166],
       ...,
       [ 0.49969047,  0.48509204,  0.49969047, ..., -1.0109575 ,
        -0.95407724, -0.95407724],
       [ 0.44129676,  0.42669836,  0.41209993, ..., -0.51325524,
        -0.5274753 , -0.49903518],
       [ 0.41209993,  0.38290307,  0.3537062 , ..., -0.6270158 ,
        -0.5985757 , -0.57013553]], dtype=float32), None, None, None, None, None, None, None, array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4659997 ,
        -1.4659997 , -1.4517797 ],
       ...,
       [-0.65358526, -0.72657734, -0.78497106, ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ],
       [-0.50760096, -0.5221994 , -0.5659947 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.4127034 , -1.500294  , -1.5586877 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[ 0.4704936 ,  0.5142889 ,  0.61647785, ..., -0.20041381,
        -0.32839438, -0.42793486],
       [ 0.41209993,  0.36830464,  0.4704936 , ..., -0.15775362,
        -0.12931348, -0.17197368],
       [-0.20103405,  0.03254076, -0.01125452, ..., -0.8260967 ,
        -0.48481512, -0.34261447],
       ...,
       [-0.09884507, -0.0550498 , -0.01125452, ..., -0.47059506,
        -0.47059506, -0.48481512],
       [ 0.4704936 ,  0.44129676,  0.49969047, ..., -0.669676  ,
        -0.6412359 , -0.5559154 ],
       [ 0.6456747 ,  0.4704936 ,  0.4704936 , ..., -0.3710546 ,
        -0.3710546 , -0.71233624]], dtype=float32), array([[-0.8141679 , -0.7557742 , -0.6681836 , ..., -0.2857342 ,
        -0.22885394, -0.18619375],
       [-0.5221994 , -0.5221994 , -0.33241987, ...,  0.5816899 ,
         0.46792936,  0.46792936],
       [-0.7703726 , -0.7411758 , -0.6973805 , ..., -0.07243322,
         0.01288717, -0.04399309],
       ...,
       [ 0.07633615,  0.09093457,  0.09093457, ..., -0.38527465,
        -0.39949474, -0.4137148 ],
       [ 0.0617376 ,  0.04713918,  0.03254076, ..., -0.5985757 ,
        -0.5559154 , -0.5274753 ],
       [ 0.0617376 ,  0.01794233,  0.01794233, ..., -0.71233624,
        -0.7265563 , -0.7549964 ]], dtype=float32), array([[-0.5659947 , -0.7119789 , -0.88716006, ..., -0.47059506,
        -0.29995427, -0.3710546 ],
       [ 0.17852512,  0.03254076,  0.03254076, ...,  0.29728848,
         0.09820756, -0.15775362],
       [-0.08424664,  0.19312355,  0.07633615, ..., -0.882977  ,
        -0.86875695, -0.7692165 ],
       ...,
       [-0.20103405, -0.24482933, -0.2302309 , ..., -0.243074  ,
        -0.20041381, -0.21463387],
       [ 0.0617376 ,  0.07633615,  0.14932826, ...,  0.14086775,
         0.16930789, -0.00133289],
       [-0.25942776, -0.50760096, -0.2740262 , ...,  0.05554737,
         0.09820756,  0.11242763]], dtype=float32), array([[ 1.2004149 ,  1.2442101 ,  1.2150133 , ...,  0.6527902 ,
         0.6243501 ,  0.93719155],
       [ 0.01794233,  0.0617376 ,  0.0617376 , ...,  1.0509521 ,
         1.690855  ,  1.7619553 ],
       [ 0.2223204 ,  1.098226  ,  0.9814385 , ..., -0.9967375 ,
        -1.2242587 , -1.1531583 ],
       ...,
       [ 0.8646511 ,  0.8208558 ,  0.791659  , ...,  0.88031125,
         0.85187113,  0.85187113],
       [ 0.6456747 ,  0.66027313,  0.6018794 , ...,  0.96563166,
         0.9798517 ,  0.96563166],
       [ 0.6018794 ,  0.5580842 ,  0.49969047, ...,  0.8376511 ,
         0.7949909 ,  0.68123037]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, None, None, None, None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two little sheep are on a grassy field.\n', "Find me an everyday image that matches the given caption: A very tall clock tower with a clock on each of it's visible sides.\n", 'Find me an everyday image that matches the given caption: Two zebras in an open field with grass.\n', 'Find me an everyday image that matches the given caption: The yellow fire hydrant is on the curb as cars pass by.\n', 'Find me an everyday image that matches the given caption: Two hands are holding a cellphone and typing.\n', 'Find me an everyday image that matches the given caption: A plane flying through a clear blue sky.\n', 'Find me an everyday image that matches the given caption: A banana, almonds, yogurt and chocolate pudding by a blender.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plate with a dessert cake and some fruit beside it.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 49/6000 [01:42<3:24:44,  2.06s/it]                                                   {'loss': 3.1596, 'grad_norm': 208.25753784179688, 'learning_rate': 4.9000000000000005e-06, 'epoch': 0.01}
  1%|          | 49/6000 [01:42<3:24:44,  2.06s/it][2025-11-13 01:32:40,391] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,  11321,    624],
        [151643, 151643, 151643,  ...,    279,  24650,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  89773,   7329,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A small airplane is flying over the shore of a beach.\n', 'Find me an everyday image that matches the given caption: A motorcycle sits on the side of the road by the fence.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of zebras laying and standing on hay in a fenced in area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A view of a couple bundles of bananas on a rack.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The woman is standing by the very large statue.\n', 'Find me an everyday image that matches the given caption: A person wind surfing on a clear day.\n', 'Find me an everyday image that matches the given caption: A group of sheep are on a rolling green hill.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Many people riding skis on a snowy surface.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272766590>], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272766650>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F32727D8EE0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727DA860>], [None], [<PIL.Image.Image image mode=RGB size=320x256 at 0x7F32727D9D80>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA7D0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB6D0>], [None], [<PIL.Image.Image image mode=RGB size=540x256 at 0x7F32727DAA40>]], 'pixel_values': [None, None, array([[-0.33241987,  0.68947   ,  1.2588086 , ..., -1.1958185 ,
        -1.2384787 , -1.1815984 ],
       [-1.4856956 , -1.5294908 , -1.4127034 , ..., -0.6412359 ,
        -0.7265563 , -0.81187665],
       [-1.1645303 , -1.2083255 , -1.1645303 , ..., -1.2384787 ,
        -1.2811389 , -1.2526988 ],
       ...,
       [-0.6243884 , -0.68278205, -0.37621516, ...,  0.5532498 ,
         0.5532498 ,  0.56746984],
       [ 0.09093457,  0.07633615,  0.09093457, ...,  0.33994877,
         0.31150854,  0.29728848],
       [ 0.10553299,  0.10553299,  0.12013142, ...,  0.15508783,
         0.1266477 ,  0.11242763]], dtype=float32), None, array([[ 0.7040684 ,  0.71866685,  0.71866685, ...,  1.918376  ,
         1.918376  ,  1.918376  ],
       [ 0.8062574 ,  0.8062574 ,  0.791659  , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       [ 1.2880055 ,  1.2880055 ,  1.3026038 , ...,  1.9894764 ,
         1.9894764 ,  1.9894764 ],
       ...,
       [ 0.791659  ,  0.76246214,  0.7478637 , ..., -0.49903518,
        -0.5274753 , -0.5274753 ],
       [ 0.89384794,  0.9084464 ,  0.9084464 , ..., -0.42793486,
        -0.4421549 , -0.45637497],
       [ 0.85005265,  0.8354542 ,  0.8354542 , ..., -0.5274753 ,
        -0.57013553, -0.57013553]], dtype=float32), array([[-0.5659947 , -0.5659947 , -0.5659947 , ..., -0.86875695,
        -0.91141707, -0.882977  ],
       [-1.1207349 , -1.0769397 , -1.0477428 , ..., -0.7265563 ,
        -0.71233624, -0.6981161 ],
       [-0.55139625, -0.55139625, -0.55139625, ..., -0.89719707,
        -0.882977  , -0.89719707],
       ...,
       [ 0.13472985,  0.12013142,  0.12013142, ..., -0.8403168 ,
        -0.86875695, -0.86875695],
       [ 0.3975015 ,  0.41209993,  0.44129676, ..., -0.54169536,
        -0.57013553, -0.58435565],
       [ 0.2807141 ,  0.2807141 ,  0.26611567, ..., -0.48481512,
        -0.58435565, -0.61279577]], dtype=float32), array([[-1.0769397 , -1.0769397 , -1.0623412 , ..., -0.669676  ,
        -0.65545595, -0.65545595],
       [-0.96015227, -0.96015227, -0.94555384, ..., -0.5559154 ,
        -0.54169536, -0.5274753 ],
       [-0.9893491 , -0.9893491 , -0.9747507 , ..., -0.5985757 ,
        -0.58435565, -0.57013553],
       ...,
       [-0.8579632 , -0.8579632 , -0.87256163, ..., -0.68389606,
        -0.7692165 , -0.8260967 ],
       [-0.8579632 , -0.87256163, -0.87256163, ..., -0.51325524,
        -0.51325524, -0.5274753 ],
       [-0.9017585 , -0.9017585 , -0.87256163, ..., -0.81187665,
        -0.8403168 , -0.86875695]], dtype=float32), None, array([[-1.6170814e+00, -1.6316798e+00, -1.6170814e+00, ...,
        -9.1141707e-01, -9.3985718e-01, -8.2609671e-01],
       [-1.5294908e+00, -1.5878845e+00, -1.5294908e+00, ...,
        -7.9765660e-01, -8.1187665e-01, -8.5453689e-01],
       [-1.4127034e+00, -1.4127034e+00, -1.3981050e+00, ...,
        -7.1233624e-01, -5.2747530e-01, -3.7105459e-01],
       ...,
       [ 2.6611567e-01,  2.9531252e-01,  3.0991095e-01, ...,
         4.1327301e-02,  5.5547368e-02,  1.2887171e-02],
       [ 5.7268262e-01,  5.4348576e-01,  4.7049361e-01, ...,
        -1.3328948e-03,  6.9767430e-02,  2.4040821e-01],
       [ 4.4129676e-01,  3.8290307e-01,  4.2669836e-01, ...,
         1.8352796e-01,  1.9774802e-01,  1.9774802e-01]], dtype=float32), None, None, None, array([[ 0.8354542 ,  0.8646511 ,  0.9084464 , ...,  1.7619553 ,
         1.6766349 ,  1.6197547 ],
       [ 0.6018794 ,  0.58728105,  0.6456747 , ..., -0.8260967 ,
        -0.9825174 , -0.96829736],
       [ 0.89384794,  0.9230448 ,  0.95224166, ...,  0.7381106 ,
         0.6243501 ,  0.14086775],
       ...,
       [-0.6973805 , -0.7411758 , -0.7411758 , ...,  0.4252692 ,
         0.4110491 ,  0.39682904],
       [ 0.13472985,  0.19312355,  0.2223204 , ...,  0.21196808,
         0.28306842,  0.29728848],
       [ 0.13472985,  0.19312355,  0.19312355, ...,  0.29728848,
         0.19774802,  0.14086775]], dtype=float32), array([[-1.4710971e+00, -1.4710971e+00, -1.4564987e+00, ...,
        -1.0087335e-01, -1.3328948e-03,  6.9767430e-02],
       [-1.3689082e+00, -1.3543098e+00, -1.2813176e+00, ...,
         6.1013001e-01,  5.9590995e-01,  5.8168989e-01],
       [-1.4710971e+00, -1.4564987e+00, -1.4419003e+00, ...,
        -1.4375596e+00, -1.4517797e+00, -1.4517797e+00],
       ...,
       [-1.1207349e+00, -1.1499318e+00, -1.1645303e+00, ...,
        -1.2242587e+00, -1.2242587e+00, -1.2242587e+00],
       [-1.6170814e+00, -1.6024829e+00, -1.5878845e+00, ...,
        -1.0393977e+00, -7.4077636e-01, -5.9857571e-01],
       [-1.3251129e+00, -1.3105145e+00, -1.3251129e+00, ...,
        -1.2953589e+00, -1.3095790e+00, -1.3237991e+00]], dtype=float32), None, array([[ 1.2150133 ,  1.2296118 ,  1.2296118 , ...,  1.3637935 ,
         1.3780135 ,  1.3780135 ],
       [ 1.2588086 ,  1.2588086 ,  1.2442101 , ...,  1.4917741 ,
         1.5202142 ,  1.5344343 ],
       [ 0.8062574 ,  0.791659  ,  0.791659  , ...,  1.3353534 ,
         1.3495734 ,  1.3637935 ],
       ...,
       [ 0.12013142,  0.12013142,  0.10553299, ...,  0.72389054,
         0.7096705 ,  0.6954504 ],
       [ 0.04713918,  0.07633615,  0.03254076, ...,  0.6954504 ,
         0.7381106 ,  0.75233066],
       [ 0.03254076,  0.01794233, -0.01125452, ...,  0.68123037,
         0.7096705 ,  0.7381106 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 24, 18]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 22]]), None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 38]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A small airplane is flying over the shore of a beach.\n', 'Find me an everyday image that matches the given caption: A motorcycle sits on the side of the road by the fence.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of zebras laying and standing on hay in a fenced in area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A view of a couple bundles of bananas on a rack.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The woman is standing by the very large statue.\n', 'Find me an everyday image that matches the given caption: A person wind surfing on a clear day.\n', 'Find me an everyday image that matches the given caption: A group of sheep are on a rolling green hill.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Many people riding skis on a snowy surface.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 50/6000 [01:44<3:25:14,  2.07s/it]                                                   {'loss': 3.3242, 'grad_norm': 245.06704711914062, 'learning_rate': 5e-06, 'epoch': 0.01}
  1%|          | 50/6000 [01:44<3:25:14,  2.07s/it][2025-11-13 01:32:42,464] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,  12408,    624],
        ...,
        [151643, 151643, 151643,  ...,   8630,  45166,    624],
        [151643, 151643, 151643,  ...,    315,   3015,    624],
        [151643, 151643, 151643,  ...,   4158,  11968,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A traffic light some signs buildings a street and trees.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close up of a basket of fruits.\n', 'Find me an everyday image that matches the given caption: Two tall giraffes eating while in a zoo.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person snowboarding down the side of a snow covered hill, with snow blowing up as the snowboarder slides down the hill.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two people sitting on a bench with their legs crossed.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman holding a tennis racquet waits for the ball.\n', 'Find me an everyday image that matches the given caption: This is an image of a person in water holding onto cows.\n', 'Find me an everyday image that matches the given caption: A group of assorted colored balloons on a tug boat in a body of water.\n', 'Find me an everyday image that matches the given caption: A sandwich is cut in half on a white plate.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DAD40>], [<PIL.Image.Image image mode=RGB size=349x256 at 0x7F32727D9D50>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA1A0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727D8370>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB9D0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8DC0>], [None], [<PIL.Image.Image image mode=RGB size=313x256 at 0x7F32727DBA90>], [None], [None], [None], [None]], 'pixel_values': [array([[ 1.6091708 ,  1.5945723 ,  1.5799739 , ...,  1.9610363 ,
         1.9894764 ,  1.9894764 ],
       [ 1.6967614 ,  1.6675645 ,  1.5945723 , ...,  1.8472759 ,
         1.8899357 ,  1.9468161 ],
       [ 1.5799739 ,  1.6091708 ,  1.6237692 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       ...,
       [-1.3251129 , -1.2521207 , -1.3251129 , ...,  0.02710724,
         0.75233066, -0.34261447],
       [ 0.5142889 ,  0.29531252, -0.2740262 , ...,  0.18352796,
         0.35416883,  0.48214942],
       [ 0.30991095,  0.07633615, -0.08424664, ..., -0.34261447,
        -0.35683453, -0.35683453]], dtype=float32), array([[ 0.6456747 ,  0.66027313,  0.7040684 , ...,  1.0651721 ,
         1.0651721 ,  1.0509521 ],
       [ 0.61647785,  0.61647785,  0.6310763 , ...,  1.0082918 ,
         1.0651721 ,  1.1220524 ],
       [ 0.67487156,  0.67487156,  0.67487156, ...,  1.1078323 ,
         1.1220524 ,  1.1362724 ],
       ...,
       [-0.42001042, -0.24482933, -0.04045137, ...,  0.59590995,
         0.59590995,  0.5816899 ],
       [-0.08424664, -0.11344349, -0.09884507, ...,  0.6243501 ,
         0.6670103 ,  0.6527902 ],
       [-0.36161673, -0.36161673, -0.31782144, ...,  0.56746984,
         0.5816899 ,  0.6243501 ]], dtype=float32), None, array([[-0.82876635, -0.82876635, -0.82876635, ...,  0.35416883,
         0.36838892,  0.38260898],
       [-0.9309554 , -0.96015227, -0.94555384, ...,  0.46792936,
         0.48214942,  0.4963695 ],
       [-0.72657734, -0.7411758 , -0.7411758 , ..., -0.7265563 ,
        -0.71233624, -0.7549964 ],
       ...,
       [ 0.68947   ,  0.67487156,  0.6310763 , ...,  0.88031125,
         0.8660912 ,  0.85187113],
       [ 1.3609976 ,  1.477785  ,  1.5945723 , ...,  1.1931527 ,
         1.1504925 ,  1.1078323 ],
       [ 0.791659  ,  0.76246214,  0.71866685, ...,  0.80921096,
         0.7949909 ,  0.7665507 ]], dtype=float32), None, None, array([[-1.7630657, -1.7630657, -1.7630657, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       ...,
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7630657, -1.7630657, -1.7630657, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997]], dtype=float32), array([[ 0.14932826, -0.09884507, -0.25942776, ..., -1.3664593 ,
        -1.2811389 , -1.1815984 ],
       [ 1.7259582 ,  1.7259582 ,  1.652966  , ...,  0.15508783,
         0.14086775,  0.16930789],
       [-0.06964822,  0.20772196,  0.67487156, ...,  1.5913146 ,
         1.7477353 ,  1.8046155 ],
       ...,
       [-0.20103405, -0.2302309 , -0.2302309 , ..., -1.0962781 ,
        -1.1104981 , -1.1104981 ],
       [-0.44920728, -0.44920728, -0.44920728, ..., -1.0109575 ,
        -0.9967375 , -1.0109575 ],
       [-0.55139625, -0.5659947 , -0.5659947 , ..., -0.9825174 ,
        -0.9825174 , -0.9967375 ]], dtype=float32), None, array([[ 0.52888733,  0.5580842 ,  0.58728105, ...,  0.31150854,
         0.38260898,  0.46792936],
       [ 0.6018794 ,  0.42669836,  0.38290307, ...,  0.21196808,
         0.3257286 ,  0.35416883],
       [-0.11344349,  0.2223204 ,  0.42669836, ...,  0.26884836,
         0.22618815,  0.21196808],
       ...,
       [ 1.6383677 ,  1.652966  ,  1.652966  , ...,  1.8899357 ,
         1.8614956 ,  1.8472759 ],
       [ 1.6675645 ,  1.6821629 ,  1.6967614 , ...,  2.103237  ,
         2.0890167 ,  2.0605767 ],
       [ 1.5361787 ,  1.5507771 ,  1.5361787 , ...,  1.9041561 ,
         1.9325962 ,  1.918376  ]], dtype=float32), None, array([[-1.398105  , -1.398105  , -1.3835065 , ..., -1.4233395 ,
        -1.4091195 , -1.4091195 ],
       [-1.2375224 , -1.2229239 , -1.193727  , ..., -1.3948994 ,
        -1.3380191 , -1.2953589 ],
       [-1.2667192 , -1.2667192 , -1.2667192 , ..., -1.3806794 ,
        -1.3522393 , -1.3522393 ],
       ...,
       [ 0.71866685,  0.71866685,  0.71866685, ...,  0.9940718 ,
         0.9940718 ,  1.0082918 ],
       [ 0.7332653 ,  0.7332653 ,  0.7332653 , ...,  0.90875137,
         0.93719155,  0.9514116 ],
       [ 0.6456747 ,  0.6310763 ,  0.61647785, ...,  0.9514116 ,
         0.9514116 ,  0.96563166]], dtype=float32), None, None, None, None], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 22]]), None, None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A traffic light some signs buildings a street and trees.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close up of a basket of fruits.\n', 'Find me an everyday image that matches the given caption: Two tall giraffes eating while in a zoo.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person snowboarding down the side of a snow covered hill, with snow blowing up as the snowboarder slides down the hill.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two people sitting on a bench with their legs crossed.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman holding a tennis racquet waits for the ball.\n', 'Find me an everyday image that matches the given caption: This is an image of a person in water holding onto cows.\n', 'Find me an everyday image that matches the given caption: A group of assorted colored balloons on a tug boat in a body of water.\n', 'Find me an everyday image that matches the given caption: A sandwich is cut in half on a white plate.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 51/6000 [01:46<3:23:26,  2.05s/it]                                                   {'loss': 3.0734, 'grad_norm': 206.12213134765625, 'learning_rate': 5.1e-06, 'epoch': 0.01}
  1%|          | 51/6000 [01:46<3:23:26,  2.05s/it][2025-11-13 01:32:44,479] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,  25284,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,   6422,    624],
        [151643, 151643, 151643,  ...,  16002,  22502,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small giraffe standing alone in the dirt.\n', 'Find me an everyday image that matches the given caption: Elephants graze a lightly grassed field nestled among trees.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bed with a white veil sitting over it.\n', 'Find me an everyday image that matches the given caption: A table with a white plate of food that includes carrots.\n', 'Find me an everyday image that matches the given caption: A large Miller Lite delivery truck refueling at a gas station.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skier that is skiing down a snowy hill.\n', 'Find me an everyday image that matches the given caption: A wood bar holds a long line of empty wine glasses.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black and white photo of a guy standing there holding a skateboard; his shadow is cast on the wall.\n', 'Find me an everyday image that matches the given caption: A cat and a bulldog looking up while sitting on the floor.\n', 'Find me an everyday image that matches the given caption: Salad, milk, orange slices and french bread pizza.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA5F0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727DBF70>], [None], [None], [<PIL.Image.Image image mode=RGB size=321x256 at 0x7F32727DBEE0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x333 at 0x7F32727DAF50>], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727DB640>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB8B0>]], 'pixel_values': [array([[ 1.6091708 ,  1.6091708 ,  1.6091708 , ...,  2.117457  ,
         2.074797  ,  1.6055346 ],
       [ 1.5507771 ,  1.2442101 ,  0.9084464 , ..., -0.29995427,
        -0.5985757 , -0.5274753 ],
       [ 1.8719424 ,  1.7697535 ,  1.7259582 , ..., -0.12931348,
        -0.45637497, -0.7549964 ],
       ...,
       [-0.7557742 , -0.6973805 , -0.7411758 , ..., -0.7976566 ,
        -0.7549964 , -0.74077636],
       [-0.8433648 , -0.94555384, -1.0331444 , ..., -0.5559154 ,
        -0.48481512, -0.42793486],
       [-0.82876635, -0.7995695 , -0.8433648 , ..., -0.882977  ,
        -0.89719707, -0.8403168 ]], dtype=float32), array([[-8.8716006e-01, -6.8278205e-01, -5.5139625e-01, ...,
        -5.8213156e-02, -1.3328948e-03,  4.1327301e-02],
       [-1.7183720e-01, -1.2804192e-01, -5.5139625e-01, ...,
         1.8352796e-01,  1.4086775e-01,  1.4086775e-01],
       [ 2.6611567e-01,  3.9750150e-01, -1.2804192e-01, ...,
        -6.1279577e-01, -4.8481512e-01, -3.7105459e-01],
       ...,
       [ 1.2734070e+00,  1.2588086e+00,  1.2588086e+00, ...,
         2.0747969e+00,  2.0463567e+00,  2.0321364e+00],
       [ 1.0252337e+00,  1.0252337e+00,  1.0544306e+00, ...,
         1.8757160e+00,  1.8330555e+00,  1.8330555e+00],
       [ 1.2588086e+00,  1.2296118e+00,  1.2004149e+00, ...,
         1.9041561e+00,  1.9041561e+00,  1.9041561e+00]], dtype=float32), None, None, array([[-1.5148925 , -1.500294  , -1.4710971 , ..., -1.4233395 ,
        -1.4233395 , -1.4375596 ],
       [-1.5440893 , -1.6024829 , -1.6170814 , ..., -1.4091195 ,
        -1.4233395 , -1.4233395 ],
       [-1.704672  , -1.7192703 , -1.7192703 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ],
       ...,
       [-1.1207349 , -1.1061366 , -1.018546  , ..., -0.78343654,
        -0.61279577, -0.6412359 ],
       [ 1.0544306 ,  1.652966  ,  1.9157377 , ..., -0.6270158 ,
        -0.49903518, -0.6270158 ],
       [-1.0915381 , -1.193727  , -1.0915381 , ..., -0.6412359 ,
        -0.6981161 , -0.71233624]], dtype=float32), None, None, None, array([[-1.4127034, -1.4127034, -1.4127034, ..., -1.0962781, -1.0962781,
        -1.0962781],
       [-1.4127034, -1.4127034, -1.4273019, ..., -1.0962781, -1.0962781,
        -1.1104981],
       [-1.398105 , -1.3835065, -1.3835065, ..., -1.1104981, -1.1104981,
        -1.0962781],
       ...,
       [-1.2083255, -1.1645303, -1.1353334, ..., -1.0251776, -0.9967375,
        -0.9967375],
       [-1.2229239, -1.193727 , -1.1645303, ..., -1.0251776, -1.0109575,
        -1.0251776],
       [-1.193727 , -1.2083255, -1.193727 , ..., -0.9825174, -1.0109575,
        -1.0393977]], dtype=float32), None, None, array([[ 1.0690291 ,  1.0690291 ,  1.0836275 , ...,  1.5913146 ,
         1.6055346 ,  1.6197547 ],
       [ 1.1128243 ,  1.1128243 ,  1.1274228 , ...,  1.477554  ,
         1.477554  ,  1.463334  ],
       [ 1.2004149 ,  1.2296118 ,  1.2296118 , ...,  1.5486543 ,
         1.5628744 ,  1.5770944 ],
       ...,
       [ 0.32450938,  0.29531252,  0.38290307, ..., -0.9256371 ,
        -0.81187665, -0.81187665],
       [ 0.10553299,  0.32450938,  0.52888733, ..., -0.08665328,
         0.01288717, -0.15775362],
       [ 0.38290307,  0.36830464,  0.3537062 , ..., -0.42793486,
        -0.45637497, -0.15775362]], dtype=float32), None, None, None, array([[-0.24482933, -0.2302309 , -0.2302309 , ..., -1.3664593 ,
        -1.4233395 , -1.4802198 ],
       [-0.44920728, -0.405412  , -0.5221994 , ..., -1.4802198 ,
        -1.4375596 , -1.2526988 ],
       [-0.2740262 , -0.2740262 , -0.2740262 , ..., -1.4517797 ,
        -1.4091195 , -1.3948994 ],
       ...,
       [-0.20103405, -0.12804192, -0.14264035, ..., -0.04399309,
        -0.07243322, -0.08665328],
       [-0.09884507, -0.06964822, -0.06964822, ..., -0.18619375,
        -0.45637497, -0.54169536],
       [-0.7557742 , -0.36161673, -0.24482933, ..., -0.07243322,
        -0.05821316, -0.04399309]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, None, array([[ 1, 18, 22]]), None, None, None, array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small giraffe standing alone in the dirt.\n', 'Find me an everyday image that matches the given caption: Elephants graze a lightly grassed field nestled among trees.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bed with a white veil sitting over it.\n', 'Find me an everyday image that matches the given caption: A table with a white plate of food that includes carrots.\n', 'Find me an everyday image that matches the given caption: A large Miller Lite delivery truck refueling at a gas station.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skier that is skiing down a snowy hill.\n', 'Find me an everyday image that matches the given caption: A wood bar holds a long line of empty wine glasses.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black and white photo of a guy standing there holding a skateboard; his shadow is cast on the wall.\n', 'Find me an everyday image that matches the given caption: A cat and a bulldog looking up while sitting on the floor.\n', 'Find me an everyday image that matches the given caption: Salad, milk, orange slices and french bread pizza.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 52/6000 [01:48<3:20:47,  2.03s/it]                                                   {'loss': 3.5856, 'grad_norm': 446.02685546875, 'learning_rate': 5.2e-06, 'epoch': 0.01}
  1%|          | 52/6000 [01:48<3:20:47,  2.03s/it][2025-11-13 01:32:46,436] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  47420,   5740,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   6319,   4004,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A beach landscape with umbrellas and people reclining.\n', 'Find me an everyday image that matches the given caption: Two plates of food with soup and sandwiches.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Bathroom with windows, a shower, bathtub, and double sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man wearing a dress shirt and a tie sitting against a dark background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=277x256 at 0x7F32727D9D80>], [<PIL.Image.Image image mode=RGB size=335x256 at 0x7F32727DBAF0>], [None], [None], [<PIL.Image.Image image mode=RGB size=346x256 at 0x7F32727B6F50>], [<PIL.Image.Image image mode=RGB size=320x256 at 0x7F327277F460>], [<PIL.Image.Image image mode=RGB size=256x382 at 0x7F32727DA710>], [<PIL.Image.Image image mode=RGB size=374x256 at 0x7F32727D9420>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727D9CF0>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727DA050>], [None], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F32727DA1D0>], [<PIL.Image.Image image mode=RGB size=353x256 at 0x7F32727D8970>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9570>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB9A0>]], 'pixel_values': [array([[ 1.3472985e-01,  1.0553299e-01,  1.4932826e-01, ...,
         1.1242763e-01, -5.8213156e-02, -2.9773025e-02],
       [ 4.8509204e-01,  6.0187942e-01,  5.8728105e-01, ...,
        -1.5552960e-02, -1.3328948e-03, -1.3328948e-03],
       [ 3.6830464e-01,  1.6392669e-01,  2.2232039e-01, ...,
         1.4086775e-01,  1.6930789e-01,  1.4086775e-01],
       ...,
       [-5.5139625e-01, -7.4117577e-01, -7.1197891e-01, ...,
        -1.3095790e+00, -1.3664593e+00, -1.4233395e+00],
       [-1.1499318e+00, -1.1061366e+00, -1.0477428e+00, ...,
        -1.2384787e+00, -1.3380191e+00, -1.3380191e+00],
       [-1.2375224e+00, -9.4555384e-01, -1.0039475e+00, ...,
        -1.3380191e+00, -1.3380191e+00, -1.3237991e+00]], dtype=float32), array([[-0.55139625, -0.55139625, -0.55139625, ..., -0.48481512,
        -0.48481512, -0.48481512],
       [-0.5221994 , -0.5221994 , -0.55139625, ..., -0.48481512,
        -0.48481512, -0.48481512],
       [-0.4638057 , -0.4638057 , -0.4638057 , ..., -0.08665328,
        -0.10087335, -0.12931348],
       ...,
       [ 0.32450938,  0.66027313,  0.68947   , ...,  0.4963695 ,
         0.4963695 ,  0.48214942],
       [ 0.4558952 ,  0.5142889 ,  0.5726826 , ...,  0.5816899 ,
         0.61013   ,  0.56746984],
       [ 0.44129676,  0.4704936 ,  0.5142889 , ..., -0.11509342,
         0.05554737, -0.01555296]], dtype=float32), None, None, array([[-0.9163569 , -0.9163569 , -0.9017585 , ...,  0.7381106 ,
         0.75233066,  0.7665507 ],
       [-0.72657734, -0.72657734, -0.7411758 , ...,  0.90875137,
         0.9229715 ,  0.93719155],
       [-0.7703726 , -0.7703726 , -0.7557742 , ...,  0.85187113,
         0.8660912 ,  0.88031125],
       ...,
       [-1.5878845 , -1.6170814 , -1.6608766 , ..., -1.3522393 ,
        -1.3380191 , -1.3380191 ],
       [-1.1791286 , -1.1499318 , -1.1061366 , ..., -1.0962781 ,
        -1.1247182 , -1.1815984 ],
       [-1.6170814 , -1.6170814 , -1.4856956 , ..., -1.2526988 ,
        -1.2242587 , -1.2242587 ]], dtype=float32), array([[-0.08424664, -0.08424664, -0.08424664, ...,  1.3922336 ,
         1.3922336 ,  1.3922336 ],
       [-0.04045137, -0.06964822, -0.09884507, ...,  1.3495734 ,
         1.3495734 ,  1.3211333 ],
       [ 0.07633615,  0.07633615,  0.07633615, ...,  1.4917741 ,
         1.5059941 ,  1.4917741 ],
       ...,
       [-1.1353334 , -1.1499318 , -1.1645303 , ..., -1.1531583 ,
        -1.1815984 , -1.1958185 ],
       [-1.3397113 , -1.3251129 , -1.2521207 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.0915381 , -1.0915381 , -1.0769397 , ..., -1.3380191 ,
        -1.3948994 , -1.4517797 ]], dtype=float32), array([[-0.08424664,  0.17852512,  0.2223204 , ...,  1.4064537 ,
         1.4491138 ,  1.4917741 ],
       [ 0.3975015 ,  0.42669836,  0.4704936 , ...,  1.6339747 ,
         1.6339747 ,  1.6197547 ],
       [ 0.42669836,  1.5799739 ,  1.4923834 , ...,  1.463334  ,
         1.477554  ,  1.5059941 ],
       ...,
       [-1.1499318 , -1.1645303 , -1.1645303 , ..., -1.4375596 ,
        -1.3948994 , -0.15775362],
       [-0.6243884 , -0.9017585 , -1.0477428 , ..., -1.3664593 ,
        -1.3806794 , -1.4233395 ],
       [-1.3689082 , -1.3251129 , -1.3543098 , ..., -1.4802198 ,
        -1.4802198 , -0.22885394]], dtype=float32), array([[-0.8141679 , -0.59519154, -0.39081356, ..., -0.01555296,
        -0.01555296, -0.01555296],
       [-1.0331444 , -1.0331444 , -1.0769397 , ...,  0.1266477 ,
        -0.01555296, -0.05821316],
       [-0.82876635, -0.6389868 , -0.39081356, ...,  0.5532498 ,
         1.022512  ,  1.4348938 ],
       ...,
       [-0.5659947 , -0.55139625, -0.55139625, ..., -0.08665328,
        -0.11509342, -0.12931348],
       [-0.04045137, -0.04045137, -0.09884507, ..., -0.669676  ,
        -0.65545595, -0.65545595],
       [-0.21563247, -0.24482933, -0.25942776, ..., -0.35683453,
        -0.35683453, -0.3710546 ]], dtype=float32), array([[ 0.26611567, -0.09884507,  0.23691882, ..., -1.1389382 ,
        -0.882977  , -0.8545369 ],
       [-1.1207349 , -1.3397113 , -0.9309554 , ..., -1.3237991 ,
        -1.0962781 , -1.0109575 ],
       [-1.1791286 , -0.9893491 , -1.1353334 , ..., -1.1673783 ,
        -1.1531583 , -1.0962781 ],
       ...,
       [-1.3251129 , -1.4273019 , -1.4273019 , ..., -1.1104981 ,
        -1.1815984 , -1.2384787 ],
       [-0.8141679 , -0.7411758 , -0.7119789 , ..., -1.067838  ,
        -1.0536178 , -1.0251776 ],
       [-1.0769397 , -1.0623412 , -1.0477428 , ..., -1.0109575 ,
        -1.0393977 , -1.067838  ]], dtype=float32), array([[ 0.04713918,  0.19312355, -0.0550498 , ...,  0.29728848,
         0.15508783,  0.25462827],
       [-0.08424664, -0.04045137,  0.0617376 , ..., -0.11509342,
        -0.05821316, -0.18619375],
       [-0.42001042, -0.42001042, -0.3470183 , ..., -0.48481512,
        -0.54169536, -0.39949474],
       ...,
       [-0.25942776, -0.20103405,  0.03254076, ...,  0.59590995,
         0.85187113,  0.823431  ],
       [-0.08424664, -0.18643562, -0.12804192, ...,  0.4252692 ,
         0.35416883,  0.33994877],
       [-0.7557742 , -1.0039475 , -0.405412  , ...,  0.25462827,
         0.5532498 ,  0.4537093 ]], dtype=float32), None, array([[ 1.0690291 ,  1.0690291 ,  1.0690291 , ...,  1.6055346 ,
         1.6055346 ,  1.6197547 ],
       [ 1.1420212 ,  1.1420212 ,  1.171218  , ...,  1.7192951 ,
         1.2500329 ,  0.6954504 ],
       [ 1.098226  ,  1.098226  ,  1.1128243 , ...,  1.6481948 ,
         1.6624149 ,  1.6766349 ],
       ...,
       [ 0.00334391,  0.0617376 , -0.06964822, ..., -0.17197368,
        -0.21463387, -0.20041381],
       [-0.8433648 , -0.6243884 , -0.5805931 , ..., -0.05821316,
        -0.07243322, -0.02977302],
       [-0.72657734, -0.68278205, -0.7995695 , ..., -0.21463387,
        -0.15775362, -0.08665328]], dtype=float32), array([[ 0.17852512,  0.13472985,  0.03254076, ...,  0.6670103 ,
         0.5816899 ,  0.4252692 ],
       [-0.49300256, -0.43460885, -0.405412  , ...,  0.22618815,
         0.3257286 ,  0.48214942],
       [ 0.29531252,  0.29531252,  0.33910778, ...,  0.85187113,
         0.72389054,  0.56746984],
       ...,
       [-0.14264035, -0.04045137, -0.04045137, ..., -1.0251776 ,
        -1.067838  , -1.1104981 ],
       [ 0.32450938,  0.2807141 ,  0.19312355, ..., -0.32839438,
        -0.4421549 , -0.54169536],
       [-0.2302309 , -0.25942776, -0.303223  , ..., -1.1104981 ,
        -1.0109575 , -0.89719707]], dtype=float32), array([[ 0.0617376 ,  0.0617376 ,  0.0617376 , ...,  1.5913146 ,
         1.5913146 ,  1.5913146 ],
       [ 0.0617376 ,  0.0617376 ,  0.0617376 , ...,  1.6055346 ,
         1.6055346 ,  1.6055346 ],
       [ 0.0617376 ,  0.0617376 ,  0.0617376 , ...,  1.5770944 ,
         1.5770944 ,  1.5770944 ],
       ...,
       [ 0.26611567,  0.10553299,  0.10553299, ..., -0.5559154 ,
        -0.5559154 , -0.54169536],
       [-0.36161673, -0.43460885, -0.47840413, ..., -0.48481512,
        -0.48481512, -0.39949474],
       [-0.3470183 , -0.2740262 , -0.25942776, ..., -0.32839438,
        -0.29995427, -0.2857342 ]], dtype=float32), None, array([[ 1.273407  ,  1.273407  ,  1.273407  , ...,  2.117457  ,
         2.117457  ,  2.117457  ],
       [ 1.273407  ,  1.2880055 ,  1.3172023 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.273407  ,  1.273407  ,  1.273407  , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       ...,
       [-1.2229239 , -1.2229239 , -1.2375224 , ...,  0.9514116 ,
         1.1362724 ,  0.80921096],
       [-1.6462783 , -1.6608766 , -1.6754751 , ..., -0.8403168 ,
        -0.8260967 , -1.0962781 ],
       [ 0.00334391,  1.0690291 ,  1.2004149 , ...,  1.477554  ,
         0.7381106 ,  1.2784731 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 20]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 22]]), array([[ 1, 28, 18]]), array([[ 1, 18, 26]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 26]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A beach landscape with umbrellas and people reclining.\n', 'Find me an everyday image that matches the given caption: Two plates of food with soup and sandwiches.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Bathroom with windows, a shower, bathtub, and double sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man wearing a dress shirt and a tie sitting against a dark background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 53/6000 [01:50<3:22:51,  2.05s/it]                                                   {'loss': 4.1369, 'grad_norm': 481.0263977050781, 'learning_rate': 5.300000000000001e-06, 'epoch': 0.01}
  1%|          | 53/6000 [01:50<3:22:51,  2.05s/it][2025-11-13 01:32:48,539] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,   2884,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  16163,  20380,    624],
        [151643, 151643, 151643,  ...,     11,  16307,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: An ornate clocks sits on a counter in front of a design.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman petting a giraffe standing next to another giraffe.\n', 'Find me an everyday image that matches the given caption: Man on skateboard riding on pavement near green open space.\n', 'Find me an everyday image that matches the given caption: A black dog and white cat playing in grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Pallet of concrete being pulled behind a white truck.\n', 'Find me an everyday image that matches the given caption: A person sitting on a motorcycle near a building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two people walking on a beach and flying a kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of children are eating pizza and drinking punch.\n', 'Find me an everyday image that matches the given caption: A white Swiss airplane with a white cross on a red field symbol on its tail, flying.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D9DB0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8DC0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727D8400>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DBA00>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277EDD0>], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727DB490>], [None], [<PIL.Image.Image image mode=RGB size=359x256 at 0x7F32727DB730>], [None], [None]], 'pixel_values': [None, array([[-1.4127034 , -1.4127034 , -1.4273019 , ..., -1.082058  ,
        -0.9825174 , -1.067838  ],
       [-1.2083255 , -1.3397113 , -1.5586877 , ...,  0.11242763,
         0.24040821, -0.3710546 ],
       [-1.4419003 , -1.398105  , -1.3835065 , ..., -1.1958185 ,
        -1.2242587 , -1.2242587 ],
       ...,
       [-0.7119789 , -0.7119789 , -1.1645303 , ...,  0.01288717,
         0.25462827, -0.34261447],
       [-0.25942776, -0.20103405, -0.11344349, ..., -0.32839438,
        -0.4421549 , -0.31417432],
       [-0.31782144, -0.50760096, -0.4638057 , ..., -0.2857342 ,
        -0.29995427, -0.18619375]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ...,  0.7807708 ,
         0.80921096,  0.80921096],
       [-1.7484672 , -1.7776641 , -1.7922626 , ...,  0.88031125,
         0.8945313 ,  0.90875137],
       [-1.7630657 , -1.7630657 , -1.7630657 , ...,  1.1931527 ,
         1.2215928 ,  1.2215928 ],
       ...,
       [-1.7192703 , -1.7776641 , -1.7922626 , ..., -1.1247182 ,
        -0.9398572 , -0.86875695],
       [-1.704672  , -1.6608766 , -1.6754751 , ...,  0.46792936,
        -0.32839438, -0.243074  ],
       [-1.398105  , -0.15723877, -0.8141679 , ...,  0.05554737,
        -0.14353354, -0.18619375]], dtype=float32), None, None, None, array([[-0.39081356, -0.59519154, -0.6243884 , ..., -0.71233624,
        -0.22885394, -0.29995427],
       [-0.65358526, -0.7411758 , -0.7411758 , ..., -0.7692165 ,
        -0.9256371 , -0.9967375 ],
       [ 0.36830464,  0.01794233, -0.2302309 , ..., -1.1673783 ,
        -1.0962781 , -1.1247182 ],
       ...,
       [ 0.10553299,  0.12013142,  0.13472985, ...,  0.29728848,
         0.35416883,  0.4963695 ],
       [-0.0550498 , -0.01125452,  0.03254076, ...,  0.43948925,
         0.59590995,  0.68123037],
       [ 0.04713918,  0.07633615,  0.04713918, ...,  0.7949909 ,
         0.6243501 ,  0.4110491 ]], dtype=float32), array([[-1.3397113 , -1.2813176 , -1.2229239 , ..., -0.89719707,
        -0.882977  , -0.8260967 ],
       [-1.0769397 , -1.1061366 , -1.0915381 , ..., -0.74077636,
        -0.8403168 , -0.5274753 ],
       [-1.2229239 , -1.193727  , -1.1791286 , ..., -0.89719707,
        -0.882977  , -0.8260967 ],
       ...,
       [-1.6754751 , -1.6754751 , -1.6608766 , ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ],
       [-1.5440893 , -1.5440893 , -1.5440893 , ..., -1.309579  ,
        -1.309579  , -1.309579  ],
       [-1.4273019 , -1.4419003 , -1.4856956 , ..., -1.3664593 ,
        -1.3948994 , -1.4091195 ]], dtype=float32), array([[-1.4419003e+00, -1.5148925e+00, -1.6024829e+00, ...,
        -1.1958185e+00, -1.0109575e+00, -9.2563713e-01],
       [-1.1207349e+00, -1.0477428e+00, -1.1645303e+00, ...,
        -1.3380191e+00, -1.3522393e+00, -1.3380191e+00],
       [-1.6462783e+00, -1.6608766e+00, -1.6754751e+00, ...,
        -1.3237991e+00, -1.3095790e+00, -1.3380191e+00],
       ...,
       [-2.7402619e-01, -2.7402619e-01, -2.8862458e-01, ...,
         6.9767430e-02,  5.5547368e-02,  4.1327301e-02],
       [-1.8643562e-01, -2.0103405e-01, -2.0103405e-01, ...,
         8.3987497e-02,  6.9767430e-02,  6.9767430e-02],
       [-2.4482933e-01, -2.4482933e-01, -2.4482933e-01, ...,
         1.2887171e-02, -1.3328948e-03, -1.3328948e-03]], dtype=float32), None, None, array([[-1.5440893 , -1.5878845 , -1.6462783 , ..., -1.2384787 ,
        -1.2100385 , -1.2100385 ],
       [-1.5732862 , -1.5732862 , -1.6170814 , ..., -1.2526988 ,
        -1.2669188 , -1.2384787 ],
       [-1.4419003 , -1.4710971 , -1.4856956 , ..., -1.0393977 ,
        -0.96829736, -0.9398572 ],
       ...,
       [ 0.01794233,  0.01794233,  0.01794233, ...,  0.4110491 ,
         0.4110491 ,  0.3257286 ],
       [-0.02585294, -0.02585294, -0.01125452, ...,  0.0413273 ,
         0.21196808,  0.33994877],
       [-0.06964822, -0.09884507, -0.12804192, ..., -0.05821316,
        -0.243074  , -0.02977302]], dtype=float32), None, array([[-1.0477428 , -0.3470183 , -0.65358526, ..., -0.95407724,
        -0.9398572 , -0.9398572 ],
       [-0.28862458, -0.28862458, -0.28862458, ..., -0.89719707,
        -0.9256371 , -0.9398572 ],
       [-1.5732862 , -1.5586877 , -1.5440893 , ..., -0.49903518,
        -0.4421549 , -0.42793486],
       ...,
       [-1.2667192 , -1.2813176 , -1.2959161 , ...,  0.1266477 ,
         0.15508783,  0.15508783],
       [-1.3397113 , -1.1791286 , -1.2521207 , ...,  0.11242763,
         0.05554737,  0.06976743],
       [ 0.07633615,  0.10553299,  0.09093457, ...,  0.16930789,
         0.1266477 ,  0.11242763]], dtype=float32), None, None], 'image_grid_thw': [None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 26]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: An ornate clocks sits on a counter in front of a design.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman petting a giraffe standing next to another giraffe.\n', 'Find me an everyday image that matches the given caption: Man on skateboard riding on pavement near green open space.\n', 'Find me an everyday image that matches the given caption: A black dog and white cat playing in grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Pallet of concrete being pulled behind a white truck.\n', 'Find me an everyday image that matches the given caption: A person sitting on a motorcycle near a building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two people walking on a beach and flying a kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of children are eating pizza and drinking punch.\n', 'Find me an everyday image that matches the given caption: A white Swiss airplane with a white cross on a red field symbol on its tail, flying.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 54/6000 [01:52<3:21:40,  2.04s/it]                                                   {'loss': 3.1684, 'grad_norm': 206.25265502929688, 'learning_rate': 5.400000000000001e-06, 'epoch': 0.01}
  1%|          | 54/6000 [01:52<3:21:40,  2.04s/it][2025-11-13 01:32:50,541] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,  18010,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  13625,    624],
        [151643, 151643, 151643,  ...,  31535,    389,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A keyboard and mouse along with other items on the desk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A toilet is in a bathroom with a blue wall and blue and white tile.\n', 'Find me an everyday image that matches the given caption: A downtown clock tower at the intersection of a busy street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man and a woman sitting down next to a railing one on the phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Man talking from a stage set with drums and a keyboard.\n', 'Find me an everyday image that matches the given caption: A man riding a horse with a helmet on.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DA080>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DB4C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DAEC0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB2E0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DA2F0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x312 at 0x7F32727DB550>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D8F70>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9510>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB370>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DAF50>]], 'pixel_values': [None, array([[ 0.20772196,  0.23691882,  0.26611567, ...,  1.1078323 ,
         1.1220524 ,  1.1362724 ],
       [ 0.48509204,  0.49969047,  0.49969047, ...,  1.3211333 ,
         1.3211333 ,  1.3353534 ],
       [ 0.2807141 ,  0.2807141 ,  0.30991095, ...,  1.1931527 ,
         1.2073728 ,  1.2215928 ],
       ...,
       [ 0.7478637 ,  0.7332653 ,  0.71866685, ...,  1.1078323 ,
         1.0651721 ,  1.1078323 ],
       [ 0.52888733,  1.0836275 ,  0.8646511 , ...,  1.1647125 ,
         1.1220524 ,  1.1220524 ],
       [-0.01125452,  0.26611567,  0.29531252, ...,  0.93719155,
         0.90875137,  0.90875137]], dtype=float32), array([[-0.20103405, -0.7703726 ,  0.0617376 , ..., -0.669676  ,
        -0.5274753 , -0.07243322],
       [-1.2375224 , -0.49300256, -0.1718372 , ..., -0.8403168 ,
        -1.1389382 , -1.2384787 ],
       [-1.0477428 , -0.96015227, -0.96015227, ..., -0.32839438,
        -0.20041381, -0.01555296],
       ...,
       [ 1.4193913 ,  1.3901944 ,  1.3901944 , ...,  0.51058954,
         0.52480966,  0.5532498 ],
       [ 1.5945723 ,  1.6967614 ,  1.6967614 , ...,  0.48214942,
         0.5532498 ,  0.4252692 ],
       [ 1.5069818 ,  1.3901944 ,  1.4339896 , ...,  0.33994877,
         0.25462827,  0.36838892]], dtype=float32), array([[ 1.3026038 ,  1.3026038 ,  1.3172023 , ...,  1.690855  ,
         1.690855  ,  1.705075  ],
       [ 1.4339896 ,  1.4339896 ,  1.4193913 , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       [ 1.3609976 ,  1.3609976 ,  1.3755959 , ...,  1.7192951 ,
         1.7192951 ,  1.7335151 ],
       ...,
       [-0.7411758 , -0.65358526, -0.72657734, ..., -1.082058  ,
        -1.1673783 , -1.2526988 ],
       [-1.500294  , -1.5732862 , -1.6316798 , ..., -0.95407724,
        -0.8260967 , -0.86875695],
       [-1.6462783 , -1.398105  , -0.9163569 , ..., -0.91141707,
        -0.86875695, -0.8260967 ]], dtype=float32), array([[-1.5440893 , -1.5586877 , -1.5878845 , ..., -0.20041381,
        -0.21463387, -0.21463387],
       [-0.9017585 , -0.9747507 , -0.87256163, ..., -0.18619375,
        -0.17197368, -0.15775362],
       [-0.96015227, -0.9747507 , -0.96015227, ..., -0.15775362,
        -0.12931348, -0.12931348],
       ...,
       [-1.1791286 , -1.193727  , -1.2229239 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ],
       [-1.1353334 , -1.1499318 , -1.1353334 , ..., -1.3806794 ,
        -1.3948994 , -1.4091195 ],
       [-1.398105  , -1.3689082 , -1.3835065 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-0.09884507, -0.09884507, -0.11344349, ..., -1.1104981 ,
        -1.1247182 , -1.0962781 ],
       [ 0.07633615,  0.01794233,  0.12013142, ..., -1.0109575 ,
        -1.082058  , -1.1531583 ],
       [-0.04045137, -0.0550498 , -0.0550498 , ..., -1.1389382 ,
        -1.1247182 , -1.0962781 ],
       ...,
       [ 0.52888733,  0.61647785,  0.66027313, ...,  0.8660912 ,
         0.7807708 ,  0.68123037],
       [-0.7703726 , -0.96015227, -1.1353334 , ..., -0.51325524,
        -0.9825174 , -1.2100385 ],
       [ 0.4558952 ,  0.5580842 ,  0.6456747 , ...,  0.7807708 ,
         0.56746984,  0.4252692 ]], dtype=float32), None, None, array([[1.7259582, 1.7259582, 1.7259582, ..., 1.9894764, 1.9894764,
        1.9894764],
       [1.6821629, 1.6821629, 1.6821629, ..., 1.9610363, 1.9610363,
        1.9610363],
       [1.8281472, 1.8281472, 1.8281472, ..., 1.8899357, 1.875716 ,
        1.875716 ],
       ...,
       [1.8719424, 1.8719424, 1.8719424, ..., 2.103237 , 2.074797 ,
        2.0463567],
       [1.857344 , 1.857344 , 1.857344 , ..., 1.8472759, 1.8472759,
        1.8472759],
       [1.8719424, 1.8719424, 1.8719424, ..., 1.8188357, 1.7477353,
        1.705075 ]], dtype=float32), array([[-1.018546  , -1.2521207 , -1.3835065 , ..., -0.9398572 ,
        -0.96829736, -0.9825174 ],
       [-1.2229239 , -1.1645303 , -1.2667192 , ..., -0.51325524,
        -0.42793486, -0.243074  ],
       [-1.3251129 , -1.1207349 , -1.0915381 , ...,  1.4348938 ,
         1.3069133 ,  1.3495734 ],
       ...,
       [-0.04045137,  0.00334391,  0.17852512, ..., -0.07243322,
        -0.15775362,  0.05554737],
       [-0.39081356, -0.5659947 , -0.49300256, ...,  0.43948925,
         0.31150854,  0.14086775],
       [-0.28862458, -0.2302309 , -0.303223  , ..., -0.12931348,
        -0.15775362, -0.51325524]], dtype=float32), None, array([[-1.2375224 , -1.2229239 , -1.2229239 , ...,  1.4491138 ,
         1.4491138 ,  1.4491138 ],
       [-1.2083255 , -1.2083255 , -1.2083255 , ...,  1.4491138 ,
         1.4491138 ,  1.4491138 ],
       [-1.1207349 , -1.1207349 , -1.1207349 , ...,  1.477554  ,
         1.477554  ,  1.477554  ],
       ...,
       [-0.39081356, -0.37621516, -0.39081356, ..., -0.27151415,
        -0.27151415, -0.25729406],
       [-0.7703726 , -0.7557742 , -0.7411758 , ..., -0.8260967 ,
        -0.8403168 , -0.8403168 ],
       [-0.6973805 , -0.7119789 , -0.7119789 , ..., -0.81187665,
        -0.7976566 , -0.7976566 ]], dtype=float32), array([[-0.55139625, -0.25942776, -0.21563247, ..., -0.5274753 ,
        -0.4421549 , -0.68389606],
       [-0.36161673, -0.5805931 , -0.21563247, ..., -1.082058  ,
        -1.0251776 , -1.4233395 ],
       [ 0.03254076, -0.28862458, -0.44920728, ...,  0.39682904,
        -0.38527465, -0.9398572 ],
       ...,
       [ 0.7332653 ,  0.52888733,  0.58728105, ..., -0.48481512,
        -0.51325524, -0.5985757 ],
       [ 0.7040684 ,  0.0617376 , -0.36161673, ..., -0.9398572 ,
        -0.6981161 , -0.54169536],
       [ 0.07633615, -0.15723877,  0.03254076, ..., -1.067838  ,
        -0.9967375 , -1.082058  ]], dtype=float32), None, None, array([[0.16392669, 0.19312355, 0.20772196, ..., 0.43948925, 0.33994877,
        0.0839875 ],
       [0.3975015 , 0.44129676, 0.4558952 , ..., 0.29728848, 0.15508783,
        0.0839875 ],
       [0.5580842 , 0.52888733, 0.5726826 , ..., 0.6954504 , 0.5816899 ,
        0.4252692 ],
       ...,
       [1.4339896 , 1.4339896 , 1.4339896 , ..., 1.6766349 , 1.6766349 ,
        1.6766349 ],
       [1.4485881 , 1.4631865 , 1.4631865 , ..., 1.7335151 , 1.705075  ,
        1.705075  ],
       [1.4047928 , 1.4047928 , 1.3901944 , ..., 1.7335151 , 1.7477353 ,
        1.7619553 ]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 22, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A keyboard and mouse along with other items on the desk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A toilet is in a bathroom with a blue wall and blue and white tile.\n', 'Find me an everyday image that matches the given caption: A downtown clock tower at the intersection of a busy street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man and a woman sitting down next to a railing one on the phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Man talking from a stage set with drums and a keyboard.\n', 'Find me an everyday image that matches the given caption: A man riding a horse with a helmet on.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 55/6000 [01:54<3:20:18,  2.02s/it]                                                   {'loss': 3.0291, 'grad_norm': 233.54122924804688, 'learning_rate': 5.500000000000001e-06, 'epoch': 0.01}
  1%|          | 55/6000 [01:54<3:20:18,  2.02s/it][2025-11-13 01:32:52,539] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,  38921,    624],
        [151643, 151643, 151643,  ...,    389,  16359,    624],
        [151643, 151643, 151643,  ...,   1045,  13041,    624],
        ...,
        [151643, 151643, 151643,  ...,   1251,   7404,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Several boats that are tied up in a canal.\n', 'Find me an everyday image that matches the given caption: A man wearing tennis whites playing tennis on grass.\n', 'Find me an everyday image that matches the given caption: A plate with rice, veggies, and some meat.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat that has just come through a doggie door.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two adult elephants are with a baby elephant that stands between them.\n', 'Find me an everyday image that matches the given caption: Several children standing in the grass playing soccer.\n', 'Find me an everyday image that matches the given caption: Otters investigating a frisbee thrown into their naturalistic enclosure.\n', 'Find me an everyday image that matches the given caption: A dog riding on a motorcycle with a person.\n', 'Find me an everyday image that matches the given caption: A person taking a photo of a group of people talking.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DA380>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9F90>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DAE00>], [<PIL.Image.Image image mode=RGB size=352x256 at 0x7F327278BF10>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727648B0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DA350>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8460>]], 'pixel_values': [None, None, None, array([[ 1.8427455 ,  1.8865409 ,  1.9303361 , ...,  2.145897  ,
         2.1316772 ,  2.117457  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.1316772 ],
       [ 1.9157377 ,  1.8865409 ,  1.7697535 , ...,  2.1316772 ,
         2.117457  ,  2.103237  ],
       ...,
       [-1.3105145 , -1.193727  , -1.1207349 , ..., -0.8403168 ,
         0.29728848,  0.80921096],
       [-1.704672  , -1.6608766 , -1.5586877 , ..., -0.8260967 ,
        -0.49903518, -0.68389606],
       [-1.0477428 , -1.0915381 , -1.0769397 , ...,  0.7381106 ,
         0.63857013,  0.6670103 ]], dtype=float32), None, array([[-1.7338688 , -1.6316798 , -1.6024829 , ...,  1.1504925 ,
         1.022512  ,  1.022512  ],
       [-1.5440893 , -1.6900735 , -1.6754751 , ...,  0.43948925,
         0.09820756,  0.31150854],
       [ 0.4558952 ,  0.52888733,  0.13472985, ...,  0.80921096,
         1.2500329 ,  1.022512  ],
       ...,
       [ 1.0544306 ,  0.8646511 ,  0.77706057, ...,  1.477554  ,
         1.5770944 ,  1.6624149 ],
       [ 1.0252337 ,  1.0836275 ,  1.0544306 , ...,  1.1931527 ,
         0.88031125,  0.7096705 ],
       [ 0.67487156,  0.6310763 ,  0.7040684 , ...,  0.6954504 ,
         0.7807708 ,  0.88031125]], dtype=float32), array([[ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.9011393 ,  1.9011393 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.9011393 ,  1.9011393 ,  1.9011393 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       ...,
       [ 0.19312355,  0.0617376 , -0.1718372 , ...,  0.52480966,
         0.39682904,  0.28306842],
       [ 0.33910778,  0.3537062 ,  0.49969047, ...,  0.1266477 ,
         0.15508783,  0.25462827],
       [ 0.61647785,  0.38290307,  0.01794233, ...,  0.6243501 ,
         0.6954504 ,  0.61013   ]], dtype=float32), array([[-1.7192703 , -1.7776641 , -1.7484672 , ..., -1.3806794 ,
        -1.3664593 , -1.3522393 ],
       [-1.7922626 , -1.7922626 , -1.7776641 , ..., -1.2526988 ,
        -1.2811389 , -1.1958185 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4517797 ],
       ...,
       [ 1.1858164 ,  1.2296118 ,  1.1858164 , ..., -1.4375596 ,
        -1.4233395 , -1.4233395 ],
       [ 0.8792495 ,  0.8646511 ,  0.85005265, ..., -1.4233395 ,
        -1.4233395 , -1.4375596 ],
       [ 0.93764323,  0.99603695,  1.1566195 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[ 0.13472985,  0.17852512,  0.29531252, ...,  2.145897  ,
         2.103237  ,  2.0890167 ],
       [ 1.9303361 ,  1.9011393 ,  1.9011393 , ...,  2.103237  ,
         2.103237  ,  2.117457  ],
       [ 0.38290307,  0.3975015 ,  0.41209993, ...,  1.0509521 ,
         1.463334  ,  1.9468161 ],
       ...,
       [-0.72657734, -0.72657734, -0.6973805 , ..., -0.89719707,
        -0.91141707, -0.9256371 ],
       [-0.78497106, -0.78497106, -0.7703726 , ..., -0.7265563 ,
        -0.7265563 , -0.68389606],
       [-0.60978997, -0.60978997, -0.59519154, ..., -0.7692165 ,
        -0.81187665, -0.882977  ]], dtype=float32), None, None, None, None, None, array([[-1.7183720e-01, -1.4264035e-01, -9.8845072e-02, ...,
        -2.8573421e-01, -2.5729406e-01, -2.8573421e-01],
       [ 1.9303361e+00,  1.8573440e+00,  1.8865409e+00, ...,
        -1.7197368e-01, -1.8619375e-01, -2.0041381e-01],
       [-3.9081356e-01, -3.7621516e-01, -3.7621516e-01, ...,
        -5.8213156e-02, -1.5552960e-02, -1.8619375e-01],
       ...,
       [-1.2804192e-01, -1.4264035e-01, -1.4264035e-01, ...,
         6.9767430e-02,  6.9767430e-02,  9.8207563e-02],
       [ 1.0553299e-01,  1.4932826e-01,  1.3472985e-01, ...,
         1.2887171e-02, -4.3993089e-02,  1.2887171e-02],
       [ 4.7139183e-02, -2.5852945e-02, -4.0451370e-02, ...,
        -1.3328948e-03, -1.5552960e-02, -2.9773025e-02]], dtype=float32), array([[ 0.7478637 ,  0.9230448 ,  1.098226  , ...,  0.38260898,
         0.63857013,  0.46792936],
       [ 1.2880055 ,  1.2588086 ,  1.3609976 , ..., -0.15775362,
         0.0413273 ,  0.31150854],
       [ 0.09093457,  0.42669836,  0.52888733, ...,  0.5390297 ,
         0.63857013,  0.4963695 ],
       ...,
       [ 0.03254076, -0.0550498 ,  0.10553299, ...,  0.85187113,
         0.93719155,  0.7807708 ],
       [-0.405412  , -0.2302309 , -0.33241987, ..., -1.309579  ,
        -1.3664593 , -1.1673783 ],
       [ 0.791659  ,  0.5726826 ,  0.33910778, ..., -0.78343654,
        -0.89719707, -0.65545595]], dtype=float32)], 'image_grid_thw': [None, None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 26]]), array([[ 1, 18, 24]]), None, None, None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Several boats that are tied up in a canal.\n', 'Find me an everyday image that matches the given caption: A man wearing tennis whites playing tennis on grass.\n', 'Find me an everyday image that matches the given caption: A plate with rice, veggies, and some meat.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat that has just come through a doggie door.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two adult elephants are with a baby elephant that stands between them.\n', 'Find me an everyday image that matches the given caption: Several children standing in the grass playing soccer.\n', 'Find me an everyday image that matches the given caption: Otters investigating a frisbee thrown into their naturalistic enclosure.\n', 'Find me an everyday image that matches the given caption: A dog riding on a motorcycle with a person.\n', 'Find me an everyday image that matches the given caption: A person taking a photo of a group of people talking.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 56/6000 [01:56<3:18:40,  2.01s/it]                                                   {'loss': 3.1543, 'grad_norm': 196.60032653808594, 'learning_rate': 5.600000000000001e-06, 'epoch': 0.01}
  1%|          | 56/6000 [01:56<3:18:40,  2.01s/it][2025-11-13 01:32:54,504] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  31415,   4935,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  12883,  11929,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A man holding a tennis racket and tennis ball.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People are standing and sitting near the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A colorful train going down the track by some trains.\n', 'Find me an everyday image that matches the given caption: A white polar bear and a little boy.\n', 'Find me an everyday image that matches the given caption: A bottle laying on top of a reflective surface.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bar lined with three different beer signs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=377x256 at 0x7F32727DBCD0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8550>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727D9AE0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D89D0>], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727D9D50>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727B61A0>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727DBB80>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DAEF0>], [None], [<PIL.Image.Image image mode=RGB size=256x382 at 0x7F32727D8040>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D86D0>]], 'pixel_values': [None, array([[-0.15723877,  0.6456747 ,  0.58728105, ...,  1.2215928 ,
         1.2784731 ,  1.3353534 ],
       [ 0.5726826 ,  0.58728105,  0.6018794 , ...,  1.4348938 ,
         1.4064537 ,  1.3780135 ],
       [ 0.6018794 ,  1.7989503 ,  1.8719424 , ...,  1.0082918 ,
         1.0936122 ,  1.2500329 ],
       ...,
       [-1.6900735 , -1.704672  , -1.7484672 , ...,  2.117457  ,
         2.0890167 ,  0.8660912 ],
       [-1.5732862 , -1.5732862 , -1.5732862 , ...,  0.88031125,
         0.90875137,  0.90875137],
       [-1.500294  , -1.500294  , -1.5294908 , ...,  0.96563166,
         0.88031125,  0.09820756]], dtype=float32), array([[-1.6170814 , -1.193727  , -1.0477428 , ..., -0.74077636,
        -0.6270158 , -0.7692165 ],
       [-1.2959161 , -1.4564987 , -1.3105145 , ..., -1.0962781 ,
        -1.2100385 , -1.309579  ],
       [-1.4127034 , -1.6024829 , -1.6316798 , ..., -0.95407724,
        -0.5559154 , -0.8260967 ],
       ...,
       [-0.24482933, -0.14264035,  0.16392669, ..., -0.11509342,
        -0.18619375, -0.4137148 ],
       [ 0.89384794,  0.8062574 ,  0.76246214, ...,  0.4537093 ,
         0.3257286 ,  0.6527902 ],
       [ 0.5726826 , -0.25942776,  0.09093457, ..., -0.27151415,
        -0.32839438, -0.42793486]], dtype=float32), array([[-1.398105  , -1.4127034 , -1.4127034 , ..., -0.8260967 ,
        -0.91141707, -0.86875695],
       [ 0.17852512,  0.30991095,  0.03254076, ...,  0.43948925,
         0.59590995,  0.59590995],
       [-0.6389868 , -0.6243884 , -0.5659947 , ..., -0.91141707,
        -0.882977  , -0.86875695],
       ...,
       [-0.04045137, -0.08424664, -0.01125452, ..., -1.067838  ,
        -1.2811389 , -1.2100385 ],
       [-1.5586877 , -1.2375224 , -1.0039475 , ...,  0.3257286 ,
         0.31150854,  0.29728848],
       [ 1.098226  ,  0.6456747 ,  0.32450938, ...,  0.18352796,
         0.15508783,  0.28306842]], dtype=float32), array([[ 1.9157377,  1.9157377,  1.9157377, ...,  2.0890167,  2.0890167,
         2.0890167],
       [ 1.9157377,  1.9157377,  1.9011393, ...,  2.117457 ,  2.117457 ,
         2.117457 ],
       [ 1.9011393,  1.9011393,  1.9011393, ...,  2.0463567,  2.0605767,
         2.0605767],
       ...,
       [-1.2813176, -1.2959161, -1.3689082, ..., -1.2526988, -1.2384787,
        -1.2100385],
       [-1.4710971, -1.193727 , -1.1061366, ..., -1.2384787, -1.2100385,
        -1.3522393],
       [-1.2813176, -1.3105145, -1.3251129, ..., -1.2242587, -1.1531583,
        -0.9967375]], dtype=float32), None, array([[ 0.61647785,  0.71866685,  0.7478637 , ...,  0.5390297 ,
         0.68123037,  0.75233066],
       [ 0.44129676,  0.61647785,  0.77706057, ...,  0.88031125,
         0.8376511 ,  0.7807708 ],
       [ 0.7040684 ,  0.7478637 ,  0.8062574 , ...,  1.9610363 ,
         1.9325962 ,  1.875716  ],
       ...,
       [-0.6389868 , -0.20103405, -0.6389868 , ..., -1.1815984 ,
        -1.1104981 , -1.082058  ],
       [-1.1353334 , -1.1353334 , -1.1207349 , ..., -1.2242587 ,
        -1.2100385 , -1.2384787 ],
       [-1.1061366 , -1.1061366 , -1.1061366 , ..., -1.309579  ,
        -1.3237991 , -1.2811389 ]], dtype=float32), None, None, None, array([[-1.0769397 , -1.1499318 , -1.1791286 , ..., -0.8403168 ,
        -0.8403168 , -0.7976566 ],
       [-1.1645303 , -1.1499318 , -1.1353334 , ..., -0.65545595,
        -0.65545595, -0.68389606],
       [-1.0623412 , -1.0623412 , -1.0331444 , ..., -0.68389606,
        -0.6981161 , -0.71233624],
       ...,
       [ 0.23691882,  0.12013142,  0.12013142, ...,  0.26884836,
         0.26884836,  0.18352796],
       [ 0.5142889 ,  0.48509204,  0.3537062 , ...,  0.35416883,
         0.0839875 ,  0.1266477 ],
       [ 0.61647785,  0.48509204,  0.44129676, ...,  0.25462827,
         0.19774802,  0.0839875 ]], dtype=float32), array([[ 1.0106354 ,  0.9084464 ,  1.0398322 , ...,  1.0509521 ,
         1.264253  ,  1.1789327 ],
       [-0.33241987, -0.4638057 , -0.405412  , ...,  1.1504925 ,
         1.2215928 ,  1.2215928 ],
       [ 0.99603695,  1.1420212 ,  0.9814385 , ...,  1.2784731 ,
         0.85187113,  0.75233066],
       ...,
       [ 1.0252337 ,  1.1128243 ,  1.171218  , ...,  1.2926931 ,
         1.1931527 ,  1.1647125 ],
       [ 1.273407  ,  1.1128243 ,  1.0690291 , ...,  1.3069133 ,
         1.264253  ,  1.2358129 ],
       [ 1.0252337 ,  1.1128243 ,  1.0690291 , ...,  1.4064537 ,
         1.3211333 ,  1.1220524 ]], dtype=float32), array([[ 0.42669836,  0.42669836,  0.38290307, ...,  0.52480966,
         0.4537093 ,  0.5532498 ],
       [-0.11344349,  0.33910778,  0.26611567, ...,  0.11242763,
         0.05554737,  0.05554737],
       [ 0.49969047,  0.48509204,  0.44129676, ...,  0.48214942,
         0.48214942,  0.52480966],
       ...,
       [-0.55139625, -0.96015227, -1.2813176 , ..., -0.9967375 ,
        -1.0536178 , -1.1247182 ],
       [-0.49300256, -0.5221994 , -0.55139625, ..., -0.9398572 ,
        -1.0962781 , -1.1531583 ],
       [-1.4419003 , -1.3835065 , -1.3835065 , ..., -1.0536178 ,
        -0.7692165 , -0.42793486]], dtype=float32), None, array([[ 0.17852512,  0.19312355,  0.19312355, ...,  1.1078323 ,
         1.1078323 ,  1.1078323 ],
       [ 0.2807141 ,  0.2807141 ,  0.2807141 , ...,  1.0793922 ,
         1.0793922 ,  1.0793922 ],
       [ 0.33910778,  0.33910778,  0.3537062 , ...,  1.0936122 ,
         1.0936122 ,  1.0936122 ],
       ...,
       [ 0.00334391, -0.11344349, -0.14264035, ..., -0.81187665,
        -0.8545369 , -0.9398572 ],
       [-0.303223  , -0.28862458, -0.25942776, ..., -0.7976566 ,
        -0.7692165 , -0.7976566 ],
       [-0.33241987, -0.28862458, -0.36161673, ..., -0.7265563 ,
        -0.7692165 , -0.7976566 ]], dtype=float32), array([[-1.7922626 , -1.3251129 , -1.7484672 , ...,  0.9940718 ,
         1.2784731 ,  1.5486543 ],
       [-1.5440893 , -1.6170814 , -1.6462783 , ...,  1.7335151 ,
         1.7477353 ,  1.7903955 ],
       [-1.5586877 ,  0.8646511 ,  1.2588086 , ...,  1.6339747 ,
         1.7192951 ,  1.8046155 ],
       ...,
       [-0.5805931 , -0.36161673, -0.15723877, ..., -0.29995427,
        -0.35683453, -1.3664593 ],
       [-0.25942776, -0.21563247, -0.18643562, ..., -1.4659997 ,
        -1.4802198 , -1.4802198 ],
       [-0.43460885, -0.43460885, -0.43460885, ..., -1.4091195 ,
        -1.2384787 , -1.4802198 ]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 26]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A man holding a tennis racket and tennis ball.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People are standing and sitting near the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A colorful train going down the track by some trains.\n', 'Find me an everyday image that matches the given caption: A white polar bear and a little boy.\n', 'Find me an everyday image that matches the given caption: A bottle laying on top of a reflective surface.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bar lined with three different beer signs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 57/6000 [01:58<3:19:30,  2.01s/it]                                                   {'loss': 2.891, 'grad_norm': 143.78921508789062, 'learning_rate': 5.7e-06, 'epoch': 0.01}
  1%|          | 57/6000 [01:58<3:19:30,  2.01s/it][2025-11-13 01:32:56,539] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  29388,    432,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The advertisment shows a young man knitting a yellow tie while wearing it.\n', 'Find me an everyday image that matches the given caption: Some purple flowers are in a white vase.\n', 'Find me an everyday image that matches the given caption: A young child in a snow outfit and goggles with skis on in the snow.\n', 'Find me an everyday image that matches the given caption: Two cats eating out of one food bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A police motorcycle driving along a street with flags flying from his vehicle.\n', 'Find me an everyday image that matches the given caption: A person sitting in a chair with a laptop and other computers in the background.\n', 'Find me an everyday image that matches the given caption: A dog wearing sunglasses setting in the passenger seat of a car.\n', 'Find me an everyday image that matches the given caption: A man with a funny look in his face is looking at his pizza.\n', 'Find me an everyday image that matches the given caption: Nested measuring cups and spoons on a gray surface.\n', 'Find me an everyday image that matches the given caption: A plated with pizza a knife and a fork and a yard stick laying beside it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x353 at 0x7F32727D9750>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D9E10>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DB1C0>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=455x256 at 0x7F32727D8DC0>], [None], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DBC70>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA470>]], 'pixel_values': [array([[-0.6243884 , -0.7411758 , -0.5367978 , ..., -0.9825174 ,
        -0.95407724, -0.9398572 ],
       [ 0.09093457,  0.14932826,  0.26611567, ..., -0.8260967 ,
        -0.9967375 , -1.0536178 ],
       [-0.28862458, -0.42001042, -0.42001042, ..., -0.45637497,
        -0.57013553, -0.71233624],
       ...,
       [-0.18643562, -0.1718372 , -0.1718372 , ..., -1.2526988 ,
        -1.2669188 , -1.2669188 ],
       [-0.18643562, -0.18643562, -0.18643562, ..., -1.0962781 ,
        -1.082058  , -1.0393977 ],
       [-0.2740262 , -0.25942776, -0.25942776, ..., -0.95407724,
        -0.89719707, -0.86875695]], dtype=float32), array([[-0.2740262 , -0.25942776, -0.2302309 , ..., -0.21463387,
        -0.21463387, -0.25729406],
       [-0.02585294, -0.02585294, -0.12804192, ..., -0.10087335,
        -0.10087335, -0.08665328],
       [-0.5367978 , -0.405412  , -0.33241987, ..., -0.4137148 ,
        -0.4421549 , -0.4421549 ],
       ...,
       [-0.12804192, -0.01125452,  0.0617376 , ..., -0.5559154 ,
        -0.6270158 , -0.58435565],
       [-0.7411758 , -0.68278205, -0.87256163, ..., -0.68389606,
        -0.5985757 , -0.48481512],
       [-0.82876635, -0.88716006, -0.6973805 , ..., -0.48481512,
        -0.21463387, -0.08665328]], dtype=float32), array([[ 0.30991095,  0.29531252,  0.2807141 , ..., -0.7976566 ,
        -0.78343654, -0.7692165 ],
       [ 0.10553299,  0.10553299,  0.12013142, ..., -0.65545595,
        -0.5985757 , -0.51325524],
       [ 0.2807141 ,  0.26611567,  0.30991095, ..., -1.0536178 ,
        -1.082058  , -1.082058  ],
       ...,
       [ 0.0617376 , -0.01125452, -0.06964822, ..., -0.07243322,
        -0.08665328, -0.11509342],
       [ 0.07633615,  0.04713918,  0.00334391, ..., -0.4421549 ,
        -0.4421549 , -0.4421549 ],
       [ 0.49969047,  0.6018794 ,  0.68947   , ..., -0.18619375,
        -0.14353354, -0.08665328]], dtype=float32), None, None, None, None, array([[-0.9163569 , -1.1207349 , -0.96015227, ..., -1.2526988 ,
        -1.309579  , -1.2953589 ],
       [-1.2959161 , -1.4127034 , -1.4127034 , ..., -1.1531583 ,
        -1.1531583 , -1.1958185 ],
       [-1.5294908 , -1.5148925 , -1.5294908 , ..., -1.2669188 ,
        -1.2384787 , -1.2100385 ],
       ...,
       [-1.3397113 , -1.3543098 , -0.68278205, ..., -1.1815984 ,
        -1.2100385 , -1.2811389 ],
       [-0.7995695 , -0.09884507, -0.04045137, ..., -1.2100385 ,
        -1.0962781 , -1.1247182 ],
       [-0.8433648 , -0.6681836 , -0.405412  , ...,  0.16930789,
        -0.86875695, -0.81187665]], dtype=float32), None, None, None, None, None, None, array([[ 1.8135487 ,  1.8135487 ,  1.8427455 , ..., -0.5559154 ,
        -0.7265563 , -0.8545369 ],
       [-1.2083255 , -1.2813176 , -1.2813176 , ..., -0.86875695,
        -0.7976566 , -0.71233624],
       [ 1.9303361 ,  1.9157377 ,  1.9011393 , ..., -0.49903518,
        -0.2857342 , -0.11509342],
       ...,
       [-1.0915381 , -1.1499318 , -0.5659947 , ..., -0.18619375,
        -0.35683453, -0.5985757 ],
       [-1.018546  , -0.9893491 , -0.96015227, ..., -0.48481512,
        -0.5985757 , -1.067838  ],
       [-0.08424664,  0.16392669,  0.25151724, ..., -0.669676  ,
        -0.9256371 , -1.1247182 ]], dtype=float32), array([[-1.3105145 , -1.4564987 , -1.2959161 , ..., -1.082058  ,
        -1.0962781 , -1.067838  ],
       [-1.2813176 , -1.2813176 , -1.3543098 , ..., -0.5559154 ,
        -0.243074  ,  0.1266477 ],
       [-1.0769397 , -1.0477428 , -1.0477428 , ..., -0.48481512,
        -0.8260967 , -0.9398572 ],
       ...,
       [ 1.6383677 ,  1.4485881 ,  1.5069818 , ...,  1.6766349 ,
         1.6624149 ,  1.6624149 ],
       [ 1.6237692 ,  1.5945723 ,  1.5945723 , ...,  1.5770944 ,
         1.5344343 ,  1.477554  ],
       [ 1.3901944 ,  1.3609976 ,  1.3901944 , ...,  1.3353534 ,
         1.3211333 ,  1.3069133 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 26, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, None, None, None, array([[ 1, 18, 32]]), None, None, None, None, None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The advertisment shows a young man knitting a yellow tie while wearing it.\n', 'Find me an everyday image that matches the given caption: Some purple flowers are in a white vase.\n', 'Find me an everyday image that matches the given caption: A young child in a snow outfit and goggles with skis on in the snow.\n', 'Find me an everyday image that matches the given caption: Two cats eating out of one food bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A police motorcycle driving along a street with flags flying from his vehicle.\n', 'Find me an everyday image that matches the given caption: A person sitting in a chair with a laptop and other computers in the background.\n', 'Find me an everyday image that matches the given caption: A dog wearing sunglasses setting in the passenger seat of a car.\n', 'Find me an everyday image that matches the given caption: A man with a funny look in his face is looking at his pizza.\n', 'Find me an everyday image that matches the given caption: Nested measuring cups and spoons on a gray surface.\n', 'Find me an everyday image that matches the given caption: A plated with pizza a knife and a fork and a yard stick laying beside it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 58/6000 [02:00<3:17:32,  1.99s/it]                                                   {'loss': 2.9324, 'grad_norm': 153.35987854003906, 'learning_rate': 5.8e-06, 'epoch': 0.01}
  1%|          | 58/6000 [02:00<3:17:32,  1.99s/it][2025-11-13 01:32:58,484] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,   6118,    624],
        [151643, 151643, 151643,  ...,    264,  42693,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    916,   3015,    624],
        [151643, 151643, 151643,  ...,    279,   5636,    624],
        [151643, 151643, 151643,  ...,    279,   4004,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A group of friends flying a long kite in a park.\n', 'Find me an everyday image that matches the given caption: A white outhouse toilet sitting inside of a stall.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skate board rider skating up a ramp near a fence.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of girls standing in a livin groom holding Wii controllers.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A train that is crossing a bridge over water.\n', 'Find me an everyday image that matches the given caption: A picture of a car driving down the road.\n', 'Find me an everyday image that matches the given caption: Several people on surfboards in the ocean with a ship in the background.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB850>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB640>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBB20>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727D9EA0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727DA530>], [None], [<PIL.Image.Image image mode=RGB size=375x256 at 0x7F32727DBA00>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727DBFA0>], [None], [<PIL.Image.Image image mode=RGB size=369x256 at 0x7F32727D8D90>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DA0B0>], [None], [None], [None]], 'pixel_values': [None, None, array([[ 1.2442101 ,  1.2588086 ,  1.3318007 , ...,  2.074797  ,
         2.074797  ,  2.0890167 ],
       [ 1.6967614 ,  1.7113597 ,  1.7551551 , ...,  2.074797  ,
         2.0890167 ,  2.103237  ],
       [ 1.2150133 ,  1.2296118 ,  1.2588086 , ...,  2.0321364 ,
         2.0463567 ,  2.117457  ],
       ...,
       [-0.02585294,  0.00334391,  0.00334391, ...,  0.21196808,
         0.21196808,  0.22618815],
       [-0.02585294, -0.02585294, -0.02585294, ...,  0.11242763,
         0.11242763,  0.11242763],
       [-0.0550498 , -0.0550498 , -0.0550498 , ...,  0.14086775,
         0.14086775,  0.14086775]], dtype=float32), array([[-0.21563247, -0.36161673, -0.42001042, ...,  0.51058954,
         0.7381106 ,  0.8376511 ],
       [ 0.66027313,  0.68947   ,  0.41209993, ...,  1.1220524 ,
         1.2215928 ,  1.6339747 ],
       [ 0.26611567, -0.3470183 , -0.31782144, ...,  1.3780135 ,
         1.6339747 ,  1.6055346 ],
       ...,
       [-0.6973805 , -0.6243884 , -0.6243884 , ..., -0.42793486,
        -0.42793486, -0.4137148 ],
       [-0.5659947 , -0.5221994 , -0.5221994 , ..., -0.39949474,
        -0.35683453, -0.3710546 ],
       [-0.6389868 , -0.6389868 , -0.6389868 , ..., -0.42793486,
        -0.42793486, -0.4137148 ]], dtype=float32), array([[ 6.1647785e-01,  6.1647785e-01,  6.3107628e-01, ...,
         5.9590995e-01,  7.3811060e-01,  8.9453131e-01],
       [ 2.9531252e-01,  3.6830464e-01,  7.6246214e-01, ...,
         9.3719155e-01,  1.0225120e+00,  1.0082918e+00],
       [ 7.6246214e-01,  6.1647785e-01,  6.0187942e-01, ...,
         1.1078323e+00,  1.1362724e+00,  1.0936122e+00],
       ...,
       [ 6.0187942e-01,  7.3326528e-01,  7.4786371e-01, ...,
         7.0967048e-01,  6.8123037e-01,  7.5233066e-01],
       [ 3.2540757e-02,  6.1737604e-02,  6.1737604e-02, ...,
        -2.0041381e-01, -1.3328948e-03,  1.9774802e-01],
       [ 3.5370621e-01,  3.9750150e-01,  4.8509204e-01, ...,
         1.3637935e+00,  1.4917741e+00,  1.5344343e+00]], dtype=float32), array([[ 1.2296118 ,  1.2296118 ,  1.2296118 , ...,  1.9752562 ,
         1.9894764 ,  2.0036962 ],
       [ 1.3026038 ,  1.2880055 ,  1.2588086 , ...,  1.9752562 ,
         1.9752562 ,  1.9610363 ],
       [ 1.3463992 ,  1.3463992 ,  1.3463992 , ...,  1.918376  ,
         1.918376  ,  1.9041561 ],
       ...,
       [ 0.2223204 ,  0.42669836,  0.17852512, ..., -0.05821316,
         0.09820756,  0.1266477 ],
       [ 0.9668401 ,  1.1420212 ,  0.9668401 , ...,  0.3257286 ,
         0.31150854,  0.48214942],
       [ 0.8646511 ,  0.8208558 ,  0.8792495 , ...,  0.4963695 ,
         0.48214942,  0.36838892]], dtype=float32), array([[ 0.01794233, -0.0550498 , -0.0550498 , ..., -0.243074  ,
        -0.5274753 , -0.81187665],
       [-0.7995695 , -0.68278205, -1.1061366 , ..., -0.95407724,
        -0.71233624, -0.58435565],
       [-1.6170814 , -1.4419003 , -1.3835065 , ..., -1.3664593 ,
        -1.3237991 , -1.309579  ],
       ...,
       [ 1.6821629 ,  1.6821629 ,  1.6967614 , ...,  1.6766349 ,
         1.6766349 ,  1.7192951 ],
       [ 1.5507771 ,  1.5653756 ,  1.6091708 , ...,  1.3069133 ,
         1.2926931 ,  1.2926931 ],
       [ 1.5945723 ,  1.6091708 ,  1.5945723 , ..., -0.08665328,
        -0.11509342, -0.11509342]], dtype=float32), None, array([[ 0.01794233,  0.03254076,  0.03254076, ...,  0.6527902 ,
         0.6527902 ,  0.6527902 ],
       [-0.04045137, -0.04045137, -0.04045137, ...,  0.7096705 ,
         0.72389054,  0.7381106 ],
       [ 0.25151724,  0.19312355,  0.12013142, ...,  0.61013   ,
         0.59590995,  0.59590995],
       ...,
       [-1.0477428 , -0.9163569 , -0.9893491 , ..., -1.3522393 ,
        -1.3664593 , -1.3380191 ],
       [-1.2375224 , -1.1061366 , -0.6243884 , ..., -1.2811389 ,
        -1.3948994 , -1.0109575 ],
       [-0.65358526, -0.6389868 , -0.8141679 , ..., -1.2384787 ,
        -1.2811389 , -1.2669188 ]], dtype=float32), array([[-0.04045137, -0.04045137, -0.02585294, ..., -0.45637497,
        -0.4421549 , -0.45637497],
       [ 0.00334391,  0.10553299,  0.10553299, ..., -0.31417432,
        -0.51325524, -0.68389606],
       [ 0.01794233,  0.03254076,  0.0617376 , ..., -0.39949474,
        -0.38527465, -0.38527465],
       ...,
       [-0.28862458, -0.94555384, -0.96015227, ..., -1.2811389 ,
        -1.309579  , -1.3237991 ],
       [ 1.273407  ,  1.2588086 ,  1.2442101 , ..., -0.29995427,
        -0.29995427, -0.29995427],
       [-0.87256163, -0.9017585 , -0.9309554 , ..., -0.39949474,
        -0.4137148 , -0.39949474]], dtype=float32), None, array([[-0.02585294,  0.01794233,  0.0617376 , ...,  0.823431  ,
         0.8376511 ,  0.8660912 ],
       [ 0.3975015 ,  0.42669836,  0.4704936 , ...,  1.1789327 ,
         1.2073728 ,  1.2358129 ],
       [ 0.26611567,  0.2807141 ,  0.30991095, ...,  1.036732  ,
         1.0936122 ,  1.1078323 ],
       ...,
       [-1.0769397 , -1.1499318 , -1.1207349 , ..., -1.0109575 ,
        -1.0251776 , -0.96829736],
       [-1.6316798 , -1.4856956 , -1.2813176 , ..., -0.9825174 ,
        -0.9256371 , -0.91141707],
       [-1.193727  , -1.2083255 , -1.2521207 , ..., -0.9967375 ,
        -0.9825174 , -1.0536178 ]], dtype=float32), array([[-0.06964822,  0.23691882, -0.5659947 , ..., -0.96829736,
        -0.6412359 , -0.01555296],
       [ 0.30991095,  0.29531252,  0.48509204, ..., -0.8403168 ,
        -0.6412359 , -0.21463387],
       [-0.11344349,  0.23691882,  0.19312355, ...,  0.26884836,
         0.22618815,  0.06976743],
       ...,
       [ 1.0252337 ,  1.1128243 ,  1.0836275 , ...,  2.0179167 ,
         1.8188357 ,  1.6055346 ],
       [ 1.098226  ,  1.171218  ,  1.3026038 , ...,  1.477554  ,
         1.4064537 ,  1.1931527 ],
       [ 1.4631865 ,  1.5215802 ,  1.4923834 , ...,  1.6766349 ,
         1.7192951 ,  1.7335151 ]], dtype=float32), None, None, None], 'image_grid_thw': [None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A group of friends flying a long kite in a park.\n', 'Find me an everyday image that matches the given caption: A white outhouse toilet sitting inside of a stall.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skate board rider skating up a ramp near a fence.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of girls standing in a livin groom holding Wii controllers.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A train that is crossing a bridge over water.\n', 'Find me an everyday image that matches the given caption: A picture of a car driving down the road.\n', 'Find me an everyday image that matches the given caption: Several people on surfboards in the ocean with a ship in the background.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 59/6000 [02:02<3:15:29,  1.97s/it]                                                   {'loss': 2.9193, 'grad_norm': 230.9863739013672, 'learning_rate': 5.9e-06, 'epoch': 0.01}
  1%|          | 59/6000 [02:02<3:15:29,  1.97s/it][2025-11-13 01:33:00,413] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   4017,   5562,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,  56411,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A smiling guy sitting in a car with a hot dog.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An urban landscape photo with the Washington monument in the background and a street signal in the foreground.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Three men sit at a table and work on their laptop computers.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large boat is coming down a river.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of double decker buses with advertisements on them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There are several large boats in the harbor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3274FE8700>], [None], [<PIL.Image.Image image mode=RGB size=256x381 at 0x7F32727D9D50>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DB130>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA1A0>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F32727D9570>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727D80D0>], [None], [<PIL.Image.Image image mode=RGB size=320x256 at 0x7F32727DB610>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DB1F0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DBFD0>], [<PIL.Image.Image image mode=RGB size=317x256 at 0x7F32727D9D20>]], 'pixel_values': [array([[-0.12804192, -0.12804192, -0.11344349, ...,  0.05554737,
         0.06976743,  0.09820756],
       [-0.01125452,  0.00334391,  0.03254076, ...,  0.24040821,
         0.25462827,  0.26884836],
       [-0.49300256, -0.47840413, -0.44920728, ...,  0.26884836,
         0.25462827,  0.26884836],
       ...,
       [-1.0915381 , -1.0623412 , -1.0331444 , ..., -0.9398572 ,
        -0.96829736, -0.96829736],
       [-1.193727  , -1.2229239 , -1.2521207 , ..., -0.9825174 ,
        -1.0109575 , -0.9825174 ],
       [-1.2375224 , -1.193727  , -1.1791286 , ..., -0.9825174 ,
        -0.9967375 , -1.0393977 ]], dtype=float32), None, array([[-0.9309554 , -0.94555384, -0.94555384, ..., -0.882977  ,
        -0.89719707, -0.882977  ],
       [-0.82876635, -0.78497106, -0.7411758 , ..., -0.47059506,
        -0.4137148 , -0.42793486],
       [-0.82876635, -0.87256163, -0.9163569 , ..., -0.8403168 ,
        -0.86875695, -0.882977  ],
       ...,
       [-0.14264035,  0.01794233, -0.04045137, ..., -0.51325524,
        -0.45637497, -0.3710546 ],
       [-1.3251129 , -1.3689082 , -1.398105  , ..., -0.11509342,
        -0.22885394, -0.2857342 ],
       [-1.3835065 , -1.2813176 , -1.1061366 , ..., -0.3710546 ,
        -0.3710546 , -0.35683453]], dtype=float32), None, array([[-0.94555384, -0.94555384, -0.94555384, ..., -1.0251776 ,
        -1.0109575 , -1.0109575 ],
       [-0.9309554 , -0.9309554 , -0.88716006, ..., -0.9967375 ,
        -0.9967375 , -0.9967375 ],
       [-0.9163569 , -0.9163569 , -0.9163569 , ..., -0.9967375 ,
        -0.9967375 , -0.9967375 ],
       ...,
       [-1.3105145 , -0.6681836 , -0.5659947 , ..., -0.8545369 ,
        -0.8545369 , -0.8545369 ],
       [-1.7776641 , -1.7630657 , -1.7630657 , ..., -0.95407724,
        -0.9256371 , -0.9256371 ],
       [-0.7557742 , -0.6389868 , -0.5805931 , ..., -0.89719707,
        -0.89719707, -0.89719707]], dtype=float32), None, array([[-1.3689082 , -1.7922626 , -1.7776641 , ..., -1.2953589 ,
        -1.4802198 , -1.4802198 ],
       [-1.6316798 , -1.6608766 , -1.7338688 , ..., -1.4802198 ,
        -1.4802198 , -1.3806794 ],
       [-1.4710971 , -1.500294  , -1.4564987 , ..., -1.4659997 ,
        -0.95407724, -0.95407724],
       ...,
       [-1.6462783 , -1.7630657 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.704672  , -1.7192703 , -1.7338688 , ..., -1.3522393 ,
        -1.4091195 , -1.4659997 ],
       [-1.6316798 , -1.2083255 , -1.4419003 , ..., -1.0109575 ,
        -1.4233395 , -1.3380191 ]], dtype=float32), array([[-0.25942776, -0.25942776, -0.25942776, ..., -0.9256371 ,
        -1.0393977 , -1.1104981 ],
       [-0.50760096, -0.49300256, -0.50760096, ..., -1.309579  ,
        -1.3237991 , -1.3237991 ],
       [-0.31782144, -0.2302309 , -0.20103405, ..., -0.81187665,
        -0.86875695, -1.0109575 ],
       ...,
       [ 0.9668401 ,  0.9814385 ,  0.76246214, ..., -0.17197368,
        -0.3710546 , -0.48481512],
       [-0.7119789 , -0.55139625, -0.6389868 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.2083255 , -1.1645303 , -1.0915381 , ..., -0.34261447,
        -0.49903518, -0.6412359 ]], dtype=float32), array([[ 0.71866685,  0.7332653 ,  0.7478637 , ..., -0.18619375,
        -0.18619375, -0.20041381],
       [ 0.71866685,  0.7040684 ,  0.7332653 , ..., -0.18619375,
        -0.20041381, -0.21463387],
       [ 0.8354542 ,  0.8354542 ,  0.8354542 , ..., -0.01555296,
        -0.02977302, -0.04399309],
       ...,
       [-0.0550498 ,  0.16392669,  0.16392669, ..., -0.54169536,
        -0.7692165 , -1.082058  ],
       [-0.3470183 , -0.39081356, -0.405412  , ..., -1.1247182 ,
        -1.1247182 , -1.2384787 ],
       [ 0.04713918,  0.2223204 ,  0.3975015 , ..., -0.9398572 ,
        -0.86875695, -0.7549964 ]], dtype=float32), None, array([[ 1.4631865 ,  1.6091708 ,  1.7113597 , ...,  1.4348938 ,
         1.3637935 ,  1.3637935 ],
       [ 1.3609976 ,  1.3901944 ,  1.4631865 , ...,  1.4491138 ,
         1.4491138 ,  1.5486543 ],
       [ 1.3172023 ,  1.4923834 ,  1.6237692 , ...,  1.4064537 ,
         1.2784731 ,  1.2358129 ],
       ...,
       [ 0.42669836,  0.4558952 ,  0.48509204, ...,  0.8660912 ,
         0.8660912 ,  0.8660912 ],
       [-1.018546  , -0.9893491 , -1.0039475 , ...,  0.6527902 ,
         0.6527902 ,  0.6670103 ],
       [ 0.66027313,  0.68947   ,  0.7040684 , ...,  0.85187113,
         0.85187113,  0.85187113]], dtype=float32), None, array([[-1.1937270e+00, -1.0331444e+00, -1.1645303e+00, ...,
         2.9728848e-01,  4.1104910e-01, -1.3328948e-03],
       [-5.2219939e-01, -9.6015227e-01, -8.1416792e-01, ...,
        -1.0393977e+00, -9.3985718e-01, -8.9719707e-01],
       [ 1.7852512e-01,  1.9312355e-01,  2.8071409e-01, ...,
         8.2343102e-01,  7.6655072e-01,  6.2435007e-01],
       ...,
       [ 3.3910778e-01,  3.3910778e-01,  4.1209993e-01, ...,
        -1.2100385e+00, -1.2100385e+00, -1.2384787e+00],
       [ 2.6611567e-01,  2.9531252e-01,  3.3910778e-01, ...,
        -1.0536178e+00, -1.0820580e+00, -1.1389382e+00],
       [ 2.8071409e-01,  3.2540757e-02, -6.9648221e-02, ...,
        -1.3380191e+00, -1.3237991e+00, -1.3237991e+00]], dtype=float32), None, array([[-0.36161673, -0.36161673, -0.36161673, ..., -0.78343654,
        -0.81187665, -0.81187665],
       [-0.15723877, -0.1718372 , -0.0550498 , ...,  0.46792936,
         0.88031125, -0.243074  ],
       [-0.7119789 , -0.7119789 , -0.7119789 , ..., -0.8403168 ,
        -0.8403168 , -0.8403168 ],
       ...,
       [-1.4856956 , -1.398105  , -0.0550498 , ..., -0.27151415,
        -0.31417432, -0.34261447],
       [ 1.6091708 ,  1.7405566 ,  1.6383677 , ..., -1.309579  ,
        -0.96829736,  0.11242763],
       [-0.7703726 ,  0.52888733,  1.1566195 , ..., -0.57013553,
        -0.669676  , -0.882977  ]], dtype=float32), array([[-0.2302309 , -0.2302309 , -0.24482933, ..., -1.2811389 ,
        -1.2811389 , -1.2669188 ],
       [-0.14264035, -0.18643562, -0.24482933, ..., -1.2953589 ,
        -1.2953589 , -1.309579  ],
       [-0.88716006, -0.9017585 , -0.9309554 , ..., -0.7692165 ,
        -0.7549964 , -0.78343654],
       ...,
       [ 1.3901944 ,  1.3609976 ,  1.3172023 , ..., -0.7692165 ,
        -0.74077636, -0.71233624],
       [ 0.791659  ,  0.77706057,  0.77706057, ..., -0.54169536,
        -0.51325524, -0.48481512],
       [ 0.95224166,  0.89384794,  0.8646511 , ..., -0.95407724,
        -1.0393977 , -1.067838  ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 22]]), None, array([[ 1, 24, 18]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 22]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A smiling guy sitting in a car with a hot dog.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An urban landscape photo with the Washington monument in the background and a street signal in the foreground.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Three men sit at a table and work on their laptop computers.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large boat is coming down a river.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of double decker buses with advertisements on them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There are several large boats in the harbor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 60/6000 [02:04<3:19:30,  2.02s/it]                                                   {'loss': 3.0449, 'grad_norm': 146.16180419921875, 'learning_rate': 6e-06, 'epoch': 0.01}
  1%|          | 60/6000 [02:04<3:19:30,  2.02s/it][2025-11-13 01:33:02,526] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  24837,   4752,    624],
        [151643, 151643, 151643,  ...,  18217,  26148,    624],
        [151643, 151643, 151643,  ...,    279,   8380,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,   7310,    624],
        [151643, 151643, 151643,  ...,  42235,   1803,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A baby elephant standing in front of a brick building.\n', 'Find me an everyday image that matches the given caption: A dog that is laying down on a pink couch.\n', 'Find me an everyday image that matches the given caption: A tusked elephant standing in an open field in the wild.\n', 'Find me an everyday image that matches the given caption: Several ponies are standing around near a fence.\n', 'Find me an everyday image that matches the given caption: A flower arrangement in a vase on a tile floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cows walk along a beach with a mountain in the distance.\n', 'Find me an everyday image that matches the given caption: A big bright yellow school bus at night in the dark.\n', 'Find me an everyday image that matches the given caption: A stop sign on a pole above a no parking sign.\n', 'Find me an everyday image that matches the given caption: A man standing in front of a white house.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat is sitting on top of a vehicle.\n', 'Find me an everyday image that matches the given caption: A parking meter next to a parked car.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB1C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8DC0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBC70>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA470>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DA590>]], 'pixel_values': [None, None, None, None, None, array([[ 1.0690291 ,  1.0836275 ,  1.098226  , ...,  2.1316772 ,
         2.103237  ,  2.103237  ],
       [ 1.2442101 ,  1.2442101 ,  1.273407  , ...,  2.0890167 ,
         2.074797  ,  2.074797  ],
       [ 1.1566195 ,  1.171218  ,  1.2004149 , ...,  2.074797  ,
         2.0890167 ,  2.0890167 ],
       ...,
       [-0.7119789 , -0.21563247, -0.06964822, ...,  0.22618815,
         0.18352796,  0.18352796],
       [ 0.76246214,  0.6018794 ,  0.44129676, ...,  0.48214942,
         0.38260898,  0.26884836],
       [ 0.6018794 ,  0.8208558 ,  0.7040684 , ...,  0.15508783,
         0.11242763,  0.0839875 ]], dtype=float32), array([[-0.88716006, -0.88716006, -0.9017585 , ..., -1.082058  ,
        -1.082058  , -1.067838  ],
       [-0.94555384, -0.9163569 , -0.9309554 , ..., -0.7549964 ,
        -0.7265563 , -0.669676  ],
       [-0.8579632 , -0.88716006, -0.9017585 , ..., -1.0251776 ,
        -1.0109575 , -0.9967375 ],
       ...,
       [ 1.7259582 ,  1.7113597 ,  1.652966  , ..., -0.6270158 ,
        -0.57013553, -0.5559154 ],
       [-0.01125452, -0.08424664, -0.12804192, ..., -0.61279577,
        -0.61279577, -0.5985757 ],
       [-0.5805931 , -0.5805931 , -0.5805931 , ..., -0.65545595,
        -0.6412359 , -0.6412359 ]], dtype=float32), array([[ 1.3755959 ,  1.5069818 ,  1.5799739 , ...,  1.0936122 ,
         1.2500329 ,  0.823431  ],
       [ 1.2150133 ,  1.3609976 ,  1.2880055 , ...,  1.1220524 ,
         1.1647125 ,  0.6954504 ],
       [ 1.3026038 ,  1.1274228 ,  0.58728105, ...,  1.0509521 ,
         0.68123037,  1.1647125 ],
       ...,
       [-0.405412  , -0.303223  , -0.5367978 , ...,  0.01288717,
         0.4252692 ,  0.52480966],
       [-0.11344349,  0.01794233,  0.10553299, ..., -0.02977302,
        -0.15775362, -0.07243322],
       [ 0.09093457,  0.10553299, -0.15723877, ...,  0.21196808,
         0.26884836,  0.35416883]], dtype=float32), None, None, None, None, array([[-0.88716006, -0.8579632 , -0.82876635, ...,  0.5390297 ,
         0.56746984,  0.75233066],
       [-0.72657734, -0.6973805 , -0.6973805 , ...,  0.96563166,
         1.036732  ,  1.1220524 ],
       [-0.24482933, -0.18643562, -0.12804192, ...,  0.7381106 ,
         0.7949909 ,  0.80921096],
       ...,
       [ 0.42669836,  0.3537062 ,  0.41209993, ..., -0.11509342,
        -0.14353354, -0.12931348],
       [ 0.4704936 ,  0.44129676,  0.41209993, ..., -0.08665328,
        -0.07243322, -0.08665328],
       [ 0.26611567,  0.23691882,  0.23691882, ..., -0.27151415,
        -0.29995427, -0.32839438]], dtype=float32), None, None, array([[-0.49300256, -0.5659947 , -0.55139625, ..., -0.58435565,
        -0.49903518, -0.51325524],
       [-0.5367978 , -0.6681836 , -0.7411758 , ..., -0.81187665,
        -0.81187665, -0.7692165 ],
       [-0.59519154, -0.6389868 , -0.7119789 , ..., -0.71233624,
        -0.5274753 , -0.7265563 ],
       ...,
       [-1.5732862 , -1.6462783 , -1.4419003 , ..., -1.3664593 ,
        -1.2669188 , -1.1958185 ],
       [-1.0623412 , -0.87256163, -0.9893491 , ..., -1.1958185 ,
        -1.2526988 , -1.4233395 ],
       [-1.2083255 , -1.3835065 , -1.500294  , ..., -1.0393977 ,
        -1.1389382 , -1.1958185 ]], dtype=float32)], 'image_grid_thw': [None, None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A baby elephant standing in front of a brick building.\n', 'Find me an everyday image that matches the given caption: A dog that is laying down on a pink couch.\n', 'Find me an everyday image that matches the given caption: A tusked elephant standing in an open field in the wild.\n', 'Find me an everyday image that matches the given caption: Several ponies are standing around near a fence.\n', 'Find me an everyday image that matches the given caption: A flower arrangement in a vase on a tile floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cows walk along a beach with a mountain in the distance.\n', 'Find me an everyday image that matches the given caption: A big bright yellow school bus at night in the dark.\n', 'Find me an everyday image that matches the given caption: A stop sign on a pole above a no parking sign.\n', 'Find me an everyday image that matches the given caption: A man standing in front of a white house.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat is sitting on top of a vehicle.\n', 'Find me an everyday image that matches the given caption: A parking meter next to a parked car.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 61/6000 [02:06<3:20:28,  2.03s/it]                                                   {'loss': 3.2176, 'grad_norm': 226.068359375, 'learning_rate': 6.1e-06, 'epoch': 0.01}
  1%|          | 61/6000 [02:07<3:20:28,  2.03s/it][2025-11-13 01:33:04,576] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A room filled with a TV next to a piano.\n', 'Find me an everyday image that matches the given caption: A picture in London of big ben and their congress building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman sitting at a table with bread on a plate and a glass of orange juice.\n', 'Find me an everyday image that matches the given caption: A pastrami sandwich with potato salad on a plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727D83A0>], [<PIL.Image.Image image mode=RGB size=369x256 at 0x7F32727D8550>], [<PIL.Image.Image image mode=RGB size=349x256 at 0x7F32727DAE30>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D9ED0>], [<PIL.Image.Image image mode=RGB size=413x256 at 0x7F32727DBD00>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727D9E70>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DBCD0>], [<PIL.Image.Image image mode=RGB size=256x258 at 0x7F32727DA6E0>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB070>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9B70>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727D86D0>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727DB520>]], 'pixel_values': [array([[-1.5294908 , -1.4856956 , -1.4273019 , ..., -1.4375596 ,
        -1.4659997 , -1.4802198 ],
       [-1.4127034 , -1.3835065 , -1.398105  , ..., -1.1958185 ,
        -1.1673783 , -1.2384787 ],
       [-1.5294908 , -1.5586877 , -1.6024829 , ..., -1.4517797 ,
        -1.4659997 , -1.4659997 ],
       ...,
       [-0.25942776, -0.4638057 , -0.4638057 , ...,  0.5532498 ,
         0.6670103 ,  1.1078323 ],
       [ 1.2150133 ,  1.1858164 ,  1.1420212 , ..., -1.0393977 ,
        -1.0393977 , -1.1104981 ],
       [ 1.2588086 ,  1.0398322 ,  0.95224166, ..., -1.3237991 ,
        -1.2811389 , -1.2242587 ]], dtype=float32), array([[-1.398105  , -1.2959161 , -1.2667192 , ..., -1.0109575 ,
        -1.0109575 , -1.082058  ],
       [-1.1207349 , -1.3251129 , -1.3689082 , ..., -1.2100385 ,
        -1.2526988 , -1.2669188 ],
       [-1.4856956 , -1.500294  , -1.5148925 , ..., -1.2242587 ,
        -1.2811389 , -1.1815984 ],
       ...,
       [ 1.5653756 ,  1.5215802 ,  1.2004149 , ...,  0.28306842,
         0.36838892,  0.52480966],
       [ 0.6310763 ,  0.6018794 ,  0.8062574 , ...,  0.4252692 ,
         0.51058954,  0.4537093 ],
       [ 0.93764323,  1.0544306 ,  1.0544306 , ...,  0.3257286 ,
         0.39682904,  0.29728848]], dtype=float32), array([[ 1.2442101 ,  1.1420212 ,  1.098226  , ...,  1.477554  ,
         1.5202142 ,  1.5486543 ],
       [ 1.0544306 ,  1.0252337 ,  0.9814385 , ...,  1.6624149 ,
         1.705075  ,  1.705075  ],
       [ 1.171218  ,  1.2296118 ,  1.3026038 , ...,  1.7335151 ,
         1.7619553 ,  1.7761754 ],
       ...,
       [ 1.0690291 ,  1.098226  ,  1.1274228 , ..., -0.02977302,
        -0.04399309, -0.07243322],
       [ 1.1274228 ,  1.1128243 ,  1.098226  , ...,  0.6954504 ,
         0.6954504 ,  0.68123037],
       [ 1.0544306 ,  1.1128243 ,  1.1128243 , ...,  0.72389054,
         0.7381106 ,  0.7381106 ]], dtype=float32), array([[ 1.2588086 ,  1.2588086 ,  1.2588086 , ...,  1.7335151 ,
         1.7335151 ,  1.7335151 ],
       [ 1.273407  ,  1.273407  ,  1.273407  , ...,  1.7335151 ,
         1.7335151 ,  1.7335151 ],
       [ 1.0690291 ,  1.0690291 ,  1.0690291 , ...,  1.6766349 ,
         1.6766349 ,  1.6766349 ],
       ...,
       [-1.2813176 , -1.2959161 , -1.3105145 , ...,  1.036732  ,
         1.2784731 ,  1.7903955 ],
       [ 1.1274228 ,  0.49969047,  0.66027313, ...,  1.8330555 ,
         1.3922336 ,  0.93719155],
       [ 0.38290307,  1.273407  ,  1.2150133 , ...,  1.036732  ,
         1.0793922 ,  1.705075  ]], dtype=float32), array([[-0.39081356, -0.43460885, -0.4638057 , ..., -0.32839438,
        -0.32839438, -0.29995427],
       [-0.50760096, -0.5221994 , -0.5221994 , ..., -0.47059506,
        -0.51325524, -0.54169536],
       [-0.42001042, -0.44920728, -0.43460885, ..., -0.34261447,
        -0.29995427, -0.2857342 ],
       ...,
       [ 0.8792495 ,  0.8792495 ,  0.8792495 , ..., -0.48481512,
        -0.48481512, -0.47059506],
       [-0.11344349, -0.09884507, -0.09884507, ..., -0.6981161 ,
        -0.7549964 , -0.68389606],
       [-0.06964822, -0.08424664, -0.06964822, ..., -0.61279577,
        -0.5985757 , -0.5985757 ]], dtype=float32), array([[ 0.8792495 ,  0.8792495 ,  0.8792495 , ...,  1.3211333 ,
         1.3211333 ,  1.3211333 ],
       [ 0.89384794,  0.89384794,  0.9084464 , ...,  1.3353534 ,
         1.3353534 ,  1.3353534 ],
       [ 0.95224166,  0.95224166,  0.95224166, ...,  1.3495734 ,
         1.3495734 ,  1.3495734 ],
       ...,
       [-0.78497106, -0.15723877, -0.2740262 , ..., -0.45637497,
        -0.47059506, -0.47059506],
       [-0.65358526, -0.6681836 , -0.68278205, ..., -0.17197368,
        -0.34261447, -0.35683453],
       [-0.8141679 , -0.82876635, -0.8579632 , ..., -0.8403168 ,
        -0.89719707, -0.9256371 ]], dtype=float32), array([[-0.42001042, -0.405412  , -0.36161673, ...,  0.61013   ,
         1.0651721 ,  1.2500329 ],
       [-0.21563247, -0.20103405, -0.2740262 , ...,  0.96563166,
         1.0082918 ,  1.1220524 ],
       [-0.96015227, -0.88716006, -0.7703726 , ...,  1.1078323 ,
         0.7807708 ,  0.16930789],
       ...,
       [ 1.0252337 ,  1.0398322 ,  1.0398322 , ...,  1.6197547 ,
         1.6197547 ,  1.6197547 ],
       [ 0.61647785,  0.6310763 ,  0.6310763 , ...,  1.2926931 ,
         1.3353534 ,  1.3780135 ],
       [ 0.7478637 ,  0.7478637 ,  0.7478637 , ...,  1.477554  ,
         1.477554  ,  1.477554  ]], dtype=float32), array([[-1.3251129 , -1.3397113 , -1.3397113 , ..., -1.1958185 ,
        -1.1958185 , -1.1958185 ],
       [-1.3397113 , -1.3397113 , -1.3251129 , ..., -1.1958185 ,
        -1.1958185 , -1.1958185 ],
       [-1.3397113 , -1.3397113 , -1.3397113 , ..., -1.1958185 ,
        -1.1958185 , -1.1958185 ],
       ...,
       [-0.7703726 , -0.7703726 , -0.6681836 , ..., -1.0251776 ,
        -0.96829736, -1.0109575 ],
       [-0.7411758 , -0.59519154, -0.405412  , ..., -0.9825174 ,
        -1.0109575 , -1.082058  ],
       [-0.7411758 , -0.87256163, -0.9893491 , ..., -0.9398572 ,
        -0.9256371 , -0.89719707]], dtype=float32), None, None, array([[ 0.09093457,  0.10553299,  0.14932826, ...,  0.36838892,
         0.35416883,  0.38260898],
       [ 0.13472985,  0.13472985,  0.23691882, ...,  0.36838892,
         0.3257286 ,  0.28306842],
       [ 0.14932826,  0.17852512,  0.20772196, ...,  0.19774802,
         0.3257286 ,  0.22618815],
       ...,
       [-0.08424664, -0.08424664, -0.01125452, ..., -0.01555296,
         0.14086775,  0.24040821],
       [-0.43460885, -0.20103405, -0.15723877, ...,  0.24040821,
         0.31150854,  0.25462827],
       [-0.36161673, -0.20103405, -0.21563247, ..., -0.51325524,
        -0.39949474, -0.29995427]], dtype=float32), None, None, array([[-0.65358526, -0.6973805 , -0.7703726 , ..., -0.17197368,
        -0.12931348, -0.18619375],
       [-0.7119789 , -0.6973805 , -0.5659947 , ...,  0.15508783,
         0.19774802,  0.05554737],
       [-0.82876635, -0.87256163, -0.96015227, ..., -0.05821316,
        -0.10087335, -0.27151415],
       ...,
       [ 0.20772196,  0.17852512,  0.20772196, ...,  0.25462827,
         0.24040821,  0.21196808],
       [ 0.14932826,  0.20772196,  0.23691882, ...,  0.8376511 ,
         0.6954504 ,  0.6670103 ],
       [ 0.25151724,  0.0617376 ,  0.07633615, ..., -0.17197368,
        -0.14353354, -0.07243322]], dtype=float32), array([[-1.1645303 , -1.1645303 , -1.1645303 , ..., -0.95407724,
        -0.96829736, -0.96829736],
       [-1.1499318 , -1.1499318 , -1.1207349 , ..., -0.96829736,
        -0.96829736, -0.95407724],
       [-1.1061366 , -1.1061366 , -1.1061366 , ..., -0.9398572 ,
        -0.9398572 , -0.95407724],
       ...,
       [-1.5878845 , -1.500294  , -1.5294908 , ..., -1.1531583 ,
        -1.2669188 , -1.4091195 ],
       [-1.2375224 , -1.2959161 , -1.3543098 , ..., -0.9967375 ,
        -1.309579  , -1.4659997 ],
       [-0.78497106, -1.0623412 , -1.3689082 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-1.4856956 , -1.4419003 , -1.398105  , ..., -1.1531583 ,
        -1.1815984 , -1.2242587 ],
       [-1.3397113 , -1.398105  , -1.4419003 , ..., -0.25729406,
         0.0839875 ,  0.35416883],
       [-1.1061366 , -1.1207349 , -1.1061366 , ..., -0.7692165 ,
        -0.7692165 , -0.78343654],
       ...,
       [ 0.26611567,  0.26611567,  0.29531252, ..., -0.21463387,
        -0.21463387, -0.21463387],
       [ 0.04713918, -0.01125452, -0.0550498 , ..., -0.48481512,
        -0.49903518, -0.51325524],
       [-0.0550498 , -0.06964822, -0.06964822, ..., -0.51325524,
        -0.47059506, -0.42793486]], dtype=float32)], 'image_grid_thw': [array([[ 1, 28, 18]]), array([[ 1, 18, 26]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 30]]), array([[ 1, 28, 18]]), array([[ 1, 24, 18]]), array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A room filled with a TV next to a piano.\n', 'Find me an everyday image that matches the given caption: A picture in London of big ben and their congress building.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman sitting at a table with bread on a plate and a glass of orange juice.\n', 'Find me an everyday image that matches the given caption: A pastrami sandwich with potato salad on a plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 62/6000 [02:09<3:20:34,  2.03s/it]                                                   {'loss': 2.8766, 'grad_norm': 221.88204956054688, 'learning_rate': 6.200000000000001e-06, 'epoch': 0.01}
  1%|          | 62/6000 [02:09<3:20:34,  2.03s/it][2025-11-13 01:33:06,603] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    285,  32031,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,   8644,    624],
        [151643, 151643, 151643,  ...,   1033,   1495,    624],
        [151643, 151643, 151643,  ...,    389,  50779,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small dog is racing towards a Frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sotre front with bread in the display window.\n', 'Find me an everyday image that matches the given caption: A plate of carrots, sausages and kales.\n', 'Find me an everyday image that matches the given caption: Dogs in life jackets ride a board over waves.\n', 'Find me an everyday image that matches the given caption: A set of chair sin a small white church.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cupcakes with icing on them are stacked on a glass plate with three levels.\n', 'Find me an everyday image that matches the given caption: Dock lining both sides looking out to the expanse of ocean.\n', 'Find me an everyday image that matches the given caption: A tunnel in the middle of a street with a car about to go down it.\n', 'Find me an everyday image that matches the given caption: A computer montior on desk next to cords and a mouse.\n', "Find me an everyday image that matches the given caption: The large passenger jet was still flying in the air, but it's wheels were down.\n", 'Find me an everyday image that matches the given caption: There are many horses that are hitched on poles.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=319x256 at 0x7F32727DBD90>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DBB50>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBD30>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9EA0>], [<PIL.Image.Image image mode=RGB size=256x391 at 0x7F32727DBA00>], [None], [None], [None], [None], [None], [None]], 'pixel_values': [array([[-0.7703726 , -0.7703726 , -0.7557742 , ...,  0.96563166,
         0.9798517 ,  1.0082918 ],
       [-0.59519154, -0.60978997, -0.6243884 , ...,  0.9798517 ,
         0.9940718 ,  1.022512  ],
       [-0.68278205, -0.68278205, -0.6681836 , ...,  0.9514116 ,
         0.93719155,  0.9798517 ],
       ...,
       [ 0.61647785,  0.6018794 ,  0.58728105, ...,  1.2358129 ,
         1.2358129 ,  1.2500329 ],
       [ 0.5142889 ,  0.5142889 ,  0.5142889 , ...,  1.1504925 ,
         1.1647125 ,  1.2215928 ],
       [ 0.4558952 ,  0.4558952 ,  0.48509204, ...,  1.2073728 ,
         1.2215928 ,  1.2215928 ]], dtype=float32), None, array([[ 1.2004149 ,  1.2004149 ,  1.2004149 , ...,  1.6339747 ,
         1.6197547 ,  1.6197547 ],
       [ 1.2588086 ,  1.2588086 ,  1.2442101 , ...,  1.5770944 ,
         1.5770944 ,  1.5913146 ],
       [ 1.171218  ,  1.171218  ,  1.171218  , ...,  1.5059941 ,
         1.5059941 ,  1.5202142 ],
       ...,
       [ 0.0617376 ,  0.0617376 ,  0.0617376 , ...,  0.3257286 ,
         0.3257286 ,  0.3257286 ],
       [-0.02585294, -0.01125452, -0.01125452, ...,  0.3257286 ,
         0.29728848,  0.29728848],
       [-0.01125452, -0.02585294, -0.04045137, ...,  0.29728848,
         0.29728848,  0.29728848]], dtype=float32), None, None, None, None, array([[-0.02585294,  0.07633615,  0.00334391, ...,  1.2926931 ,
         1.0793922 ,  0.88031125],
       [ 0.32450938,  0.36830464,  0.20772196, ...,  1.3069133 ,
         1.690855  ,  1.5770944 ],
       [ 0.01794233,  0.0617376 ,  0.04713918, ...,  1.8614956 ,
         1.690855  ,  1.3353534 ],
       ...,
       [-0.09884507, -0.18643562, -0.25942776, ..., -0.07243322,
        -0.01555296, -0.01555296],
       [-0.7703726 , -0.7995695 , -0.9017585 , ..., -0.7265563 ,
        -0.5559154 , -0.5274753 ],
       [-1.5586877 , -1.5732862 , -1.5440893 , ..., -0.47059506,
        -0.74077636, -0.8403168 ]], dtype=float32), array([[-0.14264035, -0.1718372 , -0.1718372 , ...,  0.43948925,
         0.43948925,  0.39682904],
       [ 0.03254076,  0.04713918,  0.00334391, ...,  0.61013   ,
         0.5816899 ,  0.5816899 ],
       [-0.01125452,  0.03254076,  0.04713918, ...,  0.6670103 ,
         0.68123037,  0.6954504 ],
       ...,
       [-0.24482933, -0.20103405, -0.18643562, ..., -0.18619375,
        -0.20041381, -0.21463387],
       [-0.08424664, -0.09884507, -0.11344349, ..., -0.05821316,
        -0.11509342, -0.17197368],
       [-0.21563247, -0.2740262 , -0.2302309 , ..., -0.27151415,
        -0.31417432, -0.3710546 ]], dtype=float32), array([[1.171218  , 1.171218  , 1.171218  , ..., 1.1504925 , 1.1504925 ,
        1.1504925 ],
       [1.171218  , 1.1566195 , 1.171218  , ..., 1.1362724 , 1.1362724 ,
        1.1362724 ],
       [1.171218  , 1.171218  , 1.171218  , ..., 1.2215928 , 1.2215928 ,
        1.2073728 ],
       ...,
       [0.9814385 , 0.9814385 , 0.9814385 , ..., 1.477554  , 1.477554  ,
        1.477554  ],
       [1.0106354 , 0.99603695, 0.99603695, ..., 1.4917741 , 1.4917741 ,
        1.4917741 ],
       [0.9668401 , 0.9668401 , 0.9668401 , ..., 1.4491138 , 1.4491138 ,
        1.4491138 ]], dtype=float32), None, None, None, None, None, None], 'image_grid_thw': [array([[ 1, 18, 22]]), None, array([[ 1, 24, 18]]), None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, None, None, None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small dog is racing towards a Frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sotre front with bread in the display window.\n', 'Find me an everyday image that matches the given caption: A plate of carrots, sausages and kales.\n', 'Find me an everyday image that matches the given caption: Dogs in life jackets ride a board over waves.\n', 'Find me an everyday image that matches the given caption: A set of chair sin a small white church.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cupcakes with icing on them are stacked on a glass plate with three levels.\n', 'Find me an everyday image that matches the given caption: Dock lining both sides looking out to the expanse of ocean.\n', 'Find me an everyday image that matches the given caption: A tunnel in the middle of a street with a car about to go down it.\n', 'Find me an everyday image that matches the given caption: A computer montior on desk next to cords and a mouse.\n', "Find me an everyday image that matches the given caption: The large passenger jet was still flying in the air, but it's wheels were down.\n", 'Find me an everyday image that matches the given caption: There are many horses that are hitched on poles.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 63/6000 [02:11<3:19:34,  2.02s/it]                                                   {'loss': 2.9147, 'grad_norm': 178.9524688720703, 'learning_rate': 6.300000000000001e-06, 'epoch': 0.01}
  1%|          | 63/6000 [02:11<3:19:34,  2.02s/it][2025-11-13 01:33:08,592] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    518,  42984,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,  13078,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A set of empty chairs overlook a crystal clear pool at sunset.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An airplane sitting on a runway in an airport.\n', 'Find me an everyday image that matches the given caption: A boat being towed by a jeep near a beach.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a kitchen has a pizza on a cutting board.\n', 'Find me an everyday image that matches the given caption: A huge elephant is walking down the road.\n', 'Find me an everyday image that matches the given caption: A black man is sitting on the sidewalk next to a television.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman sitting next to a  child while holding a smart phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A girl sitting at a table with pizza and wine.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA590>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727D9AE0>], [None], [None], [<PIL.Image.Image image mode=RGB size=403x256 at 0x7F32727DA470>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DBC70>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727D8400>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA260>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBEE0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8490>], [None]], 'pixel_values': [None, array([[-0.9747507 , -1.1061366 , -1.3397113 , ..., -0.7549964 ,
        -0.74077636, -0.8545369 ],
       [-0.8579632 , -0.96015227, -1.018546  , ..., -0.96829736,
        -0.8260967 , -0.7976566 ],
       [-0.7411758 , -0.72657734, -0.68278205, ..., -0.669676  ,
        -0.61279577, -0.65545595],
       ...,
       [-0.06964822, -0.06964822, -0.06964822, ...,  0.38260898,
         0.24040821,  0.19774802],
       [ 0.8062574 ,  0.76246214,  0.7332653 , ...,  0.90875137,
         0.823431  ,  0.85187113],
       [ 0.8062574 ,  0.76246214,  0.77706057, ...,  0.6527902 ,
         0.68123037,  0.7665507 ]], dtype=float32), array([[ 0.49969047,  0.4704936 ,  0.4558952 , ...,  0.68123037,
         0.6527902 ,  0.6243501 ],
       [ 0.42669836,  0.38290307,  0.36830464, ...,  0.4963695 ,
         0.4963695 ,  0.46792936],
       [ 0.5726826 ,  0.5726826 ,  0.5726826 , ...,  0.68123037,
         0.6527902 ,  0.6527902 ],
       ...,
       [-0.47840413, -0.49300256, -0.50760096, ..., -0.47059506,
        -0.47059506, -0.45637497],
       [-0.44920728, -0.44920728, -0.4638057 , ..., -0.48481512,
        -0.48481512, -0.49903518],
       [-0.60978997, -0.6243884 , -0.6389868 , ..., -0.6270158 ,
        -0.65545595, -0.669676  ]], dtype=float32), None, None, array([[-1.5878845 , -1.5732862 , -1.5586877 , ...,  0.29728848,
         0.31150854,  0.31150854],
       [-1.4856956 , -1.4856956 , -1.4856956 , ...,  0.4963695 ,
         0.52480966,  0.5532498 ],
       [-1.500294  , -1.500294  , -1.4856956 , ...,  0.48214942,
         0.4963695 ,  0.52480966],
       ...,
       [-1.3105145 , -1.1645303 , -1.0331444 , ..., -1.2526988 ,
        -1.2811389 , -1.2811389 ],
       [-0.9163569 , -0.7995695 , -0.47840413, ..., -1.4517797 ,
        -1.4375596 , -1.3380191 ],
       [-0.7411758 , -0.6243884 , -0.72657734, ..., -1.3380191 ,
        -1.3380191 , -1.3522393 ]], dtype=float32), array([[-1.0039475 , -1.0477428 , -1.1061366 , ..., -0.7549964 ,
        -1.2526988 , -1.4233395 ],
       [-1.7922626 , -1.7776641 , -1.6754751 , ..., -1.2811389 ,
        -1.4375596 , -1.4517797 ],
       [-0.5659947 , -0.4638057 , -0.55139625, ..., -1.4375596 ,
        -1.4091195 , -1.4091195 ],
       ...,
       [-0.49300256, -0.43460885, -0.55139625, ..., -1.3522393 ,
        -1.3806794 , -1.3806794 ],
       [ 0.41209993,  0.41209993,  0.3975015 , ..., -1.4659997 ,
        -1.4517797 , -1.4233395 ],
       [ 0.3975015 ,  0.42669836,  0.6310763 , ..., -1.3806794 ,
        -1.3522393 , -1.3522393 ]], dtype=float32), None, None, None, array([[ 0.8646511 ,  1.1274228 ,  0.95224166, ..., -0.5985757 ,
        -0.7265563 , -0.81187665],
       [ 0.5142889 ,  0.6310763 ,  0.7478637 , ..., -0.5559154 ,
        -0.47059506, -0.3710546 ],
       [ 0.44129676,  0.71866685,  0.49969047, ..., -0.5985757 ,
        -0.57013553, -0.6412359 ],
       ...,
       [ 0.7332653 ,  0.68947   ,  0.6456747 , ...,  1.2926931 ,
         1.2784731 ,  1.2784731 ],
       [ 0.76246214,  0.85005265,  0.95224166, ...,  1.3211333 ,
         1.2926931 ,  1.3211333 ],
       [ 1.1274228 ,  1.1420212 ,  1.2296118 , ...,  1.3211333 ,
         1.3211333 ,  1.2784731 ]], dtype=float32), array([[-1.1061366e+00, -1.0769397e+00, -7.8497106e-01, ...,
         9.0875137e-01,  9.5141160e-01,  9.6563166e-01],
       [-7.4117577e-01, -7.1197891e-01, -6.6818362e-01, ...,
         1.2073728e+00,  1.1789327e+00,  1.1504925e+00],
       [-5.5049796e-02, -1.5723877e-01, -4.0541199e-01, ...,
         1.3922336e+00,  5.1058954e-01, -1.3328948e-03],
       ...,
       [ 2.6611567e-01,  2.5151724e-01,  2.8071409e-01, ...,
        -7.9765660e-01, -7.9765660e-01, -7.6921648e-01],
       [-1.5723877e-01, -8.4246643e-02,  1.7942330e-02, ...,
        -3.8527465e-01, -6.9811612e-01, -6.8389606e-01],
       [ 1.6392669e-01,  1.4932826e-01,  1.3472985e-01, ...,
        -5.2747530e-01, -5.5591542e-01, -5.7013553e-01]], dtype=float32), None, array([[ 0.67487156,  0.67487156,  0.67487156, ..., -0.25729406,
        -0.27151415, -0.27151415],
       [ 0.791659  ,  0.8062574 ,  0.85005265, ..., -0.12931348,
        -0.12931348, -0.12931348],
       [ 0.7478637 ,  0.7478637 ,  0.7332653 , ..., -0.20041381,
        -0.20041381, -0.17197368],
       ...,
       [-1.7338688 , -1.7776641 , -1.7630657 , ..., -1.4659997 ,
        -1.4659997 , -1.4802198 ],
       [-1.5878845 , -1.5294908 , -1.500294  , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-1.3251129 , -1.3251129 , -1.3251129 , ..., -1.0251776 ,
        -1.0393977 , -1.0251776 ],
       [-1.2667192 , -1.2667192 , -1.2375224 , ..., -0.35683453,
        -0.10087335,  0.21196808],
       [ 0.8354542 ,  0.09093457, -0.7119789 , ...,  1.690855  ,
         1.5770944 ,  1.2784731 ],
       ...,
       [ 0.58728105,  0.42669836,  0.25151724, ..., -1.1104981 ,
        -1.1389382 , -1.1104981 ],
       [ 0.85005265,  0.9084464 ,  0.89384794, ...,  1.1078323 ,
         1.1362724 ,  1.1362724 ],
       [ 0.2223204 ,  0.13472985,  0.03254076, ..., -0.7976566 ,
        -0.81187665, -0.7976566 ]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A set of empty chairs overlook a crystal clear pool at sunset.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An airplane sitting on a runway in an airport.\n', 'Find me an everyday image that matches the given caption: A boat being towed by a jeep near a beach.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a kitchen has a pizza on a cutting board.\n', 'Find me an everyday image that matches the given caption: A huge elephant is walking down the road.\n', 'Find me an everyday image that matches the given caption: A black man is sitting on the sidewalk next to a television.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman sitting next to a  child while holding a smart phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A girl sitting at a table with pizza and wine.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 64/6000 [02:12<3:17:58,  2.00s/it]                                                   {'loss': 2.6828, 'grad_norm': 124.55111694335938, 'learning_rate': 6.4000000000000006e-06, 'epoch': 0.01}
  1%|          | 64/6000 [02:12<3:17:58,  2.00s/it][2025-11-13 01:33:10,562] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    389,   1105,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  14614,  19125,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,   3241,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,  26148,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A kid in the bed under a blanket and a book laying on them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A donut glazing machine on a assembly belt.\n', 'Find me an everyday image that matches the given caption: A bowl of o-shaped cereal and side of fruit sitting on a blue table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A little plane landing on the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man holds a glowing item while in the dark.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog that is eating some food with a human.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A hot dog wrapped in tin foil covered in ketchup & relish.\n', 'Find me an everyday image that matches the given caption: Two grey cats laying down, looking out a window.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An orange cat hiding in a black purse on the couch.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=267x256 at 0x7F3272FAE3E0>], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FADAE0>], [None], [<PIL.Image.Image image mode=RGB size=309x256 at 0x7F3272FAC190>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272FAEEF0>], [None], [<PIL.Image.Image image mode=RGB size=313x256 at 0x7F3272FAF820>], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272FAF4C0>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272FAD150>], [None]], 'pixel_values': [None, array([[ 0.12013142,  0.12013142,  0.12013142, ...,  1.6197547 ,
         1.6197547 ,  1.6197547 ],
       [ 0.16392669,  0.16392669,  0.16392669, ...,  1.6339747 ,
         1.6339747 ,  1.6339747 ],
       [ 0.17852512,  0.17852512,  0.17852512, ...,  1.6339747 ,
         1.6339747 ,  1.6339747 ],
       ...,
       [-1.3543098 , -1.4127034 , -1.3397113 , ..., -1.3948994 ,
        -1.2526988 , -1.1673783 ],
       [-0.8433648 , -0.88716006, -0.7119789 , ..., -0.7692165 ,
        -0.38527465,  0.1266477 ],
       [-1.3689082 , -1.398105  , -0.9893491 , ...,  0.0839875 ,
         0.01288717,  0.01288717]], dtype=float32), None, None, array([[-0.12804192,  0.0617376 ,  0.2223204 , ...,  0.26884836,
         0.33994877,  0.36838892],
       [ 0.26611567,  0.12013142,  0.23691882, ...,  0.4110491 ,
         0.4110491 ,  0.4252692 ],
       [-0.21563247, -0.06964822,  0.12013142, ...,  0.3257286 ,
         0.31150854,  0.35416883],
       ...,
       [ 0.3537062 ,  0.33910778,  0.41209993, ...,  0.85187113,
         0.7949909 ,  0.7665507 ],
       [ 0.00334391, -0.01125452, -0.02585294, ..., -0.21463387,
        -0.14353354, -0.11509342],
       [-0.6389868 , -0.65358526, -0.6681836 , ..., -0.29995427,
        -0.21463387, -0.20041381]], dtype=float32), None, array([[ 1.0252337 ,  1.0398322 ,  1.0398322 , ...,  1.264253  ,
         1.264253  ,  1.2500329 ],
       [ 1.0106354 ,  1.0106354 ,  1.0252337 , ...,  1.1931527 ,
         1.1931527 ,  1.1789327 ],
       [ 1.0544306 ,  1.0544306 ,  1.0544306 , ...,  1.2784731 ,
         1.2784731 ,  1.264253  ],
       ...,
       [-0.36161673, -0.303223  , -0.2740262 , ...,  0.7381106 ,
         0.7665507 ,  0.80921096],
       [-0.08424664, -0.20103405, -0.33241987, ...,  0.24040821,
         0.05554737, -0.00133289],
       [ 0.42669836,  0.41209993,  0.42669836, ...,  0.05554737,
         0.09820756,  0.21196808]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [-0.2302309 , -0.2740262 , -0.31782144, ...,  0.18352796,
         0.22618815,  0.22618815],
       [ 0.3537062 ,  0.32450938,  0.29531252, ...,  1.4348938 ,
         1.3495734 ,  1.3069133 ],
       [ 0.0617376 ,  0.03254076,  0.01794233, ..., -0.54169536,
        -0.57013553, -0.58435565]], dtype=float32), None, array([[-0.96015227, -0.96015227, -0.96015227, ..., -0.5559154 ,
        -0.5559154 , -0.54169536],
       [-0.87256163, -0.87256163, -0.8579632 , ..., -0.45637497,
        -0.45637497, -0.4421549 ],
       [-0.9309554 , -0.9163569 , -0.9163569 , ..., -0.5274753 ,
        -0.5274753 , -0.51325524],
       ...,
       [-0.60978997, -0.8433648 , -1.0623412 , ...,  0.85187113,
         1.2073728 ,  1.3637935 ],
       [-0.303223  , -0.21563247, -0.14264035, ...,  1.5202142 ,
         1.6055346 ,  1.6197547 ],
       [-1.3543098 , -1.3397113 , -1.1207349 , ...,  1.6055346 ,
         1.6055346 ,  1.6197547 ]], dtype=float32), None, array([[ 0.32450938,  0.33910778,  0.36830464, ...,  1.2073728 ,
         1.2073728 ,  1.2215928 ],
       [ 0.3975015 ,  0.67487156,  0.54348576, ...,  1.3780135 ,
         1.3780135 ,  1.4064537 ],
       [ 0.30991095,  0.29531252,  0.29531252, ...,  1.2784731 ,
         1.2784731 ,  1.2926931 ],
       ...,
       [-0.01125452,  0.04713918, -0.01125452, ..., -0.05821316,
        -0.01555296, -0.12931348],
       [ 0.44129676,  0.49969047,  0.54348576, ...,  0.22618815,
         0.15508783,  0.1266477 ],
       [ 0.10553299,  0.0617376 ,  0.13472985, ...,  0.5532498 ,
         0.24040821, -0.02977302]], dtype=float32), None, None, array([[-1.3397113 , -1.3251129 , -1.3251129 , ..., -0.71233624,
        -0.6981161 , -0.6981161 ],
       [-0.65358526, -0.60978997, -0.5659947 , ..., -0.91141707,
        -0.68389606, -0.78343654],
       [-1.2959161 , -1.2959161 , -1.2667192 , ..., -0.6412359 ,
        -0.6270158 , -0.6270158 ],
       ...,
       [-0.43460885, -0.405412  , -0.39081356, ..., -0.6412359 ,
        -0.6270158 , -0.65545595],
       [-0.78497106, -0.78497106, -0.7703726 , ..., -0.9967375 ,
        -0.95407724, -0.9256371 ],
       [-0.6973805 , -0.68278205, -0.6973805 , ..., -0.8545369 ,
        -0.8545369 , -0.86875695]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 20]]), None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 22]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 22]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 28, 18]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A kid in the bed under a blanket and a book laying on them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A donut glazing machine on a assembly belt.\n', 'Find me an everyday image that matches the given caption: A bowl of o-shaped cereal and side of fruit sitting on a blue table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A little plane landing on the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man holds a glowing item while in the dark.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog that is eating some food with a human.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A hot dog wrapped in tin foil covered in ketchup & relish.\n', 'Find me an everyday image that matches the given caption: Two grey cats laying down, looking out a window.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An orange cat hiding in a black purse on the couch.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 65/6000 [02:15<3:21:13,  2.03s/it]                                                   {'loss': 2.8461, 'grad_norm': 203.3210906982422, 'learning_rate': 6.5000000000000004e-06, 'epoch': 0.01}
  1%|          | 65/6000 [02:15<3:21:13,  2.03s/it][2025-11-13 01:33:12,681] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   5619,  31415,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    448,  13779,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: There is a woman on the court playing tennis.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Many livestock grazing in a field under a cloudy sky.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A family making a cake together in the kitchen.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Lots of snow are on the ground and lady is running.\n', 'Find me an everyday image that matches the given caption: A man sitting at a table at a diner with a basket of food in front of him.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of people standing at a counter with fruit.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727B71C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C60E0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C46A0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6620>], [<PIL.Image.Image image mode=RGB size=609x256 at 0x7F32727C4E20>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x298 at 0x7F32727C7AF0>], [<PIL.Image.Image image mode=RGB size=416x256 at 0x7F327277CE80>], [<PIL.Image.Image image mode=RGB size=377x256 at 0x7F3272FAD690>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C4A00>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6950>]], 'pixel_values': [None, array([[ 1.0252337 ,  1.098226  ,  1.2150133 , ...,  1.2358129 ,
         1.2500329 ,  1.264253  ],
       [ 1.477785  ,  1.4485881 ,  1.4485881 , ...,  1.2784731 ,
         1.2784731 ,  1.2926931 ],
       [ 1.0690291 ,  1.1420212 ,  1.2588086 , ...,  1.264253  ,
         1.2784731 ,  1.2784731 ],
       ...,
       [-1.4564987 , -1.3835065 , -1.2959161 , ..., -0.7549964 ,
        -0.61279577, -0.71233624],
       [-1.5732862 , -1.5732862 , -1.5878845 , ..., -0.38527465,
        -0.38527465, -0.45637497],
       [-0.21563247,  0.16392669,  0.44129676, ..., -0.57013553,
        -0.5559154 , -0.39949474]], dtype=float32), array([[-0.5221994 , -0.5221994 , -0.4638057 , ...,  0.21196808,
         0.4963695 ,  0.7096705 ],
       [-0.49300256, -0.59519154, -0.78497106, ..., -0.4137148 ,
        -0.04399309,  0.09820756],
       [-0.43460885, -0.5367978 , -0.5367978 , ...,  1.6339747 ,
         1.6197547 ,  1.6481948 ],
       ...,
       [ 0.3975015 ,  0.48509204,  0.4704936 , ...,  0.3257286 ,
        -0.11509342, -0.38527465],
       [-0.2740262 , -0.2302309 , -0.18643562, ...,  0.5390297 ,
         0.5532498 ,  0.5532498 ],
       [ 0.13472985,  0.20772196,  0.2223204 , ...,  0.25462827,
         0.19774802,  0.16930789]], dtype=float32), None, array([[-0.04045137, -0.96015227, -1.3689082 , ...,  0.09820756,
        -0.11509342,  0.06976743],
       [-0.303223  , -1.1791286 , -1.6900735 , ..., -1.1104981 ,
        -1.0962781 , -1.0393977 ],
       [ 0.01794233, -0.09884507, -0.06964822, ...,  0.19774802,
         0.7665507 ,  1.0509521 ],
       ...,
       [-0.7703726 , -0.9017585 , -0.47840413, ..., -0.9398572 ,
        -0.96829736, -1.0109575 ],
       [-0.9309554 , -0.44920728, -0.08424664, ..., -1.067838  ,
        -0.89719707, -1.1247182 ],
       [-0.87256163, -0.8433648 , -0.47840413, ..., -0.9256371 ,
        -1.1958185 , -1.1673783 ]], dtype=float32), None, array([[-1.1061366 , -1.1353334 , -1.0915381 , ..., -0.89719707,
        -0.78343654, -0.86875695],
       [-1.0915381 , -1.0769397 , -0.9893491 , ..., -0.78343654,
        -0.7976566 , -0.7265563 ],
       [-1.1061366 , -1.1061366 , -1.1791286 , ...,  0.1266477 ,
         0.0413273 , -0.58435565],
       ...,
       [ 1.2588086 ,  1.2296118 ,  1.2442101 , ...,  1.5628744 ,
         1.5486543 ,  1.5344343 ],
       [ 1.3026038 ,  1.2880055 ,  1.273407  , ...,  1.5770944 ,
         1.5913146 ,  1.5913146 ],
       [ 1.2588086 ,  1.2588086 ,  1.2588086 , ...,  1.5913146 ,
         1.5913146 ,  1.5913146 ]], dtype=float32), array([[-0.4638057 , -0.42001042, -0.39081356, ...,  1.0509521 ,
         1.0509521 ,  1.0509521 ],
       [-0.405412  , -0.405412  , -0.43460885, ...,  1.0651721 ,
         1.0651721 ,  1.0651721 ],
       [-0.36161673, -0.303223  , -0.24482933, ...,  0.90875137,
         0.90875137,  0.90875137],
       ...,
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.0393977 ,
        -1.0393977 , -1.0251776 ],
       [-1.6024829 , -1.6024829 , -1.6024829 , ..., -0.81187665,
        -0.81187665, -0.81187665],
       [-1.5732862 , -1.5586877 , -1.5586877 , ..., -0.81187665,
        -0.8403168 , -0.8545369 ]], dtype=float32), None, None, array([[-0.39081356, -0.3470183 , -0.31782144, ...,  0.06976743,
         0.14086775,  0.15508783],
       [-0.5659947 , -0.59519154, -0.5805931 , ..., -0.02977302,
        -0.04399309, -0.10087335],
       [-0.1718372 , -0.09884507, -0.04045137, ...,  0.02710724,
         0.02710724,  0.01288717],
       ...,
       [-1.4710971 , -1.3689082 , -1.2959161 , ..., -1.2526988 ,
        -1.2953589 , -1.2526988 ],
       [-1.4419003 , -1.4564987 , -1.398105  , ..., -1.0251776 ,
        -0.39949474, -0.9825174 ],
       [-1.5294908 , -1.500294  , -1.4564987 , ..., -1.067838  ,
        -1.1247182 , -1.0393977 ]], dtype=float32), array([[-0.6973805 , -0.6973805 , -0.6681836 , ...,  0.19774802,
         0.21196808,  0.22618815],
       [-0.5805931 , -0.5805931 , -0.5805931 , ...,  0.33994877,
         0.52480966,  0.823431  ],
       [-0.47840413, -0.47840413, -0.4638057 , ...,  0.24040821,
         0.24040821,  0.22618815],
       ...,
       [ 0.20772196,  0.17852512,  0.2223204 , ...,  0.26884836,
         0.28306842,  0.28306842],
       [ 0.17852512,  0.17852512,  0.16392669, ...,  0.85187113,
         0.75233066,  0.6670103 ],
       [ 0.13472985,  0.09093457,  0.01794233, ...,  0.31150854,
         0.33994877,  0.24040821]], dtype=float32), array([[ 1.9157377 ,  1.652966  ,  0.99603695, ..., -1.4375596 ,
        -1.4375596 , -1.4375596 ],
       [ 0.8354542 ,  0.85005265,  0.85005265, ..., -1.3237991 ,
        -1.1673783 , -1.2100385 ],
       [ 0.791659  , -1.5294908 , -1.7630657 , ..., -1.3664593 ,
        -1.3664593 , -1.3380191 ],
       ...,
       [-0.02585294, -0.02585294, -0.01125452, ..., -1.4802198 ,
        -0.7692165 ,  1.918376  ],
       [-0.7411758 , -0.7703726 , -0.7703726 , ...,  1.8472759 ,
         1.8330555 ,  1.8330555 ],
       [-0.303223  , -0.2740262 , -0.24482933, ...,  1.7192951 ,
         2.0890167 ,  2.0605767 ]], dtype=float32), array([[-1.704672  , -1.3397113 ,  0.7040684 , ..., -1.4802198 ,
        -1.4517797 , -1.4517797 ],
       [-1.7922626 , -1.6170814 , -0.82876635, ..., -1.4802198 ,
        -1.4517797 , -1.3237991 ],
       [-1.704672  , -1.7776641 , -1.7922626 , ...,  0.18352796,
        -0.54169536, -1.309579  ],
       ...,
       [-1.6170814 , -1.6608766 , -1.6900735 , ..., -1.309579  ,
        -1.3806794 , -1.4233395 ],
       [-1.704672  , -1.5878845 , -1.6608766 , ..., -1.3522393 ,
        -1.2811389 , -1.4091195 ],
       [-1.7484672 , -1.6900735 , -1.704672  , ..., -1.4375596 ,
        -1.4233395 , -1.4233395 ]], dtype=float32), None, array([[ 1.098226 ,  1.098226 ,  1.098226 , ...,  1.9752562,  1.9610363,
         1.9468161],
       [ 1.2150133,  1.2150133,  1.2150133, ...,  1.875716 ,  1.8899357,
         1.9041561],
       [ 1.7843518,  1.7843518,  1.7843518, ...,  2.117457 ,  2.117457 ,
         2.117457 ],
       ...,
       [-1.398105 , -1.3397113, -1.3543098, ..., -1.2953589, -1.3664593,
        -1.4233395],
       [-1.3689082, -1.1207349, -0.8141679, ..., -1.2384787, -1.1247182,
        -1.1673783],
       [-1.2083255, -1.3543098, -1.2375224, ..., -1.4091195, -0.9398572,
        -1.1389382]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 44]]), None, None, array([[ 1, 22, 18]]), array([[ 1, 18, 30]]), array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: There is a woman on the court playing tennis.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Many livestock grazing in a field under a cloudy sky.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A family making a cake together in the kitchen.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Lots of snow are on the ground and lady is running.\n', 'Find me an everyday image that matches the given caption: A man sitting at a table at a diner with a basket of food in front of him.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of people standing at a counter with fruit.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 66/6000 [02:17<3:27:11,  2.09s/it]                                                   {'loss': 2.8105, 'grad_norm': 173.2894744873047, 'learning_rate': 6.600000000000001e-06, 'epoch': 0.01}
  1%|          | 66/6000 [02:17<3:27:11,  2.09s/it][2025-11-13 01:33:14,912] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  28679,  30232,    624],
        [151643, 151643, 151643,  ...,    311,    432,    624],
        [151643, 151643, 151643,  ...,    264,   5562,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A child on skis standing on a ski slope.\n', 'Find me an everyday image that matches the given caption: The computer has a mouse and key board attached to it.\n', 'Find me an everyday image that matches the given caption: A man is reading a book while another is holding a dog.\n', 'Find me an everyday image that matches the given caption: The large crowd of people stand on a sidewalk.\n', 'Find me an everyday image that matches the given caption: A woman walking along a beach with a dog on a leash.\n', 'Find me an everyday image that matches the given caption: A horse wearing a blanket with its head sticking out of a stall.\n', 'Find me an everyday image that matches the given caption: An office work station with two computer monitors, and laptop.\n', 'Find me an everyday image that matches the given caption: Two young children preparing for bed brushing their teeth.\n', 'Find me an everyday image that matches the given caption: A kid is holding an umbrella on the street.\n', 'Find me an everyday image that matches the given caption: A vintage chair with a cloth on the back of it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An old suitcase sits abandoned in a park.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [None], [None], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272B5C640>], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F3272B5F190>], [None], [<PIL.Image.Image image mode=RGB size=314x256 at 0x7F32727DA590>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9AE0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA470>]], 'pixel_values': [None, None, None, None, None, None, None, None, None, None, array([[-0.18643562, -0.1718372 , -0.14264035, ...,  0.75233066,
         0.9229715 ,  0.90875137],
       [ 0.07633615,  0.20772196,  0.25151724, ...,  0.9798517 ,
         0.96563166,  0.96563166],
       [ 0.07633615,  0.07633615,  0.07633615, ...,  0.80921096,
         1.0793922 ,  1.022512  ],
       ...,
       [-1.7484672 , -1.7484672 , -1.7484672 , ..., -1.3664593 ,
        -1.3237991 , -1.2953589 ],
       [-0.68278205, -0.72657734, -0.7557742 , ..., -0.6981161 ,
        -0.7549964 , -0.78343654],
       [-0.9893491 , -1.0039475 , -1.0331444 , ..., -1.0251776 ,
        -1.0536178 , -1.0962781 ]], dtype=float32), array([[-0.3470183 , -0.1718372 , -0.09884507, ...,  0.9940718 ,
         0.7381106 ,  0.5532498 ],
       [-0.65358526, -0.8141679 , -1.0623412 , ..., -0.6981161 ,
        -0.68389606, -0.7692165 ],
       [-0.14264035, -0.12804192, -0.2302309 , ..., -0.8545369 ,
        -0.7692165 , -0.78343654],
       ...,
       [-1.7192703 , -1.7192703 , -1.7192703 , ..., -1.3237991 ,
        -1.3237991 , -1.3237991 ],
       [-1.6900735 , -1.704672  , -1.704672  , ..., -1.2953589 ,
        -1.309579  , -1.309579  ],
       [-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.3380191 ,
        -1.3380191 , -1.3380191 ]], dtype=float32), None, array([[ 0.2807141 ,  0.25151724,  0.2223204 , ...,  0.5390297 ,
         0.5390297 ,  0.5390297 ],
       [ 0.30991095,  0.32450938,  0.30991095, ...,  0.61013   ,
         0.6243501 ,  0.6243501 ],
       [ 0.5142889 ,  0.4558952 ,  0.38290307, ...,  0.823431  ,
         0.80921096,  0.7949909 ],
       ...,
       [-0.87256163, -0.8433648 , -0.7995695 , ..., -1.0536178 ,
        -1.0109575 , -1.0109575 ],
       [-1.4710971 , -1.4273019 , -1.500294  , ..., -1.0109575 ,
        -1.0393977 , -1.082058  ],
       [-1.4273019 , -1.4127034 , -1.4127034 , ..., -0.86875695,
        -0.91141707, -0.91141707]], dtype=float32), array([[ 1.8865409 ,  1.9303361 ,  1.8135487 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.5878845 , -1.5732862 , -1.5732862 , ..., -1.3806794 ,
        -1.3664593 , -1.3664593 ],
       [-1.7484672 , -1.7192703 , -1.6900735 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       ...,
       [ 0.48509204,  0.19312355, -0.04045137, ..., -1.309579  ,
        -1.3237991 , -1.3237991 ],
       [-0.15723877, -0.50760096, -0.9309554 , ..., -1.3237991 ,
        -1.309579  , -1.2811389 ],
       [-1.6316798 , -1.6316798 , -1.6170814 , ...,  1.9752562 ,
         2.074797  ,  2.0890167 ]], dtype=float32), array([[ 1.6967614 ,  1.6967614 ,  1.6967614 , ...,  1.6197547 ,
         1.6481948 ,  1.6481948 ],
       [ 1.652966  ,  1.652966  ,  1.652966  , ...,  1.6766349 ,
         1.6766349 ,  1.6766349 ],
       [ 1.5507771 ,  1.5507771 ,  1.5507771 , ...,  1.1504925 ,
         1.1931527 ,  1.2073728 ],
       ...,
       [-0.6681836 , -0.6389868 , -0.6389868 , ...,  0.21196808,
         0.19774802,  0.15508783],
       [-1.0915381 , -1.0331444 , -1.0331444 , ..., -0.45637497,
        -0.42793486, -0.35683453],
       [-0.7995695 , -0.7557742 , -0.7411758 , ..., -0.3710546 ,
        -0.51325524, -0.5985757 ]], dtype=float32)], 'image_grid_thw': [None, None, None, None, None, None, None, None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 22]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A child on skis standing on a ski slope.\n', 'Find me an everyday image that matches the given caption: The computer has a mouse and key board attached to it.\n', 'Find me an everyday image that matches the given caption: A man is reading a book while another is holding a dog.\n', 'Find me an everyday image that matches the given caption: The large crowd of people stand on a sidewalk.\n', 'Find me an everyday image that matches the given caption: A woman walking along a beach with a dog on a leash.\n', 'Find me an everyday image that matches the given caption: A horse wearing a blanket with its head sticking out of a stall.\n', 'Find me an everyday image that matches the given caption: An office work station with two computer monitors, and laptop.\n', 'Find me an everyday image that matches the given caption: Two young children preparing for bed brushing their teeth.\n', 'Find me an everyday image that matches the given caption: A kid is holding an umbrella on the street.\n', 'Find me an everyday image that matches the given caption: A vintage chair with a cloth on the back of it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An old suitcase sits abandoned in a park.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 67/6000 [02:19<3:25:47,  2.08s/it]                                                   {'loss': 2.6682, 'grad_norm': 159.5136260986328, 'learning_rate': 6.700000000000001e-06, 'epoch': 0.01}
  1%|          | 67/6000 [02:19<3:25:47,  2.08s/it][2025-11-13 01:33:16,952] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   1045,  23035,    624],
        [151643, 151643, 151643,  ...,   3941,    432,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,   1865,  13829,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    369,  13404,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A giraffe sitting in a grassy field with some rocks.\n', 'Find me an everyday image that matches the given caption: The yellow fire hydrant has a chain across it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A boy wearing glasses holding a remote controller.\n', 'Find me an everyday image that matches the given caption: A man is holding a wrapper with a hotdog.\n', 'Find me an everyday image that matches the given caption: An image of a cat that has hands in a bowl.\n', 'Find me an everyday image that matches the given caption: To motorcross riders enjoy their run through the mud.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person holding a partially eaten sandwich filled with meat.\n', 'Find me an everyday image that matches the given caption: A close up of a neatly made bedroom.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cargo airplane with its nose opened for maintenance.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727D9B40>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DB190>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DAE00>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9570>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8490>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB7F0>], [None], [None], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F32727DBEE0>], [None]], 'pixel_values': [None, None, array([[-0.14264035, -0.14264035, -0.14264035, ..., -0.21463387,
        -0.21463387, -0.18619375],
       [ 0.17852512,  0.19312355,  0.25151724, ...,  0.59590995,
         0.6670103 ,  0.7665507 ],
       [-0.12804192, -0.08424664, -0.01125452, ...,  0.02710724,
         0.0413273 ,  0.06976743],
       ...,
       [-1.0769397 , -1.0769397 , -1.0623412 , ..., -0.81187665,
        -0.74077636, -0.7265563 ],
       [-0.78497106, -0.68278205, -0.78497106, ..., -1.3522393 ,
        -1.2384787 , -1.2953589 ],
       [-1.2083255 , -1.193727  , -1.2667192 , ..., -1.1958185 ,
        -1.2100385 , -1.2384787 ]], dtype=float32), array([[-1.7630657 , -1.7630657 , -1.7630657 , ..., -1.3948994 ,
        -1.3806794 , -1.3664593 ],
       [-1.7630657 , -1.7630657 , -1.7630657 , ..., -1.2526988 ,
        -1.2669188 , -1.2811389 ],
       [-1.6754751 , -1.6900735 , -1.704672  , ..., -0.9825174 ,
        -1.0109575 , -1.0536178 ],
       ...,
       [ 0.01794233,  0.00334391,  0.00334391, ..., -0.6412359 ,
        -0.65545595, -0.65545595],
       [-0.47840413, -0.47840413, -0.47840413, ...,  0.68123037,
         0.6670103 ,  0.6527902 ],
       [-0.5805931 , -0.59519154, -0.60978997, ...,  0.39682904,
         0.38260898,  0.36838892]], dtype=float32), array([[-1.0915381 , -1.1061366 , -1.0915381 , ..., -1.1531583 ,
        -1.1389382 , -1.1389382 ],
       [-1.5294908 , -1.4856956 , -1.500294  , ..., -1.1815984 ,
        -1.1247182 , -1.082058  ],
       [-1.0477428 , -0.94555384, -1.0039475 , ..., -1.1958185 ,
        -1.1815984 , -1.1389382 ],
       ...,
       [-0.2302309 , -0.15723877, -0.06964822, ...,  0.21196808,
         0.14086775,  0.09820756],
       [-0.18643562, -0.1718372 , -0.15723877, ...,  0.18352796,
         0.16930789,  0.1266477 ],
       [-0.28862458, -0.31782144, -0.2740262 , ...,  0.06976743,
         0.05554737,  0.11242763]], dtype=float32), array([[ 1.6091708 ,  1.6091708 ,  1.6237692 , ...,  1.8899357 ,
         1.8899357 ,  1.9041561 ],
       [ 1.6675645 ,  1.6675645 ,  1.6821629 , ...,  1.875716  ,
         1.875716  ,  1.875716  ],
       [ 1.4923834 ,  1.4923834 ,  1.4923834 , ...,  1.7619553 ,
         1.7619553 ,  1.7619553 ],
       ...,
       [-0.87256163, -0.7411758 , -0.7703726 , ..., -0.68389606,
        -0.71233624, -0.71233624],
       [-0.7411758 , -0.7411758 , -0.72657734, ..., -0.68389606,
        -0.71233624, -0.74077636],
       [-1.0477428 , -0.9747507 , -0.88716006, ..., -0.7265563 ,
        -0.6981161 , -0.68389606]], dtype=float32), None, None, None, None, array([[ 1.8135487 ,  1.8135487 ,  1.7989503 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.7259582 ,  1.7113597 ,  1.6967614 , ...,  2.103237  ,
         2.117457  ,  2.117457  ],
       [ 1.8427455 ,  1.857344  ,  1.8719424 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       ...,
       [-0.0550498 , -0.08424664, -0.06964822, ...,  0.09820756,
         0.0839875 ,  0.06976743],
       [-0.3470183 , -0.42001042, -0.4638057 , ..., -0.11509342,
        -0.08665328, -0.11509342],
       [-0.14264035, -0.25942776, -0.21563247, ..., -0.08665328,
        -0.08665328, -0.10087335]], dtype=float32), array([[ 1.2588086 ,  1.3318007 ,  1.4923834 , ...,  0.25462827,
         0.18352796,  0.0413273 ],
       [ 1.477785  ,  1.7405566 ,  1.857344  , ...,  1.1789327 ,
         1.022512  ,  1.0509521 ],
       [ 1.1858164 ,  1.3026038 ,  1.3755959 , ...,  0.5390297 ,
        -0.04399309,  0.24040821],
       ...,
       [-1.193727  , -1.193727  , -1.1207349 , ..., -0.96829736,
        -0.96829736, -0.95407724],
       [-1.1499318 , -1.1499318 , -1.1499318 , ..., -0.21463387,
        -0.7549964 , -1.1531583 ],
       [-1.1353334 , -1.1061366 , -1.193727  , ..., -1.4517797 ,
        -1.4517797 , -1.4375596 ]], dtype=float32), None, None, array([[-1.7192703 , -1.5878845 , -1.6462783 , ..., -1.3948994 ,
        -1.3806794 , -1.3806794 ],
       [-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.4375596 ,
        -1.4517797 , -1.3806794 ],
       [-1.7484672 , -1.7192703 , -1.704672  , ..., -1.2526988 ,
        -1.2526988 , -1.2811389 ],
       ...,
       [-1.1791286 , -1.1353334 , -1.1499318 , ..., -1.0536178 ,
        -1.0393977 , -1.0109575 ],
       [-0.9747507 , -0.94555384, -0.96015227, ..., -1.0962781 ,
        -1.067838  , -1.0536178 ],
       [-1.2667192 , -1.3251129 , -1.3397113 , ..., -0.9398572 ,
        -0.96829736, -0.9398572 ]], dtype=float32), None], 'image_grid_thw': [None, None, array([[ 1, 18, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A giraffe sitting in a grassy field with some rocks.\n', 'Find me an everyday image that matches the given caption: The yellow fire hydrant has a chain across it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A boy wearing glasses holding a remote controller.\n', 'Find me an everyday image that matches the given caption: A man is holding a wrapper with a hotdog.\n', 'Find me an everyday image that matches the given caption: An image of a cat that has hands in a bowl.\n', 'Find me an everyday image that matches the given caption: To motorcross riders enjoy their run through the mud.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person holding a partially eaten sandwich filled with meat.\n', 'Find me an everyday image that matches the given caption: A close up of a neatly made bedroom.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cargo airplane with its nose opened for maintenance.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 68/6000 [02:21<3:23:50,  2.06s/it]                                                   {'loss': 2.7599, 'grad_norm': 153.4126434326172, 'learning_rate': 6.800000000000001e-06, 'epoch': 0.01}
  1%|          | 68/6000 [02:21<3:23:50,  2.06s/it][2025-11-13 01:33:18,973] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,  16359,    624],
        [151643, 151643, 151643,  ...,   9853,  15138,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,   4004,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Two small children holding onto teddy bears in the grass.\n', 'Find me an everyday image that matches the given caption: A person cuts a fish on top of an ice chest.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man riding a motorcycle next to a beach ball colored umbrella.\n', 'Find me an everyday image that matches the given caption: A close up of a pizza with different toppings.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A jet sits on a tarmac with vehicles parked near it.\n', "Find me an everyday image that matches the given caption: A young elephant with it's parent in a zoo setting.\n", 'Find me an everyday image that matches the given caption: A young elephant helps a baby elephant out of a pool of water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two zebras running together in grass with a pair of utility poles in the background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=353x256 at 0x7F32727C6620>], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F3272B5E7A0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5F790>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272B5F850>], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DA260>], [<PIL.Image.Image image mode=RGB size=256x259 at 0x7F32727DACE0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727D9750>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBD00>]], 'pixel_values': [None, None, array([[-0.49300256, -0.65358526, -0.6243884 , ..., -0.9256371 ,
        -0.8403168 , -0.42793486],
       [-0.82876635, -0.7411758 , -0.5221994 , ..., -0.38527465,
        -0.38527465, -0.39949474],
       [-0.44920728, -0.1718372 ,  0.76246214, ...,  0.5532498 ,
         0.61013   ,  0.28306842],
       ...,
       [-0.2302309 , -0.2302309 , -0.21563247, ..., -0.10087335,
        -0.04399309, -0.10087335],
       [-0.06964822,  0.29531252,  0.2807141 , ...,  0.22618815,
         0.11242763, -0.02977302],
       [ 0.04713918,  0.0617376 ,  0.0617376 , ..., -0.35683453,
        -0.42793486, -0.27151415]], dtype=float32), array([[-8.4336478e-01, -9.6015227e-01, -1.0039475e+00, ...,
        -1.1815984e+00, -1.3806794e+00, -1.4375596e+00],
       [-1.3835065e+00, -1.3397113e+00, -1.3105145e+00, ...,
        -8.6875695e-01, -8.2609671e-01, -8.1187665e-01],
       [ 3.3439053e-03, -8.4246643e-02, -2.0103405e-01, ...,
        -1.2669188e+00, -1.3806794e+00, -1.4375596e+00],
       ...,
       [ 1.7942330e-02, -2.5852945e-02, -4.0451370e-02, ...,
         1.9774802e-01,  1.5508783e-01,  9.8207563e-02],
       [-1.4856956e+00, -1.4419003e+00, -1.4127034e+00, ...,
        -1.3328948e-03,  5.5547368e-02, -1.5552960e-02],
       [-9.8845072e-02, -8.4246643e-02, -8.4246643e-02, ...,
         2.6884836e-01,  2.9728848e-01,  3.1150854e-01]], dtype=float32), array([[ 1.6091708 ,  1.6383677 ,  1.6967614 , ...,  1.6766349 ,
         1.6339747 ,  1.6055346 ],
       [ 0.4558952 ,  0.54348576,  0.52888733, ...,  1.5913146 ,
         1.5913146 ,  1.5913146 ],
       [ 1.6675645 ,  1.6237692 ,  1.6675645 , ...,  1.5344343 ,
         1.4917741 ,  1.5059941 ],
       ...,
       [-1.3105145 , -1.3251129 , -1.3689082 , ..., -0.9825174 ,
        -0.9825174 , -1.0393977 ],
       [-0.25942776, -0.42001042, -0.2302309 , ...,  1.5059941 ,
         1.5913146 ,  1.2926931 ],
       [ 0.5142889 ,  0.49969047,  0.23691882, ...,  1.4206737 ,
         1.4491138 ,  1.4917741 ]], dtype=float32), array([[-0.50760096, -0.5221994 , -0.55139625, ..., -0.7265563 ,
        -0.78343654, -0.7265563 ],
       [-0.5367978 , -0.5367978 , -0.47840413, ..., -0.96829736,
        -0.8545369 , -0.57013553],
       [ 0.13472985,  0.32450938,  0.12013142, ..., -0.3710546 ,
        -0.243074  , -0.14353354],
       ...,
       [-0.02585294, -0.14264035, -0.1718372 , ..., -0.4421549 ,
        -1.0393977 , -1.4091195 ],
       [ 0.20772196,  0.32450938,  0.09093457, ..., -1.1531583 ,
        -0.9967375 , -1.0393977 ],
       [ 0.00334391,  0.16392669, -0.0550498 , ..., -0.91141707,
        -1.2526988 , -1.1958185 ]], dtype=float32), None, None, array([[ 0.01794233,  0.01794233, -0.01125452, ..., -0.54169536,
        -0.54169536, -0.51325524],
       [-0.7557742 , -0.405412  , -0.14264035, ..., -0.669676  ,
        -0.58435565, -0.49903518],
       [-0.43460885, -0.5367978 , -0.5805931 , ..., -0.243074  ,
        -0.22885394, -0.11509342],
       ...,
       [-1.3251129 , -1.3105145 , -1.2813176 , ..., -0.9256371 ,
        -0.9398572 , -0.9398572 ],
       [-1.1061366 , -0.96015227, -1.0769397 , ..., -0.8403168 ,
        -0.74077636, -0.7549964 ],
       [-0.9309554 , -1.1499318 , -0.87256163, ..., -0.81187665,
        -0.7549964 , -0.7265563 ]], dtype=float32), array([[-0.78497106, -0.8433648 , -0.82876635, ..., -0.5559154 ,
        -0.57013553, -0.57013553],
       [-0.15723877, -0.11344349, -0.08424664, ..., -0.4421549 ,
        -0.48481512, -0.58435565],
       [-0.8433648 , -1.193727  , -0.96015227, ..., -0.05821316,
        -0.02977302,  0.01288717],
       ...,
       [ 1.857344  ,  1.8427455 ,  1.8427455 , ...,  0.7665507 ,
         0.88031125,  1.0082918 ],
       [ 1.0690291 ,  1.098226  ,  1.1274228 , ...,  0.6527902 ,
         0.7381106 ,  0.823431  ],
       [ 1.273407  ,  1.273407  ,  1.2880055 , ...,  0.8945313 ,
         1.1362724 ,  1.5628744 ]], dtype=float32), None, None, None, array([[-0.5221994 , -1.2813176 , -1.6024829 , ..., -0.71233624,
        -0.51325524,  0.39682904],
       [-1.3543098 , -1.0769397 , -1.6462783 , ...,  0.35416883,
        -0.18619375, -0.61279577],
       [ 1.1128243 ,  0.791659  ,  0.77706057, ...,  0.43948925,
         1.0082918 ,  1.477554  ],
       ...,
       [-0.47840413, -0.50760096, -0.55139625, ..., -0.7265563 ,
        -0.71233624, -0.74077636],
       [-0.49300256, -0.4638057 , -0.4638057 , ..., -0.7265563 ,
        -0.7692165 , -0.81187665],
       [-0.5221994 , -0.5367978 , -0.55139625, ..., -0.5559154 ,
        -0.5559154 , -0.57013553]], dtype=float32), None, array([[ 0.7332653 ,  0.68947   ,  0.6018794 , ...,  1.0651721 ,
         1.1220524 ,  1.2073728 ],
       [ 0.68947   ,  0.68947   ,  0.68947   , ...,  1.1931527 ,
         1.2215928 ,  1.264253  ],
       [ 1.171218  ,  1.098226  ,  1.0836275 , ...,  1.2073728 ,
         1.2500329 ,  1.264253  ],
       ...,
       [-0.6681836 , -0.42001042, -0.50760096, ..., -0.05821316,
         0.02710724,  0.09820756],
       [ 0.10553299, -0.6389868 , -0.9747507 , ...,  0.7807708 ,
         1.0936122 ,  1.7477353 ],
       [-0.303223  , -0.09884507, -0.02585294, ...,  0.11242763,
         0.22618815,  0.33994877]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 18]]), None, None, None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Two small children holding onto teddy bears in the grass.\n', 'Find me an everyday image that matches the given caption: A person cuts a fish on top of an ice chest.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man riding a motorcycle next to a beach ball colored umbrella.\n', 'Find me an everyday image that matches the given caption: A close up of a pizza with different toppings.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A jet sits on a tarmac with vehicles parked near it.\n', "Find me an everyday image that matches the given caption: A young elephant with it's parent in a zoo setting.\n", 'Find me an everyday image that matches the given caption: A young elephant helps a baby elephant out of a pool of water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two zebras running together in grass with a pair of utility poles in the background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|          | 69/6000 [02:23<3:23:13,  2.06s/it]                                                   {'loss': 2.6643, 'grad_norm': 349.0285949707031, 'learning_rate': 6.9e-06, 'epoch': 0.01}
  1%|          | 69/6000 [02:23<3:23:13,  2.06s/it][2025-11-13 01:33:21,017] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,  12060,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  21944,    624],
        [151643, 151643, 151643,  ...,    279,  12884,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A surfer kicks up some spray as he surfs the crest of a wave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy swinging a baseball bat at home plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A female skier competing in a skiing competition.\n', 'Find me an everyday image that matches the given caption: A dog is peeking its head through a gate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is sitting in a beige chair in a living room.\n', 'Find me an everyday image that matches the given caption: A tours bus on a tropical island that had some trouble.\n', 'Find me an everyday image that matches the given caption: Small boy in black and orange baseball uniform swinging a bat.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person sitting on a bench looking out on a pier.\n', 'Find me an everyday image that matches the given caption: An airplane flying on a sunny day with a few wispy clouds in the sky.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272764EE0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272766650>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB0D0>], [None], [<PIL.Image.Image image mode=RGB size=518x256 at 0x7F32727DB760>], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DBAC0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727DB100>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727D9D50>], [None], [None]], 'pixel_values': [None, array([[ 0.5142889 ,  0.52888733,  0.5580842 , ...,  0.96563166,
         0.96563166,  0.9798517 ],
       [ 0.7040684 ,  0.7040684 ,  0.67487156, ...,  1.0509521 ,
         1.0509521 ,  1.0509521 ],
       [ 0.6018794 ,  0.6018794 ,  0.6018794 , ...,  0.9514116 ,
         0.96563166,  0.9798517 ],
       ...,
       [-0.303223  ,  0.09093457,  0.41209993, ..., -1.2526988 ,
        -1.2811389 , -1.2953589 ],
       [-1.1791286 , -1.2375224 , -1.2959161 , ..., -1.2242587 ,
        -1.2384787 , -1.2100385 ],
       [-1.4856956 , -1.398105  , -1.398105  , ..., -1.2384787 ,
        -1.2384787 , -1.2384787 ]], dtype=float32), array([[-0.9893491 , -1.0039475 , -1.018546  , ..., -0.54169536,
        -0.54169536, -0.54169536],
       [-0.9893491 , -0.9893491 , -0.96015227, ..., -0.58435565,
        -0.5985757 , -0.5985757 ],
       [-0.9017585 , -0.9017585 , -0.9017585 , ..., -0.08665328,
        -0.11509342, -0.07243322],
       ...,
       [-0.405412  , -0.55139625, -0.6973805 , ...,  0.46792936,
         0.4963695 ,  0.51058954],
       [ 0.58728105,  0.58728105,  0.58728105, ...,  0.7665507 ,
         0.7665507 ,  0.38260898],
       [ 0.7478637 ,  0.7332653 ,  0.49969047, ...,  0.59590995,
         0.29728848,  0.0413273 ]], dtype=float32), array([[-0.31782144, -0.43460885, -0.7557742 , ..., -0.08665328,
         0.7096705 ,  1.1789327 ],
       [ 0.04713918,  0.2807141 ,  0.41209993, ..., -0.49903518,
        -0.58435565, -0.65545595],
       [-0.18643562, -0.15723877,  0.00334391, ..., -1.1673783 ,
        -0.9398572 , -0.74077636],
       ...,
       [ 1.652966  ,  1.5507771 ,  1.7113597 , ...,  2.145897  ,
         1.8899357 ,  1.3780135 ],
       [ 1.5945723 ,  1.5507771 ,  1.4923834 , ...,  1.5770944 ,
         1.4348938 ,  1.2215928 ],
       [ 1.6967614 ,  1.6967614 ,  1.7259582 , ...,  0.7807708 ,
         0.90875137,  1.022512  ]], dtype=float32), None, array([[-1.2667192 , -1.193727  , -1.0915381 , ...,  1.022512  ,
         1.1078323 ,  1.2073728 ],
       [-0.21563247, -0.14264035, -0.01125452, ...,  1.7335151 ,
         1.7761754 ,  1.7903955 ],
       [-0.14264035, -0.0550498 ,  0.09093457, ...,  1.463334  ,
         1.6197547 ,  1.7477353 ],
       ...,
       [ 0.85005265,  0.791659  ,  0.7040684 , ..., -0.4421549 ,
        -0.48481512, -0.5274753 ],
       [ 0.9814385 ,  0.9814385 ,  0.99603695, ..., -0.65545595,
        -0.6981161 , -0.74077636],
       [ 0.03254076, -0.02585294, -0.12804192, ..., -0.9967375 ,
        -1.0251776 , -1.0251776 ]], dtype=float32), None, None, array([[-0.42001042, -0.47840413, -0.49300256, ...,  0.75233066,
         0.7949909 ,  0.7807708 ],
       [-0.39081356, -0.405412  , -0.42001042, ...,  0.6527902 ,
         0.75233066,  0.88031125],
       [-0.94555384, -0.9163569 , -0.9017585 , ..., -0.01555296,
         0.02710724,  0.06976743],
       ...,
       [ 0.61647785,  0.61647785,  0.6310763 , ...,  0.9798517 ,
         0.9798517 ,  0.9798517 ],
       [ 0.7332653 ,  0.7332653 ,  0.7332653 , ...,  0.6243501 ,
         0.6954504 ,  0.6954504 ],
       [ 0.58728105,  0.58728105,  0.58728105, ...,  0.6243501 ,
         0.61013   ,  0.59590995]], dtype=float32), array([[-0.5805931 , -1.1353334 , -0.7703726 , ..., -0.32839438,
        -0.54169536, -0.81187665],
       [-0.5221994 , -0.8433648 , -0.9017585 , ..., -0.45637497,
        -0.04399309,  0.18352796],
       [ 0.9084464 ,  0.6310763 , -0.5805931 , ..., -0.29995427,
         0.16930789, -0.07243322],
       ...,
       [ 1.7551551 ,  1.7551551 ,  1.7697535 , ...,  1.2073728 ,
         1.1931527 ,  1.1647125 ],
       [ 1.7259582 ,  1.7551551 ,  1.6967614 , ...,  1.1078323 ,
         1.1078323 ,  1.0936122 ],
       [ 1.5799739 ,  1.5215802 ,  1.5215802 , ...,  1.3780135 ,
         1.4348938 ,  1.3069133 ]], dtype=float32), None, None, None, array([[-1.3251129 , -1.3105145 , -1.3105145 , ..., -1.1531583 ,
        -1.1389382 , -1.1531583 ],
       [-1.2521207 , -1.2521207 , -1.2083255 , ..., -1.2669188 ,
        -1.2669188 , -1.2526988 ],
       [-1.1353334 , -1.1207349 , -1.1207349 , ..., -1.1673783 ,
        -1.1673783 , -1.1673783 ],
       ...,
       [ 0.8208558 ,  0.8208558 ,  0.8208558 , ...,  0.93719155,
         0.8945313 ,  0.7096705 ],
       [ 0.76246214,  0.791659  ,  0.8208558 , ..., -1.2669188 ,
        -1.2526988 , -1.2384787 ],
       [ 1.0690291 ,  1.0106354 ,  0.89384794, ..., -0.9967375 ,
        -0.9825174 , -0.9967375 ]], dtype=float32), None, None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 36]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None, None, None, array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A surfer kicks up some spray as he surfs the crest of a wave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy swinging a baseball bat at home plate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A female skier competing in a skiing competition.\n', 'Find me an everyday image that matches the given caption: A dog is peeking its head through a gate.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is sitting in a beige chair in a living room.\n', 'Find me an everyday image that matches the given caption: A tours bus on a tropical island that had some trouble.\n', 'Find me an everyday image that matches the given caption: Small boy in black and orange baseball uniform swinging a bat.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person sitting on a bench looking out on a pier.\n', 'Find me an everyday image that matches the given caption: An airplane flying on a sunny day with a few wispy clouds in the sky.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|          | 70/6000 [02:25<3:22:37,  2.05s/it]                                                   {'loss': 2.7858, 'grad_norm': 129.14273071289062, 'learning_rate': 7e-06, 'epoch': 0.01}
  1%|          | 70/6000 [02:25<3:22:37,  2.05s/it][2025-11-13 01:33:23,054] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,   8527,    624],
        [151643, 151643, 151643,  ...,    264,  10729,    624],
        [151643, 151643, 151643,  ...,    264,   3283,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Man standing in front of a parking meter holding a folder.\n', 'Find me an everyday image that matches the given caption: A pizza just delivered to a table in a restaurant.\n', 'Find me an everyday image that matches the given caption: A sculpture on top of a traffic light in a city.\n', 'Find me an everyday image that matches the given caption: Four giraffes walking across a bare land, with water behind them.\n', 'Find me an everyday image that matches the given caption: A collage of photos show random red objects.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black cat is sitting on the rug covered lid of a toilet bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bearded cross country skier traveling in deep snow.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman looking through a bunch of ripe bananas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3274FE9D20>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA8F0>], [<PIL.Image.Image image mode=RGB size=256x386 at 0x7F32727D8E20>], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727C7AF0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBBB0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DB880>], [<PIL.Image.Image image mode=RGB size=256x268 at 0x7F32727D8F10>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DB3A0>]], 'pixel_values': [None, None, None, None, None, array([[ 1.2150133 ,  1.2150133 ,  1.2150133 , ...,  1.7903955 ,
         1.7903955 ,  1.7903955 ],
       [ 1.273407  ,  1.273407  ,  1.2588086 , ...,  1.8188357 ,
         1.8188357 ,  1.8188357 ],
       [ 1.2880055 ,  1.3026038 ,  1.3026038 , ...,  1.7761754 ,
         1.7761754 ,  1.7903955 ],
       ...,
       [-0.04045137, -0.08424664, -0.0550498 , ...,  0.19774802,
         0.26884836,  0.18352796],
       [ 0.07633615,  0.0617376 ,  0.07633615, ...,  0.06976743,
        -0.01555296, -0.05821316],
       [-0.04045137,  0.00334391,  0.03254076, ...,  0.0839875 ,
         0.0839875 ,  0.05554737]], dtype=float32), None, array([[1.6091708 , 1.6091708 , 1.6091708 , ..., 1.8330555 , 1.8330555 ,
        1.8188357 ],
       [1.5361787 , 1.5507771 , 1.6091708 , ..., 1.7335151 , 1.7192951 ,
        1.705075  ],
       [1.6675645 , 1.6675645 , 1.6675645 , ..., 1.875716  , 1.875716  ,
        1.8614956 ],
       ...,
       [0.13472985, 0.10553299, 0.10553299, ..., 0.3257286 , 0.33994877,
        0.33994877],
       [0.14932826, 0.14932826, 0.14932826, ..., 0.36838892, 0.35416883,
        0.31150854],
       [0.13472985, 0.10553299, 0.10553299, ..., 0.31150854, 0.29728848,
        0.29728848]], dtype=float32), array([[ 0.71866685,  0.71866685,  0.71866685, ...,  1.3922336 ,
         1.4206737 ,  1.463334  ],
       [ 0.85005265,  0.8646511 ,  1.0252337 , ...,  1.5486543 ,
         1.5202142 ,  1.477554  ],
       [ 0.8354542 ,  0.8354542 ,  0.8354542 , ...,  1.3780135 ,
         1.4064537 ,  1.4206737 ],
       ...,
       [-1.5732862 , -1.5294908 , -1.5148925 , ...,  0.19774802,
        -0.74077636, -0.96829736],
       [ 1.0544306 , -0.405412  , -1.2375224 , ..., -1.2669188 ,
        -1.0536178 , -1.1104981 ],
       [-1.6316798 , -1.5440893 , -0.42001042, ..., -0.01555296,
         1.1789327 ,  1.1220524 ]], dtype=float32), None, array([[ 0.38290307,  0.38290307,  0.10553299, ..., -0.21463387,
        -0.05821316, -0.11509342],
       [ 0.25151724,  0.6310763 ,  0.61647785, ..., -0.882977  ,
        -0.7265563 , -0.61279577],
       [ 1.652966  ,  1.477785  ,  1.6383677 , ..., -0.91141707,
        -0.78343654, -0.58435565],
       ...,
       [ 0.29531252,  0.3975015 ,  0.58728105, ..., -0.86875695,
        -0.89719707, -1.1958185 ],
       [ 0.25151724,  0.20772196,  0.04713918, ..., -0.9967375 ,
        -1.067838  , -1.0536178 ],
       [-0.0550498 , -0.08424664, -0.12804192, ..., -1.0251776 ,
        -1.0962781 , -0.882977  ]], dtype=float32), None, array([[ 0.01794233,  0.04713918, -0.01125452, ...,  0.21196808,
         0.11242763,  0.11242763],
       [-0.11344349, -0.06964822, -0.08424664, ..., -0.243074  ,
        -0.2857342 , -0.91141707],
       [-1.5148925 , -1.6608766 , -1.6462783 , ..., -0.22885394,
        -0.38527465, -0.58435565],
       ...,
       [-0.5659947 , -0.6681836 , -0.6243884 , ..., -0.5559154 ,
        -0.51325524, -0.42793486],
       [-0.94555384, -0.94555384, -0.9747507 , ..., -0.882977  ,
        -0.8545369 , -0.81187665],
       [-1.018546  , -1.0039475 , -0.8579632 , ..., -0.7549964 ,
        -0.78343654, -0.78343654]], dtype=float32), array([[-0.15723877, -0.15723877, -0.15723877, ...,  0.8945313 ,
         0.8945313 ,  0.8945313 ],
       [-0.14264035, -0.14264035, -0.14264035, ...,  0.88031125,
         0.88031125,  0.88031125],
       [-0.21563247, -0.21563247, -0.21563247, ...,  0.93719155,
         0.93719155,  0.93719155],
       ...,
       [ 0.791659  ,  0.8062574 ,  0.8354542 , ...,  1.690855  ,
         1.7192951 ,  1.7335151 ],
       [ 0.66027313,  0.67487156,  0.66027313, ...,  1.4491138 ,
         1.463334  ,  1.477554  ],
       [ 0.61647785,  0.61647785,  0.6310763 , ...,  1.5770944 ,
         1.5770944 ,  1.5628744 ]], dtype=float32), array([[ 1.2880055 ,  1.4193913 ,  1.5945723 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.7551551 ,  1.7259582 ,  1.7259582 , ...,  2.145897  ,
         2.145897  ,  2.1316772 ],
       [ 1.8281472 ,  1.6383677 ,  1.7843518 , ...,  2.117457  ,
         2.117457  ,  2.117457  ],
       ...,
       [ 1.2442101 ,  1.2442101 ,  1.2442101 , ...,  1.5486543 ,
         1.5344343 ,  1.5202142 ],
       [-1.3397113 , -1.2667192 , -1.1645303 , ...,  0.52480966,
        -0.10087335, -0.17197368],
       [ 1.1858164 ,  1.171218  ,  1.2004149 , ..., -0.65545595,
        -0.7265563 , -0.2857342 ]], dtype=float32), array([[-1.4127034 , -1.4127034 , -1.4127034 , ..., -0.95407724,
        -0.95407724, -0.9398572 ],
       [-1.4273019 , -1.4273019 , -1.3835065 , ..., -0.882977  ,
        -0.882977  , -0.882977  ],
       [-1.2813176 , -1.2813176 , -1.2813176 , ..., -0.9398572 ,
        -0.89719707, -0.882977  ],
       ...,
       [-1.3689082 , -1.3397113 , -1.3105145 , ..., -1.3948994 ,
        -1.3806794 , -1.3806794 ],
       [-1.6462783 , -1.5294908 , -1.3689082 , ..., -1.4802198 ,
        -1.4802198 , -1.4659997 ],
       [-1.6608766 , -1.6608766 , -1.6608766 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ]], dtype=float32)], 'image_grid_thw': [None, None, None, None, None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 20, 18]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Man standing in front of a parking meter holding a folder.\n', 'Find me an everyday image that matches the given caption: A pizza just delivered to a table in a restaurant.\n', 'Find me an everyday image that matches the given caption: A sculpture on top of a traffic light in a city.\n', 'Find me an everyday image that matches the given caption: Four giraffes walking across a bare land, with water behind them.\n', 'Find me an everyday image that matches the given caption: A collage of photos show random red objects.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black cat is sitting on the rug covered lid of a toilet bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bearded cross country skier traveling in deep snow.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman looking through a bunch of ripe bananas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|          | 71/6000 [02:27<3:20:13,  2.03s/it]                                                   {'loss': 2.8781, 'grad_norm': 172.2129364013672, 'learning_rate': 7.100000000000001e-06, 'epoch': 0.01}
  1%|          | 71/6000 [02:27<3:20:13,  2.03s/it][2025-11-13 01:33:25,024] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    315,  19818,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   6255,  16002,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A stove top oven in a kitchen filled with black tile.\n', 'Find me an everyday image that matches the given caption: A pizza in a cardboard box with several stuffed animals sitting around it.\n', 'Find me an everyday image that matches the given caption: A woman dressed in a revealing outfit while on a cell phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in skies is standing in the snow.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A herd of horses running through a grassy field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Street vendors shows off their selection of ties.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Fresh made pizza with vegetables on pita bread.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA530>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB070>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB5E0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB850>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9FF0>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727D9870>], [<PIL.Image.Image image mode=RGB size=339x256 at 0x7F32727DB640>], [None], [<PIL.Image.Image image mode=RGB size=342x256 at 0x7F32727D8EB0>], [None], [<PIL.Image.Image image mode=RGB size=652x256 at 0x7F32727D9420>], [None]], 'pixel_values': [array([[ 0.07633615,  0.09093457,  0.10553299, ...,  0.18352796,
         0.18352796,  0.18352796],
       [ 0.09093457,  0.09093457,  0.0617376 , ..., -0.07243322,
         0.22618815,  0.56746984],
       [ 0.12013142,  0.12013142,  0.12013142, ...,  0.16930789,
         0.16930789,  0.18352796],
       ...,
       [ 1.0690291 ,  1.1128243 ,  1.098226  , ..., -0.07243322,
        -0.08665328, -0.10087335],
       [ 1.098226  ,  1.0106354 ,  1.0106354 , ..., -1.4802198 ,
        -1.4802198 , -1.4375596 ],
       [ 1.1420212 ,  1.1566195 ,  1.1128243 , ..., -0.07243322,
        -0.04399309, -0.05821316]], dtype=float32), array([[ 0.17852512,  0.19312355,  0.23691882, ..., -1.1389382 ,
        -1.1389382 , -1.1389382 ],
       [ 0.49969047,  0.48509204,  0.5142889 , ..., -1.1389382 ,
        -1.1531583 , -1.1531583 ],
       [ 0.3975015 ,  0.41209993,  0.4558952 , ..., -1.0962781 ,
        -1.082058  , -1.082058  ],
       ...,
       [ 0.52888733,  0.52888733,  0.5142889 , ...,  0.05554737,
         0.0413273 ,  0.02710724],
       [ 0.42669836,  0.48509204,  0.5726826 , ...,  0.14086775,
         0.11242763,  0.1266477 ],
       [ 0.44129676,  0.3975015 ,  0.38290307, ..., -0.00133289,
        -0.01555296, -0.02977302]], dtype=float32), array([[-0.303223  ,  0.8208558 ,  0.99603695, ...,  0.4110491 ,
         0.96563166,  0.5532498 ],
       [-0.5659947 ,  0.0617376 ,  0.77706057, ...,  0.9514116 ,
         0.46792936,  0.0413273 ],
       [ 0.5726826 ,  0.2223204 ,  0.12013142, ...,  0.63857013,
         0.7807708 ,  0.7381106 ],
       ...,
       [ 0.12013142,  0.01794233,  0.20772196, ..., -0.68389606,
        -0.61279577, -0.4421549 ],
       [ 0.3537062 ,  0.17852512,  0.13472985, ...,  0.05554737,
        -0.08665328, -0.39949474],
       [ 0.23691882,  0.19312355,  0.10553299, ..., -0.47059506,
        -0.42793486, -0.35683453]], dtype=float32), array([[ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.1316772 ,  2.1316772 ],
       [ 1.9011393 ,  1.9011393 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       ...,
       [-1.0915381 , -1.0331444 , -0.6243884 , ..., -1.1673783 ,
        -1.0393977 , -0.89719707],
       [-1.4273019 , -1.3397113 , -1.3689082 , ..., -1.1247182 ,
        -1.1389382 , -1.1815984 ],
       [-1.1645303 , -1.193727  , -1.2229239 , ..., -1.309579  ,
        -1.3380191 , -1.3380191 ]], dtype=float32), None, None, None, array([[-0.12804192, -0.12804192, -0.12804192, ...,  1.022512  ,
         1.1362724 ,  0.7807708 ],
       [-0.2740262 , -0.2740262 , -0.303223  , ..., -1.2384787 ,
        -0.96829736, -0.7549964 ],
       [-0.09884507, -0.14264035,  0.04713918, ..., -0.81187665,
        -0.7976566 , -0.9256371 ],
       ...,
       [-1.4419003 , -1.500294  , -1.5294908 , ..., -1.0962781 ,
        -1.1104981 , -1.1104981 ],
       [-0.78497106, -0.88716006, -0.9309554 , ..., -1.1531583 ,
        -1.1247182 , -1.0962781 ],
       [-1.4710971 , -1.4856956 , -1.4564987 , ..., -1.0962781 ,
        -1.1104981 , -1.1247182 ]], dtype=float32), None, array([[ 1.8719424 ,  1.8719424 ,  1.8719424 , ...,  1.918376  ,
         1.918376  ,  1.918376  ],
       [ 1.8719424 ,  1.8719424 ,  1.857344  , ...,  0.72389054,
         0.4537093 ,  0.52480966],
       [ 1.857344  ,  1.857344  ,  1.857344  , ...,  1.8899357 ,
         1.8899357 ,  1.8899357 ],
       ...,
       [-1.6608766 , -1.7192703 , -1.7484672 , ..., -0.91141707,
        -0.86875695, -0.9256371 ],
       [-0.12804192, -0.15723877, -0.20103405, ..., -0.9825174 ,
        -0.7549964 , -0.7265563 ],
       [-1.2521207 , -1.0623412 , -1.1645303 , ..., -0.65545595,
        -0.81187665, -1.067838  ]], dtype=float32), array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  1.9752562 ,
         1.3637935 ,  1.3495734 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.117457  ,
         2.145897  ,  1.9610363 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.243074  ,
        -0.04399309,  0.43948925],
       ...,
       [ 1.4485881 ,  1.477785  ,  1.4485881 , ..., -0.34261447,
        -0.34261447, -0.34261447],
       [ 0.3975015 ,  0.5142889 ,  0.3537062 , ..., -0.58435565,
        -0.57013553, -0.5559154 ],
       [-0.87256163, -0.8433648 , -0.82876635, ..., -0.47059506,
        -0.48481512, -0.48481512]], dtype=float32), None, array([[ 1.7551551 ,  1.7551551 ,  1.7697535 , ...,  2.0321364 ,
         2.0179167 ,  2.0321364 ],
       [ 1.8719424 ,  1.857344  ,  1.8281472 , ...,  2.0321364 ,
         2.0321364 ,  2.0321364 ],
       [ 1.6237692 ,  1.6383677 ,  1.652966  , ...,  2.0321364 ,
         2.0321364 ,  2.0321364 ],
       ...,
       [-1.0623412 , -1.0623412 , -1.0477428 , ..., -0.91141707,
        -0.86875695, -0.8403168 ],
       [-0.5659947 , -0.6681836 , -0.7557742 , ..., -0.9825174 ,
        -0.9967375 , -1.0251776 ],
       [-1.0477428 , -1.0039475 , -0.94555384, ..., -1.0109575 ,
        -1.0251776 , -1.0251776 ]], dtype=float32), None, array([[-0.1718372 , -0.06964822,  0.2807141 , ..., -0.15775362,
        -0.15775362, -0.15775362],
       [ 0.9230448 ,  0.9668401 ,  0.93764323, ..., -0.54169536,
        -0.5985757 , -0.5985757 ],
       [-0.55139625, -0.47840413, -0.55139625, ..., -0.5985757 ,
        -0.61279577, -0.61279577],
       ...,
       [ 0.3975015 ,  0.49969047,  0.58728105, ..., -1.3522393 ,
        -1.3664593 , -1.3806794 ],
       [-1.4419003 , -1.4564987 , -1.4273019 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.3689082 , -1.3689082 , -1.3251129 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 46]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A stove top oven in a kitchen filled with black tile.\n', 'Find me an everyday image that matches the given caption: A pizza in a cardboard box with several stuffed animals sitting around it.\n', 'Find me an everyday image that matches the given caption: A woman dressed in a revealing outfit while on a cell phone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in skies is standing in the snow.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A herd of horses running through a grassy field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Street vendors shows off their selection of ties.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Fresh made pizza with vegetables on pita bread.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 72/6000 [02:29<3:23:28,  2.06s/it]                                                   {'loss': 2.8181, 'grad_norm': 156.79928588867188, 'learning_rate': 7.2000000000000005e-06, 'epoch': 0.01}
  1%|          | 72/6000 [02:29<3:23:28,  2.06s/it][2025-11-13 01:33:27,160] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    285,  32031,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  32319,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A black dog and a red dog are trying to get a frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Picture of double red traffic light while pedestrians cross street.\n', 'Find me an everyday image that matches the given caption: An old restaurant in Lucerne that apparently has wonderful wiener schnitzel.\n', 'Find me an everyday image that matches the given caption: An older model double deck tour bus sitting on a road side.\n', 'Find me an everyday image that matches the given caption: A little red and blue fire hydran next to a sidewalk.\n', 'Find me an everyday image that matches the given caption: An upside down blender containing a mixture of food.\n', 'Find me an everyday image that matches the given caption: A highway with train tracks in the middle.\n', 'Find me an everyday image that matches the given caption: Two old train cars laying against trees near a passing train.\n', 'Find me an everyday image that matches the given caption: Ano ver cast sky over a parking lot of a shopping center on S Girard Ave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A herd of cows eating hay near a barn.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=343x256 at 0x7F3272FADAE0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727DBD00>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727C6E00>], [None], [None], [None], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x320 at 0x7F32727D9750>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB0D0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB760>], [None]], 'pixel_values': [None, array([[ 4.1209993e-01,  4.2669836e-01,  4.4129676e-01, ...,
        -2.9773025e-02, -1.3328948e-03,  1.2664770e-01],
       [-1.0185460e+00, -1.0331444e+00, -1.0915381e+00, ...,
        -3.7105459e-01, -3.2839438e-01, -2.8573421e-01],
       [ 5.7268262e-01,  5.8728105e-01,  6.0187942e-01, ...,
         1.6930789e-01,  2.2618815e-01,  2.8306842e-01],
       ...,
       [-1.5878845e+00, -1.5878845e+00, -1.5878845e+00, ...,
        -1.3664593e+00, -1.3522393e+00, -1.3806794e+00],
       [-1.6754751e+00, -1.7046720e+00, -1.7046720e+00, ...,
        -1.4375596e+00, -1.4375596e+00, -1.4233395e+00],
       [-1.6900735e+00, -1.6900735e+00, -1.6900735e+00, ...,
        -1.1389382e+00, -1.1673783e+00, -1.1247182e+00]], dtype=float32), array([[ 0.7040684 ,  0.7040684 ,  0.7040684 , ...,  1.3211333 ,
         1.3211333 ,  1.2926931 ],
       [ 0.791659  ,  0.85005265,  0.9230448 , ...,  0.8945313 ,
         0.90875137,  0.93719155],
       [ 0.77706057,  0.791659  ,  0.8062574 , ...,  0.90875137,
         0.90875137,  0.90875137],
       ...,
       [ 1.2004149 ,  1.2004149 ,  1.1858164 , ..., -1.2811389 ,
        -1.3380191 , -1.3237991 ],
       [ 1.2296118 ,  1.2296118 ,  1.2296118 , ..., -1.082058  ,
        -0.9825174 , -0.9256371 ],
       [ 0.29531252,  0.07633615, -0.09884507, ..., -0.71233624,
        -0.7692165 , -0.81187665]], dtype=float32), array([[-0.72657734,  0.12013142, -1.2375224 , ...,  0.59590995,
         0.0839875 , -0.12931348],
       [-0.50760096, -0.72657734, -0.78497106, ..., -0.7549964 ,
        -0.25729406, -0.89719707],
       [-1.1791286 , -0.43460885, -0.6681836 , ..., -0.8403168 ,
        -0.8260967 , -0.5985757 ],
       ...,
       [-1.3689082 , -1.3543098 , -1.3543098 , ..., -1.4233395 ,
        -1.4233395 , -1.4091195 ],
       [-1.500294  , -1.500294  , -1.5148925 , ..., -1.4233395 ,
        -1.4091195 , -1.3948994 ],
       [-1.5294908 , -1.5148925 , -1.4856956 , ..., -1.3522393 ,
        -1.3948994 , -1.3806794 ]], dtype=float32), None, None, None, None, None, None, None, None, array([[1.9303361 , 1.9303361 , 1.9157377 , ..., 1.4064537 , 1.3495734 ,
        1.2215928 ],
       [1.9157377 , 1.8427455 , 1.7405566 , ..., 0.80921096, 0.61013   ,
        0.1266477 ],
       [1.9303361 , 1.9303361 , 1.9303361 , ..., 1.3922336 , 1.4064537 ,
        1.4064537 ],
       ...,
       [1.5215802 , 1.5069818 , 1.4923834 , ..., 0.9229715 , 0.93719155,
        0.9229715 ],
       [1.5507771 , 1.5507771 , 1.5507771 , ..., 0.9229715 , 0.9229715 ,
        0.8945313 ],
       [1.5653756 , 1.5653756 , 1.5653756 , ..., 0.72389054, 0.75233066,
        0.7665507 ]], dtype=float32), array([[-1.2521207 , -1.2521207 , -1.2375224 , ..., -0.9256371 ,
        -0.91141707, -0.89719707],
       [-1.193727  , -1.193727  , -1.193727  , ..., -0.78343654,
        -0.78343654, -0.78343654],
       [-1.2229239 , -1.2083255 , -1.193727  , ..., -0.86875695,
        -0.8545369 , -0.95407724],
       ...,
       [ 0.19312355,  0.17852512,  0.14932826, ..., -1.2953589 ,
        -1.2953589 , -1.309579  ],
       [ 0.23691882,  0.19312355,  0.17852512, ..., -1.2811389 ,
        -1.2953589 , -1.2953589 ],
       [ 0.03254076,  0.00334391, -0.01125452, ..., -1.3522393 ,
        -1.3664593 , -1.3664593 ]], dtype=float32), array([[ 1.6675645 ,  1.6967614 ,  1.7113597 , ...,  2.0605767 ,
         2.145897  ,  2.145897  ],
       [ 1.2442101 ,  1.5069818 ,  1.4485881 , ...,  2.1316772 ,
         2.103237  ,  2.117457  ],
       [ 1.7697535 ,  1.7843518 ,  1.8135487 , ...,  1.918376  ,
         1.7761754 ,  1.8330555 ],
       ...,
       [ 0.33910778,  0.32450938,  0.20772196, ...,  0.09820756,
         0.35416883,  0.4537093 ],
       [ 0.12013142,  0.00334391, -0.0550498 , ...,  0.31150854,
         0.3257286 ,  0.48214942],
       [-0.01125452, -0.01125452,  0.25151724, ...,  0.48214942,
         0.28306842,  0.28306842]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, None, None, None, None, None, None, None, array([[ 1, 22, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A black dog and a red dog are trying to get a frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Picture of double red traffic light while pedestrians cross street.\n', 'Find me an everyday image that matches the given caption: An old restaurant in Lucerne that apparently has wonderful wiener schnitzel.\n', 'Find me an everyday image that matches the given caption: An older model double deck tour bus sitting on a road side.\n', 'Find me an everyday image that matches the given caption: A little red and blue fire hydran next to a sidewalk.\n', 'Find me an everyday image that matches the given caption: An upside down blender containing a mixture of food.\n', 'Find me an everyday image that matches the given caption: A highway with train tracks in the middle.\n', 'Find me an everyday image that matches the given caption: Two old train cars laying against trees near a passing train.\n', 'Find me an everyday image that matches the given caption: Ano ver cast sky over a parking lot of a shopping center on S Girard Ave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A herd of cows eating hay near a barn.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 73/6000 [02:31<3:21:42,  2.04s/it]                                                   {'loss': 2.553, 'grad_norm': 151.3253936767578, 'learning_rate': 7.3e-06, 'epoch': 0.01}
  1%|          | 73/6000 [02:31<3:21:42,  2.04s/it][2025-11-13 01:33:29,170] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    553,   3015,    624],
        ...,
        [151643, 151643, 151643,  ...,    862,   5750,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   3460,   6946,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People flying a kite in a grassy field by water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A passenger train sitting outside of  the station.\n', 'Find me an everyday image that matches the given caption: A woman with a tennis racket is tying her shoes.\n', 'Find me an everyday image that matches the given caption: A train with people inside is about to go into a tunnel.\n', 'Find me an everyday image that matches the given caption: Display of fruit with apples and bananas together.\n', 'Find me an everyday image that matches the given caption: Big tanker trucks lined up on an icy street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Some people and two elephants in their pen.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A colorful bird sitting on a large rock.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DA470>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBA00>], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727DB7C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB4C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB8E0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB190>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727DADA0>], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F32727D9D50>], [None]], 'pixel_values': [array([[-1.2521207 , -1.2521207 , -1.2521207 , ..., -1.309579  ,
        -1.309579  , -1.309579  ],
       [-1.193727  , -1.193727  , -1.2083255 , ..., -1.309579  ,
        -1.309579  , -1.309579  ],
       [-1.2521207 , -1.2521207 , -1.2521207 , ..., -1.3237991 ,
        -1.3237991 , -1.3380191 ],
       ...,
       [ 0.9668401 ,  0.8208558 ,  0.68947   , ..., -0.7549964 ,
        -0.89719707, -0.9967375 ],
       [ 1.1274228 ,  1.1566195 ,  1.2150133 , ...,  1.6481948 ,
         1.705075  ,  1.6197547 ],
       [ 0.3537062 ,  0.32450938,  0.19312355, ...,  0.85187113,
         0.90875137,  1.0509521 ]], dtype=float32), array([[ 0.17852512,  0.17852512,  0.19312355, ...,  0.8376511 ,
         0.85187113,  0.85187113],
       [ 0.17852512,  0.16392669,  0.14932826, ...,  0.90875137,
         0.90875137,  0.9229715 ],
       [ 0.54348576,  0.5142889 ,  0.49969047, ...,  1.0509521 ,
         1.036732  ,  0.9940718 ],
       ...,
       [ 0.44129676,  0.36830464,  0.20772196, ..., -0.32839438,
        -0.39949474, -0.32839438],
       [-0.42001042, -0.5805931 , -0.6389868 , ..., -0.20041381,
        -0.42793486, -0.58435565],
       [-0.65358526, -0.7557742 , -0.55139625, ..., -0.32839438,
        -0.35683453, -0.3710546 ]], dtype=float32), None, array([[ 0.8354542 ,  0.8062574 ,  0.7478637 , ...,  0.35416883,
         0.33994877,  0.31150854],
       [ 0.8354542 ,  0.85005265,  0.8646511 , ...,  1.1220524 ,
         0.93719155,  0.72389054],
       [ 0.9668401 ,  0.95224166,  0.95224166, ...,  0.7096705 ,
         0.7807708 ,  0.823431  ],
       ...,
       [ 0.61647785,  0.5580842 ,  0.5142889 , ...,  0.3257286 ,
         0.09820756,  0.0839875 ],
       [ 0.61647785,  0.8208558 ,  0.5142889 , ..., -0.21463387,
        -0.48481512, -0.51325524],
       [ 0.3537062 ,  0.25151724,  0.38290307, ..., -0.01555296,
        -0.00133289,  0.18352796]], dtype=float32), array([[-0.8579632 , -0.8433648 , -0.78497106, ..., -0.34261447,
        -0.31417432, -0.2857342 ],
       [-0.42001042, -0.42001042, -0.44920728, ..., -0.31417432,
        -0.2857342 , -0.2857342 ],
       [-1.0039475 , -1.018546  , -1.0039475 , ..., -0.54169536,
        -0.49903518, -0.45637497],
       ...,
       [-1.4273019 , -1.4419003 , -1.4564987 , ..., -1.2526988 ,
        -1.2669188 , -1.2669188 ],
       [-1.3105145 , -1.3397113 , -1.3251129 , ..., -1.1531583 ,
        -1.1673783 , -1.1815984 ],
       [-1.4419003 , -1.4419003 , -1.4419003 , ..., -1.2242587 ,
        -1.2384787 , -1.2526988 ]], dtype=float32), array([[ 1.0398322 ,  0.93764323,  0.9814385 , ...,  1.7192951 ,
         1.7761754 ,  1.7761754 ],
       [ 0.7332653 ,  0.13472985, -0.68278205, ..., -0.95407724,
        -0.86875695, -0.61279577],
       [ 1.171218  ,  1.1858164 ,  1.2150133 , ...,  1.6481948 ,
         1.6481948 ,  1.6481948 ],
       ...,
       [ 0.36830464,  0.3537062 ,  0.48509204, ..., -0.21463387,
        -0.32839438, -0.39949474],
       [ 0.44129676,  0.4558952 ,  0.32450938, ..., -0.5274753 ,
        -0.48481512, -0.49903518],
       [ 0.32450938,  0.36830464,  0.2807141 , ..., -0.7265563 ,
        -0.51325524, -0.34261447]], dtype=float32), None, None, None, None, None, array([[ 0.8208558 ,  0.85005265,  0.89384794, ..., -1.3948994 ,
        -1.3948994 , -1.3806794 ],
       [ 1.1566195 ,  1.1274228 ,  1.0836275 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ],
       [-1.398105  , -1.3835065 , -1.3543098 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       ...,
       [-1.3543098 , -1.398105  , -1.3543098 , ..., -1.4233395 ,
        -1.4517797 , -1.4517797 ],
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.2811389 ,
        -1.2384787 , -1.2242587 ],
       [-1.6170814 , -1.6170814 , -1.6316798 , ..., -1.3664593 ,
        -1.3522393 , -1.3522393 ]], dtype=float32), array([[ 1.7989503 ,  1.8135487 ,  1.8135487 , ...,  0.39682904,
         0.36838892,  0.15508783],
       [ 1.7989503 ,  1.7989503 ,  1.7989503 , ...,  0.4537093 ,
         0.46792936,  0.48214942],
       [ 1.8135487 ,  1.8135487 ,  1.8135487 , ...,  0.4963695 ,
         0.39682904,  0.4110491 ],
       ...,
       [-1.2229239 , -1.2667192 , -1.2667192 , ...,  1.9468161 ,
         1.9468161 ,  1.9610363 ],
       [-1.2375224 , -1.2375224 , -1.2375224 , ...,  1.9041561 ,
         1.9325962 ,  1.9468161 ],
       [-1.3397113 , -1.2667192 , -1.2959161 , ...,  1.9041561 ,
         1.8899357 ,  1.8899357 ]], dtype=float32), None, array([[-0.08424664, -0.02585294, -0.4638057 , ...,  0.9229715 ,
         0.9229715 ,  0.7807708 ],
       [ 0.32450938,  0.23691882,  0.25151724, ...,  1.1931527 ,
         1.1931527 ,  0.9229715 ],
       [ 0.41209993,  0.26611567, -0.43460885, ...,  1.036732  ,
         0.6954504 ,  0.48214942],
       ...,
       [-0.15723877,  0.07633615,  0.10553299, ..., -0.8403168 ,
        -0.8403168 , -0.8545369 ],
       [-0.28862458, -0.405412  , -0.39081356, ..., -0.38527465,
        -0.57013553, -0.669676  ],
       [-0.3470183 , -0.2740262 , -0.33241987, ..., -0.57013553,
        -0.96829736, -0.95407724]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 18]]), None, array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People flying a kite in a grassy field by water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A passenger train sitting outside of  the station.\n', 'Find me an everyday image that matches the given caption: A woman with a tennis racket is tying her shoes.\n', 'Find me an everyday image that matches the given caption: A train with people inside is about to go into a tunnel.\n', 'Find me an everyday image that matches the given caption: Display of fruit with apples and bananas together.\n', 'Find me an everyday image that matches the given caption: Big tanker trucks lined up on an icy street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Some people and two elephants in their pen.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A colorful bird sitting on a large rock.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|          | 74/6000 [02:33<3:19:11,  2.02s/it]                                                   {'loss': 2.4899, 'grad_norm': 147.09390258789062, 'learning_rate': 7.4e-06, 'epoch': 0.01}
  1%|          | 74/6000 [02:33<3:19:11,  2.02s/it][2025-11-13 01:33:31,117] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    311,   4669,    624],
        [151643, 151643, 151643,  ...,   2766,   1809,    624],
        [151643, 151643, 151643,  ...,    264,  13425,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    315,  71624,    624],
        [151643, 151643, 151643,  ...,    315,   8592,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A big celebrations deserves a big cake for all to enjoy.\n', 'Find me an everyday image that matches the given caption: A woman and a man play with Wii video game.\n', 'Find me an everyday image that matches the given caption: A man sitting by himself on a bench.\n', 'Find me an everyday image that matches the given caption: A tray of food with hotdogs, fries and onion rings on the table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman leaning against a brick building looking into the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A deep dish pizza sitting on a wooden table.\n', 'Find me an everyday image that matches the given caption: A woman in jeans and a hat holds a brown horse by a bridle and has a white pole in her other hand.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Selfie of a young male and his luggage on a train.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pile of cut hair on top of a comb and pair of scissors.\n', 'Find me an everyday image that matches the given caption: A man sitting under a stop sign on the side of street.\n'], 'images': [[None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DAF80>], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727D9B40>], [None], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727D9E40>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727D83A0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBDF0>], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727DAE30>], [None], [None]], 'pixel_values': [None, None, None, None, array([[ 0.01794233, -0.3470183 , -0.7703726 , ..., -1.3237991 ,
        -1.3522393 , -1.3522393 ],
       [-1.5440893 , -1.5148925 , -1.4710971 , ..., -1.3237991 ,
        -1.3237991 , -1.3237991 ],
       [-1.3689082 , -1.3689082 , -1.3689082 , ..., -1.4233395 ,
        -1.4091195 , -1.4091195 ],
       ...,
       [ 1.0106354 ,  0.67487156,  0.8646511 , ...,  0.7949909 ,
         0.8945313 ,  1.0082918 ],
       [ 1.6675645 ,  1.652966  ,  1.6675645 , ...,  1.1220524 ,
         1.1220524 ,  1.1220524 ],
       [ 1.6091708 ,  1.3318007 ,  1.2442101 , ...,  0.96563166,
         0.88031125,  0.8660912 ]], dtype=float32), None, array([[-0.5367978 , -0.7411758 , -0.68278205, ..., -0.9967375 ,
        -1.0393977 , -1.0962781 ],
       [-0.42001042, -0.55139625, -0.5221994 , ..., -0.5985757 ,
        -0.61279577, -0.71233624],
       [-0.4638057 , -0.5659947 , -0.5805931 , ..., -1.0393977 ,
        -1.082058  , -1.0962781 ],
       ...,
       [-0.6243884 , -0.47840413, -0.28862458, ..., -0.8403168 ,
        -0.8260967 , -0.8545369 ],
       [-0.65358526, -0.68278205, -0.68278205, ..., -1.4802198 ,
        -1.4375596 , -1.0251776 ],
       [-0.9309554 , -0.8579632 , -0.78497106, ..., -1.2384787 ,
        -1.1958185 , -1.2100385 ]], dtype=float32), None, None, array([[ 1.3755959 ,  1.0252337 , -0.08424664, ...,  0.36838892,
         0.51058954,  0.11242763],
       [ 1.1566195 ,  0.25151724,  1.1274228 , ...,  0.52480966,
         0.48214942,  0.48214942],
       [ 0.9814385 , -0.18643562,  1.2588086 , ...,  0.43948925,
         0.11242763, -0.71233624],
       ...,
       [-0.55139625, -0.7411758 , -0.8141679 , ..., -0.14353354,
        -0.17197368, -0.11509342],
       [-0.50760096, -0.405412  , -0.47840413, ..., -1.1958185 ,
        -1.1104981 , -1.1389382 ],
       [-0.43460885, -0.4638057 , -0.5221994 , ..., -1.0393977 ,
        -0.95407724, -1.1247182 ]], dtype=float32), array([[-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4659997],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4659997, -1.4659997,
        -1.4659997],
       ...,
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), array([[ 0.2223204 , -0.04045137,  0.19312355, ...,  0.39682904,
         0.4963695 ,  0.823431  ],
       [ 1.1420212 ,  1.2150133 ,  1.0836275 , ...,  1.3780135 ,
         1.2926931 ,  1.4064537 ],
       [ 1.0690291 ,  0.99603695,  1.098226  , ...,  0.90875137,
         0.6954504 ,  0.68123037],
       ...,
       [ 1.7697535 ,  1.7989503 ,  1.7843518 , ...,  1.9468161 ,
         1.9610363 ,  1.9610363 ],
       [ 1.3755959 ,  1.4193913 ,  1.4339896 , ...,  1.9468161 ,
         1.9610363 ,  1.9468161 ],
       [ 1.5507771 ,  1.6383677 ,  1.6675645 , ...,  1.9610363 ,
         1.9752562 ,  1.9752562 ]], dtype=float32), None, array([[ 0.00334391,  0.00334391,  0.00334391, ..., -0.25729406,
        -0.243074  , -0.243074  ],
       [ 0.03254076,  0.03254076,  0.04713918, ..., -0.20041381,
        -0.20041381, -0.20041381],
       [ 0.03254076,  0.03254076,  0.03254076, ..., -0.22885394,
        -0.21463387, -0.21463387],
       ...,
       [-0.405412  , -0.33241987, -0.36161673, ..., -0.95407724,
        -0.78343654, -0.65545595],
       [-1.3543098 , -1.3835065 , -1.3835065 , ..., -0.95407724,
        -0.9398572 , -0.9398572 ],
       [-1.4419003 , -1.4419003 , -1.4710971 , ..., -1.1531583 ,
        -1.1673783 , -1.1673783 ]], dtype=float32), None, None], 'image_grid_thw': [None, None, None, None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 28, 18]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A big celebrations deserves a big cake for all to enjoy.\n', 'Find me an everyday image that matches the given caption: A woman and a man play with Wii video game.\n', 'Find me an everyday image that matches the given caption: A man sitting by himself on a bench.\n', 'Find me an everyday image that matches the given caption: A tray of food with hotdogs, fries and onion rings on the table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman leaning against a brick building looking into the street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A deep dish pizza sitting on a wooden table.\n', 'Find me an everyday image that matches the given caption: A woman in jeans and a hat holds a brown horse by a bridle and has a white pole in her other hand.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Selfie of a young male and his luggage on a train.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pile of cut hair on top of a comb and pair of scissors.\n', 'Find me an everyday image that matches the given caption: A man sitting under a stop sign on the side of street.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 75/6000 [02:35<3:17:07,  2.00s/it]                                                   {'loss': 2.5689, 'grad_norm': 158.05703735351562, 'learning_rate': 7.500000000000001e-06, 'epoch': 0.01}
  1%|â–         | 75/6000 [02:35<3:17:07,  2.00s/it][2025-11-13 01:33:33,074] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  44015,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person walking through a snowy cross walk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A polaroid-looking photograph of a bespectacled man in a black shirt and white tie.\n', 'Find me an everyday image that matches the given caption: A black train engine parked on snowy tracks.\n', 'Find me an everyday image that matches the given caption: A bird sits perched on a branch near leaves.\n', 'Find me an everyday image that matches the given caption: A young girl siting in the back of a red truck.\n', 'Find me an everyday image that matches the given caption: Food on a grill with people working.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pan full of roasted vegetables on top of a stove.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=340x256 at 0x7F32727DACE0>], [<PIL.Image.Image image mode=RGB size=342x256 at 0x7F32727D9750>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA260>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F3272FAD690>], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272B5F850>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727DA590>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D8400>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DB4F0>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727DA530>]], 'pixel_values': [array([[-1.7922626 , -1.7922626 , -1.6170814 , ..., -1.1958185 ,
        -0.96829736, -0.8545369 ],
       [-1.6608766 , -1.6170814 , -1.6024829 , ..., -1.2242587 ,
        -1.1815984 , -1.1815984 ],
       [ 0.13472985, -0.04045137,  0.19312355, ..., -1.309579  ,
        -1.2242587 , -1.0536178 ],
       ...,
       [-1.5148925 , -1.5440893 , -1.5586877 , ..., -1.2242587 ,
        -1.309579  , -1.3664593 ],
       [-0.88716006, -0.87256163, -0.88716006, ..., -0.6981161 ,
        -0.68389606, -0.68389606],
       [-1.0039475 , -1.018546  , -1.0623412 , ..., -0.61279577,
        -0.669676  , -0.91141707]], dtype=float32), array([[0.85005265, 0.8646511 , 0.89384794, ..., 1.4491138 , 1.4491138 ,
        1.4491138 ],
       [0.99603695, 0.99603695, 1.0252337 , ..., 1.4491138 , 1.4491138 ,
        1.4491138 ],
       [0.8062574 , 0.8062574 , 0.8208558 , ..., 0.8945313 , 0.9514116 ,
        1.0651721 ],
       ...,
       [1.1274228 , 1.1274228 , 1.098226  , ..., 0.4963695 , 0.4963695 ,
        0.4963695 ],
       [1.3026038 , 1.3026038 , 1.3026038 , ..., 0.33994877, 0.35416883,
        0.38260898],
       [1.3318007 , 1.3755959 , 1.4193913 , ..., 0.14086775, 0.11242763,
        0.06976743]], dtype=float32), array([[-0.5659947 , -0.5221994 , -0.49300256, ..., -1.0393977 ,
        -1.4233395 , -1.4091195 ],
       [-1.4564987 , -1.4564987 , -1.398105  , ..., -0.57013553,
        -0.4421549 , -0.4137148 ],
       [-0.12804192, -0.12804192, -0.1718372 , ..., -0.74077636,
        -0.7549964 , -0.8403168 ],
       ...,
       [-1.2813176 , -1.2667192 , -1.1499318 , ..., -1.1104981 ,
        -1.0536178 , -0.9398572 ],
       [-0.7119789 , -0.68278205, -0.78497106, ..., -0.9967375 ,
        -0.95407724, -0.96829736],
       [-1.3543098 , -1.3543098 , -1.1499318 , ..., -1.309579  ,
        -1.4375596 , -1.4091195 ]], dtype=float32), array([[-0.6681836 , -0.6681836 , -0.6681836 , ...,  0.7096705 ,
         0.7096705 ,  0.72389054],
       [-0.5659947 , -0.5659947 , -0.5367978 , ...,  0.6954504 ,
         0.7096705 ,  0.7096705 ],
       [-0.49300256, -0.49300256, -0.50760096, ...,  0.823431  ,
         0.8376511 ,  0.823431  ],
       ...,
       [-0.2740262 , -0.09884507, -0.06964822, ...,  0.9229715 ,
         1.0936122 ,  1.3637935 ],
       [ 0.6310763 ,  0.6310763 ,  0.6018794 , ...,  1.2358129 ,
         1.1504925 ,  1.2358129 ],
       [ 0.71866685,  0.66027313,  0.791659  , ...,  0.80921096,
         1.0509521 ,  0.72389054]], dtype=float32), None, array([[ 0.32450938,  0.77706057,  0.25151724, ..., -0.39949474,
        -0.04399309,  0.22618815],
       [ 0.2223204 ,  0.30991095,  1.171218  , ..., -0.243074  ,
        -0.54169536, -1.0393977 ],
       [ 0.23691882,  0.2807141 ,  0.30991095, ..., -1.0536178 ,
        -1.0109575 , -1.0536178 ],
       ...,
       [ 0.71866685,  0.76246214,  0.9084464 , ...,  0.6670103 ,
         0.6243501 ,  0.59590995],
       [ 0.13472985,  0.0617376 ,  0.20772196, ...,  0.01288717,
         0.1266477 ,  0.22618815],
       [ 0.42669836,  0.54348576,  0.68947   , ...,  0.5816899 ,
         0.7381106 ,  0.823431  ]], dtype=float32), None, None, None, None, None, array([[ 1.8135487 ,  1.8719424 ,  1.8865409 , ..., -0.51325524,
        -0.25729406,  0.28306842],
       [-0.60978997, -0.5805931 , -0.6243884 , ..., -0.20041381,
        -0.14353354,  0.0413273 ],
       [ 1.7697535 ,  1.9011393 ,  1.9303361 , ..., -0.5274753 ,
        -0.4421549 , -0.51325524],
       ...,
       [-0.82876635, -0.8433648 , -0.8433648 , ..., -0.5985757 ,
        -0.61279577, -0.6412359 ],
       [-0.8141679 , -0.7995695 , -0.8141679 , ..., -0.61279577,
        -0.6270158 , -0.65545595],
       [-0.87256163, -0.87256163, -0.8579632 , ..., -0.6412359 ,
        -0.669676  , -0.68389606]], dtype=float32), array([[-0.5221994 , -0.5221994 , -0.5367978 , ..., -1.2953589 ,
        -1.2811389 , -1.2811389 ],
       [-0.6243884 , -0.6389868 , -0.65358526, ..., -1.2526988 ,
        -1.2526988 , -1.2242587 ],
       [-0.24482933, -0.24482933, -0.24482933, ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ],
       ...,
       [-1.5148925 , -1.5440893 , -1.5732862 , ..., -1.1531583 ,
        -1.1389382 , -1.1104981 ],
       [-1.6316798 , -1.6316798 , -1.6316798 , ..., -1.1389382 ,
        -1.1104981 , -1.0962781 ],
       [-1.6024829 , -1.6024829 , -1.6024829 , ..., -1.0109575 ,
        -0.9967375 , -0.9825174 ]], dtype=float32), None, array([[-1.6900735 , -1.704672  , -1.7192703 , ..., -0.8260967 ,
        -0.57013553, -0.32839438],
       [-1.6900735 , -1.7338688 , -1.6462783 , ...,  2.145897  ,
         2.117457  ,  2.0605767 ],
       [-1.704672  , -1.704672  , -1.704672  , ..., -1.3522393 ,
        -1.309579  , -1.2811389 ],
       ...,
       [-0.68278205, -0.65358526, -0.6389868 , ...,  1.6339747 ,
         1.8188357 ,  1.875716  ],
       [-0.87256163, -0.8141679 , -0.7703726 , ...,  1.4064537 ,
         1.6197547 ,  1.8046155 ],
       [-0.3470183 , -0.01125452,  0.33910778, ...,  1.8046155 ,
         1.8188357 ,  1.7903955 ]], dtype=float32), array([[ 1.3901944 ,  1.3901944 ,  1.3755959 , ...,  0.25462827,
         0.24040821,  0.24040821],
       [ 1.5653756 ,  1.5799739 ,  1.5799739 , ...,  0.6670103 ,
         0.80921096,  0.9798517 ],
       [ 1.3609976 ,  1.3609976 ,  1.3463992 , ..., -0.47059506,
        -0.47059506, -0.45637497],
       ...,
       [-1.2959161 , -1.3105145 , -1.3105145 , ..., -0.9825174 ,
        -1.0109575 , -1.0251776 ],
       [-1.3543098 , -1.3689082 , -1.3543098 , ..., -1.1247182 ,
        -1.1389382 , -1.1389382 ],
       [-1.2813176 , -1.3251129 , -1.3251129 , ..., -1.1247182 ,
        -1.1247182 , -1.1389382 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 18]]), None, None, None, None, None, array([[ 1, 18, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 24, 18]]), array([[ 1, 18, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A person walking through a snowy cross walk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A polaroid-looking photograph of a bespectacled man in a black shirt and white tie.\n', 'Find me an everyday image that matches the given caption: A black train engine parked on snowy tracks.\n', 'Find me an everyday image that matches the given caption: A bird sits perched on a branch near leaves.\n', 'Find me an everyday image that matches the given caption: A young girl siting in the back of a red truck.\n', 'Find me an everyday image that matches the given caption: Food on a grill with people working.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pan full of roasted vegetables on top of a stove.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|â–         | 76/6000 [02:37<3:26:33,  2.09s/it]                                                   {'loss': 2.5551, 'grad_norm': 150.46420288085938, 'learning_rate': 7.600000000000001e-06, 'epoch': 0.01}
  1%|â–         | 76/6000 [02:37<3:26:33,  2.09s/it][2025-11-13 01:33:35,381] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,  11174,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   2070,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bunch of cars are jammed together in a street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Bikes lined up at a bike stop with an advertisement near by that says "your butts.\n', 'Find me an everyday image that matches the given caption: A group of people sitting on benches having lunch together at a curbside garden area.\n', 'Find me an everyday image that matches the given caption: A person is holding a large laptop with stickers on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bunch of people on a wet street in the rain.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of young boys playing soccer in a field.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272FAF850>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F520>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F327277CE80>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C6E00>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F32727C7820>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727C4580>], [<PIL.Image.Image image mode=RGB size=342x256 at 0x7F32727C45E0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727C7190>], [<PIL.Image.Image image mode=RGB size=515x256 at 0x7F32727DA470>], [None], [<PIL.Image.Image image mode=RGB size=455x256 at 0x7F32727DBA00>], [None]], 'pixel_values': [array([[-0.36161673, -0.36161673, -0.36161673, ...,  0.31150854,
         0.31150854,  0.3257286 ],
       [-0.25942776, -0.25942776, -0.25942776, ...,  0.4110491 ,
         0.4110491 ,  0.43948925],
       [-0.3470183 , -0.3470183 , -0.3470183 , ...,  0.33994877,
         0.33994877,  0.35416883],
       ...,
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4375596 ,
        -1.4375596 , -1.4517797 ],
       [-1.6754751 , -1.704672  , -1.704672  , ..., -1.2100385 ,
        -1.2242587 , -1.2669188 ],
       [-1.500294  , -1.5586877 , -1.6024829 , ..., -1.4375596 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[ 1.4923834 ,  1.4047928 ,  1.2442101 , ..., -0.05821316,
        -0.08665328, -0.15775362],
       [ 1.3901944 ,  1.4339896 ,  1.5069818 , ..., -0.39949474,
        -0.47059506, -0.48481512],
       [-1.0769397 , -1.0331444 , -1.0039475 , ..., -1.3664593 ,
        -1.3664593 , -1.3522393 ],
       ...,
       [ 1.7551551 ,  1.7551551 ,  1.7551551 , ...,  2.0890167 ,
         2.103237  ,  2.117457  ],
       [-1.398105  , -1.398105  , -1.3835065 , ..., -1.1673783 ,
        -1.1531583 , -1.0962781 ],
       [-0.7995695 , -0.04045137,  1.4193913 , ...,  1.4917741 ,
         0.80921096,  0.4252692 ]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.2953589 ,
        -1.2953589 , -1.2953589 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.309579  ,
        -1.2953589 , -1.2811389 ],
       [-1.7338688 , -1.7484672 , -1.7484672 , ..., -1.2953589 ,
        -1.2953589 , -1.309579  ],
       ...,
       [ 0.49969047,  0.4704936 ,  0.4558952 , ...,  0.19774802,
         0.09820756,  0.05554737],
       [ 0.77706057,  0.68947   ,  0.68947   , ..., -0.89719707,
        -0.81187665, -0.78343654],
       [ 0.3537062 ,  0.36830464,  0.3537062 , ..., -0.27151415,
        -0.22885394, -0.20041381]], dtype=float32), None, array([[ 1.098226  ,  1.098226  ,  1.1128243 , ...,  2.0890167 ,
         2.0890167 ,  2.0890167 ],
       [ 1.1858164 ,  1.2004149 ,  1.171218  , ...,  2.145897  ,
         2.1316772 ,  2.1316772 ],
       [ 0.8792495 ,  0.8792495 ,  0.8646511 , ...,  2.103237  ,
         2.103237  ,  2.103237  ],
       ...,
       [ 0.03254076,  0.0617376 ,  0.10553299, ...,  0.75233066,
         0.6954504 ,  0.5816899 ],
       [-0.08424664, -0.02585294,  0.00334391, ...,  0.43948925,
         0.59590995,  0.61013   ],
       [ 0.0617376 ,  0.0617376 ,  0.01794233, ...,  0.6243501 ,
         0.68123037,  0.6670103 ]], dtype=float32), None, None, None, array([[1.4193913 , 1.4339896 , 1.4485881 , ..., 1.4917741 , 1.4491138 ,
        1.4348938 ],
       [1.3463992 , 1.3755959 , 1.4339896 , ..., 1.6481948 , 1.6339747 ,
        1.6055346 ],
       [1.2150133 , 1.2442101 , 1.2880055 , ..., 1.5770944 , 1.5486543 ,
        1.5344343 ],
       ...,
       [1.0544306 , 1.0106354 , 0.99603695, ..., 1.4491138 , 1.4206737 ,
        1.4206737 ],
       [0.85005265, 0.8208558 , 0.7478637 , ..., 1.463334  , 1.5628744 ,
        1.5202142 ],
       [0.76246214, 0.6018794 , 0.7478637 , ..., 0.96563166, 0.96563166,
        0.96563166]], dtype=float32), array([[-0.6681836 , -0.65358526, -0.6389868 , ..., -0.8260967 ,
        -0.78343654, -0.7692165 ],
       [ 0.0617376 , -0.24482933, -0.6681836 , ..., -0.8260967 ,
        -0.8403168 , -0.7692165 ],
       [-0.94555384, -0.9893491 , -1.0477428 , ..., -0.8260967 ,
        -0.8260967 , -0.8545369 ],
       ...,
       [ 0.49969047,  0.5142889 ,  0.52888733, ...,  0.14086775,
         0.1266477 ,  0.06976743],
       [ 0.33910778,  0.33910778,  0.33910778, ...,  0.11242763,
         0.14086775,  0.26884836],
       [ 0.30991095,  0.30991095,  0.3537062 , ...,  0.05554737,
         0.01288717,  0.0839875 ]], dtype=float32), array([[ 0.5142889 ,  0.4704936 ,  0.5726826 , ..., -0.65545595,
        -0.02977302,  0.36838892],
       [-0.60978997, -0.5659947 , -0.59519154, ..., -0.7265563 ,
        -0.74077636, -0.6981161 ],
       [-0.04045137, -0.44920728, -0.18643562, ..., -0.17197368,
        -0.21463387, -0.51325524],
       ...,
       [-1.500294  , -1.5294908 , -1.5294908 , ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ],
       [-1.2229239 , -1.2375224 , -1.2375224 , ..., -1.3522393 ,
        -1.3806794 , -1.3948994 ],
       [-1.500294  , -1.5294908 , -1.5294908 , ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ]], dtype=float32), array([[ 0.09093457,  0.09093457,  0.10553299, ...,  0.02710724,
         0.0839875 ,  0.1266477 ],
       [-0.04045137, -0.04045137, -0.01125452, ...,  0.25462827,
         0.24040821,  0.24040821],
       [ 0.13472985,  0.13472985,  0.16392669, ..., -0.00133289,
        -0.00133289,  0.0413273 ],
       ...,
       [-0.36161673, -0.3470183 , -0.33241987, ..., -1.1389382 ,
        -1.1389382 , -1.0962781 ],
       [-0.37621516, -0.37621516, -0.36161673, ..., -1.0536178 ,
        -1.0393977 , -1.0393977 ],
       [-0.39081356, -0.42001042, -0.43460885, ..., -1.2100385 ,
        -1.2384787 , -1.1247182 ]], dtype=float32), array([[ 1.2296118 ,  1.2588086 ,  1.2880055 , ...,  1.3069133 ,
         1.2926931 ,  1.3069133 ],
       [ 1.2296118 ,  1.2296118 ,  1.2880055 , ...,  1.3637935 ,
         1.3922336 ,  1.4206737 ],
       [ 1.1274228 ,  1.1274228 ,  1.1274228 , ...,  1.4348938 ,
         1.4064537 ,  1.3780135 ],
       ...,
       [ 0.04713918,  0.29531252,  0.0617376 , ..., -0.27151415,
        -0.35683453, -0.17197368],
       [-0.04045137,  0.68947   ,  1.098226  , ..., -0.42793486,
        -0.5559154 , -0.74077636],
       [ 0.10553299,  0.29531252,  0.66027313, ..., -0.51325524,
        -0.74077636, -0.74077636]], dtype=float32), None, array([[-0.36161673, -0.3470183 , -0.3470183 , ...,  0.4537093 ,
         0.4537093 ,  0.46792936],
       [-0.28862458, -0.2740262 , -0.24482933, ..., -0.882977  ,
        -0.8545369 , -0.86875695],
       [-0.37621516, -0.37621516, -0.37621516, ...,  0.39682904,
         0.39682904,  0.4110491 ],
       ...,
       [ 0.29531252,  0.48509204,  0.8354542 , ...,  0.18352796,
        -0.12931348, -0.4421549 ],
       [-1.2229239 , -1.2083255 , -1.1791286 , ..., -0.54169536,
        -0.669676  , -0.58435565],
       [-1.0477428 , -1.1353334 , -1.1791286 , ..., -1.0109575 ,
        -0.95407724, -0.882977  ]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, array([[ 1, 28, 18]]), None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 36]]), None, array([[ 1, 18, 32]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bunch of cars are jammed together in a street.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Bikes lined up at a bike stop with an advertisement near by that says "your butts.\n', 'Find me an everyday image that matches the given caption: A group of people sitting on benches having lunch together at a curbside garden area.\n', 'Find me an everyday image that matches the given caption: A person is holding a large laptop with stickers on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bunch of people on a wet street in the rain.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of young boys playing soccer in a field.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 77/6000 [02:39<3:22:14,  2.05s/it]                                                   {'loss': 2.8349, 'grad_norm': 144.95556640625, 'learning_rate': 7.7e-06, 'epoch': 0.01}
  1%|â–         | 77/6000 [02:39<3:22:14,  2.05s/it][2025-11-13 01:33:37,327] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,  44015,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    419,  14852,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A woman is scooping food in a pan on the stove.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Girl is setting up a camera to film herself in bed.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large clock on the side of a building.\n', 'Find me an everyday image that matches the given caption: The baby sheep are all in the pen.\n', 'Find me an everyday image that matches the given caption: A person in a field with a baseball and a glove.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A wooden bench sits in the middle of a forest.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People are at an outside market selling bananas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a urinal in the ground in this bathroom.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727D93C0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727D8E50>], [None], [<PIL.Image.Image image mode=RGB size=712x256 at 0x7F32727DB490>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x342 at 0x7F32727DBD30>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9D50>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBDC0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8550>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DBE20>]], 'pixel_values': [None, array([[-0.12804192, -0.303223  , -0.55139625, ..., -0.669676  ,
        -0.49903518, -0.57013553],
       [-0.15723877, -0.37621516, -0.18643562, ..., -0.6981161 ,
        -0.8545369 , -0.9398572 ],
       [-1.1645303 , -1.0915381 , -0.7995695 , ..., -0.5559154 ,
        -0.5559154 , -0.81187665],
       ...,
       [ 1.4339896 ,  1.3755959 ,  1.273407  , ..., -0.7265563 ,
        -0.669676  , -0.5559154 ],
       [ 1.4923834 ,  1.4339896 ,  1.4631865 , ...,  0.4537093 ,
         0.4963695 ,  0.38260898],
       [ 0.30991095,  0.41209993,  0.5580842 , ...,  0.46792936,
         0.24040821,  0.36838892]], dtype=float32), array([[ 1.4339896 ,  1.4339896 ,  1.4339896 , ...,  1.7903955 ,
         1.7903955 ,  0.59590995],
       [ 1.4339896 ,  1.4485881 ,  1.477785  , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       [ 1.4485881 ,  1.4485881 ,  1.4485881 , ...,  1.2215928 ,
         0.33994877,  0.7381106 ],
       ...,
       [-0.9017585 , -0.88716006, -0.82876635, ..., -0.95407724,
        -1.0536178 , -1.3522393 ],
       [-1.7484672 , -1.7630657 , -1.7776641 , ..., -0.9825174 ,
        -0.9967375 , -1.0109575 ],
       [-0.82876635, -0.78497106, -0.6681836 , ..., -0.7692165 ,
        -0.8545369 , -1.1389382 ]], dtype=float32), None, array([[ 1.2588086 ,  1.2004149 ,  1.171218  , ...,  0.51058954,
         0.3257286 ,  0.14086775],
       [ 1.2588086 ,  1.3318007 ,  1.4047928 , ..., -0.05821316,
        -0.05821316, -0.08665328],
       [-0.15723877, -0.01125452, -0.04045137, ..., -0.8403168 ,
        -0.8260967 , -0.81187665],
       ...,
       [-1.5294908 , -1.5294908 , -1.5294908 , ..., -1.2669188 ,
        -1.2811389 , -1.2384787 ],
       [-1.6462783 , -1.6462783 , -1.6170814 , ..., -1.3664593 ,
        -1.4517797 , -1.4517797 ],
       [-1.5878845 , -1.6170814 , -1.6170814 , ..., -1.3237991 ,
        -1.3237991 , -1.3948994 ]], dtype=float32), None, None, None, array([[-1.7922626 , -1.7776641 , -1.7484672 , ..., -1.0962781 ,
        -1.082058  , -1.0962781 ],
       [-1.4273019 , -1.193727  , -1.2521207 , ...,  0.09820756,
        -0.20041381, -0.51325524],
       [-1.6900735 , -1.6900735 , -1.7192703 , ..., -1.2242587 ,
        -1.3522393 , -1.309579  ],
       ...,
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ]], dtype=float32), None, array([[-0.5221994 , -0.50760096, -0.47840413, ..., -0.65545595,
        -0.6412359 , -0.6412359 ],
       [-0.2740262 , -0.25942776, -0.21563247, ..., -0.669676  ,
        -0.669676  , -0.65545595],
       [-0.59519154, -0.5805931 , -0.5805931 , ..., -0.17197368,
        -0.15775362, -0.14353354],
       ...,
       [-1.5586877 , -1.6608766 , -1.7630657 , ..., -1.3522393 ,
        -1.3664593 , -1.3806794 ],
       [-1.7338688 , -1.7630657 , -1.7776641 , ..., -1.082058  ,
        -1.2384787 , -1.3664593 ],
       [-1.7630657 , -1.704672  , -1.7338688 , ..., -1.082058  ,
        -0.91141707, -0.71233624]], dtype=float32), array([[-1.5148925 , -1.500294  , -1.4856956 , ..., -1.0109575 ,
        -1.0109575 , -0.9967375 ],
       [-1.4273019 , -1.4127034 , -1.4273019 , ..., -0.89719707,
        -0.89719707, -0.91141707],
       [-1.500294  , -1.500294  , -1.500294  , ..., -1.0251776 ,
        -1.0251776 , -1.0251776 ],
       ...,
       [-0.02585294,  0.01794233,  0.04713918, ...,  0.7949909 ,
         0.75233066,  0.7807708 ],
       [-0.47840413, -0.39081356, -0.3470183 , ...,  0.24040821,
         0.16930789,  0.22618815],
       [-0.20103405, -0.39081356, -0.33241987, ...,  0.22618815,
         0.29728848,  0.36838892]], dtype=float32), None, array([[ 0.03254076, -0.11344349, -0.0550498 , ..., -0.48481512,
        -0.05821316,  0.21196808],
       [-0.1718372 ,  0.8062574 ,  1.3901944 , ...,  0.18352796,
         0.52480966,  0.88031125],
       [ 1.0690291 ,  1.0690291 ,  0.5580842 , ..., -0.54169536,
        -0.61279577, -0.7265563 ],
       ...,
       [-0.37621516, -0.6243884 , -0.94555384, ..., -1.0109575 ,
        -1.0109575 , -0.9967375 ],
       [-0.49300256, -0.47840413, -0.6243884 , ..., -0.65545595,
        -1.0393977 , -1.1673783 ],
       [-1.0331444 , -1.0915381 , -1.018546  , ..., -0.57013553,
        -0.8403168 , -0.96829736]], dtype=float32), None, array([[ 0.3537062 ,  0.36830464,  0.3975015 , ..., -0.54169536,
        -0.5274753 , -0.48481512],
       [ 0.44129676,  0.41209993,  0.29531252, ..., -0.42793486,
        -0.4421549 , -0.45637497],
       [ 0.32450938,  0.36830464,  0.41209993, ..., -0.51325524,
        -0.48481512, -0.51325524],
       ...,
       [ 1.0106354 ,  0.95224166,  0.85005265, ..., -0.05821316,
         0.02710724,  0.06976743],
       [ 1.0544306 ,  0.9668401 ,  0.8208558 , ...,  0.09820756,
         0.09820756,  0.06976743],
       [ 0.7040684 ,  0.67487156,  0.66027313, ..., -0.243074  ,
        -0.25729406, -0.11509342]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 50]]), None, None, None, array([[ 1, 24, 18]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A woman is scooping food in a pan on the stove.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Girl is setting up a camera to film herself in bed.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A large clock on the side of a building.\n', 'Find me an everyday image that matches the given caption: The baby sheep are all in the pen.\n', 'Find me an everyday image that matches the given caption: A person in a field with a baseball and a glove.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A wooden bench sits in the middle of a forest.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: People are at an outside market selling bananas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a urinal in the ground in this bathroom.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|â–         | 78/6000 [02:41<3:27:32,  2.10s/it]                                                   {'loss': 2.2964, 'grad_norm': 208.78781127929688, 'learning_rate': 7.800000000000002e-06, 'epoch': 0.01}
  1%|â–         | 78/6000 [02:41<3:27:32,  2.10s/it][2025-11-13 01:33:39,559] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   9442,   3100,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  12060,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of cars traveling near a street traffic light.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two black bears standing next to each other at a zoo.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A red train on a track passing a building.\n', 'Find me an everyday image that matches the given caption: A number of items with a cell phone an i pod and headphones.\n', 'Find me an everyday image that matches the given caption: A clean kitchen filled with decor and kitchen furniture.\n', 'Find me an everyday image that matches the given caption: A pink rose that has been carefully placed in the toilet bowl as though it were a vase.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of three giraffe standing next to each other on a grass field.\n', 'Find me an everyday image that matches the given caption: A guy on a surfboard is riding a wave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x386 at 0x7F32727D9B10>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D8730>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8040>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9B70>], [<PIL.Image.Image image mode=RGB size=256x430 at 0x7F32727DB520>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA740>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DB010>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727DB9D0>]], 'pixel_values': [array([[-1.6170814 , -1.6170814 , -1.6170814 , ..., -1.1958185 ,
        -1.1958185 , -1.1815984 ],
       [-1.6170814 , -1.6170814 , -1.6170814 , ..., -1.1815984 ,
        -1.1815984 , -1.1815984 ],
       [-1.5878845 , -1.5878845 , -1.5878845 , ..., -1.1673783 ,
        -1.1673783 , -1.1531583 ],
       ...,
       [-0.88716006, -0.9163569 , -0.9017585 , ..., -0.71233624,
        -0.7265563 , -0.74077636],
       [-1.1499318 , -1.2375224 , -1.1645303 , ..., -0.8403168 ,
        -0.7692165 , -0.74077636],
       [-1.0039475 , -1.0477428 , -1.1499318 , ..., -0.8545369 ,
        -0.8403168 , -0.8403168 ]], dtype=float32), array([[0.8354542 , 1.4485881 , 1.4923834 , ..., 1.3495734 , 1.3922336 ,
        1.3637935 ],
       [1.5361787 , 1.6967614 , 1.8281472 , ..., 1.1504925 , 1.1220524 ,
        1.2926931 ],
       [1.171218  , 1.5361787 , 1.3318007 , ..., 1.3069133 , 1.5486543 ,
        1.3922336 ],
       ...,
       [0.25151724, 0.17852512, 0.2223204 , ..., 0.28306842, 0.25462827,
        0.21196808],
       [0.5142889 , 0.49969047, 0.4704936 , ..., 0.19774802, 0.19774802,
        0.1266477 ],
       [0.30991095, 0.30991095, 0.29531252, ..., 0.15508783, 0.15508783,
        0.14086775]], dtype=float32), None, array([[ 1.8427455 ,  1.8427455 ,  1.857344  , ...,  2.0605767 ,
         2.0605767 ,  2.0605767 ],
       [ 1.9011393 ,  1.8865409 ,  1.857344  , ...,  2.103237  ,
         2.117457  ,  2.1316772 ],
       [ 1.8281472 ,  1.8281472 ,  1.8427455 , ...,  2.0321364 ,
         2.0321364 ,  2.0179167 ],
       ...,
       [ 0.68947   ,  0.67487156,  0.6456747 , ..., -0.01555296,
         0.0413273 ,  0.09820756],
       [ 0.13472985,  0.3975015 ,  0.6018794 , ...,  0.02710724,
        -0.07243322, -0.07243322],
       [ 0.2807141 ,  0.3537062 ,  0.26611567, ..., -0.08665328,
        -0.08665328, -0.04399309]], dtype=float32), None, array([[-0.01125452, -0.24482933, -0.04045137, ...,  0.88031125,
         0.72389054,  0.93719155],
       [-0.02585294, -0.09884507, -0.06964822, ...,  0.88031125,
         0.8660912 ,  0.96563166],
       [ 0.03254076,  0.32450938,  0.0617376 , ...,  1.0509521 ,
         1.0651721 ,  0.93719155],
       ...,
       [-1.6462783 , -1.5878845 , -1.5732862 , ..., -0.71233624,
        -0.7265563 , -0.669676  ],
       [-1.6316798 , -1.6170814 , -1.6170814 , ..., -0.6412359 ,
        -0.68389606, -0.74077636],
       [-1.5732862 , -1.5878845 , -1.6316798 , ..., -0.6270158 ,
        -0.65545595, -0.6412359 ]], dtype=float32), array([[-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.243074  ,
        -0.243074  , -0.243074  ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.21463387,
        -0.21463387, -0.21463387],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.22885394,
        -0.22885394, -0.22885394],
       ...,
       [ 1.3172023 ,  1.3463992 ,  1.4047928 , ...,  1.690855  ,
         1.705075  ,  1.705075  ],
       [ 1.4047928 ,  1.4047928 ,  1.3755959 , ...,  1.5770944 ,
         1.6624149 ,  1.6624149 ],
       [ 1.3609976 ,  1.3318007 ,  1.3026038 , ...,  1.705075  ,
         1.690855  ,  1.690855  ]], dtype=float32), None, None, None, None, array([[-1.6462783, -1.6462783, -1.6462783, ..., -1.3522393, -1.3522393,
        -1.3522393],
       [-1.6462783, -1.6462783, -1.6316798, ..., -1.3380191, -1.3380191,
        -1.3380191],
       [-1.5148925, -1.5148925, -1.5148925, ..., -1.309579 , -1.309579 ,
        -1.309579 ],
       ...,
       [-1.4856956, -1.4710971, -1.5148925, ..., -1.2669188, -1.2669188,
        -1.2526988],
       [-1.2813176, -1.2083255, -1.2521207, ..., -1.2526988, -1.2953589,
        -1.309579 ],
       [-1.4710971, -1.5148925, -1.5294908, ..., -1.3380191, -1.3237991,
        -1.3237991]], dtype=float32), None, None, array([[-0.7703726 , -0.7557742 , -0.72657734, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-0.82876635, -0.82876635, -0.96015227, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.6462783 , -1.6462783 , -1.6462783 , ..., -1.4375596 ,
        -1.4375596 , -1.4659997 ],
       ...,
       [-0.7703726 , -0.7411758 , -0.7411758 , ..., -1.4659997 ,
        -1.4802198 , -1.4802198 ],
       [-0.65358526, -0.65358526, -0.65358526, ..., -1.309579  ,
        -1.3522393 , -1.3522393 ],
       [-0.6243884 , -0.60978997, -0.60978997, ..., -1.067838  ,
        -1.067838  , -1.067838  ]], dtype=float32), array([[ 1.273407  ,  1.273407  ,  1.2880055 , ...,  1.690855  ,
         1.690855  ,  1.690855  ],
       [ 1.4485881 ,  1.4485881 ,  1.4631865 , ...,  1.690855  ,
         1.690855  ,  1.690855  ],
       [ 1.3901944 ,  1.3901944 ,  1.3901944 , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       ...,
       [-0.4638057 , -0.303223  , -0.14264035, ..., -0.39949474,
        -0.49903518, -0.48481512],
       [-0.44920728, -0.4638057 , -0.28862458, ...,  0.3257286 ,
         0.28306842,  0.11242763],
       [-0.5367978 , -0.6681836 , -0.72657734, ..., -0.22885394,
        -0.11509342,  0.15508783]], dtype=float32)], 'image_grid_thw': [array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), array([[ 1, 30, 18]]), None, None, None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A couple of cars traveling near a street traffic light.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two black bears standing next to each other at a zoo.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A red train on a track passing a building.\n', 'Find me an everyday image that matches the given caption: A number of items with a cell phone an i pod and headphones.\n', 'Find me an everyday image that matches the given caption: A clean kitchen filled with decor and kitchen furniture.\n', 'Find me an everyday image that matches the given caption: A pink rose that has been carefully placed in the toilet bowl as though it were a vase.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of three giraffe standing next to each other on a grass field.\n', 'Find me an everyday image that matches the given caption: A guy on a surfboard is riding a wave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  1%|â–         | 79/6000 [02:43<3:24:31,  2.07s/it]                                                   {'loss': 2.2356, 'grad_norm': 138.03665161132812, 'learning_rate': 7.9e-06, 'epoch': 0.01}
  1%|â–         | 79/6000 [02:43<3:24:31,  2.07s/it][2025-11-13 01:33:41,571] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  60011,   3786,    624],
        [151643, 151643, 151643,  ...,    264,  87849,    624],
        [151643, 151643, 151643,  ...,    700,   3108,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two uniformed baseball players in positions at a base.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: An elephant scratching it's neck on a post.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Several people on skis on a slalom course.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: It looks like they are putting something in jars together.\n', 'Find me an everyday image that matches the given caption: A black and white cat is laying in a suitcase.\n', 'Find me an everyday image that matches the given caption: A train passing a train station with cars parked out side.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x311 at 0x7F32727D9960>], [<PIL.Image.Image image mode=RGB size=340x256 at 0x7F32727D9720>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D8B20>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727D9390>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8B80>], [None], [<PIL.Image.Image image mode=RGB size=256x320 at 0x7F32727D8BB0>], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727D8070>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8AC0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8C10>], [<PIL.Image.Image image mode=RGB size=343x256 at 0x7F32727D8130>], [None], [None], [None]], 'pixel_values': [array([[ 1.4923834 ,  1.4923834 ,  1.4923834 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.5215802 ,  1.5215802 ,  1.5215802 , ...,  2.0890167 ,
         2.0605767 ,  2.0321364 ],
       [ 1.7697535 ,  1.7697535 ,  1.7697535 , ...,  1.9610363 ,
         1.9752562 ,  1.9894764 ],
       ...,
       [-1.2083255 , -1.1791286 , -1.2083255 , ...,  0.15508783,
         0.18352796,  0.16930789],
       [ 0.44129676,  0.42669836,  0.41209993, ..., -0.9967375 ,
        -0.96829736, -0.95407724],
       [ 0.04713918,  0.01794233, -0.01125452, ..., -0.27151415,
        -0.32839438, -0.38527465]], dtype=float32), array([[-0.7119789 , -0.7119789 , -0.7119789 , ..., -1.1389382 ,
        -1.1389382 , -1.1389382 ],
       [-0.6973805 , -0.6681836 , -0.60978997, ..., -1.2100385 ,
        -1.2242587 , -1.2100385 ],
       [-0.60978997, -0.60978997, -0.60978997, ..., -1.1673783 ,
        -1.1673783 , -1.1673783 ],
       ...,
       [-1.7484672 , -1.7484672 , -1.7192703 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.6462783 , -1.6608766 , -1.6754751 , ..., -1.3522393 ,
        -1.4233395 , -1.3948994 ],
       [-1.6900735 , -1.6754751 , -1.6608766 , ..., -1.3806794 ,
        -1.3806794 , -1.3948994 ]], dtype=float32), array([[-0.8141679 , -0.8141679 , -0.8141679 , ..., -0.12931348,
        -0.11509342, -0.10087335],
       [-0.7995695 , -0.7995695 , -0.7557742 , ...,  0.09820756,
         0.09820756,  0.1266477 ],
       [-0.82876635, -0.82876635, -0.8141679 , ..., -0.07243322,
        -0.05821316, -0.04399309],
       ...,
       [-1.1207349 , -1.1353334 , -1.2521207 , ..., -0.5985757 ,
        -0.7265563 , -0.78343654],
       [-1.0331444 , -1.0477428 , -1.0769397 , ..., -1.0393977 ,
        -1.0251776 , -1.0393977 ],
       [-1.018546  , -0.9893491 , -0.9893491 , ..., -1.1958185 ,
        -1.2100385 , -1.2100385 ]], dtype=float32), array([[-1.1207349 , -1.0915381 , -1.0477428 , ..., -1.2526988 ,
        -1.1958185 , -1.1247182 ],
       [-1.1645303 , -1.1645303 , -1.1061366 , ..., -0.8403168 ,
        -0.58435565, -0.4421549 ],
       [-1.398105  , -1.4127034 , -1.4273019 , ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ],
       ...,
       [ 0.13472985,  0.3975015 ,  0.4704936 , ..., -1.3380191 ,
        -1.3237991 , -1.3237991 ],
       [-1.4273019 , -1.4419003 , -1.4419003 , ..., -1.2953589 ,
        -1.2953589 , -1.2953589 ],
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.3237991 ,
        -1.3522393 , -1.3664593 ]], dtype=float32), array([[1.1128243 , 1.1128243 , 1.1128243 , ..., 1.6624149 , 1.6766349 ,
        1.6766349 ],
       [1.1420212 , 1.1420212 , 1.1566195 , ..., 1.6766349 , 1.6766349 ,
        1.6766349 ],
       [1.2442101 , 1.2442101 , 1.2442101 , ..., 1.6481948 , 1.6481948 ,
        1.6481948 ],
       ...,
       [0.2807141 , 0.23691882, 0.16392669, ..., 0.43948925, 0.38260898,
        0.35416883],
       [0.33910778, 0.36830464, 0.3975015 , ..., 0.5390297 , 0.51058954,
        0.4963695 ],
       [0.23691882, 0.17852512, 0.14932826, ..., 0.38260898, 0.4110491 ,
        0.43948925]], dtype=float32), None, array([[-1.7192703 , -1.6608766 , -1.5586877 , ..., -0.47059506,
        -0.5559154 , -0.57013553],
       [-1.5440893 , -1.4856956 , -1.5586877 , ...,  0.22618815,
         0.1266477 ,  0.09820756],
       [-1.3689082 , -1.3689082 , -1.3689082 , ..., -0.08665328,
        -0.12931348, -0.02977302],
       ...,
       [ 1.6237692 ,  1.5945723 ,  1.5945723 , ...,  1.9894764 ,
         2.0321364 ,  2.0463567 ],
       [ 1.2296118 ,  1.2150133 ,  1.2004149 , ...,  1.7903955 ,
         1.7477353 ,  1.7761754 ],
       [ 1.5799739 ,  1.5945723 ,  1.652966  , ...,  1.7619553 ,
         1.7335151 ,  1.705075  ]], dtype=float32), None, array([[-1.6024829 , -1.5878845 , -1.5732862 , ..., -1.2811389 ,
        -1.2953589 , -1.2811389 ],
       [-1.2083255 , -1.1645303 , -1.1499318 , ..., -1.0962781 ,
        -1.1958185 , -1.2811389 ],
       [-1.7192703 , -1.704672  , -1.6900735 , ..., -1.2811389 ,
        -1.2811389 , -1.2242587 ],
       ...,
       [-1.5440893 , -1.5440893 , -1.5294908 , ..., -1.0251776 ,
        -1.0536178 , -1.082058  ],
       [-1.5732862 , -1.5732862 , -1.5586877 , ..., -1.2242587 ,
        -1.3237991 , -1.3806794 ],
       [-1.5586877 , -1.5440893 , -1.5148925 , ..., -0.7265563 ,
        -0.71233624, -0.71233624]], dtype=float32), array([[-0.49300256, -0.49300256, -0.47840413, ...,  0.19774802,
         0.21196808,  0.21196808],
       [-0.3470183 , -0.3470183 , -0.36161673, ...,  0.25462827,
         0.25462827,  0.25462827],
       [-0.37621516, -0.37621516, -0.36161673, ...,  1.036732  ,
         1.2500329 ,  1.4064537 ],
       ...,
       [-0.37621516, -0.3470183 , -0.36161673, ...,  0.02710724,
         0.02710724,  0.02710724],
       [-0.37621516, -0.37621516, -0.37621516, ...,  0.05554737,
         0.0413273 ,  0.0413273 ],
       [-0.42001042, -0.43460885, -0.44920728, ..., -0.08665328,
        -0.08665328, -0.08665328]], dtype=float32), None, array([[-1.5440893 , -1.4127034 , -1.398105  , ..., -1.4659997 ,
        -1.4659997 , -1.4517797 ],
       [-1.2959161 , -1.1791286 , -0.88716006, ..., -1.4517797 ,
        -1.4091195 , -1.2953589 ],
       [-1.704672  , -1.704672  , -1.6900735 , ..., -0.8545369 ,
        -0.7549964 , -0.5274753 ],
       ...,
       [ 0.7040684 ,  0.7478637 ,  0.71866685, ...,  1.3922336 ,
         1.3922336 ,  1.4064537 ],
       [ 1.1858164 ,  1.2004149 ,  1.1858164 , ...,  1.463334  ,
         1.4491138 ,  1.4206737 ],
       [ 0.8208558 ,  0.77706057,  0.76246214, ...,  1.0651721 ,
         1.0509521 ,  1.036732  ]], dtype=float32), array([[-1.7630657 , -1.7776641 , -1.7922626 , ..., -1.2811389 ,
        -1.2811389 , -1.2811389 ],
       [-1.4856956 , -1.4856956 , -1.500294  , ..., -1.2526988 ,
        -1.2669188 , -1.2669188 ],
       [-1.7922626 , -1.7484672 , -1.7630657 , ..., -1.2811389 ,
        -1.2811389 , -1.2669188 ],
       ...,
       [ 0.04713918,  0.17852512,  0.36830464, ...,  0.6243501 ,
         0.18352796, -0.49903518],
       [ 0.6018794 ,  0.66027313,  0.5580842 , ..., -0.6270158 ,
        -0.6412359 , -0.61279577],
       [ 0.6018794 ,  0.38290307,  0.23691882, ..., -0.35683453,
        -0.39949474, -0.2857342 ]], dtype=float32), None, None, None], 'image_grid_thw': [array([[ 1, 22, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 22, 18]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two uniformed baseball players in positions at a base.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: An elephant scratching it's neck on a post.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Several people on skis on a slalom course.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: It looks like they are putting something in jars together.\n', 'Find me an everyday image that matches the given caption: A black and white cat is laying in a suitcase.\n', 'Find me an everyday image that matches the given caption: A train passing a train station with cars parked out side.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 80/6000 [02:45<3:22:30,  2.05s/it]                                                   {'loss': 2.3153, 'grad_norm': 156.2135772705078, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.01}
  1%|â–         | 80/6000 [02:45<3:22:30,  2.05s/it][2025-11-13 01:33:43,566] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  20638,  18495,    624],
        [151643, 151643, 151643,  ...,    315,   8991,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Woman using her phone standing under an umbrella on the sidewalk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two older type Amtrak cars sitting on tracks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A fresh carnation in a vase sits alongside a computer.\n', 'Find me an everyday image that matches the given caption: A man is standing on a baseball field in action.\n', 'Find me an everyday image that matches the given caption: A brown teddy bear in striped shirt on its back.\n', 'Find me an everyday image that matches the given caption: A cat looking out of the passenger window in a vehicle.\n', 'Find me an everyday image that matches the given caption: A woman looking at her phone while sitting at a table with four laptop computers.\n', 'Find me an everyday image that matches the given caption: The shower stall sliding doors are made of glass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=320x256 at 0x7F32727DA800>], [<PIL.Image.Image image mode=RGB size=387x256 at 0x7F32727C44C0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C45E0>], [None], [<PIL.Image.Image image mode=RGB size=301x256 at 0x7F32727D8580>], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727C7CD0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C6E00>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C56C0>], [None], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=391x256 at 0x7F32727C4C40>]], 'pixel_values': [array([[-0.33241987, -0.08424664, -0.06964822, ...,  0.31150854,
        -0.01555296, -0.02977302],
       [-0.303223  , -0.405412  , -0.37621516, ..., -0.14353354,
        -0.243074  , -0.11509342],
       [-0.06964822, -0.20103405,  0.19312355, ...,  0.09820756,
         0.0413273 ,  0.05554737],
       ...,
       [ 0.14932826,  0.19312355,  0.23691882, ...,  0.6670103 ,
         0.6527902 ,  0.6527902 ],
       [ 0.54348576,  0.49969047,  0.48509204, ...,  0.6954504 ,
         0.5816899 ,  0.4537093 ],
       [ 0.67487156,  0.6456747 ,  0.6310763 , ...,  0.6243501 ,
         0.6670103 ,  0.56746984]], dtype=float32), array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       ...,
       [-0.5221994 , -0.47840413, -0.47840413, ..., -0.21463387,
        -0.22885394, -0.243074  ],
       [-0.44920728, -0.50760096, -0.49300256, ..., -0.35683453,
        -0.34261447, -0.32839438],
       [-0.50760096, -0.50760096, -0.49300256, ..., -0.31417432,
        -0.31417432, -0.32839438]], dtype=float32), array([[ 1.1420212 ,  1.1420212 ,  1.1274228 , ...,  1.463334  ,
         1.5202142 ,  1.5344343 ],
       [ 1.2004149 ,  1.2296118 ,  1.2150133 , ...,  1.5486543 ,
         1.5770944 ,  1.5913146 ],
       [ 0.36830464,  0.42669836,  0.52888733, ...,  0.28306842,
         0.33994877,  0.38260898],
       ...,
       [ 0.3975015 ,  0.44129676,  0.26611567, ..., -0.8545369 ,
        -0.882977  , -0.9256371 ],
       [-0.9893491 , -0.405412  , -0.0550498 , ..., -0.9398572 ,
        -0.8260967 , -0.9256371 ],
       [ 0.09093457,  0.12013142,  0.14932826, ..., -0.34261447,
        -0.5559154 , -0.57013553]], dtype=float32), None, array([[1.5945723 , 1.5945723 , 1.5945723 , ..., 2.117457  , 2.117457  ,
        2.1316772 ],
       [1.652966  , 1.652966  , 1.6821629 , ..., 2.103237  , 2.117457  ,
        2.117457  ],
       [1.5653756 , 1.5799739 , 1.5799739 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       ...,
       [1.6383677 , 1.5945723 , 1.5799739 , ..., 1.3211333 , 1.3211333 ,
        1.3211333 ],
       [0.8792495 , 0.93764323, 1.0106354 , ..., 1.2358129 , 1.2358129 ,
        1.2073728 ],
       [1.1274228 , 1.1566195 , 1.1274228 , ..., 1.1647125 , 1.1504925 ,
        1.1504925 ]], dtype=float32), None, array([[1.6091708, 1.6091708, 1.6091708, ..., 1.918376 , 1.918376 ,
        1.918376 ],
       [1.6091708, 1.6091708, 1.6383677, ..., 1.4491138, 1.7619553,
        1.8614956],
       [1.6237692, 1.6237692, 1.6237692, ..., 1.9325962, 1.9325962,
        1.9325962],
       ...,
       [1.7113597, 1.7113597, 1.7113597, ..., 1.9041561, 1.9041561,
        1.918376 ],
       [1.7405566, 1.7405566, 1.7259582, ..., 1.9041561, 1.8899357,
        1.875716 ],
       [1.7113597, 1.7113597, 1.6967614, ..., 1.8899357, 1.8899357,
        1.875716 ]], dtype=float32), array([[-0.7557742 , -0.88716006, -0.9893491 , ...,  0.52480966,
         0.4110491 ,  0.25462827],
       [-1.4856956 , -1.500294  , -1.500294  , ...,  0.68123037,
         0.6954504 ,  0.7665507 ],
       [-0.33241987, -0.31782144, -0.33241987, ...,  0.56746984,
         0.56746984,  0.6243501 ],
       ...,
       [-0.7119789 , -0.68278205, -0.65358526, ..., -0.95407724,
        -0.9967375 , -0.9967375 ],
       [-0.78497106, -0.7995695 , -0.8433648 , ..., -1.1958185 ,
        -1.1815984 , -1.1104981 ],
       [-0.82876635, -0.82876635, -0.8433648 , ..., -1.0109575 ,
        -1.0536178 , -1.067838  ]], dtype=float32), array([[-1.2521207 , -1.2521207 , -1.2521207 , ..., -0.48481512,
        -0.48481512, -0.49903518],
       [-1.3251129 , -1.3251129 , -1.3397113 , ..., -0.42793486,
        -0.42793486, -0.42793486],
       [-1.2667192 , -1.2667192 , -1.2667192 , ..., -0.45637497,
        -0.45637497, -0.47059506],
       ...,
       [-0.303223  , -0.3470183 , -0.37621516, ..., -0.81187665,
        -0.8260967 , -0.7692165 ],
       [-0.5367978 , -0.5367978 , -0.55139625, ..., -0.57013553,
        -0.5985757 , -0.5559154 ],
       [-0.49300256, -0.50760096, -0.49300256, ..., -0.5985757 ,
        -0.669676  , -0.669676  ]], dtype=float32), None, None, None, None, None, None, array([[-0.94555384, -0.94555384, -0.9309554 , ..., -1.4517797 ,
        -1.4517797 , -1.4659997 ],
       [-0.8579632 , -0.87256163, -0.9309554 , ..., -1.4375596 ,
        -1.4091195 , -1.4375596 ],
       [ 0.4704936 , -0.68278205, -1.4710971 , ..., -0.7265563 ,
        -0.78343654, -1.2953589 ],
       ...,
       [-1.3835065 , -1.398105  , -1.4127034 , ..., -1.4659997 ,
        -1.4517797 , -1.4517797 ],
       [-1.3835065 , -1.4273019 , -1.4564987 , ..., -1.4802198 ,
        -1.4802198 , -1.4375596 ],
       [-1.4273019 , -1.4273019 , -1.4273019 , ..., -1.4091195 ,
        -1.3948994 , -1.3948994 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 22]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 22]]), None, array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), None, None, None, None, None, None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Woman using her phone standing under an umbrella on the sidewalk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two older type Amtrak cars sitting on tracks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A fresh carnation in a vase sits alongside a computer.\n', 'Find me an everyday image that matches the given caption: A man is standing on a baseball field in action.\n', 'Find me an everyday image that matches the given caption: A brown teddy bear in striped shirt on its back.\n', 'Find me an everyday image that matches the given caption: A cat looking out of the passenger window in a vehicle.\n', 'Find me an everyday image that matches the given caption: A woman looking at her phone while sitting at a table with four laptop computers.\n', 'Find me an everyday image that matches the given caption: The shower stall sliding doors are made of glass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|â–         | 81/6000 [02:47<3:18:49,  2.02s/it]                                                   {'loss': 2.2993, 'grad_norm': 145.4953155517578, 'learning_rate': 8.1e-06, 'epoch': 0.01}
  1%|â–         | 81/6000 [02:47<3:18:49,  2.02s/it][2025-11-13 01:33:45,497] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    389,    432,    624],
        [151643, 151643, 151643,  ...,   1602,   1909,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  16301,  30232,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a plate with different food and vegetables on it.\n', 'Find me an everyday image that matches the given caption: The building is tall with a clock and a flag on the very top.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small kid on skis ride through the snow.\n', 'Find me an everyday image that matches the given caption: A plate of a sandwich and french fries.\n', 'Find me an everyday image that matches the given caption: A young child is dressed and ready to go skiing.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy holding a baseball bat getting ready to swing at the ball.\n', 'Find me an everyday image that matches the given caption: A herd of elephants standing on leaf covered ground.\n', 'Find me an everyday image that matches the given caption: Apples and leaves on the ground beneath an apple tree.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man skies down a snowy mountain slope.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBA00>], [None], [None], [<PIL.Image.Image image mode=RGB size=363x256 at 0x7F32727D8700>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DA590>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727DBA60>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C4460>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7E50>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C64D0>], [None]], 'pixel_values': [array([[ 0.66027313,  0.68947   ,  0.7478637 , ...,  1.7619553 ,
         1.7761754 ,  1.7761754 ],
       [ 0.89384794,  0.8792495 ,  0.8354542 , ...,  1.7903955 ,
         1.7903955 ,  1.7903955 ],
       [ 0.8646511 ,  0.8646511 ,  0.8792495 , ...,  1.1931527 ,
         1.4491138 ,  0.80921096],
       ...,
       [-0.06964822, -0.06964822, -0.08424664, ..., -0.7976566 ,
        -0.7549964 , -0.71233624],
       [ 0.01794233,  0.04713918,  0.00334391, ..., -0.5985757 ,
        -0.65545595, -0.5985757 ],
       [-0.08424664, -0.0550498 , -0.04045137, ..., -0.4421549 ,
        -0.51325524, -0.5559154 ]], dtype=float32), None, None, array([[ 1.7989503,  1.7989503,  1.7989503, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       [ 1.8865409,  1.8865409,  1.9157377, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       [ 1.7843518,  1.7843518,  1.7843518, ...,  2.1316772,  2.1316772,
         2.145897 ],
       ...,
       [-1.2813176, -1.2667192, -1.2521207, ..., -1.0251776, -1.0962781,
        -1.1389382],
       [-1.3543098, -1.2375224, -1.2813176, ..., -1.1531583, -1.1531583,
        -1.1389382],
       [-1.1499318, -1.2521207, -1.1353334, ..., -1.0536178, -1.1247182,
        -1.1673783]], dtype=float32), None, None, None, array([[ 6.6027313e-01,  6.3107628e-01,  6.3107628e-01, ...,
         1.3495734e+00,  1.3353534e+00,  1.3637935e+00],
       [ 8.6465108e-01,  8.5005265e-01,  8.0625743e-01, ...,
         1.5486543e+00,  1.5486543e+00,  1.5628744e+00],
       [ 6.7487156e-01,  7.3326528e-01,  7.7706057e-01, ...,
         1.5913146e+00,  1.5913146e+00,  1.5770944e+00],
       ...,
       [ 3.0991095e-01,  3.3910778e-01,  3.0991095e-01, ...,
         6.9767430e-02,  5.5547368e-02,  4.1327301e-02],
       [ 5.1428890e-01,  4.8509204e-01,  4.4129676e-01, ...,
         2.4040821e-01,  3.5416883e-01,  3.2572860e-01],
       [ 1.3472985e-01,  1.0553299e-01,  9.0934567e-02, ...,
        -1.3328948e-03,  4.1327301e-02,  5.5547368e-02]], dtype=float32), array([[-1.0623412 ,  0.0617376 , -0.3470183 , ...,  0.48214942,
         0.7096705 ,  0.6954504 ],
       [-0.9017585 , -0.94555384, -0.9309554 , ...,  0.9514116 ,
         0.9514116 ,  1.0082918 ],
       [ 0.66027313,  0.67487156,  0.09093457, ...,  0.823431  ,
         0.85187113,  1.1078323 ],
       ...,
       [ 0.26611567,  0.26611567,  0.25151724, ...,  0.29728848,
         0.29728848,  0.31150854],
       [ 0.41209993,  0.3975015 ,  0.38290307, ...,  0.38260898,
         0.25462827,  0.0413273 ],
       [ 0.29531252,  0.30991095,  0.26611567, ..., -0.7549964 ,
        -0.7265563 , -0.669676  ]], dtype=float32), array([[-1.0769397 , -1.1207349 , -1.0477428 , ..., -1.2100385 ,
        -1.2526988 , -1.2526988 ],
       [-1.2667192 , -1.2959161 , -1.3251129 , ..., -1.3380191 ,
        -1.3522393 , -1.3664593 ],
       [-0.9163569 , -0.47840413,  0.20772196, ...,  1.6766349 ,
         1.918376  ,  2.0321364 ],
       ...,
       [ 0.03254076, -0.72657734, -1.2375224 , ...,  0.35416883,
         0.9940718 ,  0.75233066],
       [-0.14264035, -0.33241987, -0.405412  , ...,  2.117457  ,
         1.6481948 ,  1.6766349 ],
       [ 1.3755959 ,  1.4047928 ,  1.0252337 , ...,  0.80921096,
         1.9468161 ,  1.918376  ]], dtype=float32), None, None, None, array([[-0.65358526, -0.6681836 , -0.68278205, ...,  0.46792936,
         0.6954504 ,  0.9514116 ],
       [-0.2740262 , -0.33241987, -0.44920728, ...,  0.25462827,
         0.4252692 ,  0.5390297 ],
       [-0.25942776, -0.2302309 , -0.37621516, ...,  1.3495734 ,
         1.463334  ,  1.6766349 ],
       ...,
       [-0.33241987, -0.37621516, -0.50760096, ..., -0.49903518,
        -0.47059506, -0.4421549 ],
       [-0.6973805 , -0.6681836 , -0.65358526, ..., -0.10087335,
        -0.01555296, -0.02977302],
       [-0.1718372 , -0.3470183 , -0.5221994 , ..., -0.5559154 ,
        -0.57013553, -0.57013553]], dtype=float32), array([[-1.4419003 , -1.4710971 , -1.2521207 , ..., -1.0962781 ,
        -1.1389382 , -0.9825174 ],
       [-1.2083255 , -1.3689082 , -1.3251129 , ..., -1.1389382 ,
        -1.1247182 , -1.067838  ],
       [-1.2521207 , -1.2813176 , -1.1207349 , ..., -1.1104981 ,
        -1.1958185 , -1.2811389 ],
       ...,
       [-1.2667192 , -1.4273019 , -1.500294  , ..., -1.082058  ,
        -1.0109575 , -0.95407724],
       [-1.5732862 , -1.5732862 , -1.5586877 , ..., -1.2526988 ,
        -1.1673783 , -1.0962781 ],
       [-1.4127034 , -1.500294  , -1.5586877 , ..., -1.2811389 ,
        -1.1673783 , -1.0393977 ]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 26]]), None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: There is a plate with different food and vegetables on it.\n', 'Find me an everyday image that matches the given caption: The building is tall with a clock and a flag on the very top.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small kid on skis ride through the snow.\n', 'Find me an everyday image that matches the given caption: A plate of a sandwich and french fries.\n', 'Find me an everyday image that matches the given caption: A young child is dressed and ready to go skiing.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy holding a baseball bat getting ready to swing at the ball.\n', 'Find me an everyday image that matches the given caption: A herd of elephants standing on leaf covered ground.\n', 'Find me an everyday image that matches the given caption: Apples and leaves on the ground beneath an apple tree.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man skies down a snowy mountain slope.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 82/6000 [02:50<3:21:13,  2.04s/it]                                                   {'loss': 2.173, 'grad_norm': 184.38772583007812, 'learning_rate': 8.2e-06, 'epoch': 0.01}
  1%|â–         | 82/6000 [02:50<3:21:13,  2.04s/it][2025-11-13 01:33:47,598] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    806,  50497,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  36025,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is standing at the airport waiting on his luggage.\n', 'Find me an everyday image that matches the given caption: A group of sheep in the field eating green grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two beach chairs on a beach under an umbrella.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man is preparing a meal shirtless in the kitchen.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pile of luggage has been placed on a lawn.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9F60>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C7640>], [None], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F32727C7F10>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C7E20>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C7B50>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C7A00>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C5150>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C62F0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7B80>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727C7FD0>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C6140>], [None]], 'pixel_values': [array([[-0.31782144, -0.36161673, -0.2740262 , ...,  0.25462827,
         0.1266477 , -0.27151415],
       [-0.11344349, -0.21563247, -0.28862458, ..., -0.669676  ,
        -0.68389606, -0.71233624],
       [ 0.26611567,  0.32450938,  0.13472985, ..., -0.05821316,
        -0.07243322, -0.08665328],
       ...,
       [-0.55139625, -0.55139625, -0.55139625, ..., -0.86875695,
        -0.89719707, -0.89719707],
       [-0.88716006, -0.88716006, -0.88716006, ..., -1.0962781 ,
        -1.1104981 , -1.1104981 ],
       [-0.82876635, -0.8433648 , -0.8433648 , ..., -1.082058  ,
        -1.082058  , -1.082058  ]], dtype=float32), array([[-0.9017585 , -0.88716006, -0.87256163, ..., -1.4233395 ,
        -1.4375596 , -1.4375596 ],
       [-0.7995695 , -0.8141679 , -0.7995695 , ..., -1.4659997 ,
        -1.4659997 , -1.4517797 ],
       [-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       ...,
       [-1.704672  , -1.704672  , -1.704672  , ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-1.7484672 , -1.7484672 , -1.7484672 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-1.7484672 , -1.7484672 , -1.7484672 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ]], dtype=float32), None, None, array([[-0.7557742 , -0.14264035, -0.25942776, ...,  0.8660912 ,
         0.80921096,  0.6527902 ],
       [-0.14264035, -0.08424664, -0.08424664, ..., -0.65545595,
        -0.8260967 , -0.31417432],
       [-1.7922626 , -1.0039475 , -0.20103405, ..., -0.95407724,
        -0.9256371 , -0.91141707],
       ...,
       [-0.14264035, -0.14264035, -0.14264035, ...,  1.036732  ,
         0.9940718 ,  0.9940718 ],
       [ 0.00334391, -0.02585294, -0.0550498 , ...,  1.0936122 ,
         1.0793922 ,  1.0651721 ],
       [-0.11344349, -0.12804192, -0.12804192, ...,  0.8376511 ,
         0.8376511 ,  0.8376511 ]], dtype=float32), array([[-0.6681836 ,  1.0836275 ,  1.0544306 , ...,  0.52480966,
         1.1647125 ,  1.1647125 ],
       [ 1.3318007 ,  1.3463992 ,  1.3755959 , ...,  0.39682904,
         0.7381106 ,  1.022512  ],
       [ 0.8354542 ,  0.8208558 ,  0.99603695, ...,  1.0936122 ,
         1.1362724 ,  1.1220524 ],
       ...,
       [ 1.3172023 ,  1.2296118 ,  1.098226  , ...,  0.80921096,
         0.9229715 ,  0.9514116 ],
       [ 0.33910778,  0.33910778,  0.3537062 , ..., -0.68389606,
        -0.61279577, -0.65545595],
       [ 0.3537062 ,  0.36830464,  0.38290307, ...,  0.5816899 ,
         0.6670103 ,  0.6954504 ]], dtype=float32), None, array([[-1.2813176 , -1.3251129 , -1.2813176 , ..., -1.3806794 ,
        -1.4802198 , -1.1958185 ],
       [-1.1645303 , -1.193727  , -1.1061366 , ..., -1.3380191 ,
        -1.3237991 , -1.309579  ],
       [-1.5294908 , -1.3835065 , -1.4127034 , ..., -1.3380191 ,
        -1.309579  , -1.2669188 ],
       ...,
       [-0.49300256, -0.47840413, -0.43460885, ..., -1.1673783 ,
        -1.1815984 , -1.1958185 ],
       [ 0.0617376 ,  0.04713918, -0.0550498 , ..., -1.2384787 ,
        -1.2100385 , -1.1958185 ],
       [-0.06964822, -0.11344349,  0.10553299, ..., -1.2100385 ,
        -1.2384787 , -1.2953589 ]], dtype=float32), array([[-0.9747507 , -0.9747507 , -0.9747507 , ..., -0.29995427,
        -0.29995427, -0.29995427],
       [-0.9747507 , -0.9747507 , -0.96015227, ..., -0.34261447,
        -0.34261447, -0.34261447],
       [-0.65358526, -0.6681836 , -0.65358526, ...,  0.02710724,
         0.02710724,  0.02710724],
       ...,
       [ 0.41209993,  0.52888733,  0.66027313, ..., -1.2384787 ,
        -1.4802198 , -1.4517797 ],
       [-0.7119789 , -0.6389868 , -0.5221994 , ..., -1.1247182 ,
        -1.1247182 , -1.0251776 ],
       [-1.0331444 , -0.94555384, -0.9747507 , ..., -1.4659997 ,
        -0.95407724, -1.4659997 ]], dtype=float32), array([[-0.06964822, -0.18643562, -0.5221994 , ..., -0.8545369 ,
        -1.067838  , -0.8545369 ],
       [-0.303223  , -0.5367978 , -0.7119789 , ..., -0.49903518,
        -0.51325524, -0.57013553],
       [-0.5221994 , -0.50760096, -0.44920728, ..., -0.6270158 ,
        -0.68389606, -0.8260967 ],
       ...,
       [-0.96015227, -0.8141679 , -0.5659947 , ...,  0.48214942,
         0.4537093 ,  0.46792936],
       [-0.24482933, -0.14264035, -0.1718372 , ..., -0.27151415,
        -0.38527465, -0.17197368],
       [-0.5659947 , -0.2740262 , -0.47840413, ...,  0.4537093 ,
         0.43948925,  0.46792936]], dtype=float32), None, array([[ 1.8281472 ,  1.8281472 ,  1.8281472 , ..., -0.31417432,
        -0.31417432, -0.3710546 ],
       [ 1.9157377 ,  1.9303361 ,  1.9157377 , ..., -0.39949474,
        -0.58435565, -0.81187665],
       [ 1.1420212 ,  1.2004149 ,  1.3318007 , ...,  2.103237  ,
         2.0321364 ,  1.918376  ],
       ...,
       [ 0.8062574 ,  1.2588086 , -0.08424664, ...,  0.48214942,
        -0.15775362, -0.31417432],
       [-1.7338688 , -1.6900735 , -1.6608766 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.3543098 , -1.3105145 , -1.0915381 , ..., -1.3664593 ,
        -1.4091195 , -1.4233395 ]], dtype=float32), array([[ 0.42669836,  0.41209993,  0.41209993, ...,  1.1647125 ,
         1.0793922 ,  0.9798517 ],
       [ 0.42669836,  0.38290307,  0.2807141 , ...,  0.6527902 ,
         0.6243501 ,  0.63857013],
       [ 0.5726826 ,  0.5580842 ,  0.54348576, ...,  1.1931527 ,
         1.3211333 ,  1.2926931 ],
       ...,
       [-1.4273019 , -1.5148925 , -1.5294908 , ..., -1.2526988 ,
        -1.2669188 , -1.2953589 ],
       [-1.2813176 , -1.3251129 , -1.3397113 , ..., -1.2384787 ,
        -1.3948994 , -1.4802198 ],
       [-1.2083255 , -1.2667192 , -1.4419003 , ..., -1.2100385 ,
        -1.3380191 , -1.4091195 ]], dtype=float32), array([[ 1.9312355e-01,  2.0772196e-01,  1.0553299e-01, ...,
        -1.3328948e-03,  8.3987497e-02,  1.6930789e-01],
       [-2.5942776e-01, -3.0322301e-01, -3.4701830e-01, ...,
         1.8330555e+00,  9.5141160e-01,  3.2572860e-01],
       [ 1.7942330e-02,  6.1737604e-02,  3.2540757e-02, ...,
        -1.3328948e-03,  4.1327301e-02,  8.3987497e-02],
       ...,
       [-1.1645303e+00, -1.5294908e+00, -1.4419003e+00, ...,
         3.1150854e-01, -6.1279577e-01, -7.2655630e-01],
       [-6.5358526e-01, -6.5358526e-01, -6.2438840e-01, ...,
        -1.5552960e-02, -2.1463387e-01, -2.1463387e-01],
       [-1.0915381e+00, -7.8497106e-01, -2.3023090e-01, ...,
        -1.0820580e+00, -1.1531583e+00, -1.1958185e+00]], dtype=float32), array([[-0.33241987, -0.31782144, -0.25942776, ...,  0.52480966,
         0.48214942,  0.4110491 ],
       [-0.36161673, -0.36161673, -0.24482933, ...,  0.02710724,
         0.22618815,  0.39682904],
       [ 0.71866685,  0.7040684 ,  0.68947   , ...,  0.24040821,
         0.22618815,  0.24040821],
       ...,
       [ 0.85005265,  0.3537062 ,  0.04713918, ...,  0.7096705 ,
         0.39682904,  0.93719155],
       [ 0.95224166,  0.8354542 ,  0.76246214, ...,  1.2073728 ,
         0.8376511 ,  0.72389054],
       [ 0.2807141 ,  0.7040684 ,  1.3755959 , ...,  0.56746984,
         0.19774802,  0.25462827]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is standing at the airport waiting on his luggage.\n', 'Find me an everyday image that matches the given caption: A group of sheep in the field eating green grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two beach chairs on a beach under an umbrella.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man is preparing a meal shirtless in the kitchen.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A pile of luggage has been placed on a lawn.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 83/6000 [02:52<3:22:39,  2.05s/it]                                                   {'loss': 2.2589, 'grad_norm': 192.33726501464844, 'learning_rate': 8.3e-06, 'epoch': 0.01}
  1%|â–         | 83/6000 [02:52<3:22:39,  2.05s/it][2025-11-13 01:33:49,685] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  29388,    432,    624],
        [151643, 151643, 151643,  ...,    311,   1105,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    315,   7329,    624],
        [151643, 151643, 151643,  ...,   5426,   3754,    624],
        [151643, 151643, 151643,  ...,   8872,  24484,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ["Find me an everyday image that matches the given caption: A Holstein cow sticks it's nose under a strand of barbed wire fencing, while another is close beside it.\n", 'Find me an everyday image that matches the given caption: A long plate hold some fries with some sliders next to them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A blue rubbish removal truck and two vehicles behind it.\n', 'Find me an everyday image that matches the given caption: A person on skis doing a flip in the air.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close up of a plate of a doughnut.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman laying in a hospital bed hooked up to an IV and monitors.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is pointing at a sticker on the back of surface.\n', 'Find me an everyday image that matches the given caption: A yellow train moving down a train track.\n', 'Find me an everyday image that matches the given caption: A cargo dolly next to several motor cycles.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x269 at 0x7F32727C48B0>], [None], [None], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727C50F0>], [<PIL.Image.Image image mode=RGB size=256x329 at 0x7F32727C6FE0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727D93C0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D9DB0>], [None], [<PIL.Image.Image image mode=RGB size=518x256 at 0x7F32727C6E30>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C67D0>], [None], [None], [None]], 'pixel_values': [None, None, array([[ 1.7989503 ,  1.7989503 ,  1.7989503 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.7989503 ,  1.7989503 ,  1.7989503 , ...,  1.9468161 ,
         1.875716  ,  1.875716  ],
       [ 1.7989503 ,  1.7989503 ,  1.7989503 , ...,  2.074797  ,
         2.0605767 ,  2.0463567 ],
       ...,
       [-0.09884507, -0.04045137, -0.01125452, ...,  0.25462827,
         0.18352796,  0.11242763],
       [ 0.20772196,  0.17852512,  0.13472985, ...,  0.09820756,
         0.09820756,  0.09820756],
       [ 0.42669836,  0.52888733,  0.58728105, ...,  0.09820756,
         0.0839875 ,  0.0839875 ]], dtype=float32), None, None, array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  1.3780135 ,
         1.4064537 ,  1.4206737 ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  1.4206737 ,
         1.4206737 ,  1.3637935 ],
       [ 1.2442101 ,  1.2296118 ,  1.2296118 , ...,  1.1078323 ,
         1.1504925 ,  1.1362724 ],
       ...,
       [-0.59519154, -0.59519154, -0.6243884 , ...,  0.02710724,
         0.0839875 ,  0.14086775],
       [-0.9309554 , -0.88716006, -0.8579632 , ..., -0.3710546 ,
        -0.32839438, -0.25729406],
       [-0.6243884 , -0.59519154, -0.5659947 , ..., -0.12931348,
         0.02710724,  0.19774802]], dtype=float32), array([[ 0.8792495 ,  0.8646511 ,  0.8792495 , ...,  1.918376  ,
         1.918376  ,  1.9325962 ],
       [ 1.1858164 ,  1.2150133 ,  1.2296118 , ...,  1.9325962 ,
         1.9325962 ,  1.9468161 ],
       [ 0.8354542 ,  0.8354542 ,  0.8354542 , ...,  1.8899357 ,
         1.918376  ,  1.8899357 ],
       ...,
       [ 0.12013142,  0.12013142,  0.4558952 , ..., -0.65545595,
        -0.17197368,  0.18352796],
       [ 0.99603695,  0.89384794,  0.8792495 , ..., -0.08665328,
         0.05554737,  0.15508783],
       [ 0.6018794 ,  0.4704936 ,  0.8792495 , ...,  0.5390297 ,
         0.6527902 ,  0.39682904]], dtype=float32), array([[-1.4564987, -1.4564987, -1.4564987, ..., -1.0962781, -1.1104981,
        -1.1104981],
       [-1.4273019, -1.4273019, -1.4273019, ..., -1.082058 , -1.082058 ,
        -1.067838 ],
       [-1.398105 , -1.4127034, -1.4127034, ..., -1.0962781, -1.0962781,
        -1.0962781],
       ...,
       [-1.4564987, -1.4710971, -1.5148925, ..., -1.2384787, -1.2100385,
        -1.2100385],
       [-1.5878845, -1.6024829, -1.5586877, ..., -1.1247182, -1.1531583,
        -1.1815984],
       [-1.4273019, -1.4273019, -1.5294908, ..., -1.1531583, -1.1389382,
        -1.1247182]], dtype=float32), None, array([[ 0.33910778,  0.33910778,  0.3537062 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       [ 0.6018794 ,  0.6018794 ,  0.6310763 , ...,  1.9894764 ,
         1.9894764 ,  2.0036962 ],
       [ 0.49969047,  0.5142889 ,  0.54348576, ...,  2.0179167 ,
         2.0036962 ,  2.0036962 ],
       ...,
       [ 1.0252337 ,  1.0836275 ,  1.0398322 , ..., -0.48481512,
        -0.71233624, -0.35683453],
       [ 1.2296118 ,  0.8792495 ,  0.0617376 , ..., -0.74077636,
        -0.61279577, -0.5559154 ],
       [-1.2959161 , -0.94555384, -0.9747507 , ..., -0.5274753 ,
        -0.5559154 , -0.49903518]], dtype=float32), None, array([[1.9011393, 1.9011393, 1.9011393, ..., 2.103237 , 2.103237 ,
        2.103237 ],
       [1.9011393, 1.9011393, 1.8865409, ..., 2.0890167, 2.0890167,
        2.0890167],
       [1.9011393, 1.9011393, 1.9011393, ..., 2.103237 , 2.103237 ,
        2.103237 ],
       ...,
       [1.9011393, 1.9011393, 1.9011393, ..., 2.0890167, 2.0890167,
        2.0890167],
       [1.9011393, 1.9011393, 1.8865409, ..., 2.1316772, 1.9752562,
        2.0463567],
       [1.8865409, 1.8719424, 1.857344 , ..., 2.0463567, 2.0036962,
        2.0890167]], dtype=float32), array([[-0.9309554 , -1.0915381 , -1.1061366 , ..., -0.08665328,
         0.15508783,  0.15508783],
       [-1.0477428 , -1.1353334 , -1.1207349 , ...,  0.4537093 ,
         0.51058954,  0.88031125],
       [-0.36161673, -0.18643562, -0.6389868 , ...,  0.8660912 ,
         0.80921096,  0.38260898],
       ...,
       [ 0.9668401 ,  1.2004149 ,  1.0252337 , ...,  1.3069133 ,
         1.5913146 ,  1.5770944 ],
       [ 1.3901944 ,  1.5507771 ,  1.6821629 , ..., -0.3710546 ,
        -0.20041381,  0.0413273 ],
       [ 1.652966  ,  1.7697535 ,  1.5945723 , ...,  0.80921096,
         0.85187113,  0.6527902 ]], dtype=float32), None, None, None], 'image_grid_thw': [None, None, array([[ 1, 20, 18]]), None, None, array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 36]]), array([[ 1, 18, 28]]), None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ["Find me an everyday image that matches the given caption: A Holstein cow sticks it's nose under a strand of barbed wire fencing, while another is close beside it.\n", 'Find me an everyday image that matches the given caption: A long plate hold some fries with some sliders next to them.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A blue rubbish removal truck and two vehicles behind it.\n', 'Find me an everyday image that matches the given caption: A person on skis doing a flip in the air.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close up of a plate of a doughnut.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A woman laying in a hospital bed hooked up to an IV and monitors.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is pointing at a sticker on the back of surface.\n', 'Find me an everyday image that matches the given caption: A yellow train moving down a train track.\n', 'Find me an everyday image that matches the given caption: A cargo dolly next to several motor cycles.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 84/6000 [02:54<3:21:45,  2.05s/it]                                                   {'loss': 1.8652, 'grad_norm': 131.72836303710938, 'learning_rate': 8.400000000000001e-06, 'epoch': 0.01}
  1%|â–         | 84/6000 [02:54<3:21:45,  2.05s/it][2025-11-13 01:33:51,708] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    279,   3015,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,   7002,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: An old Navy plane being pulled from the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A girl holds her racquet out as a yellow tennis ball comes toward her.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Woman tennis player holding racket during a match.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black pony at a show being led by a woman, while another woman judges it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A band member in a black shirt with a red tie plays the trombone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An old fashioned bathroom with gravity fed toilet and bidet and a gas water heater on the wall.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=259x256 at 0x7F32727C7220>], [<PIL.Image.Image image mode=RGB size=256x456 at 0x7F32727B6F20>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B48B0>], [<PIL.Image.Image image mode=RGB size=758x256 at 0x7F32727B4160>], [None], [<PIL.Image.Image image mode=RGB size=256x371 at 0x7F32727B4550>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B5C00>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727B4130>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B4220>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B41C0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B52A0>], [None]], 'pixel_values': [None, array([[ 1.8427455,  1.8281472,  1.7989503, ...,  1.9468161,  1.9325962,
         1.918376 ],
       [ 1.652966 ,  1.6237692,  1.5945723, ...,  1.8614956,  1.8614956,
         1.8614956],
       [ 1.9011393,  1.8865409,  1.857344 , ...,  2.0179167,  2.0321364,
         2.0036962],
       ...,
       [-1.7630657, -1.7192703, -1.6900735, ..., -1.0536178, -1.1958185,
        -1.4091195],
       [-1.7338688, -1.7338688, -1.7192703, ..., -1.4091195, -1.4517797,
        -1.4802198],
       [-1.7484672, -1.7630657, -1.7776641, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), array([[ 1.5507771 ,  1.5507771 ,  1.5507771 , ...,  1.8472759 ,
         1.8330555 ,  1.8188357 ],
       [ 0.8354542 ,  0.6018794 ,  0.791659  , ...,  1.2358129 ,
         0.9229715 ,  0.5390297 ],
       [ 1.477785  ,  1.4923834 ,  1.5069818 , ...,  1.8046155 ,
         1.7903955 ,  1.7761754 ],
       ...,
       [-0.36161673, -0.405412  , -0.44920728, ..., -0.20041381,
        -0.21463387, -0.243074  ],
       [-0.72657734, -0.7557742 , -0.7411758 , ..., -0.14353354,
        -0.15775362, -0.21463387],
       [-0.42001042, -0.43460885, -0.44920728, ..., -0.22885394,
        -0.35683453, -0.49903518]], dtype=float32), array([[ 5.1428890e-01,  5.1428890e-01,  5.1428890e-01, ...,
         1.9325962e+00,  1.9325962e+00,  1.9325962e+00],
       [ 5.2888733e-01,  5.2888733e-01,  5.2888733e-01, ...,
         1.9325962e+00,  1.9325962e+00,  1.9325962e+00],
       [ 5.5808419e-01,  5.5808419e-01,  5.5808419e-01, ...,
         1.8472759e+00,  1.8472759e+00,  1.8472759e+00],
       ...,
       [ 5.1428890e-01,  5.8728105e-01,  1.9312355e-01, ...,
         4.2526919e-01,  4.3948925e-01,  4.5370930e-01],
       [ 9.2304480e-01,  6.1647785e-01,  8.3545423e-01, ...,
        -1.3328948e-03,  1.1242763e-01,  2.4040821e-01],
       [ 5.8728105e-01,  8.3545423e-01,  9.2304480e-01, ...,
         7.9499090e-01,  7.2389054e-01,  5.6746984e-01]], dtype=float32), array([[-1.193727  , -1.1645303 , -1.2813176 , ..., -0.882977  ,
        -0.91141707, -0.95407724],
       [-1.2229239 , -1.2959161 , -1.3689082 , ..., -0.58435565,
        -0.58435565, -0.7265563 ],
       [-1.3105145 , -1.3689082 , -1.4127034 , ..., -0.7549964 ,
        -0.71233624, -0.71233624],
       ...,
       [-1.1791286 , -1.2229239 , -1.2083255 , ..., -0.882977  ,
        -0.89719707, -0.86875695],
       [-1.2959161 , -1.3543098 , -1.3105145 , ..., -0.65545595,
        -0.6412359 , -0.6270158 ],
       [-1.0915381 , -1.1207349 , -1.1791286 , ..., -0.34261447,
        -0.4137148 , -0.7976566 ]], dtype=float32), None, array([[ 1.8865409 ,  1.8865409 ,  1.8865409 , ...,  1.6624149 ,
         1.705075  ,  1.7477353 ],
       [ 1.8719424 ,  1.8719424 ,  1.8719424 , ...,  0.51058954,
         0.4537093 ,  0.43948925],
       [ 1.8865409 ,  1.8865409 ,  1.8865409 , ...,  1.690855  ,
         1.7477353 ,  1.8046155 ],
       ...,
       [-0.50760096, -1.1061366 , -1.4419003 , ..., -1.3806794 ,
        -1.2811389 , -1.2242587 ],
       [-1.5878845 , -1.6170814 , -1.6462783 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.33910778,  0.2223204 ,  0.03254076, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, array([[-1.7484672 , -1.7922626 , -1.7192703 , ...,  0.75233066,
         0.88031125,  0.9229715 ],
       [ 0.32450938,  1.0106354 ,  1.7697535 , ...,  0.7665507 ,
         0.93719155,  1.0651721 ],
       [-1.3689082 , -1.7922626 , -1.7922626 , ...,  0.8376511 ,
         1.0793922 ,  1.022512  ],
       ...,
       [ 0.25151724,  0.30991095,  0.17852512, ..., -0.21463387,
        -0.17197368, -0.15775362],
       [-0.08424664, -0.04045137,  0.01794233, ...,  0.11242763,
         0.11242763,  0.1266477 ],
       [ 0.16392669,  0.16392669,  0.16392669, ...,  0.19774802,
         0.02710724, -0.10087335]], dtype=float32), array([[ 1.9303361 ,  1.9303361 ,  1.9157377 , ...,  1.7619553 ,
         1.7192951 ,  1.705075  ],
       [ 1.6675645 ,  1.8427455 ,  1.7697535 , ...,  0.8376511 ,
         0.823431  ,  0.7665507 ],
       [ 1.9157377 ,  1.9157377 ,  1.9011393 , ...,  1.7192951 ,
         1.705075  ,  1.7192951 ],
       ...,
       [ 0.8792495 ,  0.8792495 ,  0.8646511 , ..., -0.65545595,
        -0.61279577, -0.5985757 ],
       [ 0.9814385 ,  0.89384794,  0.9230448 , ..., -0.9825174 ,
        -0.95407724, -0.91141707],
       [ 1.3026038 ,  1.3026038 ,  1.3026038 , ..., -0.65545595,
        -0.61279577, -0.5985757 ]], dtype=float32), None, array([[-0.88716006, -0.87256163, -0.8579632 , ..., -0.38527465,
        -0.3710546 , -0.35683453],
       [-0.7557742 , -0.7411758 , -0.7119789 , ..., -0.35683453,
        -0.34261447, -0.32839438],
       [-1.1207349 , -1.0915381 , -1.0623412 , ..., -0.7549964 ,
        -0.7549964 , -0.7549964 ],
       ...,
       [ 0.7332653 ,  0.7478637 ,  0.89384794, ...,  0.7807708 ,
         0.72389054,  0.7096705 ],
       [ 0.49969047,  0.5580842 ,  0.5726826 , ...,  1.022512  ,
         1.0936122 ,  1.0509521 ],
       [ 0.48509204,  0.48509204,  0.48509204, ...,  0.75233066,
         0.7807708 ,  0.80921096]], dtype=float32), None, array([[-0.36161673,  0.0617376 ,  0.5726826 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.19312355, -0.31782144, -0.68278205, ..., -1.4802198 ,
        -1.4659997 , -1.4659997 ],
       [-1.3543098 , -1.3251129 , -1.2959161 , ..., -1.4659997 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [-0.7119789 , -0.7119789 , -0.6973805 , ..., -1.1958185 ,
        -1.1958185 , -1.1815984 ],
       [-1.1499318 , -1.1499318 , -1.1645303 , ..., -1.4233395 ,
        -1.4233395 , -1.4375596 ],
       [-1.1207349 , -1.0915381 , -1.0769397 , ..., -1.4375596 ,
        -1.4375596 , -1.4375596 ]], dtype=float32), array([[-1.0915381 , -1.0915381 , -1.0915381 , ...,  0.4110491 ,
         0.4252692 ,  0.4252692 ],
       [-1.018546  , -1.018546  , -1.0039475 , ...,  0.51058954,
         0.51058954,  0.52480966],
       [-1.018546  , -1.018546  , -1.018546  , ...,  0.4963695 ,
         0.4963695 ,  0.4963695 ],
       ...,
       [-0.72657734, -0.72657734, -0.72657734, ...,  0.6527902 ,
         0.6527902 ,  0.6527902 ],
       [-0.6973805 , -0.6973805 , -0.7119789 , ...,  0.6243501 ,
         0.61013   ,  0.61013   ],
       [-0.7411758 , -0.7557742 , -0.7557742 , ...,  0.59590995,
         0.5816899 ,  0.5816899 ]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 18]]), array([[ 1, 32, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 54]]), None, array([[ 1, 26, 18]]), None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: An old Navy plane being pulled from the water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A girl holds her racquet out as a yellow tennis ball comes toward her.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Woman tennis player holding racket during a match.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black pony at a show being led by a woman, while another woman judges it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A band member in a black shirt with a red tie plays the trombone.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An old fashioned bathroom with gravity fed toilet and bidet and a gas water heater on the wall.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 85/6000 [02:56<3:24:29,  2.07s/it]                                                   {'loss': 1.9372, 'grad_norm': 136.2179718017578, 'learning_rate': 8.5e-06, 'epoch': 0.01}
  1%|â–         | 85/6000 [02:56<3:24:29,  2.07s/it][2025-11-13 01:33:53,855] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,  12408,    624],
        [151643, 151643, 151643,  ...,   5106,  11929,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  12883,    624],
        [151643, 151643, 151643,  ...,    323,  39411,    624],
        [151643, 151643, 151643,  ...,    650,  10242,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An elephant walking down a dirt trail among the trees.\n', 'Find me an everyday image that matches the given caption: A man in blue shirt holding a frisbee in front of various direction signs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A giraffe walks on grass in an area with trees.\n', 'Find me an everyday image that matches the given caption: Books a sandwich soda and headphones on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A hat on a pole near a street where a bus zips by.\n', 'Find me an everyday image that matches the given caption: An adult elephant and a baby elephant are eating a bush.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plate of soup and a hot dog sandwich.\n', 'Find me an everyday image that matches the given caption: A variety of doughnuts sitting on a paper plate.\n', 'Find me an everyday image that matches the given caption: Two people, dressed as refrigerators, walk through a city park.\n', 'Find me an everyday image that matches the given caption: A hotdog with onions on it is next to fries and a beer.\n', 'Find me an everyday image that matches the given caption: Den with green carpet and blinds, comfortable wing chairs, a couch and fireplace.\n', 'Find me an everyday image that matches the given caption: A person sitting at a table that has a blue checked tablecloth on it and a large round pizza that is uncut.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9390>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D9A80>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727DBA60>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D85E0>], [None], [None], [None], [None], [None], [None]], 'pixel_values': [array([[-1.6316798 , -1.5878845 , -1.4419003 , ..., -0.96829736,
        -0.91141707, -1.0962781 ],
       [-1.0331444 , -1.2229239 , -1.2083255 , ..., -0.96829736,
        -0.96829736, -1.0393977 ],
       [-1.3835065 , -1.2229239 , -1.0769397 , ..., -1.4091195 ,
        -1.3237991 , -1.2526988 ],
       ...,
       [-1.2083255 , -1.2229239 , -0.9893491 , ...,  0.33994877,
         0.39682904,  0.43948925],
       [-0.20103405, -0.09884507, -0.18643562, ..., -0.34261447,
        -0.22885394, -0.04399309],
       [ 0.03254076,  0.13472985,  0.16392669, ..., -0.31417432,
        -0.22885394, -0.22885394]], dtype=float32), None, None, array([[-0.9309554 , -0.37621516, -0.0550498 , ..., -0.89719707,
        -0.7549964 , -0.71233624],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.4137148 ,
        -0.42793486, -0.45637497],
       [-0.96015227, -0.43460885, -0.15723877, ..., -1.067838  ,
        -0.74077636, -0.6412359 ],
       ...,
       [-1.2229239 , -1.2229239 , -1.2229239 , ..., -0.35683453,
        -0.35683453, -0.31417432],
       [-0.9017585 , -0.9017585 , -0.9017585 , ..., -0.27151415,
        -0.25729406, -0.243074  ],
       [-0.88716006, -0.7703726 , -0.7557742 , ..., -0.29995427,
        -0.29995427, -0.2857342 ]], dtype=float32), None, None, array([[-1.0331444 , -0.9747507 , -0.9163569 , ..., -0.12931348,
        -0.12931348, -0.12931348],
       [-0.9309554 , -0.9163569 , -0.9163569 , ...,  0.02710724,
         0.5532498 ,  0.9514116 ],
       [-0.9309554 , -0.9309554 , -0.9163569 , ..., -0.15775362,
        -0.15775362, -0.15775362],
       ...,
       [ 0.7478637 ,  0.7478637 ,  0.7478637 , ...,  0.9229715 ,
         0.9229715 ,  0.9229715 ],
       [ 0.68947   ,  0.7040684 ,  0.7040684 , ...,  0.35416883,
         0.63857013,  0.38260898],
       [ 0.7040684 ,  0.7040684 ,  0.7040684 , ...,  0.4537093 ,
         0.39682904,  0.4963695 ]], dtype=float32), None, None, array([[-1.3543098 , -1.3543098 , -1.3543098 , ..., -0.65545595,
        -0.6412359 , -0.6412359 ],
       [-1.2813176 , -1.2813176 , -1.2959161 , ..., -0.6270158 ,
        -0.61279577, -0.61279577],
       [-1.3689082 , -1.3251129 , -1.2667192 , ..., -0.51325524,
        -0.51325524, -0.51325524],
       ...,
       [ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  2.0605767 ,
         2.0463567 ,  2.0605767 ],
       [ 1.8427455 ,  1.8427455 ,  1.8281472 , ...,  1.875716  ,
         1.875716  ,  1.8614956 ],
       [ 1.8135487 ,  1.8135487 ,  1.7989503 , ...,  1.8472759 ,
         1.8330555 ,  1.8330555 ]], dtype=float32), None, None, None, None, None, None], 'image_grid_thw': [array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 24]]), None, None, None, None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An elephant walking down a dirt trail among the trees.\n', 'Find me an everyday image that matches the given caption: A man in blue shirt holding a frisbee in front of various direction signs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A giraffe walks on grass in an area with trees.\n', 'Find me an everyday image that matches the given caption: Books a sandwich soda and headphones on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A hat on a pole near a street where a bus zips by.\n', 'Find me an everyday image that matches the given caption: An adult elephant and a baby elephant are eating a bush.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plate of soup and a hot dog sandwich.\n', 'Find me an everyday image that matches the given caption: A variety of doughnuts sitting on a paper plate.\n', 'Find me an everyday image that matches the given caption: Two people, dressed as refrigerators, walk through a city park.\n', 'Find me an everyday image that matches the given caption: A hotdog with onions on it is next to fries and a beer.\n', 'Find me an everyday image that matches the given caption: Den with green carpet and blinds, comfortable wing chairs, a couch and fireplace.\n', 'Find me an everyday image that matches the given caption: A person sitting at a table that has a blue checked tablecloth on it and a large round pizza that is uncut.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 86/6000 [02:58<3:22:44,  2.06s/it]                                                   {'loss': 1.7951, 'grad_norm': 198.4061737060547, 'learning_rate': 8.6e-06, 'epoch': 0.01}
  1%|â–         | 86/6000 [02:58<3:22:44,  2.06s/it][2025-11-13 01:33:55,868] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    553,   9331,    624],
        [151643, 151643, 151643,  ...,  14038,   1787,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A microwave is atop a wooden table, below a mirror.\n', 'Find me an everyday image that matches the given caption: A man holds a banana in front of his face.\n', 'Find me an everyday image that matches the given caption: Someone is holing a very small pair of scissors in there hand.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A car with a bike on the back of it sitting in a field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An airplane is on a tarmac surrounded by cars.\n', 'Find me an everyday image that matches the given caption: There is a train at the station with its doors open.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C6890>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C4520>], [<PIL.Image.Image image mode=RGB size=380x256 at 0x7F32727B6350>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B73A0>], [<PIL.Image.Image image mode=RGB size=332x256 at 0x7F32727B7BB0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=296x256 at 0x7F32727C7880>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F32727C5150>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B4BB0>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B6C50>], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727B6E00>]], 'pixel_values': [array([[-0.96015227, -0.96015227, -0.94555384, ..., -0.61279577,
        -0.6270158 , -0.6412359 ],
       [-0.87256163, -0.8579632 , -0.8579632 , ..., -0.5985757 ,
        -0.58435565, -0.57013553],
       [-0.7411758 , -0.7557742 , -0.7557742 , ..., -0.4421549 ,
        -0.45637497, -0.45637497],
       ...,
       [-0.7995695 , -0.7557742 , -0.78497106, ..., -0.38527465,
        -0.38527465, -0.39949474],
       [-0.78497106, -0.7557742 , -0.7411758 , ..., -0.31417432,
        -0.32839438, -0.29995427],
       [-0.8579632 , -0.78497106, -0.78497106, ..., -0.29995427,
        -0.29995427, -0.29995427]], dtype=float32), array([[-1.7192703 , -1.7630657 , -1.7338688 , ...,  1.0793922 ,
        -0.35683453, -0.81187665],
       [-1.0769397 , -1.1645303 , -1.3835065 , ...,  0.48214942,
         0.56746984, -0.34261447],
       [-1.4127034 , -1.3543098 , -1.398105  , ...,  0.7807708 ,
        -0.89719707, -0.89719707],
       ...,
       [ 0.93764323,  0.8646511 ,  0.8646511 , ...,  0.9798517 ,
         0.9798517 ,  0.9798517 ],
       [ 0.8208558 ,  0.8208558 ,  0.8354542 , ...,  0.90875137,
         0.93719155,  0.96563166],
       [ 0.791659  ,  0.77706057,  0.77706057, ...,  1.0082918 ,
         0.9798517 ,  0.9229715 ]], dtype=float32), array([[-0.12804192, -0.15723877, -0.2302309 , ..., -1.2384787 ,
        -1.1104981 , -1.1247182 ],
       [-0.21563247, -0.25942776, -0.28862458, ..., -1.1958185 ,
        -1.1815984 , -1.2100385 ],
       [-0.15723877, -0.11344349, -0.25942776, ..., -1.3806794 ,
        -1.2953589 , -1.2100385 ],
       ...,
       [-0.68278205, -0.5367978 , -0.44920728, ..., -1.4091195 ,
        -1.4091195 , -1.4091195 ],
       [-0.6243884 , -0.6243884 , -0.65358526, ..., -1.3664593 ,
        -1.309579  , -1.2953589 ],
       [-0.49300256, -0.50760096, -0.5659947 , ..., -1.4517797 ,
        -1.4517797 , -1.4517797 ]], dtype=float32), array([[ 1.5945723 ,  1.477785  ,  1.5069818 , ...,  1.8046155 ,
         1.7619553 ,  1.5628744 ],
       [ 1.6675645 ,  1.6821629 ,  1.7697535 , ...,  1.5628744 ,
         1.6339747 ,  2.145897  ],
       [ 1.7113597 ,  1.3901944 ,  1.3026038 , ...,  0.9798517 ,
         1.036732  ,  0.88031125],
       ...,
       [-0.08424664, -0.21563247, -0.11344349, ...,  0.6954504 ,
         0.7949909 ,  0.9229715 ],
       [-0.18643562, -0.18643562, -0.15723877, ...,  2.117457  ,
         2.103237  ,  2.0890167 ],
       [ 0.9668401 ,  1.1128243 ,  1.2442101 , ...,  2.0890167 ,
         2.0890167 ,  2.0890167 ]], dtype=float32), array([[-0.21563247, -0.0550498 , -0.21563247, ..., -0.29995427,
        -0.243074  ,  0.05554737],
       [-0.5659947 , -0.24482933,  0.01794233, ..., -0.14353354,
        -0.15775362, -0.10087335],
       [ 0.04713918, -0.0550498 , -0.33241987, ..., -0.35683453,
        -0.4137148 , -0.15775362],
       ...,
       [ 0.19312355,  0.0617376 , -0.12804192, ...,  0.6670103 ,
         0.52480966,  0.4252692 ],
       [ 0.8792495 ,  0.76246214,  0.8208558 , ...,  0.68123037,
         0.7949909 ,  1.0936122 ],
       [ 0.8208558 ,  0.8208558 ,  0.9230448 , ...,  0.8660912 ,
         0.80921096,  0.6954504 ]], dtype=float32), None, None, None, array([[1.9303361 , 1.9303361 , 1.9303361 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [1.9303361 , 1.9303361 , 1.9011393 , ..., 1.5913146 , 1.4917741 ,
        1.3922336 ],
       [1.9303361 , 1.9303361 , 1.9303361 , ..., 2.0890167 , 2.0605767 ,
        2.0463567 ],
       ...,
       [0.29531252, 0.29531252, 0.29531252, ..., 0.6670103 , 0.6670103 ,
        0.6670103 ],
       [0.38290307, 0.42669836, 0.41209993, ..., 1.2926931 , 1.2784731 ,
        1.2784731 ],
       [0.42669836, 0.42669836, 0.42669836, ..., 1.3495734 , 1.3353534 ,
        1.3353534 ]], dtype=float32), None, array([[1.2150133 , 1.0836275 , 1.098226  , ..., 2.0321364 , 1.9894764 ,
        1.9610363 ],
       [1.273407  , 1.3318007 , 1.1858164 , ..., 1.7477353 , 1.7192951 ,
        1.7192951 ],
       [1.6821629 , 1.7113597 , 1.7405566 , ..., 2.145897  , 2.1316772 ,
        2.117457  ],
       ...,
       [0.23691882, 0.52888733, 0.58728105, ..., 0.24040821, 0.25462827,
        0.25462827],
       [0.6018794 , 0.25151724, 0.01794233, ..., 0.33994877, 0.22618815,
        0.5390297 ],
       [0.30991095, 0.13472985, 0.12013142, ..., 0.39682904, 0.6527902 ,
        0.5816899 ]], dtype=float32), array([[ 0.2223204 , -0.11344349, -0.405412  , ..., -0.35683453,
        -0.3710546 , -0.3710546 ],
       [-0.12804192, -0.06964822, -0.21563247, ..., -0.22885394,
        -0.20041381, -0.18619375],
       [ 0.25151724,  0.26611567,  0.29531252, ..., -0.17197368,
        -0.15775362, -0.14353354],
       ...,
       [-0.8433648 , -0.8141679 , -0.82876635, ..., -1.1389382 ,
        -1.1389382 , -1.1389382 ],
       [-1.0039475 , -1.0623412 , -1.1207349 , ..., -1.309579  ,
        -1.3522393 , -1.3806794 ],
       [-0.8579632 , -0.72657734, -0.6681836 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[ 0.7040684 ,  0.66027313,  0.6310763 , ..., -1.1815984 ,
        -1.1389382 , -0.5985757 ],
       [ 1.1858164 ,  1.3172023 ,  1.273407  , ..., -0.54169536,
        -0.5559154 , -0.5985757 ],
       [ 0.14932826,  0.12013142,  0.09093457, ..., -1.4233395 ,
        -1.4233395 , -0.91141707],
       ...,
       [ 1.7843518 ,  1.3026038 ,  1.2150133 , ..., -0.5274753 ,
        -0.49903518, -0.4421549 ],
       [ 1.5361787 ,  1.4631865 ,  1.4631865 , ...,  2.103237  ,
         2.1316772 ,  2.145897  ],
       [ 1.9303361 ,  1.7259582 ,  1.4339896 , ...,  1.264253  ,
         1.3211333 ,  1.3922336 ]], dtype=float32), None, None, array([[-0.5221994 , -0.65358526, -0.8141679 , ..., -0.882977  ,
        -0.7549964 , -0.58435565],
       [-1.1645303 , -1.2813176 , -1.1353334 , ..., -0.95407724,
        -0.42793486, -0.32839438],
       [-1.3835065 , -1.193727  , -0.9017585 , ..., -1.3380191 ,
        -1.3522393 , -1.2384787 ],
       ...,
       [-0.3470183 , -0.39081356, -0.24482933, ...,  0.09820756,
         0.0413273 ,  0.01288717],
       [-0.06964822, -0.0550498 , -0.01125452, ...,  0.33994877,
         0.21196808,  0.25462827],
       [-0.31782144, -0.24482933, -0.15723877, ..., -0.04399309,
        -0.22885394, -0.3710546 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 18, 22]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A microwave is atop a wooden table, below a mirror.\n', 'Find me an everyday image that matches the given caption: A man holds a banana in front of his face.\n', 'Find me an everyday image that matches the given caption: Someone is holing a very small pair of scissors in there hand.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A car with a bike on the back of it sitting in a field.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An airplane is on a tarmac surrounded by cars.\n', 'Find me an everyday image that matches the given caption: There is a train at the station with its doors open.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  1%|â–         | 87/6000 [03:00<3:20:30,  2.03s/it]                                                   {'loss': 1.4417, 'grad_norm': 136.32289123535156, 'learning_rate': 8.700000000000001e-06, 'epoch': 0.01}
  1%|â–         | 87/6000 [03:00<3:20:30,  2.03s/it][2025-11-13 01:33:57,848] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  20336,   3081,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,   6176,  13425,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  10729,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Assorted fruits sitting in stands at a farmers market.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A beautiful woman bending over on a tennis court.\n', 'Find me an everyday image that matches the given caption: A smiley face being made out of some fruit.\n', 'Find me an everyday image that matches the given caption: Lady under an umbrella walking in the rain.\n', 'Find me an everyday image that matches the given caption: There is a group of cows walking in the dirt.\n', 'Find me an everyday image that matches the given caption: A tabby cat sitting near a green bench.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Sandwich sitting on counter table in a restaurant.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727B5F30>], [<PIL.Image.Image image mode=RGB size=358x256 at 0x7F32727B6590>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B6710>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727B67D0>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727B66E0>], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F32727B7520>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727C7730>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B48B0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=332x256 at 0x7F32727B75B0>], [None]], 'pixel_values': [None, array([[ 1.1420212 ,  1.1566195 ,  1.1566195 , ...,  1.5344343 ,
         1.4917741 ,  1.4206737 ],
       [ 1.2442101 ,  1.2442101 ,  1.273407  , ...,  1.5202142 ,
         1.5059941 ,  1.5202142 ],
       [ 1.3901944 ,  1.3609976 ,  1.3318007 , ...,  1.264253  ,
         1.3211333 ,  1.3780135 ],
       ...,
       [-1.3251129 , -1.1499318 , -1.0039475 , ...,  0.8660912 ,
         0.88031125,  0.8945313 ],
       [-1.5148925 , -1.4856956 , -1.4564987 , ..., -1.0251776 ,
        -0.6981161 ,  0.0413273 ],
       [ 1.4047928 ,  1.5069818 ,  1.5215802 , ...,  0.48214942,
         0.43948925,  0.4963695 ]], dtype=float32), array([[1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9157377, 1.9157377, ..., 1.3211333, 1.3495734,
        1.3780135],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.0463567, 2.0036962,
        1.5628744],
       ...,
       [1.6821629, 1.6383677, 1.6237692, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.5653756, 1.4923834, 1.5069818, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.477785 , 1.5069818, 1.4923834, ..., 2.145897 , 2.145897 ,
        2.145897 ]], dtype=float32), array([[ 0.66027313,  0.66027313,  0.67487156, ...,  0.7949909 ,
         0.7949909 ,  0.80921096],
       [ 0.8208558 ,  0.8208558 ,  0.8354542 , ...,  0.7381106 ,
         0.7381106 ,  0.7381106 ],
       [ 1.0544306 ,  1.0544306 ,  1.0398322 , ...,  0.823431  ,
         0.823431  ,  0.823431  ],
       ...,
       [ 0.2807141 ,  0.23691882,  0.2223204 , ...,  0.06976743,
         0.05554737,  0.05554737],
       [ 0.2807141 ,  0.29531252,  0.29531252, ...,  0.02710724,
         0.02710724,  0.02710724],
       [ 0.16392669,  0.13472985,  0.12013142, ..., -0.12931348,
        -0.14353354, -0.15775362]], dtype=float32), array([[ 1.8135487e+00,  1.7551551e+00,  1.7113597e+00, ...,
        -1.2931348e-01, -1.0087335e-01, -1.3328948e-03],
       [ 1.6237692e+00,  1.7697535e+00,  1.8135487e+00, ...,
         1.4086775e-01,  2.2618815e-01,  2.4040821e-01],
       [-6.8278205e-01, -6.3898683e-01, -6.3898683e-01, ...,
        -5.2747530e-01, -4.8481512e-01, -4.7059506e-01],
       ...,
       [ 9.3764323e-01,  1.2442101e+00,  1.4485881e+00, ...,
         4.9636951e-01,  5.3902972e-01,  4.8214942e-01],
       [ 1.4193913e+00,  1.3463992e+00,  1.5069818e+00, ...,
         3.6838892e-01,  3.8260898e-01,  4.8214942e-01],
       [ 1.6237692e+00,  1.5653756e+00,  1.4485881e+00, ...,
         6.9545043e-01,  6.5279019e-01,  6.3857013e-01]], dtype=float32), array([[-1.6462783 , -1.6462783 , -1.6462783 , ..., -0.95407724,
        -0.95407724, -0.95407724],
       [-1.6316798 , -1.6316798 , -1.6316798 , ..., -0.9256371 ,
        -0.9256371 , -0.9256371 ],
       [-1.6316798 , -1.6316798 , -1.6316798 , ..., -0.9256371 ,
        -0.91141707, -0.91141707],
       ...,
       [-0.68278205, -0.68278205, -0.78497106, ..., -1.309579  ,
        -1.309579  , -1.309579  ],
       [-0.68278205, -0.7995695 , -1.0477428 , ..., -1.3522393 ,
        -1.3237991 , -1.309579  ],
       [-0.7995695 , -1.018546  , -0.9017585 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ]], dtype=float32), array([[1.8719424 , 1.857344  , 1.7697535 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [1.8427455 , 1.8427455 , 1.8427455 , ..., 2.103237  , 2.103237  ,
        2.103237  ],
       [1.8427455 , 0.99603695, 1.2588086 , ..., 2.0463567 , 2.0321364 ,
        2.0321364 ],
       ...,
       [0.5726826 , 0.58728105, 0.58728105, ..., 1.2215928 , 1.1647125 ,
        1.1362724 ],
       [0.38290307, 0.3975015 , 0.41209993, ..., 1.264253  , 1.264253  ,
        1.264253  ],
       [0.48509204, 0.49969047, 0.49969047, ..., 1.2215928 , 1.2215928 ,
        1.2215928 ]], dtype=float32), array([[-1.4127034 , -1.3835065 , -1.2521207 , ..., -0.7692165 ,
        -0.34261447, -0.243074  ],
       [-1.1353334 , -1.1645303 , -1.1499318 , ..., -0.29995427,
        -0.29995427, -0.2857342 ],
       [ 0.71866685,  0.791659  ,  0.5142889 , ...,  1.3211333 ,
         1.4064537 ,  1.4348938 ],
       ...,
       [-1.4710971 , -1.500294  , -1.5294908 , ..., -1.2526988 ,
        -1.2526988 , -1.2526988 ],
       [-1.6024829 , -1.6024829 , -1.6024829 , ..., -1.3380191 ,
        -1.309579  , -1.2811389 ],
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.2811389 ,
        -1.2811389 , -1.2811389 ]], dtype=float32), array([[ 1.4631865 ,  1.4631865 ,  1.4631865 , ...,  1.9041561 ,
         1.9041561 ,  1.918376  ],
       [ 1.5215802 ,  1.5215802 ,  1.4923834 , ...,  1.918376  ,
         1.918376  ,  1.9325962 ],
       [ 1.477785  ,  1.477785  ,  1.477785  , ...,  1.918376  ,
         1.918376  ,  1.9325962 ],
       ...,
       [-0.39081356, -0.42001042, -0.43460885, ..., -0.29995427,
        -0.22885394, -0.20041381],
       [-0.49300256, -0.5367978 , -0.5221994 , ..., -0.3710546 ,
        -0.4137148 , -0.4137148 ],
       [-0.33241987, -0.25942776, -0.2740262 , ..., -0.35683453,
        -0.35683453, -0.34261447]], dtype=float32), None, None, None, None, None, array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ...,  0.0413273 ,
         0.06976743,  0.09820756],
       ...,
       [-0.50760096, -0.50760096, -0.50760096, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 28]]), array([[ 1, 18, 26]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 18]]), array([[ 1, 18, 24]]), None, None, None, None, None, array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Assorted fruits sitting in stands at a farmers market.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A beautiful woman bending over on a tennis court.\n', 'Find me an everyday image that matches the given caption: A smiley face being made out of some fruit.\n', 'Find me an everyday image that matches the given caption: Lady under an umbrella walking in the rain.\n', 'Find me an everyday image that matches the given caption: There is a group of cows walking in the dirt.\n', 'Find me an everyday image that matches the given caption: A tabby cat sitting near a green bench.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Sandwich sitting on counter table in a restaurant.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 88/6000 [03:02<3:19:16,  2.02s/it]                                                   {'loss': 1.8861, 'grad_norm': 198.48593139648438, 'learning_rate': 8.8e-06, 'epoch': 0.01}
  1%|â–         | 88/6000 [03:02<3:19:16,  2.02s/it][2025-11-13 01:33:59,845] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  25507,  15625,    624],
        [151643, 151643, 151643,  ...,  23790,   6802,    624],
        [151643, 151643, 151643,  ...,  10074,   6059,    624],
        ...,
        [151643, 151643, 151643,  ...,  19507,  15743,    624],
        [151643, 151643, 151643,  ...,    806,   1424,    624],
        [151643, 151643, 151643,  ...,  17233,   3786,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ["Find me an everyday image that matches the given caption: A little child brushing it's teeth with an orange tooth brush.\n", 'Find me an everyday image that matches the given caption: A man poses next to his motorcycle in a vintage picture.\n', 'Find me an everyday image that matches the given caption: A family gathered in the living room enjoying drinks and snacks on Christmas Day.\n', 'Find me an everyday image that matches the given caption: A citi bus parked in the street with buildings in teh background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A truck filled with a pile of yellow bananas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat is sitting in front of a television.\n', 'Find me an everyday image that matches the given caption: The oranges, grapefruit and other produce are displayed at the market.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A living room with a bright red couch next to a yellow wall.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man standing over a little girl holding a baseball bat.\n', 'Find me an everyday image that matches the given caption: The man is walking and holding a kite in his hand.\n', 'Find me an everyday image that matches the given caption: A bunch of tiny pancakes are cooking together.\n'], 'images': [[None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=369x256 at 0x7F32727B4BE0>], [None], [<PIL.Image.Image image mode=RGB size=323x256 at 0x7F32727B4160>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727B7550>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727B7670>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B7010>], [None], [None], [None]], 'pixel_values': [None, None, None, None, array([[-0.15723877,  0.3537062 ,  1.0836275 , ...,  0.48214942,
         0.5532498 ,  0.6954504 ],
       [ 0.38290307,  0.3975015 ,  0.52888733, ...,  1.4491138 ,
         1.6055346 ,  1.7619553 ],
       [ 1.3172023 ,  1.2880055 ,  1.2004149 , ...,  1.5344343 ,
         1.5913146 ,  1.6339747 ],
       ...,
       [ 0.4704936 ,  0.4558952 ,  0.48509204, ..., -0.78343654,
        -0.42793486,  0.36838892],
       [-1.5732862 , -1.5732862 , -1.5732862 , ..., -0.7976566 ,
        -0.78343654, -0.7549964 ],
       [-1.2521207 , -1.2229239 , -1.2667192 , ..., -0.5274753 ,
        -0.54169536, -0.51325524]], dtype=float32), None, array([[ 0.20772196,  0.2223204 ,  0.20772196, ...,  0.52480966,
         0.4963695 ,  0.4963695 ],
       [ 0.2223204 ,  0.20772196,  0.23691882, ...,  0.48214942,
         0.4963695 ,  0.51058954],
       [ 0.09093457,  0.14932826,  0.16392669, ...,  0.38260898,
         0.4252692 ,  0.4252692 ],
       ...,
       [-1.7338688 , -1.7630657 , -1.7922626 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.2521207 , -1.3543098 , -1.6024829 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ]], dtype=float32), None, None, array([[0.33910778, 0.33910778, 0.33910778, ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [0.38290307, 0.3975015 , 0.42669836, ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [0.58728105, 0.58728105, 0.58728105, ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       ...,
       [0.48509204, 0.3975015 , 0.76246214, ..., 1.036732  , 0.93719155,
        0.8376511 ],
       [0.791659  , 0.95224166, 0.7040684 , ..., 0.5390297 , 0.7096705 ,
        0.88031125],
       [0.5580842 , 0.9668401 , 0.8792495 , ..., 0.48214942, 0.61013   ,
        0.5816899 ]], dtype=float32), array([[-1.398105  , -1.398105  , -1.398105  , ..., -1.3380191 ,
        -1.3380191 , -1.3380191 ],
       [-1.3835065 , -1.398105  , -1.4273019 , ..., -1.2526988 ,
        -1.2384787 , -1.2242587 ],
       [-1.6608766 , -1.6608766 , -1.6608766 , ..., -1.2953589 ,
        -1.309579  , -1.3522393 ],
       ...,
       [ 1.0544306 ,  1.0106354 ,  0.9814385 , ...,  0.43948925,
         0.43948925,  0.4110491 ],
       [ 1.098226  ,  1.1274228 ,  1.1566195 , ..., -0.07243322,
        -0.07243322, -0.05821316],
       [ 1.0252337 ,  1.0690291 ,  1.1420212 , ...,  0.0839875 ,
         0.06976743,  0.05554737]], dtype=float32), None, array([[ 0.5726826 ,  0.5142889 ,  0.48509204, ..., -0.18619375,
        -0.10087335,  0.05554737],
       [ 0.36830464,  0.36830464,  0.42669836, ...,  0.6954504 ,
         0.6670103 ,  0.59590995],
       [ 0.38290307,  0.41209993,  0.42669836, ...,  0.16930789,
         0.18352796,  0.24040821],
       ...,
       [-0.39081356, -0.42001042, -0.68278205, ..., -1.309579  ,
        -1.1673783 , -1.2384787 ],
       [-1.018546  , -0.94555384, -0.6973805 , ..., -1.3806794 ,
        -1.4233395 , -1.2242587 ],
       [-0.88716006, -0.72657734, -0.9309554 , ..., -1.2669188 ,
        -1.2526988 , -1.2669188 ]], dtype=float32), None, None, None], 'image_grid_thw': [None, None, None, None, array([[ 1, 18, 26]]), None, array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 24]]), None, None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ["Find me an everyday image that matches the given caption: A little child brushing it's teeth with an orange tooth brush.\n", 'Find me an everyday image that matches the given caption: A man poses next to his motorcycle in a vintage picture.\n', 'Find me an everyday image that matches the given caption: A family gathered in the living room enjoying drinks and snacks on Christmas Day.\n', 'Find me an everyday image that matches the given caption: A citi bus parked in the street with buildings in teh background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A truck filled with a pile of yellow bananas.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat is sitting in front of a television.\n', 'Find me an everyday image that matches the given caption: The oranges, grapefruit and other produce are displayed at the market.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A living room with a bright red couch next to a yellow wall.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man standing over a little girl holding a baseball bat.\n', 'Find me an everyday image that matches the given caption: The man is walking and holding a kite in his hand.\n', 'Find me an everyday image that matches the given caption: A bunch of tiny pancakes are cooking together.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  1%|â–         | 89/6000 [03:04<3:16:02,  1.99s/it]                                                   {'loss': 1.1837, 'grad_norm': 136.92266845703125, 'learning_rate': 8.900000000000001e-06, 'epoch': 0.01}
  1%|â–         | 89/6000 [03:04<3:16:02,  1.99s/it][2025-11-13 01:34:01,754] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  50497,   7406,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    315,  11794,    624],
        [151643, 151643, 151643,  ...,   1008,  15298,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people waling along a street with a luggage cart.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A table with some laptops and arms on it.\n', 'Find me an everyday image that matches the given caption: A bunch of sheep grazing in an open field.\n', 'Find me an everyday image that matches the given caption: A yellow toothbrush placed in a safety handle in a shower.\n', 'Find me an everyday image that matches the given caption: A glass jar next to a ceramic heeled shoe on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skateboarder in grey doing a trick on the side of a ramp.\n', 'Find me an everyday image that matches the given caption: A person is holding a snowboard on a pile of snow.\n', 'Find me an everyday image that matches the given caption: A bowl of soup with chicken, zucchini, tomato, shrimp and other foods.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C61D0>], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F327278A3B0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327278A170>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272789000>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B9A0>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=313x256 at 0x7F3272789960>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272788430>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x354 at 0x7F327278BA60>]], 'pixel_values': [array([[-1.0331444 , -0.9893491 , -0.94555384, ...,  0.29728848,
         0.29728848,  0.28306842],
       [-0.8579632 , -0.8433648 , -0.7557742 , ...,  0.5390297 ,
         0.56746984,  0.61013   ],
       [-0.14264035, -0.12804192, -0.09884507, ..., -0.39949474,
        -0.4421549 , -0.4421549 ],
       ...,
       [-0.39081356, -0.42001042, -0.42001042, ..., -0.6412359 ,
        -0.68389606, -0.68389606],
       [-1.7630657 , -1.7338688 , -1.6024829 , ..., -0.51325524,
        -0.54169536, -0.58435565],
       [-0.4638057 , -0.44920728, -0.4638057 , ..., -0.7692165 ,
        -0.78343654, -0.81187665]], dtype=float32), None, array([[-0.59519154, -0.6243884 , -0.5221994 , ...,  0.09820756,
         0.0413273 , -0.15775362],
       [-0.37621516, -0.14264035, -0.02585294, ...,  0.38260898,
         0.29728848,  0.3257286 ],
       [-0.6243884 , -0.6389868 , -0.59519154, ...,  1.1362724 ,
         1.1362724 ,  1.4064537 ],
       ...,
       [-1.6316798 , -1.704672  , -1.7192703 , ..., -1.1958185 ,
        -1.1673783 , -1.1958185 ],
       [-0.87256163, -0.9747507 , -1.1207349 , ..., -0.89719707,
        -0.89719707, -0.91141707],
       [-1.3251129 , -1.2375224 , -1.3543098 , ..., -0.96829736,
        -1.0536178 , -1.082058  ]], dtype=float32), array([[-1.2229239 , -0.9163569 , -0.94555384, ..., -1.2669188 ,
        -1.309579  , -1.2953589 ],
       [-0.7703726 , -1.1207349 , -1.3689082 , ..., -1.1815984 ,
        -1.1673783 , -1.1673783 ],
       [-1.6170814 , -1.6170814 , -1.5732862 , ..., -0.54169536,
        -0.42793486,  0.46792936],
       ...,
       [ 0.5142889 ,  0.41209993,  0.3537062 , ...,  0.7665507 ,
         0.7665507 ,  0.7665507 ],
       [ 0.85005265,  0.85005265,  0.95224166, ...,  0.9798517 ,
         0.9229715 ,  0.9229715 ],
       [ 0.7478637 ,  0.8062574 ,  0.93764323, ...,  0.85187113,
         0.90875137,  0.9229715 ]], dtype=float32), array([[ 0.01794233,  0.01794233,  0.0617376 , ..., -0.9398572 ,
        -0.89719707, -0.882977  ],
       [ 0.30991095,  0.32450938,  0.3537062 , ..., -0.7265563 ,
        -0.74077636, -0.74077636],
       [-0.37621516, -0.37621516, -0.36161673, ..., -1.1389382 ,
        -1.1247182 , -1.1247182 ],
       ...,
       [ 0.6456747 ,  0.6310763 ,  0.61647785, ..., -0.8260967 ,
        -0.8545369 , -0.86875695],
       [ 0.6456747 ,  0.6456747 ,  0.6456747 , ..., -0.8260967 ,
        -0.8403168 , -0.8545369 ],
       [ 0.5580842 ,  0.54348576,  0.54348576, ..., -0.96829736,
        -0.9825174 , -0.9967375 ]], dtype=float32), array([[-0.303223  , -0.18643562, -0.06964822, ..., -0.882977  ,
        -0.9967375 , -1.2242587 ],
       [ 0.14932826, -0.0550498 ,  0.09093457, ..., -0.5985757 ,
        -0.74077636, -0.68389606],
       [ 0.12013142,  0.2223204 ,  0.29531252, ..., -0.54169536,
        -0.38527465, -0.35683453],
       ...,
       [-0.28862458, -0.09884507,  0.00334391, ..., -0.2857342 ,
        -0.31417432, -0.27151415],
       [-0.42001042, -0.44920728, -0.47840413, ..., -0.34261447,
        -0.4421549 , -0.4421549 ],
       [-0.65358526, -0.6389868 , -0.5805931 , ..., -0.15775362,
        -0.17197368, -0.18619375]], dtype=float32), None, None, None, None, array([[ 1.0398322 ,  1.0398322 ,  1.0398322 , ...,  1.3637935 ,
         1.3637935 ,  1.3780135 ],
       [ 1.1274228 ,  1.1274228 ,  1.1128243 , ...,  1.4206737 ,
         1.4206737 ,  1.4206737 ],
       [ 1.0252337 ,  1.0252337 ,  1.0252337 , ...,  1.3211333 ,
         1.3211333 ,  1.3353534 ],
       ...,
       [-0.87256163, -0.8579632 , -0.7995695 , ..., -0.8260967 ,
        -0.8403168 , -0.8260967 ],
       [-1.0623412 , -1.0477428 , -1.0623412 , ..., -0.8403168 ,
        -0.89719707, -0.9398572 ],
       [-1.0039475 , -0.9893491 , -0.9893491 , ..., -0.9825174 ,
        -0.9967375 , -1.0536178 ]], dtype=float32), array([[ 1.9303361,  1.9303361,  1.9303361, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       [ 1.9303361,  1.9303361,  1.9303361, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       [ 1.9303361,  1.9303361,  1.9303361, ...,  2.145897 ,  2.145897 ,
         2.145897 ],
       ...,
       [-1.7338688, -1.7630657, -1.7484672, ..., -1.4802198, -1.4802198,
        -1.4659997],
       [-1.5148925, -1.5586877, -1.6170814, ..., -1.3522393, -1.2526988,
        -1.309579 ],
       [-1.6608766, -1.6316798, -1.6170814, ..., -1.4091195, -1.3948994,
        -1.3380191]], dtype=float32), None, None, None, array([[1.9303361 , 1.9303361 , 1.9303361 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [1.9303361 , 1.9303361 , 1.9303361 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [1.9303361 , 1.9303361 , 1.9303361 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       ...,
       [0.8792495 , 0.99603695, 1.0106354 , ..., 0.80921096, 0.7381106 ,
        0.85187113],
       [0.89384794, 0.8208558 , 0.5726826 , ..., 0.6670103 , 0.39682904,
        0.6527902 ],
       [1.1128243 , 0.8792495 , 1.0106354 , ..., 0.24040821, 0.8945313 ,
        0.39682904]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 22]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 26, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people waling along a street with a luggage cart.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A table with some laptops and arms on it.\n', 'Find me an everyday image that matches the given caption: A bunch of sheep grazing in an open field.\n', 'Find me an everyday image that matches the given caption: A yellow toothbrush placed in a safety handle in a shower.\n', 'Find me an everyday image that matches the given caption: A glass jar next to a ceramic heeled shoe on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skateboarder in grey doing a trick on the side of a ramp.\n', 'Find me an everyday image that matches the given caption: A person is holding a snowboard on a pile of snow.\n', 'Find me an everyday image that matches the given caption: A bowl of soup with chicken, zucchini, tomato, shrimp and other foods.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 90/6000 [03:06<3:19:04,  2.02s/it]                                                   {'loss': 0.8836, 'grad_norm': 108.13288116455078, 'learning_rate': 9e-06, 'epoch': 0.01}
  2%|â–         | 90/6000 [03:06<3:19:04,  2.02s/it][2025-11-13 01:34:03,854] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   1008,  60766,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: Two baby elephants walk next to water and other elephants.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The semi makes a turn onto the road avoiding a red fire-hydrant.\n', 'Find me an everyday image that matches the given caption: A boat drives though the water with a water skier behind.\n', 'Find me an everyday image that matches the given caption: A guy looking at a small device and wearing ear phones.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: The glazed donut is on wax paper in someone's hand.\n", 'Find me an everyday image that matches the given caption: There are people watching a batter jump up.\n', 'Find me an everyday image that matches the given caption: Two players playing tennis on a tennis court.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727B7850>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272789390>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727B4460>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727892A0>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272789150>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327278AFE0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x277 at 0x7F327278AB30>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B4C0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327278AE90>]], 'pixel_values': [None, array([[-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4659997, -1.4659997,
        -1.4659997],
       ...,
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ...,  0.7096705 ,
         1.2500329 ,  1.2358129 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ...,  1.3637935 ,
         1.4917741 ,  1.4491138 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ...,  0.29728848,
         0.25462827,  0.25462827],
       ...,
       [ 0.38290307,  0.3975015 ,  0.36830464, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.19312355,  0.19312355,  0.14932826, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.14932826,  0.2807141 , -0.06964822, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, None, None, array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.21463387,
        -0.5559154 , -0.49903518],
       [ 1.8281472 ,  1.7989503 ,  1.8427455 , ..., -0.14353354,
        -0.15775362, -0.5274753 ],
       [ 1.9303361 ,  1.8865409 ,  1.9011393 , ..., -0.5274753 ,
        -0.5274753 , -0.4137148 ],
       ...,
       [-1.0331444 , -0.96015227, -0.9017585 , ...,  2.0036962 ,
         1.9894764 ,  2.0463567 ],
       [-1.5440893 , -1.5878845 , -1.6316798 , ...,  2.0605767 ,
         2.0463567 ,  2.117457  ],
       [-0.43460885,  0.14932826,  0.44129676, ...,  2.0179167 ,
         1.9041561 ,  1.9468161 ]], dtype=float32), array([[-1.5732862, -1.6900735, -1.7484672, ..., -1.3522393, -1.2526988,
        -1.2100385],
       [-1.6608766, -1.7630657, -1.6754751, ..., -1.4233395, -1.4233395,
        -1.4091195],
       [-1.4710971, -1.4127034, -1.398105 , ..., -1.2811389, -1.3522393,
        -1.3664593],
       ...,
       [-1.704672 , -1.704672 , -1.704672 , ..., -1.4375596, -1.4375596,
        -1.4375596],
       [-1.704672 , -1.7192703, -1.7192703, ..., -1.3948994, -1.3948994,
        -1.3948994],
       [-1.7192703, -1.7192703, -1.7192703, ..., -1.4091195, -1.4091195,
        -1.4091195]], dtype=float32), array([[-0.60978997, -0.18643562,  0.01794233, ..., -0.5985757 ,
        -0.5985757 , -0.58435565],
       [ 0.13472985,  0.13472985,  0.14932826, ..., -0.5559154 ,
        -0.5559154 , -0.5559154 ],
       [-0.55139625, -0.12804192,  0.09093457, ..., -0.57013553,
        -0.5559154 , -0.5559154 ],
       ...,
       [-0.60978997, -0.5805931 , -0.55139625, ..., -1.2242587 ,
        -1.1815984 , -1.2526988 ],
       [-0.36161673, -0.303223  , -0.25942776, ...,  0.4537093 ,
         0.6670103 ,  0.7949909 ],
       [ 0.3975015 , -0.2740262 , -0.55139625, ..., -0.17197368,
        -0.35683453, -0.32839438]], dtype=float32), array([[-0.68278205, -0.68278205, -0.6681836 , ..., -0.31417432,
        -0.32839438, -0.35683453],
       [-1.5148925 , -1.4564987 , -1.3105145 , ..., -0.61279577,
        -0.68389606, -0.7692165 ],
       [-0.65358526, -0.6389868 , -0.60978997, ..., -0.25729406,
        -0.243074  , -0.243074  ],
       ...,
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), None, None, None, array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.39949474,
        -0.45637497, -0.39949474],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.65545595,
        -0.65545595, -0.669676  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ..., -0.61279577,
        -0.6270158 , -0.7265563 ],
       ...,
       [ 0.3975015 ,  0.5142889 ,  0.6018794 , ...,  2.074797  ,
         2.145897  ,  2.1316772 ],
       [ 1.8865409 ,  1.9303361 ,  1.7989503 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.6675645 ,  1.4631865 ,  1.6237692 , ...,  2.145897  ,
         2.145897  ,  2.145897  ]], dtype=float32), array([[-0.5659947 , -0.87256163, -1.1207349 , ..., -1.1247182 ,
        -1.1389382 , -1.1815984 ],
       [-1.1353334 , -1.1207349 , -1.1791286 , ..., -0.20041381,
        -0.10087335, -0.04399309],
       [-0.47840413, -0.59519154, -0.78497106, ..., -1.2242587 ,
        -1.2526988 , -1.2526988 ],
       ...,
       [-0.14264035, -0.21563247,  0.3975015 , ..., -0.58435565,
        -0.45637497, -0.3710546 ],
       [ 0.00334391,  0.2223204 ,  0.30991095, ..., -0.7265563 ,
        -0.7976566 , -0.54169536],
       [-0.8141679 , -0.88716006, -0.87256163, ...,  1.7477353 ,
         1.7477353 ,  1.7192951 ]], dtype=float32), array([[ 0.5580842 ,  0.61647785,  0.66027313, ...,  0.4537093 ,
         0.48214942,  0.5390297 ],
       [ 0.6456747 ,  0.8646511 ,  1.0544306 , ...,  0.61013   ,
         0.5816899 ,  0.5816899 ],
       [ 1.2150133 ,  1.0398322 ,  0.8354542 , ..., -0.14353354,
         0.26884836,  0.48214942],
       ...,
       [ 0.5142889 ,  0.3975015 ,  0.29531252, ..., -0.51325524,
        -0.68389606, -0.81187665],
       [-0.28862458, -0.3470183 , -0.405412  , ..., -0.882977  ,
        -0.9825174 , -1.1104981 ],
       [ 0.61647785,  0.5726826 ,  0.5580842 , ..., -0.21463387,
        -0.21463387, -0.25729406]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 18]]), array([[ 1, 18, 18]]), None, None, None, array([[ 1, 18, 18]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, None, None, array([[ 1, 20, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: Two baby elephants walk next to water and other elephants.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The semi makes a turn onto the road avoiding a red fire-hydrant.\n', 'Find me an everyday image that matches the given caption: A boat drives though the water with a water skier behind.\n', 'Find me an everyday image that matches the given caption: A guy looking at a small device and wearing ear phones.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: The glazed donut is on wax paper in someone's hand.\n", 'Find me an everyday image that matches the given caption: There are people watching a batter jump up.\n', 'Find me an everyday image that matches the given caption: Two players playing tennis on a tennis court.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 91/6000 [03:08<3:19:12,  2.02s/it]                                                   {'loss': 1.0885, 'grad_norm': 125.99381256103516, 'learning_rate': 9.100000000000001e-06, 'epoch': 0.02}
  2%|â–         | 91/6000 [03:08<3:19:12,  2.02s/it][2025-11-13 01:34:05,873] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  88747,    624],
        [151643, 151643, 151643,  ...,    264,  11968,    624],
        ...,
        [151643, 151643, 151643,  ...,   8630,  31912,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A table that is filled with hot dogs, and a hamburger.\n', 'Find me an everyday image that matches the given caption: A hotdog that is sitting on a plate.\n', 'Find me an everyday image that matches the given caption: A big clock tower sits in the middle of a road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sandwich with spread on the side with chips and a pickle.\n', 'Find me an everyday image that matches the given caption: A fat black cat leaning on a keyboard on the floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two people playing Wii games in a living room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A surfer is out at sea waiting for a wave to come.\n', 'Find me an everyday image that matches the given caption: A group of people that are holding onto sheep.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727B7520>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272788700>], [None], [None], [<PIL.Image.Image image mode=RGB size=660x256 at 0x7F3272789EA0>], [None], [<PIL.Image.Image image mode=RGB size=378x256 at 0x7F327278B0D0>], [<PIL.Image.Image image mode=RGB size=342x256 at 0x7F3272789060>], [<PIL.Image.Image image mode=RGB size=388x256 at 0x7F327278B280>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272788820>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272788AF0>]], 'pixel_values': [array([[ 0.23691882,  0.3975015 ,  0.4704936 , ...,  0.1266477 ,
         0.18352796,  0.05554737],
       [ 0.3537062 ,  0.19312355,  0.09093457, ..., -0.10087335,
         0.02710724,  0.18352796],
       [ 0.20772196,  0.20772196,  0.25151724, ...,  0.0839875 ,
        -0.07243322, -0.2857342 ],
       ...,
       [ 0.42669836,  0.29531252,  0.17852512, ..., -0.7265563 ,
        -0.669676  , -0.65545595],
       [ 0.16392669,  0.17852512,  0.14932826, ..., -0.8545369 ,
        -0.882977  , -0.9256371 ],
       [-0.6389868 , -0.5221994 , -0.55139625, ..., -0.68389606,
        -0.6981161 , -0.7265563 ]], dtype=float32), None, None, None, array([[-0.2302309 , -0.24482933, -0.25942776, ..., -0.42793486,
        -0.42793486, -0.4137148 ],
       [-0.405412  , -0.44920728, -0.49300256, ..., -1.0536178 ,
        -1.067838  , -1.082058  ],
       [-0.37621516, -0.37621516, -0.36161673, ..., -0.29995427,
        -0.27151415, -0.29995427],
       ...,
       [-0.49300256, -0.49300256, -0.50760096, ...,  0.31150854,
         0.28306842,  0.28306842],
       [-0.02585294, -0.04045137, -0.06964822, ...,  0.1266477 ,
         0.09820756,  0.0839875 ],
       [-0.42001042, -0.47840413, -0.5367978 , ...,  0.01288717,
        -0.00133289, -0.00133289]], dtype=float32), None, None, array([[0.33910778, 0.33910778, 0.3537062 , ..., 0.9798517 , 0.9940718 ,
        0.9940718 ],
       [0.42669836, 0.42669836, 0.44129676, ..., 1.0509521 , 1.0509521 ,
        1.0509521 ],
       [0.32450938, 0.32450938, 0.32450938, ..., 0.8945313 , 0.8945313 ,
        0.8945313 ],
       ...,
       [0.77706057, 0.8354542 , 0.99603695, ..., 1.6624149 , 1.7903955 ,
        1.7761754 ],
       [0.7478637 , 0.7478637 , 0.7040684 , ..., 1.3780135 , 1.3495734 ,
        1.3353534 ],
       [0.9668401 , 1.0106354 , 0.8646511 , ..., 1.4206737 , 1.3922336 ,
        1.3637935 ]], dtype=float32), None, array([[-0.25942776, -0.68278205, -0.8579632 , ..., -1.1531583 ,
        -1.082058  , -1.067838  ],
       [ 0.26611567,  0.41209993,  0.5726826 , ..., -0.78343654,
        -0.58435565, -0.42793486],
       [-0.11344349, -0.15723877, -0.25942776, ..., -1.1958185 ,
        -0.9398572 , -0.6412359 ],
       ...,
       [ 0.7478637 ,  0.76246214,  0.76246214, ...,  1.0509521 ,
         1.0651721 ,  1.0651721 ],
       [ 0.9084464 ,  0.8646511 ,  0.8646511 , ...,  0.93719155,
         0.9514116 ,  0.9514116 ],
       [ 0.8354542 ,  0.8354542 ,  0.8354542 , ...,  0.7665507 ,
         0.80921096,  0.80921096]], dtype=float32), array([[ 0.9668401 ,  1.0106354 ,  1.0252337 , ..., -0.65545595,
        -0.6981161 , -0.7976566 ],
       [-0.94555384, -0.9747507 , -1.018546  , ..., -1.1531583 ,
        -1.1531583 , -1.1673783 ],
       [ 1.098226  ,  1.1566195 ,  1.171218  , ...,  0.25462827,
        -0.51325524, -0.6412359 ],
       ...,
       [ 0.7332653 ,  0.71866685,  0.68947   , ...,  0.61013   ,
         0.59590995,  0.5816899 ],
       [ 0.0617376 ,  0.12013142,  0.13472985, ...,  0.7807708 ,
         0.75233066,  0.7381106 ],
       [ 1.3318007 ,  1.2880055 ,  1.2588086 , ...,  0.72389054,
         0.7096705 ,  0.7096705 ]], dtype=float32), array([[-1.4419003 , -1.398105  , -1.3251129 , ..., -0.882977  ,
        -0.91141707, -0.95407724],
       [-1.3689082 , -1.3835065 , -1.4710971 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.2375224 , -1.1791286 , -1.1061366 , ..., -0.81187665,
        -0.8260967 , -0.8545369 ],
       ...,
       [-1.2229239 , -1.2521207 , -1.3105145 , ..., -1.082058  ,
        -1.1389382 , -1.1815984 ],
       [-1.1061366 , -1.0769397 , -1.1061366 , ..., -1.2242587 ,
        -1.4375596 , -1.2526988 ],
       [-1.1207349 , -1.1061366 , -1.1207349 , ..., -1.2953589 ,
        -1.3380191 , -1.3664593 ]], dtype=float32), None, None, array([[ 1.9011393 ,  1.9157377 ,  1.9157377 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       [ 1.9157377 ,  1.9157377 ,  1.9011393 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       [ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       ...,
       [-1.2959161 , -1.2521207 , -1.2521207 , ..., -0.5985757 ,
        -0.5985757 , -0.61279577],
       [-1.4419003 , -1.4564987 , -1.4273019 , ..., -0.669676  ,
        -0.61279577, -0.58435565],
       [-1.1499318 , -1.1061366 , -1.0769397 , ..., -0.31417432,
        -0.25729406, -0.18619375]], dtype=float32), array([[ 0.61647785,  0.61647785,  0.61647785, ...,  0.823431  ,
         0.8376511 ,  0.8376511 ],
       [ 0.67487156,  0.67487156,  0.67487156, ...,  0.9514116 ,
         0.9514116 ,  0.9514116 ],
       [ 0.61647785,  0.61647785,  0.6310763 , ...,  0.8660912 ,
         0.8660912 ,  0.8376511 ],
       ...,
       [ 0.30991095,  0.29531252,  0.30991095, ..., -0.39949474,
        -0.4137148 , -0.42793486],
       [ 0.61647785,  0.61647785,  0.61647785, ..., -0.2857342 ,
        -0.2857342 , -0.25729406],
       [ 0.68947   ,  0.67487156,  0.66027313, ..., -0.5274753 ,
        -0.5274753 , -0.5274753 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 24]]), None, None, None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 48]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A table that is filled with hot dogs, and a hamburger.\n', 'Find me an everyday image that matches the given caption: A hotdog that is sitting on a plate.\n', 'Find me an everyday image that matches the given caption: A big clock tower sits in the middle of a road.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sandwich with spread on the side with chips and a pickle.\n', 'Find me an everyday image that matches the given caption: A fat black cat leaning on a keyboard on the floor.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two people playing Wii games in a living room.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A surfer is out at sea waiting for a wave to come.\n', 'Find me an everyday image that matches the given caption: A group of people that are holding onto sheep.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 92/6000 [03:10<3:20:37,  2.04s/it]                                                   {'loss': 0.9139, 'grad_norm': 117.99816131591797, 'learning_rate': 9.200000000000002e-06, 'epoch': 0.02}
  2%|â–         | 92/6000 [03:10<3:20:37,  2.04s/it][2025-11-13 01:34:07,950] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,    264,   6118,    624],
        [151643, 151643, 151643,  ...,   7579,  18010,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  89773,  30232,    624],
        [151643, 151643, 151643,  ...,  10799,   1965,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A young boy riding a skate board on the walkway of a park.\n', 'Find me an everyday image that matches the given caption: This is a computer on top of a light wood desk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Empty stylish kitchen and living room with big picture windows.\n', 'Find me an everyday image that matches the given caption: A woman holds a huge plate of cheese pizza.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man riding a horse through a field.\n', 'Find me an everyday image that matches the given caption: Some chairs sit next to a umbrella in front of some water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cows seen before a majestic, misty green mountain.\n', 'Find me an everyday image that matches the given caption: Modern well lit bathroom in residential home under construction.\n', 'Find me an everyday image that matches the given caption: Windsurfers in the ocean during a fairly heavy breeze.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of skiers heading down a snowy slope.\n', 'Find me an everyday image that matches the given caption: A dog with his snout near a cake on a coffee table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B940>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x344 at 0x7F32727899C0>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278A170>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272789D80>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278BBE0>]], 'pixel_values': [None, None, array([[-1.6754751 , -1.6754751 , -1.6900735 , ..., -1.3522393 ,
        -1.3664593 , -1.3806794 ],
       [-1.7630657 , -1.6900735 , -1.6754751 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.3689082 , -1.4856956 , -1.6170814 , ..., -1.3948994 ,
        -1.3522393 , -1.3522393 ],
       ...,
       [-1.1499318 , -1.1645303 , -1.1645303 , ..., -0.5985757 ,
        -0.5985757 , -0.5985757 ],
       [-1.398105  , -1.3251129 , -1.2375224 , ..., -0.5985757 ,
        -0.5985757 , -0.61279577],
       [-1.193727  , -1.2375224 , -1.2521207 , ..., -0.669676  ,
        -0.669676  , -0.669676  ]], dtype=float32), None, None, array([[ 0.38290307,  0.3975015 ,  0.41209993, ...,  0.7949909 ,
         0.823431  ,  0.85187113],
       [ 0.6456747 ,  0.6456747 ,  0.67487156, ...,  1.0651721 ,
         1.0936122 ,  1.1078323 ],
       [ 0.2807141 ,  0.2807141 ,  0.2807141 , ...,  1.2500329 ,
         1.264253  ,  1.264253  ],
       ...,
       [-0.82876635, -0.6973805 , -0.6681836 , ..., -0.669676  ,
        -0.68389606, -0.7265563 ],
       [-1.193727  , -1.2229239 , -1.193727  , ..., -0.31417432,
        -0.39949474, -0.34261447],
       [-1.0477428 , -1.1207349 , -0.8433648 , ..., -0.32839438,
        -0.21463387, -0.18619375]], dtype=float32), None, None, array([[1.0252337 , 1.0252337 , 1.0252337 , ..., 0.3257286 , 0.33994877,
        0.33994877],
       [1.1420212 , 1.1566195 , 1.2004149 , ..., 0.39682904, 0.4252692 ,
        0.4537093 ],
       [1.2150133 , 1.2296118 , 1.2442101 , ..., 0.4537093 , 0.46792936,
        0.48214942],
       ...,
       [1.8135487 , 1.8281472 , 1.8281472 , ..., 1.2784731 , 1.264253  ,
        1.264253  ],
       [1.8865409 , 1.8865409 , 1.8719424 , ..., 1.2926931 , 1.2784731 ,
        1.2784731 ],
       [1.8281472 , 1.857344  , 1.857344  , ..., 1.2358129 , 1.2215928 ,
        1.2215928 ]], dtype=float32), None, None, None, array([[-0.9747507 , -0.8433648 , -0.7995695 , ..., -0.5559154 ,
        -0.58435565, -0.5985757 ],
       [-0.88716006, -0.7411758 , -0.7703726 , ..., -1.0251776 ,
        -0.7692165 , -0.6270158 ],
       [ 0.38290307,  0.12013142, -0.20103405, ..., -0.6981161 ,
        -0.7692165 , -0.71233624],
       ...,
       [ 0.8354542 ,  0.85005265,  0.85005265, ...,  0.63857013,
         0.6527902 ,  0.68123037],
       [ 0.9084464 ,  0.89384794,  0.89384794, ...,  0.6954504 ,
         0.7096705 ,  0.7381106 ],
       [ 0.8208558 ,  0.8208558 ,  0.8354542 , ...,  0.6954504 ,
         0.7096705 ,  0.7096705 ]], dtype=float32), None, None, array([[-0.9747507 , -0.9747507 , -0.9747507 , ...,  1.1647125 ,
         1.1647125 ,  1.1789327 ],
       [-0.9163569 , -0.9309554 , -0.9309554 , ...,  1.2215928 ,
         1.2215928 ,  1.2215928 ],
       [-0.88716006, -0.88716006, -0.88716006, ...,  1.3211333 ,
         1.3211333 ,  1.3211333 ],
       ...,
       [-1.0915381 , -1.1061366 , -1.1791286 , ..., -1.3380191 ,
        -1.3380191 , -1.3380191 ],
       [-1.2667192 , -1.2521207 , -1.2667192 , ..., -1.4517797 ,
        -1.4375596 , -1.3948994 ],
       [-1.4127034 , -1.3251129 , -1.3397113 , ..., -1.4091195 ,
        -1.4802198 , -1.4802198 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 24]]), None, None, None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A young boy riding a skate board on the walkway of a park.\n', 'Find me an everyday image that matches the given caption: This is a computer on top of a light wood desk.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Empty stylish kitchen and living room with big picture windows.\n', 'Find me an everyday image that matches the given caption: A woman holds a huge plate of cheese pizza.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man riding a horse through a field.\n', 'Find me an everyday image that matches the given caption: Some chairs sit next to a umbrella in front of some water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cows seen before a majestic, misty green mountain.\n', 'Find me an everyday image that matches the given caption: Modern well lit bathroom in residential home under construction.\n', 'Find me an everyday image that matches the given caption: Windsurfers in the ocean during a fairly heavy breeze.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of skiers heading down a snowy slope.\n', 'Find me an everyday image that matches the given caption: A dog with his snout near a cake on a coffee table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 93/6000 [03:12<3:20:59,  2.04s/it]                                                   {'loss': 0.7371, 'grad_norm': 112.68257904052734, 'learning_rate': 9.3e-06, 'epoch': 0.02}
  2%|â–         | 93/6000 [03:12<3:20:59,  2.04s/it][2025-11-13 01:34:09,999] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,   8600,    624],
        [151643, 151643, 151643,  ...,   1852,  12060,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: Six donuts inside an open Dunkin' Donut box.\n", 'Find me an everyday image that matches the given caption: A man is flying a kite on the beach on a clear day.\n', 'Find me an everyday image that matches the given caption: People at a baseball game with the batter ready to swing.\n', 'Find me an everyday image that matches the given caption: A plate of pastries being served on a table with other items of food.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A truck is stopped at a stop light on an empty highway.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small heard of sheep staring at the camera through the mist.\n', 'Find me an everyday image that matches the given caption: Three surfers wearing we suits are riding the same wave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=385x256 at 0x7F327277E740>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277D360>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327277DF00>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277DE40>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F327277F2B0>], [<PIL.Image.Image image mode=RGB size=387x256 at 0x7F327277F3A0>], [<PIL.Image.Image image mode=RGB size=375x256 at 0x7F327277F100>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F327277F250>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F610>]], 'pixel_values': [array([[-1.6316798 , -1.5878845 , -1.5440893 , ..., -1.1958185 ,
        -1.1958185 , -1.1815984 ],
       [-1.4710971 , -1.4710971 , -1.4856956 , ..., -1.2100385 ,
        -1.2100385 , -1.2100385 ],
       [-1.4856956 , -1.4710971 , -1.4564987 , ..., -1.2669188 ,
        -1.2669188 , -1.2669188 ],
       ...,
       [-1.704672  , -1.5732862 , -1.5878845 , ..., -0.11509342,
         0.5390297 ,  0.4537093 ],
       [ 0.14932826, -0.405412  , -1.3105145 , ..., -1.4802198 ,
        -1.3806794 , -1.1531583 ],
       [ 0.29531252, -0.78497106, -1.7922626 , ..., -1.1958185 ,
        -1.4802198 , -1.2100385 ]], dtype=float32), array([[ 0.44129676,  0.4704936 ,  0.49969047, ..., -0.45637497,
        -0.4421549 , -0.45637497],
       [ 0.7478637 ,  0.7332653 ,  0.71866685, ..., -0.42793486,
        -0.4421549 , -0.42793486],
       [ 0.5726826 ,  0.5726826 ,  0.6018794 , ..., -0.29995427,
        -0.29995427, -0.29995427],
       ...,
       [ 0.49969047,  0.5726826 ,  0.6310763 , ..., -1.1673783 ,
        -1.1389382 , -1.1247182 ],
       [-0.12804192, -0.12804192, -0.14264035, ..., -1.1531583 ,
        -1.1673783 , -1.1673783 ],
       [-0.36161673, -0.39081356, -0.42001042, ..., -1.2242587 ,
        -1.2384787 , -1.2384787 ]], dtype=float32), array([[-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.3806794 ,
        -1.3806794 , -1.3664593 ],
       [-1.6754751 , -1.6754751 , -1.6754751 , ..., -1.3522393 ,
        -1.3522393 , -1.3380191 ],
       [-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.3664593 ,
        -1.3664593 , -1.3522393 ],
       ...,
       [ 0.30991095,  0.23691882,  0.17852512, ..., -1.2953589 ,
        -1.3237991 , -1.3237991 ],
       [ 0.2807141 ,  0.25151724,  0.14932826, ..., -1.3237991 ,
        -1.3380191 , -1.3806794 ],
       [ 0.10553299, -0.0550498 , -0.6973805 , ..., -1.2669188 ,
        -1.2669188 , -1.2669188 ]], dtype=float32), None, None, None, None, array([[-1.0769397 , -0.87256163, -0.7411758 , ...,  1.0509521 ,
         1.0082918 ,  1.022512  ],
       [-0.7557742 , -0.87256163, -0.82876635, ...,  1.0509521 ,
         1.0651721 ,  1.0793922 ],
       [-1.2813176 , -1.0331444 , -0.02585294, ...,  1.1647125 ,
         1.1789327 ,  1.1647125 ],
       ...,
       [ 0.7040684 ,  0.7332653 ,  0.7478637 , ...,  1.1078323 ,
         1.0793922 ,  1.0509521 ],
       [ 0.7332653 ,  0.7332653 ,  0.7332653 , ...,  1.0936122 ,
         1.0793922 ,  1.0509521 ],
       [ 0.67487156,  0.7040684 ,  0.7040684 , ...,  0.9229715 ,
         0.88031125,  0.8660912 ]], dtype=float32), None, array([[ 0.01794233, -0.2302309 ,  0.14932826, ..., -1.3237991 ,
        -1.1104981 , -0.6981161 ],
       [ 0.44129676,  0.01794233,  0.3975015 , ..., -0.8260967 ,
        -0.882977  , -0.7549964 ],
       [-0.15723877, -0.15723877, -0.18643562, ..., -0.68389606,
        -0.9825174 , -0.9256371 ],
       ...,
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -0.882977  ,
        -0.9256371 , -0.95407724],
       [-1.0477428 , -1.3105145 , -1.4856956 , ..., -1.3237991 ,
        -1.3664593 , -1.3237991 ],
       [-1.5732862 , -1.5732862 , -1.5732862 , ..., -0.9967375 ,
        -1.0251776 , -1.0393977 ]], dtype=float32), array([[-1.7776641 , -1.7338688 , -1.7922626 , ...,  0.7949909 ,
         1.1647125 ,  1.2215928 ],
       [-1.7922626 , -1.6608766 , -1.6316798 , ...,  1.5059941 ,
         1.463334  ,  1.4348938 ],
       [-1.7776641 , -1.7338688 , -1.7922626 , ..., -0.22885394,
        -0.18619375, -0.10087335],
       ...,
       [-1.0769397 , -1.0915381 , -1.0915381 , ..., -0.669676  ,
        -0.669676  , -0.669676  ],
       [-1.0769397 , -1.0623412 , -1.0769397 , ..., -0.5985757 ,
        -0.61279577, -0.61279577],
       [-1.0769397 , -1.1207349 , -1.1499318 , ..., -0.6270158 ,
        -0.6270158 , -0.6270158 ]], dtype=float32), array([[ 1.0690291,  1.0690291,  1.0544306, ...,  1.2926931,  1.2926931,
         1.2926931],
       [ 1.0544306,  1.0544306,  1.0398322, ...,  1.3211333,  1.3211333,
         1.3211333],
       [ 1.2004149,  1.2004149,  1.1858164, ..., -1.0393977, -1.1815984,
        -1.1389382],
       ...,
       [-1.5294908, -1.5294908, -1.5294908, ..., -1.3237991, -1.309579 ,
        -1.309579 ],
       [-1.5294908, -1.5294908, -1.5294908, ..., -1.3237991, -1.3237991,
        -1.3237991],
       [-1.5294908, -1.5294908, -1.5440893, ..., -1.3237991, -1.309579 ,
        -1.309579 ]], dtype=float32), array([[ 0.76246214,  0.8646511 ,  0.9668401 , ...,  0.6527902 ,
         0.72389054,  0.72389054],
       [ 0.66027313,  0.7478637 ,  0.8208558 , ..., -0.20041381,
         0.33994877,  0.4963695 ],
       [ 0.791659  ,  0.76246214,  0.6456747 , ...,  0.68123037,
         0.72389054,  0.7381106 ],
       ...,
       [ 0.16392669,  0.10553299,  0.14932826, ...,  0.31150854,
         0.25462827,  0.21196808],
       [ 0.00334391,  0.0617376 ,  0.13472985, ...,  0.14086775,
         0.26884836,  0.25462827],
       [ 0.01794233,  0.03254076,  0.0617376 , ...,  0.22618815,
         0.1266477 ,  0.06976743]], dtype=float32), None, None, array([[-1.7484672e+00, -1.7484672e+00, -1.7484672e+00, ...,
        -1.4517797e+00, -1.4517797e+00, -1.4517797e+00],
       [-1.7484672e+00, -1.7484672e+00, -1.7338688e+00, ...,
        -1.4517797e+00, -1.4517797e+00, -1.4375596e+00],
       [-1.7484672e+00, -1.7484672e+00, -1.7484672e+00, ...,
        -1.4517797e+00, -1.4517797e+00, -1.4517797e+00],
       ...,
       [-4.4920728e-01, -3.1782144e-01, -3.3241987e-01, ...,
         1.4086775e-01,  5.5547368e-02, -1.3328948e-03],
       [ 1.1858164e+00,  9.9603695e-01,  7.1866685e-01, ...,
        -8.6653285e-02,  9.8207563e-02,  1.9774802e-01],
       [-5.3679782e-01, -5.0760096e-01, -5.2219939e-01, ...,
         5.5547368e-02,  2.7107235e-02,  1.2887171e-02]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, None, None, None, array([[ 1, 18, 24]]), None, array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', "Find me an everyday image that matches the given caption: Six donuts inside an open Dunkin' Donut box.\n", 'Find me an everyday image that matches the given caption: A man is flying a kite on the beach on a clear day.\n', 'Find me an everyday image that matches the given caption: People at a baseball game with the batter ready to swing.\n', 'Find me an everyday image that matches the given caption: A plate of pastries being served on a table with other items of food.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A truck is stopped at a stop light on an empty highway.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small heard of sheep staring at the camera through the mist.\n', 'Find me an everyday image that matches the given caption: Three surfers wearing we suits are riding the same wave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 94/6000 [03:14<3:21:00,  2.04s/it]                                                   {'loss': 1.228, 'grad_norm': 664.9187622070312, 'learning_rate': 9.4e-06, 'epoch': 0.02}
  2%|â–         | 94/6000 [03:14<3:21:00,  2.04s/it][2025-11-13 01:34:12,041] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  16217,  13702,    624],
        [151643, 151643, 151643,  ...,    264,   8968,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  15198,  19145,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A large long train on a track near some tall buildings.\n', 'Find me an everyday image that matches the given caption: The black kitten is sitting inside of a bag.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bench sitting in a room beside a table with brochures on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baby in a padded play area playing with a remote and a metal pot.\n', 'Find me an everyday image that matches the given caption: Pancackes with sliced strawberries and jelly on it.\n', 'Find me an everyday image that matches the given caption: Cluttered dining room with a family of dolls in a doll house.\n', 'Find me an everyday image that matches the given caption: Two woman and a little girl sitting on a bench.\n', 'Find me an everyday image that matches the given caption: A computer sits on in front of a television set.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A parking meter with no time left on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A photo of two people next to a birthday cake.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272788820>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277CEE0>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277EC50>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F327277FB20>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327277DC60>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F327277ED70>], [None]], 'pixel_values': [None, None, array([[-0.3470183 ,  0.07633615,  1.1128243 , ..., -1.1247182 ,
        -1.0109575 , -0.96829736],
       [ 1.0106354 ,  1.4339896 ,  1.3901944 , ...,  1.9468161 ,
         1.9041561 ,  1.8472759 ],
       [ 0.13472985,  0.12013142, -0.06964822, ...,  1.2500329 ,
         1.1220524 ,  0.9798517 ],
       ...,
       [ 1.6967614 ,  1.6091708 ,  1.6091708 , ...,  0.38260898,
         0.36838892,  0.36838892],
       [ 0.68947   ,  0.791659  ,  0.93764323, ..., -0.6270158 ,
        -0.65545595, -0.3710546 ],
       [ 1.477785  ,  1.2880055 ,  1.4339896 , ..., -0.17197368,
        -0.12931348, -0.10087335]], dtype=float32), None, array([[-0.5221994 , -0.6973805 , -0.8141679 , ..., -0.7265563 ,
        -0.8545369 , -0.7549964 ],
       [ 0.5142889 ,  0.03254076, -0.08424664, ...,  1.0082918 ,
         0.56746984, -0.15775362],
       [-0.47840413, -0.2740262 , -0.68278205, ..., -0.7549964 ,
        -0.68389606, -0.7265563 ],
       ...,
       [-1.4273019 , -1.3689082 , -1.398105  , ..., -1.067838  ,
        -1.0109575 , -1.0109575 ],
       [-1.4419003 , -1.3251129 , -1.2959161 , ..., -1.0536178 ,
        -1.0393977 , -1.0393977 ],
       [-1.3105145 , -1.3105145 , -1.3105145 , ..., -1.1247182 ,
        -1.1104981 , -1.0393977 ]], dtype=float32), None, None, None, None, None, array([[ 0.00334391,  0.8646511 ,  0.54348576, ..., -0.4137148 ,
        -0.31417432, -0.61279577],
       [-0.18643562, -0.37621516, -0.37621516, ..., -0.71233624,
        -0.58435565, -0.4421549 ],
       [ 1.0106354 ,  0.76246214,  1.2150133 , ..., -1.1389382 ,
        -0.7976566 , -0.3710546 ],
       ...,
       [ 0.3537062 ,  0.77706057,  0.8208558 , ..., -0.4137148 ,
        -0.4137148 , -0.4137148 ],
       [ 0.93764323,  1.0252337 ,  1.0690291 , ..., -1.1247182 ,
        -1.067838  , -1.0536178 ],
       [-0.87256163, -0.82876635, -0.82876635, ..., -0.57013553,
        -0.5559154 , -0.5559154 ]], dtype=float32), array([[-0.5221994 , -0.5221994 , -0.50760096, ..., -1.1247182 ,
        -1.1389382 , -1.1531583 ],
       [-0.60978997, -0.6243884 , -0.59519154, ..., -1.1673783 ,
        -1.1815984 , -1.1815984 ],
       [-0.405412  , -0.405412  , -0.42001042, ..., -1.0536178 ,
        -1.082058  , -1.082058  ],
       ...,
       [ 0.14932826,  0.17852512,  0.20772196, ..., -0.54169536,
        -0.57013553, -0.5985757 ],
       [ 0.07633615,  0.07633615,  0.12013142, ..., -0.7549964 ,
        -0.74077636, -0.74077636],
       [ 0.09093457,  0.12013142,  0.13472985, ..., -0.68389606,
        -0.71233624, -0.74077636]], dtype=float32), None, array([[-1.7338688 , -1.7338688 , -1.7338688 , ...,  0.05554737,
         0.05554737,  0.05554737],
       [-1.7192703 , -1.7192703 , -1.7338688 , ...,  0.09820756,
         0.09820756,  0.09820756],
       [-1.7338688 , -1.7338688 , -1.7338688 , ...,  0.06976743,
         0.06976743,  0.0839875 ],
       ...,
       [-0.59519154, -0.11344349, -0.28862458, ..., -0.10087335,
        -0.49903518, -0.51325524],
       [ 0.3975015 ,  0.10553299, -0.11344349, ..., -0.38527465,
        -0.39949474, -0.6412359 ],
       [-0.55139625,  0.03254076,  0.00334391, ..., -0.38527465,
        -0.68389606,  0.09820756]], dtype=float32), array([[ 0.7040684 ,  0.7040684 ,  0.71866685, ...,  1.1504925 ,
         1.1647125 ,  1.1789327 ],
       [ 0.8646511 ,  0.8354542 ,  0.8646511 , ...,  1.264253  ,
         1.264253  ,  1.264253  ],
       [ 0.93764323,  0.93764323,  0.95224166, ...,  1.2926931 ,
         1.3069133 ,  1.3211333 ],
       ...,
       [-1.4273019 , -1.3689082 , -1.3251129 , ..., -0.9398572 ,
        -0.9398572 , -1.0109575 ],
       [-1.1499318 , -1.1061366 , -1.0331444 , ..., -0.49903518,
        -0.49903518, -0.5274753 ],
       [-0.9747507 , -0.96015227, -0.94555384, ..., -1.2526988 ,
        -1.2669188 , -1.1673783 ]], dtype=float32), None], 'image_grid_thw': [None, None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 28]]), None, None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A large long train on a track near some tall buildings.\n', 'Find me an everyday image that matches the given caption: The black kitten is sitting inside of a bag.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A bench sitting in a room beside a table with brochures on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baby in a padded play area playing with a remote and a metal pot.\n', 'Find me an everyday image that matches the given caption: Pancackes with sliced strawberries and jelly on it.\n', 'Find me an everyday image that matches the given caption: Cluttered dining room with a family of dolls in a doll house.\n', 'Find me an everyday image that matches the given caption: Two woman and a little girl sitting on a bench.\n', 'Find me an everyday image that matches the given caption: A computer sits on in front of a television set.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A parking meter with no time left on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A photo of two people next to a birthday cake.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 95/6000 [03:16<3:19:28,  2.03s/it]                                                   {'loss': 0.5557, 'grad_norm': 85.0340805053711, 'learning_rate': 9.5e-06, 'epoch': 0.02}
  2%|â–         | 95/6000 [03:16<3:19:28,  2.03s/it][2025-11-13 01:34:14,035] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  31415,   4935,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,  31419,  16448],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,  19212,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A woman raising her arms up so she can serve a tennis ball.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A little girl that is on a tennis court with a racquet.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The miniature horse is standing on the red chair.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baseball hitter swings and prepares to run.\n', 'Find me an everyday image that matches the given caption: Two blue headed birds sit on tree branch.\n', 'Find me an everyday image that matches the given caption: A little boy dressed in a costume .\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skateboarder riding at the edge of a bowl.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272789390>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272789000>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277C940>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277DF30>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F327277E290>], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F327277C9D0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277C1C0>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F327277FDC0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=328x256 at 0x7F327277F4F0>], [None]], 'pixel_values': [None, array([[ 0.93764323,  0.9668401 ,  0.9230448 , ...,  1.1931527 ,
         1.1931527 ,  1.1931527 ],
       [ 0.7040684 ,  0.67487156,  0.66027313, ...,  1.036732  ,
         1.0651721 ,  1.0651721 ],
       [ 0.6310763 ,  0.6456747 ,  0.67487156, ...,  1.1647125 ,
         1.2215928 ,  1.2073728 ],
       ...,
       [-1.4710971 , -1.4564987 , -1.4273019 , ..., -1.1673783 ,
        -1.1247182 , -1.1247182 ],
       [-1.2229239 , -1.2813176 , -1.3689082 , ..., -1.4517797 ,
        -1.4802198 , -1.4802198 ],
       [-1.5732862 , -1.5294908 , -1.4856956 , ...,  0.25462827,
         0.46792936,  0.5532498 ]], dtype=float32), array([[ 0.04713918,  0.04713918,  0.04713918, ...,  1.1220524 ,
         1.1220524 ,  1.1220524 ],
       [ 0.07633615,  0.07633615,  0.07633615, ...,  1.022512  ,
         1.022512  ,  1.0082918 ],
       [ 0.13472985,  0.13472985,  0.13472985, ...,  1.1078323 ,
         1.1078323 ,  1.1078323 ],
       ...,
       [ 0.10553299,  0.0617376 ,  0.10553299, ...,  0.48214942,
         0.8376511 ,  0.8660912 ],
       [ 0.9814385 ,  1.1274228 ,  1.1420212 , ...,  1.2073728 ,
         0.63857013,  0.46792936],
       [-0.33241987,  0.66027313,  0.8646511 , ...,  0.43948925,
         0.5816899 ,  0.63857013]], dtype=float32), None, array([[-1.3835065 , -1.3397113 , -1.3251129 , ..., -0.17197368,
         0.1266477 , -0.08665328],
       [-1.2959161 , -1.3397113 , -1.3689082 , ..., -0.45637497,
        -0.25729406, -0.35683453],
       [-1.2229239 , -1.0623412 , -1.1353334 , ..., -0.81187665,
        -0.6981161 , -0.61279577],
       ...,
       [-1.2375224 , -1.3689082 , -1.4710971 , ..., -1.2811389 ,
        -1.2242587 , -1.2100385 ],
       [-1.500294  , -1.500294  , -1.4564987 , ..., -1.4802198 ,
        -1.4517797 , -1.3948994 ],
       [-1.398105  , -1.4419003 , -1.4564987 , ..., -1.4091195 ,
        -1.4233395 , -1.4375596 ]], dtype=float32), array([[-0.96015227, -0.14264035,  0.38290307, ...,  1.5486543 ,
         1.5486543 ,  1.5628744 ],
       [ 0.32450938,  0.3537062 ,  0.33910778, ...,  1.6197547 ,
         1.6339747 ,  1.6624149 ],
       [-0.06964822,  0.30991095,  0.52888733, ...,  1.4917741 ,
         1.5059941 ,  1.5202142 ],
       ...,
       [-1.3251129 , -1.3251129 , -1.3397113 , ..., -0.74077636,
        -0.7265563 , -0.71233624],
       [-1.2813176 , -1.2813176 , -1.2813176 , ..., -0.7692165 ,
        -0.7692165 , -0.78343654],
       [-1.398105  , -1.398105  , -1.398105  , ..., -0.78343654,
        -0.7549964 , -0.7265563 ]], dtype=float32), array([[-1.5440893 , -1.5440893 , -1.5440893 , ..., -0.6981161 ,
        -0.669676  , -0.6412359 ],
       [-1.4419003 , -1.4419003 , -1.4273019 , ..., -0.6270158 ,
        -0.6270158 , -0.61279577],
       [-1.4710971 , -1.4710971 , -1.4564987 , ..., -0.35683453,
        -0.34261447, -0.35683453],
       ...,
       [ 0.25151724,  0.19312355,  0.12013142, ..., -0.8260967 ,
        -0.9256371 , -0.95407724],
       [-0.42001042, -0.72657734, -0.8579632 , ..., -1.3237991 ,
        -1.309579  , -1.2953589 ],
       [-1.3397113 , -1.2959161 , -1.2521207 , ..., -1.309579  ,
        -1.3237991 , -1.3237991 ]], dtype=float32), array([[ 0.44129676,  0.58728105,  0.49969047, ..., -0.35683453,
        -0.3710546 , -0.4137148 ],
       [ 0.23691882,  0.09093457, -0.08424664, ..., -0.07243322,
        -0.08665328, -0.08665328],
       [ 0.66027313,  0.8354542 ,  0.7478637 , ..., -0.22885394,
        -0.22885394, -0.20041381],
       ...,
       [ 0.791659  ,  0.791659  ,  0.77706057, ...,  0.06976743,
         0.05554737,  0.02710724],
       [ 0.14932826,  0.23691882,  0.14932826, ..., -0.18619375,
        -0.21463387, -0.25729406],
       [ 0.6018794 ,  0.61647785,  0.6456747 , ..., -0.15775362,
        -0.17197368, -0.18619375]], dtype=float32), array([[-0.9309554 , -0.9163569 , -0.9017585 , ..., -0.8403168 ,
        -0.81187665, -0.81187665],
       [-0.6243884 , -0.59519154, -0.50760096, ..., -1.3237991 ,
        -1.4233395 , -1.4802198 ],
       [-0.72657734, -0.7119789 , -0.68278205, ..., -0.7265563 ,
        -0.6981161 , -0.68389606],
       ...,
       [-1.5440893 , -1.5732862 , -1.5732862 , ..., -0.6981161 ,
        -0.7265563 , -0.74077636],
       [ 0.3537062 ,  0.32450938,  0.30991095, ..., -0.71233624,
        -0.7265563 , -0.7692165 ],
       [-0.0550498 , -0.12804192, -0.14264035, ..., -1.0251776 ,
        -1.0536178 , -1.082058  ]], dtype=float32), None, array([[-1.7484672 , -1.7484672 , -1.7484672 , ..., -1.4659997 ,
        -1.4091195 , -1.1247182 ],
       [ 0.20772196, -1.4127034 , -1.7922626 , ..., -0.669676  ,
        -1.1815984 , -1.3237991 ],
       [-1.7630657 , -1.7630657 , -1.7630657 , ..., -1.4233395 ,
        -1.4375596 , -1.4517797 ],
       ...,
       [-1.7630657 , -1.7630657 , -1.7338688 , ..., -1.4659997 ,
        -1.4659997 , -1.4517797 ],
       [-1.7630657 , -1.7630657 , -1.7630657 , ..., -1.3948994 ,
        -1.4091195 , -1.3948994 ],
       [-1.7922626 , -1.7922626 , -1.7776641 , ..., -1.4375596 ,
        -1.4517797 , -1.4517797 ]], dtype=float32), None, None, None, array([[-0.11344349, -0.24482933, -0.3470183 , ...,  1.1078323 ,
         1.0651721 ,  0.85187113],
       [ 0.42669836, -0.18643562, -1.1353334 , ...,  1.1789327 ,
         0.33994877, -0.04399309],
       [ 0.04713918, -0.02585294,  0.04713918, ...,  1.0651721 ,
         0.8376511 , -0.10087335],
       ...,
       [-1.398105  , -1.3543098 , -1.2813176 , ..., -1.1958185 ,
        -1.1958185 , -1.1958185 ],
       [ 0.10553299,  0.30991095,  0.68947   , ..., -1.2242587 ,
        -1.2669188 , -1.2242587 ],
       [-1.4564987 , -1.4419003 , -1.4273019 , ..., -1.0962781 ,
        -1.0109575 , -0.9398572 ]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), None, array([[ 1, 28, 18]]), None, None, None, array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A woman raising her arms up so she can serve a tennis ball.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A little girl that is on a tennis court with a racquet.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The miniature horse is standing on the red chair.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baseball hitter swings and prepares to run.\n', 'Find me an everyday image that matches the given caption: Two blue headed birds sit on tree branch.\n', 'Find me an everyday image that matches the given caption: A little boy dressed in a costume .\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skateboarder riding at the edge of a bowl.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 96/6000 [03:18<3:20:50,  2.04s/it]                                                   {'loss': 0.5476, 'grad_norm': 80.62564086914062, 'learning_rate': 9.600000000000001e-06, 'epoch': 0.02}
  2%|â–         | 96/6000 [03:18<3:20:50,  2.04s/it][2025-11-13 01:34:16,107] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,     88,   3082,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,  12884,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A few animals roaming about a fenced in grassy area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man and a woman riding on horses near some water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plate layered with gravy, potatoes, beef, orange peppers and lettuce leaves on top.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Man with glasses demonstrates how to use the Nintendo Wii.\n', 'Find me an everyday image that matches the given caption: A young man rides his skateboard across the street in a city.\n', 'Find me an everyday image that matches the given caption: A person on a beach flying a kite high above the sky.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727C5750>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727C4250>], [None], [<PIL.Image.Image image mode=RGB size=455x256 at 0x7F32727C6A10>], [None], [<PIL.Image.Image image mode=RGB size=256x382 at 0x7F32727C4340>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F32727C4730>], [None], [<PIL.Image.Image image mode=RGB size=287x256 at 0x7F32727C6E00>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727C7310>], [<PIL.Image.Image image mode=RGB size=256x444 at 0x7F32727C44C0>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727C7E50>], [<PIL.Image.Image image mode=RGB size=350x256 at 0x7F32727C4460>]], 'pixel_values': [array([[-1.7630657 , -1.7484672 , -1.704672  , ..., -0.89719707,
        -0.89719707, -0.86875695],
       [-1.6462783 , -1.6754751 , -1.5878845 , ..., -0.8403168 ,
        -0.89719707, -0.91141707],
       [-1.0331444 , -1.1353334 , -1.2229239 , ..., -0.10087335,
        -0.05821316, -0.02977302],
       ...,
       [-0.7995695 , -1.1645303 , -0.9893491 , ..., -0.47059506,
        -0.39949474, -0.51325524],
       [-0.36161673, -0.405412  , -0.405412  , ...,  0.18352796,
        -0.02977302, -0.20041381],
       [-0.43460885, -0.39081356, -0.50760096, ..., -0.6270158 ,
        -0.35683453, -0.49903518]], dtype=float32), array([[ 1.4047928 ,  1.3609976 ,  1.2880055 , ...,  1.8188357 ,
         1.8046155 ,  1.7761754 ],
       [ 1.3609976 ,  1.3755959 ,  1.3463992 , ...,  1.8472759 ,
         1.8472759 ,  1.8614956 ],
       [ 1.5215802 ,  1.5507771 ,  1.5799739 , ...,  1.7192951 ,
         1.7335151 ,  1.7477353 ],
       ...,
       [-1.2521207 , -1.1353334 , -1.0623412 , ..., -0.5559154 ,
        -0.7549964 , -0.7692165 ],
       [-0.08424664, -0.02585294, -0.12804192, ..., -1.1389382 ,
        -1.2669188 , -1.2669188 ],
       [-0.303223  , -0.08424664,  0.12013142, ..., -0.74077636,
        -0.57013553, -0.81187665]], dtype=float32), None, array([[-1.0769397 , -1.0623412 , -1.0623412 , ...,  0.09820756,
         0.11242763,  0.14086775],
       [-1.0915381 , -1.0915381 , -1.0623412 , ...,  0.16930789,
         0.15508783,  0.11242763],
       [-0.6973805 , -0.6681836 , -0.6389868 , ..., -0.882977  ,
        -0.882977  , -0.86875695],
       ...,
       [-1.7776641 , -1.7776641 , -1.7484672 , ..., -1.309579  ,
        -1.2669188 , -1.2669188 ],
       [-1.1353334 , -1.1645303 , -1.1207349 , ..., -1.3806794 ,
        -1.4802198 , -1.4802198 ],
       [-1.7776641 , -1.7776641 , -1.7484672 , ..., -1.1815984 ,
        -1.2669188 , -1.2953589 ]], dtype=float32), None, array([[-0.18643562, -0.18643562, -0.15723877, ..., -0.4421549 ,
        -0.47059506, -0.48481512],
       [-0.21563247, -0.12804192,  0.17852512, ..., -0.81187665,
        -0.91141707, -0.65545595],
       [ 0.2223204 ,  0.14932826,  0.12013142, ..., -0.7265563 ,
        -0.7976566 , -0.8403168 ],
       ...,
       [-0.9893491 , -1.0039475 , -0.94555384, ..., -0.10087335,
        -0.12931348, -0.18619375],
       [-0.9309554 , -0.55139625, -0.33241987, ..., -0.47059506,
        -0.39949474, -0.25729406],
       [-0.405412  , -0.43460885, -0.36161673, ..., -0.32839438,
        -0.34261447, -0.39949474]], dtype=float32), array([[ 0.5580842 ,  0.5726826 ,  0.58728105, ..., -0.12931348,
        -0.15775362, -0.12931348],
       [ 0.5726826 ,  0.58728105,  0.48509204, ..., -0.11509342,
        -0.14353354, -0.15775362],
       [ 0.44129676,  0.42669836,  0.42669836, ..., -0.11509342,
        -0.12931348, -0.14353354],
       ...,
       [ 1.0398322 ,  1.0106354 ,  0.9668401 , ...,  1.0936122 ,
         1.0936122 ,  1.1362724 ],
       [ 0.9814385 ,  0.9814385 ,  1.0106354 , ...,  1.0651721 ,
         1.0082918 ,  0.9798517 ],
       [ 0.9668401 ,  0.9668401 ,  0.9668401 , ...,  0.96563166,
         0.93719155,  1.0082918 ]], dtype=float32), None, array([[-0.09884507, -0.09884507, -0.09884507, ...,  1.264253  ,
         1.2784731 ,  1.2784731 ],
       [ 0.0617376 ,  0.03254076,  0.00334391, ...,  1.1931527 ,
         1.1931527 ,  1.1931527 ],
       [ 0.6456747 ,  0.52888733,  0.33910778, ...,  1.1362724 ,
         1.1789327 ,  1.2073728 ],
       ...,
       [ 0.791659  ,  0.791659  ,  0.8792495 , ...,  1.036732  ,
         1.0793922 ,  1.0509521 ],
       [ 0.93764323,  0.89384794,  0.8646511 , ...,  0.7807708 ,
         0.7665507 ,  0.7381106 ],
       [ 0.8646511 ,  0.8354542 ,  0.85005265, ...,  0.52480966,
         0.51058954,  0.4963695 ]], dtype=float32), array([[-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.6608766 , -1.6900735 , -1.7338688 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [ 0.76246214,  0.67487156,  0.6456747 , ...,  1.022512  ,
         1.0082918 ,  1.022512  ],
       [-1.1353334 , -1.0623412 ,  0.14932826, ...,  0.9798517 ,
         0.96563166,  0.93719155],
       [ 0.5726826 ,  0.6310763 ,  0.67487156, ...,  0.8660912 ,
         0.8660912 ,  0.88031125]], dtype=float32), array([[-1.6754751, -1.6754751, -1.6754751, ..., -1.3380191, -1.3380191,
        -1.3380191],
       [-1.6608766, -1.6608766, -1.6900735, ..., -1.3806794, -1.3806794,
        -1.3806794],
       [-1.5878845, -1.5878845, -1.5878845, ..., -1.4091195, -1.4091195,
        -1.3948994],
       ...,
       [ 1.2442101,  1.1858164,  1.2004149, ...,  1.5770944,  1.5202142,
         1.5059941],
       [ 1.273407 ,  1.2880055,  1.2588086, ...,  1.5202142,  1.6197547,
         1.690855 ],
       [ 1.3463992,  1.2442101,  1.1274228, ...,  1.5913146,  1.6481948,
         1.6481948]], dtype=float32), None, None, None, array([[ 0.4704936 ,  0.3975015 ,  0.41209993, ..., -1.2526988 ,
        -1.3237991 , -1.4517797 ],
       [-1.6900735 , -1.7192703 , -1.6754751 , ..., -1.4233395 ,
        -1.4233395 , -1.4233395 ],
       [-0.8141679 , -0.72657734, -0.65358526, ..., -0.71233624,
        -0.78343654, -0.61279577],
       ...,
       [-1.7484672 , -1.7484672 , -1.7338688 , ..., -1.2669188 ,
        -1.2811389 , -1.2953589 ],
       [-1.6462783 , -1.5586877 , -1.4710971 , ..., -1.4659997 ,
        -1.4802198 , -1.4659997 ],
       [-1.6608766 , -1.7338688 , -1.704672  , ..., -1.4375596 ,
        -1.3948994 , -1.3948994 ]], dtype=float32), array([[ 0.07633615,  0.07633615,  0.07633615, ...,  0.56746984,
         0.5816899 ,  0.5816899 ],
       [ 0.13472985,  0.16392669,  0.19312355, ...,  0.56746984,
         0.5532498 ,  0.5390297 ],
       [ 0.09093457,  0.07633615,  0.07633615, ...,  0.61013   ,
         0.61013   ,  0.61013   ],
       ...,
       [-0.04045137, -0.02585294, -0.02585294, ...,  0.38260898,
         0.38260898,  0.38260898],
       [-0.04045137, -0.04045137, -0.04045137, ...,  0.4537093 ,
         0.4537093 ,  0.4537093 ],
       [-0.04045137, -0.01125452, -0.01125452, ...,  0.4252692 ,
         0.4252692 ,  0.4252692 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 32]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 20]]), array([[ 1, 18, 24]]), array([[ 1, 32, 18]]), None, None, None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A few animals roaming about a fenced in grassy area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man and a woman riding on horses near some water.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A plate layered with gravy, potatoes, beef, orange peppers and lettuce leaves on top.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Man with glasses demonstrates how to use the Nintendo Wii.\n', 'Find me an everyday image that matches the given caption: A young man rides his skateboard across the street in a city.\n', 'Find me an everyday image that matches the given caption: A person on a beach flying a kite high above the sky.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 97/6000 [03:20<3:17:05,  2.00s/it]                                                   {'loss': 1.0765, 'grad_norm': 223.1405029296875, 'learning_rate': 9.7e-06, 'epoch': 0.02}
  2%|â–         | 97/6000 [03:20<3:17:05,  2.00s/it][2025-11-13 01:34:18,023] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  30578,  13994,    624],
        [151643, 151643, 151643,  ...,    264,   1965,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,  23387,    624],
        [151643, 151643, 151643,  ...,    264,  20638,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Technician installing laptops on a curve table in a lecture hall.\n', 'Find me an everyday image that matches the given caption: A couple of hotdogs are laying out on a table.\n', "Find me an everyday image that matches the given caption: A baby holding a slice of orange up to it's mouth.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baseball player standing next to a woman.\n', 'Find me an everyday image that matches the given caption: A man in full gear and helmet snowboarding on a hill.\n', 'Find me an everyday image that matches the given caption: A man cuts a birthday cake for a boy.\n', "Find me an everyday image that matches the given caption: A collection of items one might find in a woman's purse.\n", 'Find me an everyday image that matches the given caption: A man on a skateboard performs a trick for the camera.\n', 'Find me an everyday image that matches the given caption: A small boy with a bat about to hit the ball .\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man takes freshly baked muffins out of the oven.\n', 'Find me an everyday image that matches the given caption: A cat that is laying on a desk near a laptop.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727DB520>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=337x256 at 0x7F327277ED70>], [None], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727D8730>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F327277E3B0>], [None], [None], [<PIL.Image.Image image mode=RGB size=381x256 at 0x7F327277DC60>]], 'pixel_values': [array([[ 0.14932826,  0.14932826,  0.16392669, ...,  0.25462827,
         0.28306842,  0.26884836],
       [ 0.2807141 ,  0.2807141 ,  0.26611567, ...,  0.21196808,
         0.21196808,  0.22618815],
       [ 0.791659  ,  0.76246214,  0.7478637 , ...,  0.1266477 ,
         0.14086775,  0.11242763],
       ...,
       [-0.1718372 , -0.2302309 , -0.2740262 , ..., -1.3380191 ,
        -1.3380191 , -1.3380191 ],
       [ 1.1274228 ,  1.0690291 ,  0.99603695, ..., -1.4375596 ,
        -1.3380191 , -1.3237991 ],
       [-1.0331444 , -1.0331444 , -1.0331444 , ..., -1.3522393 ,
        -1.3664593 , -1.3806794 ]], dtype=float32), None, None, None, array([[ 0.20772196,  0.20772196,  0.2223204 , ...,  0.59590995,
         0.59590995,  0.61013   ],
       [ 0.33910778,  0.33910778,  0.33910778, ...,  0.63857013,
         0.63857013,  0.63857013],
       [ 0.25151724,  0.23691882,  0.23691882, ...,  0.80921096,
         0.823431  ,  0.85187113],
       ...,
       [-0.44920728, -0.49300256, -0.50760096, ..., -1.2953589 ,
        -1.1389382 , -1.2242587 ],
       [-0.33241987, -0.37621516, -0.42001042, ..., -1.4802198 ,
        -1.3806794 , -1.4802198 ],
       [-0.68278205, -0.6681836 , -0.60978997, ..., -1.2811389 ,
        -1.4802198 , -1.4233395 ]], dtype=float32), None, None, None, None, None, None, array([[-1.4273019 , -1.4127034 , -1.3835065 , ..., -1.2384787 ,
        -1.2384787 , -1.2384787 ],
       [-1.4127034 , -1.4127034 , -1.3835065 , ..., -1.1247182 ,
        -1.1247182 , -1.1104981 ],
       [-1.4273019 , -1.4273019 , -1.4273019 , ..., -1.2242587 ,
        -1.1815984 , -1.2100385 ],
       ...,
       [-1.0331444 , -1.0039475 , -1.0039475 , ..., -0.8260967 ,
        -0.8260967 , -0.8260967 ],
       [-1.0623412 , -1.0623412 , -1.0623412 , ..., -0.86875695,
        -0.8545369 , -0.8545369 ],
       [-1.018546  , -1.0039475 , -1.0039475 , ..., -0.8403168 ,
        -0.8403168 , -0.8403168 ]], dtype=float32), array([[ 1.6821629 ,  1.6675645 ,  1.5945723 , ..., -0.12931348,
        -0.05821316, -0.11509342],
       [ 1.9157377 ,  1.9157377 ,  1.9303361 , ..., -0.243074  ,
        -0.22885394, -0.22885394],
       [ 1.9303361 ,  1.9011393 ,  1.857344  , ..., -0.243074  ,
        -0.20041381, -0.22885394],
       ...,
       [-0.9309554 , -0.9309554 , -0.94555384, ...,  1.8188357 ,
         1.875716  ,  1.8188357 ],
       [-0.7119789 , -0.72657734, -0.7411758 , ...,  1.690855  ,
         1.7903955 ,  1.8472759 ],
       [-1.0039475 , -1.0331444 , -1.0623412 , ...,  1.8330555 ,
         1.8330555 ,  1.7761754 ]], dtype=float32), None, None, array([[ 0.29531252,  0.26611567,  0.20772196, ...,  0.9798517 ,
         0.9940718 ,  0.9940718 ],
       [ 0.29531252,  0.25151724,  0.20772196, ..., -0.34261447,
        -0.3710546 , -0.47059506],
       [ 1.171218  ,  1.1128243 ,  1.171218  , ...,  0.7807708 ,
         0.5816899 ,  0.3257286 ],
       ...,
       [ 0.17852512,  0.0617376 ,  0.14932826, ..., -0.22885394,
        -0.35683453, -0.15775362],
       [ 0.41209993,  0.19312355,  0.00334391, ..., -0.7692165 ,
        -0.9256371 , -0.669676  ],
       [-0.06964822, -0.42001042, -0.1718372 , ..., -0.7692165 ,
        -0.71233624, -0.61279577]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 24]]), None, None, None, None, None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 28]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Technician installing laptops on a curve table in a lecture hall.\n', 'Find me an everyday image that matches the given caption: A couple of hotdogs are laying out on a table.\n', "Find me an everyday image that matches the given caption: A baby holding a slice of orange up to it's mouth.\n", '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A baseball player standing next to a woman.\n', 'Find me an everyday image that matches the given caption: A man in full gear and helmet snowboarding on a hill.\n', 'Find me an everyday image that matches the given caption: A man cuts a birthday cake for a boy.\n', "Find me an everyday image that matches the given caption: A collection of items one might find in a woman's purse.\n", 'Find me an everyday image that matches the given caption: A man on a skateboard performs a trick for the camera.\n', 'Find me an everyday image that matches the given caption: A small boy with a bat about to hit the ball .\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man takes freshly baked muffins out of the oven.\n', 'Find me an everyday image that matches the given caption: A cat that is laying on a desk near a laptop.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 98/6000 [03:22<3:16:15,  2.00s/it]                                                   {'loss': 0.6069, 'grad_norm': 83.57598876953125, 'learning_rate': 9.800000000000001e-06, 'epoch': 0.02}
  2%|â–         | 98/6000 [03:22<3:16:15,  2.00s/it][2025-11-13 01:34:20,005] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,  16359,    624],
        ...,
        [151643, 151643, 151643,  ...,  47053,   3390,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    315,  19653,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Sheep in a field of purple lavender and grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A white fire hydrant next to a newspaper dispenser.\n', 'Find me an everyday image that matches the given caption: A person in the middle of public taking a selfie.\n', 'Find me an everyday image that matches the given caption: A red tiled kitchen with a small stove and fridge.\n', 'Find me an everyday image that matches the given caption: A vase sitting on top of a roof top.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: THERE ARE PEOPLE THAT ARE ON A MOTOR BIKE.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A table that has a plate of food, a bottle of wine, and a container of rice.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327278B4C0>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F327277DF30>], [None], [<PIL.Image.Image image mode=RGB size=256x309 at 0x7F327277E290>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277F130>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277DCF0>], [<PIL.Image.Image image mode=RGB size=256x361 at 0x7F327277F100>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=365x256 at 0x7F327277D900>], [<PIL.Image.Image image mode=RGB size=256x320 at 0x7F327277F9A0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F327277D7B0>], [None]], 'pixel_values': [array([[-0.88716006, -0.0550498 ,  0.09093457, ...,  0.24040821,
         0.15508783,  0.38260898],
       [-1.500294  , -1.3397113 , -1.3251129 , ...,  0.22618815,
        -0.2857342 , -0.68389606],
       [-0.28862458,  0.04713918,  0.07633615, ...,  0.56746984,
         0.9229715 ,  0.29728848],
       ...,
       [-0.6243884 , -0.6243884 , -1.0477428 , ..., -0.96829736,
        -0.96829736, -0.96829736],
       [-0.39081356, -1.1207349 , -1.398105  , ..., -1.1247182 ,
        -1.0962781 , -1.0536178 ],
       [-1.5732862 , -1.6170814 , -1.4856956 , ..., -1.1389382 ,
        -1.1531583 , -1.1673783 ]], dtype=float32), array([[-1.7922626, -1.7922626, -1.7922626, ..., -1.3237991, -1.2811389,
        -1.2811389],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.1815984, -1.1815984,
        -1.1815984],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.2669188, -1.2242587,
        -1.1815984],
       ...,
       [-1.7630657, -1.7776641, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7338688, -1.7484672, -1.7630657, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), None, array([[ 1.7551551 ,  1.7405566 ,  1.7113597 , ...,  1.9752562 ,
         1.9752562 ,  1.9752562 ],
       [ 1.5653756 ,  1.5653756 ,  1.5945723 , ...,  1.9041561 ,
         1.9041561 ,  1.918376  ],
       [ 1.7113597 ,  1.6967614 ,  1.6821629 , ...,  2.0036962 ,
         2.0179167 ,  2.0179167 ],
       ...,
       [ 0.30991095, -0.11344349,  0.00334391, ..., -1.3948994 ,
        -1.4375596 , -1.1531583 ],
       [-0.24482933, -0.06964822,  0.17852512, ..., -1.4375596 ,
        -1.1958185 , -1.2384787 ],
       [ 0.03254076,  0.29531252, -0.04045137, ..., -1.3237991 ,
        -1.1673783 , -0.61279577]], dtype=float32), array([[1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       ...,
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ]], dtype=float32), array([[-0.94555384, -0.94555384, -0.94555384, ..., -1.0109575 ,
        -0.9967375 , -0.9825174 ],
       [-0.7995695 , -0.7995695 , -0.8579632 , ..., -0.96829736,
        -0.9967375 , -0.95407724],
       [-0.88716006, -0.88716006, -0.88716006, ..., -0.9256371 ,
        -0.95407724, -0.95407724],
       ...,
       [-0.87256163, -0.7411758 , -0.7119789 , ..., -0.89719707,
        -0.86875695, -0.882977  ],
       [-1.2959161 , -1.2521207 , -1.2375224 , ..., -0.5985757 ,
        -0.71233624, -0.8260967 ],
       [-0.8141679 , -0.8141679 , -0.7703726 , ..., -0.96829736,
        -0.9256371 , -0.882977  ]], dtype=float32), array([[ 1.0398322 ,  1.0398322 ,  1.0398322 , ...,  1.8188357 ,
         1.8472759 ,  1.8330555 ],
       [ 0.9668401 ,  0.95224166,  0.9230448 , ...,  1.8188357 ,
         1.8188357 ,  1.8188357 ],
       [ 1.0544306 ,  1.0690291 ,  1.1274228 , ..., -0.7549964 ,
        -0.4137148 , -0.49903518],
       ...,
       [ 0.77706057,  0.76246214,  0.8062574 , ...,  0.80921096,
         0.72389054,  0.6527902 ],
       [ 0.48509204,  0.3975015 ,  0.38290307, ...,  1.036732  ,
         1.036732  ,  0.9229715 ],
       [ 0.6310763 ,  0.5726826 ,  0.5142889 , ...,  0.90875137,
         1.1078323 ,  1.2073728 ]], dtype=float32), None, None, None, None, array([[-0.9893491 , -0.9893491 , -0.9747507 , ...,  1.2358129 ,
         1.2358129 ,  1.2358129 ],
       [-0.8433648 , -0.8579632 , -0.9163569 , ...,  1.2500329 ,
         1.2500329 ,  1.2500329 ],
       [-1.0769397 , -1.0769397 , -1.0769397 , ...,  1.3069133 ,
         1.3069133 ,  1.3069133 ],
       ...,
       [-1.6024829 , -1.3543098 , -1.3251129 , ..., -0.5274753 ,
        -0.45637497, -0.45637497],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.58435565,
        -0.6412359 , -0.61279577],
       [-1.3835065 , -1.4419003 , -1.4273019 , ..., -0.49903518,
        -0.5274753 , -0.57013553]], dtype=float32), array([[-0.44920728, -0.42001042, -0.39081356, ..., -0.78343654,
        -0.7976566 , -0.78343654],
       [-0.60978997, -0.59519154, -0.42001042, ..., -0.6270158 ,
        -0.61279577, -0.61279577],
       [-0.4638057 , -0.5367978 , -0.6243884 , ..., -0.5985757 ,
        -0.61279577, -0.61279577],
       ...,
       [ 0.26611567,  0.09093457, -0.0550498 , ..., -0.6412359 ,
        -0.65545595, -0.669676  ],
       [-0.47840413, -0.47840413, -0.43460885, ..., -0.8260967 ,
        -0.669676  , -0.71233624],
       [-0.50760096, -0.55139625, -0.55139625, ..., -0.81187665,
        -0.81187665, -0.8260967 ]], dtype=float32), None, array([[-0.36161673, -0.31782144, -0.28862458, ..., -0.4421549 ,
        -0.49903518, -0.58435565],
       [-0.01125452,  0.12013142,  0.29531252, ...,  1.6055346 ,
         1.477554  ,  1.0509521 ],
       [-0.44920728, -0.39081356, -0.3470183 , ..., -0.04399309,
         0.05554737, -0.20041381],
       ...,
       [-0.24482933, -0.31782144, -0.1718372 , ..., -0.25729406,
        -0.243074  , -0.18619375],
       [-0.59519154, -0.50760096, -0.405412  , ..., -0.31417432,
        -0.32839438, -0.35683453],
       [ 0.01794233, -0.04045137, -0.0550498 , ..., -0.12931348,
        -0.10087335, -0.04399309]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 24]]), array([[ 1, 18, 18]]), None, array([[ 1, 22, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 26, 18]]), None, None, None, None, array([[ 1, 18, 26]]), array([[ 1, 22, 18]]), None, array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Sheep in a field of purple lavender and grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A white fire hydrant next to a newspaper dispenser.\n', 'Find me an everyday image that matches the given caption: A person in the middle of public taking a selfie.\n', 'Find me an everyday image that matches the given caption: A red tiled kitchen with a small stove and fridge.\n', 'Find me an everyday image that matches the given caption: A vase sitting on top of a roof top.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: THERE ARE PEOPLE THAT ARE ON A MOTOR BIKE.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A table that has a plate of food, a bottle of wine, and a container of rice.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 99/6000 [03:24<3:16:37,  2.00s/it]                                                   {'loss': 0.4614, 'grad_norm': 76.5787582397461, 'learning_rate': 9.9e-06, 'epoch': 0.02}
  2%|â–         | 99/6000 [03:24<3:16:37,  2.00s/it][2025-11-13 01:34:22,019] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  13028,   3283,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  31415,  81512,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: This is a picture of a car going by in a very busy city.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Street signs, a blue truck, a tree, and railroad signs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two parking meters sitting on a sidewalk near a building.\n', 'Find me an everyday image that matches the given caption: A tray with avocados, toast and a beverage.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A busy street full of cars and buses with buildings in the background.\n', 'Find me an everyday image that matches the given caption: A desk with a keyboard mouse monitor and a tv.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy holding a tennis racket.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=325x256 at 0x7F32727C7040>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F3272788E80>], [<PIL.Image.Image image mode=RGB size=382x256 at 0x7F32727641C0>], [<PIL.Image.Image image mode=RGB size=325x256 at 0x7F3272767490>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272765BD0>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272766770>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272766110>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727654E0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272766680>], [None]], 'pixel_values': [None, array([[-0.5805931 , -0.60978997, -0.6243884 , ...,  0.8376511 ,
         0.7949909 ,  0.823431  ],
       [ 0.54348576,  0.67487156,  0.77706057, ...,  1.6339747 ,
         1.6624149 ,  1.7477353 ],
       [-0.59519154, -0.55139625, -0.49300256, ...,  1.1647125 ,
         1.1647125 ,  1.1789327 ],
       ...,
       [-1.4273019 , -1.5732862 , -1.6754751 , ..., -1.4091195 ,
        -1.4091195 , -1.3806794 ],
       [-1.6608766 , -1.6754751 , -1.6900735 , ..., -1.0251776 ,
        -0.9256371 , -0.882977  ],
       [-1.6462783 , -1.704672  , -1.704672  , ..., -0.68389606,
        -0.65545595, -0.5559154 ]], dtype=float32), array([[-0.36161673, -0.36161673, -0.36161673, ..., -1.4233395 ,
        -1.4233395 , -1.4091195 ],
       [-0.2740262 , -0.2740262 , -0.2302309 , ..., -1.4375596 ,
        -1.4375596 , -1.4375596 ],
       [-1.0623412 , -1.0769397 , -1.0623412 , ..., -1.4375596 ,
        -1.4375596 , -1.4375596 ],
       ...,
       [ 0.9668401 ,  0.95224166,  0.95224166, ..., -1.4375596 ,
        -1.3664593 , -1.309579  ],
       [ 0.3975015 ,  0.41209993,  0.44129676, ..., -1.3664593 ,
        -1.3522393 , -1.3522393 ],
       [ 0.58728105,  0.61647785,  0.68947   , ..., -1.3806794 ,
        -1.3806794 , -1.3664593 ]], dtype=float32), array([[ 0.2223204 ,  0.2223204 ,  0.2807141 , ...,  0.26884836,
         0.28306842,  0.35416883],
       [ 0.6310763 ,  0.61647785,  0.67487156, ...,  0.7807708 ,
         0.7949909 ,  0.80921096],
       [ 0.25151724,  0.4558952 ,  0.67487156, ...,  0.5816899 ,
         0.59590995,  0.61013   ],
       ...,
       [-1.2229239 , -1.193727  , -1.2375224 , ..., -0.6412359 ,
        -0.65545595, -0.6412359 ],
       [-1.2521207 , -1.2667192 , -1.2813176 , ..., -1.4375596 ,
        -1.4802198 , -1.4517797 ],
       [-1.3397113 , -1.2959161 , -1.2521207 , ..., -0.29995427,
        -0.27151415, -0.25729406]], dtype=float32), array([[-0.7411758 , -0.7557742 , -0.7557742 , ..., -1.2100385 ,
        -1.2100385 , -1.2526988 ],
       [-0.7119789 , -0.6973805 , -0.65358526, ..., -1.2384787 ,
        -1.1815984 , -1.2242587 ],
       [-0.6243884 , -0.6389868 , -0.6243884 , ..., -1.2242587 ,
        -1.2100385 , -1.1958185 ],
       ...,
       [-1.1645303 , -1.1645303 , -1.1353334 , ..., -1.3522393 ,
        -1.4091195 , -1.4091195 ],
       [ 0.00334391,  0.30991095,  0.12013142, ..., -1.3806794 ,
        -1.3380191 , -1.309579  ],
       [-0.9893491 , -0.9893491 , -1.0039475 , ..., -1.3664593 ,
        -1.3664593 , -1.3664593 ]], dtype=float32), None, array([[-1.2959161 , -1.2959161 , -1.2959161 , ...,  0.4963695 ,
         0.4963695 ,  0.4963695 ],
       [-1.2667192 , -1.2667192 , -1.2375224 , ...,  0.5390297 ,
         0.5390297 ,  0.5390297 ],
       [-1.2375224 , -1.2375224 , -1.2375224 , ...,  0.5816899 ,
         0.5816899 ,  0.5816899 ],
       ...,
       [-0.44920728, -0.44920728, -0.44920728, ...,  0.02710724,
         0.01288717,  0.01288717],
       [-0.1718372 , -0.1718372 , -0.1718372 , ...,  0.11242763,
         0.09820756,  0.09820756],
       [-0.24482933, -0.303223  , -0.31782144, ...,  0.02710724,
         0.02710724,  0.02710724]], dtype=float32), None, None, array([[-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988],
       [-1.5586877, -1.5586877, -1.5586877, ..., -1.2384787, -1.2384787,
        -1.2384787],
       [-1.5440893, -1.5440893, -1.5440893, ..., -1.2526988, -1.2669188,
        -1.2669188],
       ...,
       [ 1.8427455,  1.8281472,  1.8135487, ...,  1.1078323,  1.0936122,
         1.1220524],
       [ 1.5799739,  1.5653756,  1.5653756, ...,  2.0179167,  2.0036962,
         1.9894764],
       [ 1.7697535,  1.7259582,  1.652966 , ...,  1.0651721,  1.0793922,
         1.1220524]], dtype=float32), None, None, array([[-0.78497106, -0.8141679 , -0.9163569 , ...,  0.35416883,
         0.9940718 ,  0.8945313 ],
       [-0.9309554 , -0.9747507 , -0.9017585 , ..., -0.65545595,
        -0.4421549 ,  0.24040821],
       [ 0.38290307,  0.42669836,  0.48509204, ...,  0.38260898,
         0.6243501 ,  0.8376511 ],
       ...,
       [-1.2521207 , -0.82876635, -0.4638057 , ..., -0.6270158 ,
        -0.31417432, -0.14353354],
       [-1.5878845 , -1.5732862 , -1.5294908 , ...,  0.823431  ,
         0.7665507 ,  0.4252692 ],
       [-1.5148925 , -1.5440893 , -1.5294908 , ..., -0.71233624,
        -0.96829736, -1.1531583 ]], dtype=float32), array([[-1.3543098 , -1.4856956 , -1.500294  , ..., -0.81187665,
        -0.7692165 , -0.78343654],
       [-1.4856956 , -1.2667192 , -0.9017585 , ..., -1.067838  ,
        -1.2384787 , -1.2811389 ],
       [-1.0769397 , -1.1791286 , -1.0039475 , ...,  0.3257286 ,
         0.19774802, -0.15775362],
       ...,
       [ 0.7478637 ,  0.8646511 ,  0.7478637 , ...,  0.5390297 ,
         0.48214942,  0.52480966],
       [-0.9017585 , -0.9309554 , -1.0039475 , ..., -0.02977302,
        -0.01555296, -0.01555296],
       [-1.0477428 , -1.2521207 , -0.68278205, ..., -0.61279577,
        -0.61279577, -0.669676  ]], dtype=float32), array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       ...,
       [ 0.44129676,  0.4558952 ,  0.4558952 , ..., -0.61279577,
        -0.669676  , -0.6981161 ],
       [-0.7703726 , -0.94555384, -0.94555384, ...,  0.96563166,
         0.9798517 ,  1.022512  ],
       [ 1.3755959 ,  1.2296118 ,  0.71866685, ..., -0.882977  ,
        -0.8403168 , -0.7976566 ]], dtype=float32), None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: This is a picture of a car going by in a very busy city.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Street signs, a blue truck, a tree, and railroad signs.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two parking meters sitting on a sidewalk near a building.\n', 'Find me an everyday image that matches the given caption: A tray with avocados, toast and a beverage.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A busy street full of cars and buses with buildings in the background.\n', 'Find me an everyday image that matches the given caption: A desk with a keyboard mouse monitor and a tv.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young boy holding a tennis racket.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 100/6000 [03:26<3:16:56,  2.00s/it]                                                    {'loss': 0.7659, 'grad_norm': 85.90826416015625, 'learning_rate': 1e-05, 'epoch': 0.02}
  2%|â–         | 100/6000 [03:26<3:16:56,  2.00s/it][2025-11-13 01:34:24,027] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   6249,    883,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A teddy bear holding three boxes of pizza.\n', 'Find me an everyday image that matches the given caption: A room with a taupe rug and large brown sofa with a chimney in the background and other furnitures.\n', 'Find me an everyday image that matches the given caption: Two men dressed in suits holding their cellphones.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An empty train is sitting in a train station.\n', 'Find me an everyday image that matches the given caption: A large slice of pizza on a paper plate.\n', 'Find me an everyday image that matches the given caption: Man on a skateboard preforming a stunt at a skate park.\n', 'Find me an everyday image that matches the given caption: A man in a suit looks into his cel phone camera.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A tabby cat lounges on a cushion set in the middle of a large bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two zebras looking down a small hill at the camera man.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=411x256 at 0x7F32727C44C0>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F32727C7310>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272766E90>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272766A70>], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727677F0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272767760>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272765510>], [None]], 'pixel_values': [array([[-1.2229239 , -1.2229239 , -1.2229239 , ..., -0.32839438,
        -0.32839438, -0.32839438],
       [-1.1791286 , -1.1791286 , -1.193727  , ..., -0.2857342 ,
        -0.2857342 , -0.2857342 ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -0.17197368,
        -0.14353354, -0.20041381],
       ...,
       [-0.37621516, -0.37621516, -0.39081356, ..., -1.067838  ,
        -1.082058  , -1.067838  ],
       [-0.303223  , -0.28862458, -0.31782144, ..., -1.0536178 ,
        -1.067838  , -1.082058  ],
       [-0.47840413, -0.5367978 , -0.5659947 , ..., -1.2384787 ,
        -1.2384787 , -1.2100385 ]], dtype=float32), array([[-0.5659947 , -0.5805931 , -0.25942776, ...,  1.6339747 ,
         1.7903955 ,  1.9041561 ],
       [ 1.0398322 ,  1.2442101 ,  1.3463992 , ...,  1.4917741 ,
         1.477554  ,  1.4348938 ],
       [ 0.01794233,  0.01794233, -0.02585294, ...,  0.7949909 ,
         0.823431  ,  0.85187113],
       ...,
       [-0.8141679 , -0.72657734, -0.68278205, ...,  0.39682904,
         0.56746984,  0.52480966],
       [ 0.5142889 ,  0.41209993,  0.4558952 , ..., -0.4137148 ,
        -0.7692165 , -0.65545595],
       [ 0.13472985,  0.12013142,  0.09093457, ..., -0.21463387,
        -0.17197368,  0.05554737]], dtype=float32), array([[ 0.5142889 ,  0.6018794 ,  0.6310763 , ..., -0.5559154 ,
        -0.5274753 , -0.5559154 ],
       [-0.04045137, -0.24482933, -0.11344349, ...,  0.48214942,
         0.6954504 ,  1.036732  ],
       [ 0.71866685, -0.02585294,  0.0617376 , ..., -0.58435565,
        -0.669676  , -0.65545595],
       ...,
       [-1.3689082 , -1.3251129 , -1.3397113 , ..., -0.7976566 ,
        -0.7976566 , -0.7976566 ],
       [-1.4419003 , -1.4419003 , -1.4419003 , ..., -0.9398572 ,
        -0.9398572 , -0.9398572 ],
       [-1.4419003 , -1.4419003 , -1.4419003 , ..., -0.9825174 ,
        -0.9825174 , -0.9825174 ]], dtype=float32), None, None, None, array([[ 0.16392669,  0.17852512,  0.17852512, ..., -0.8403168 ,
        -0.7976566 , -0.86875695],
       [-0.5659947 , -0.55139625, -0.50760096, ..., -0.81187665,
        -0.7692165 , -0.7976566 ],
       [ 0.13472985,  0.14932826,  0.13472985, ..., -0.7549964 ,
        -0.8260967 , -0.78343654],
       ...,
       [ 0.9230448 ,  1.1858164 ,  0.9814385 , ..., -0.71233624,
        -0.71233624, -0.71233624],
       [ 0.0617376 ,  0.17852512,  0.38290307, ...,  1.2500329 ,
         1.2926931 ,  1.3495734 ],
       [ 0.8646511 ,  1.0398322 ,  1.171218  , ..., -0.7692165 ,
        -0.7692165 , -0.7692165 ]], dtype=float32), None, None, None, None, array([[-1.6316798 , -1.5732862 , -1.4856956 , ..., -0.882977  ,
        -0.7976566 , -0.78343654],
       [-1.5878845 , -1.5440893 , -1.500294  , ..., -1.2669188 ,
        -1.2811389 , -1.2669188 ],
       [-0.12804192, -0.14264035, -0.14264035, ..., -0.08665328,
        -0.07243322, -0.10087335],
       ...,
       [-1.6608766 , -1.6900735 , -1.7192703 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.704672  , -1.7192703 , -1.7338688 , ..., -1.4375596 ,
        -1.4233395 , -1.4233395 ],
       [-1.7192703 , -1.7338688 , -1.7338688 , ..., -1.4375596 ,
        -1.4375596 , -1.4375596 ]], dtype=float32), None, array([[-0.96015227, -1.0623412 , -0.8141679 , ..., -1.3664593 ,
        -1.1815984 , -0.42793486],
       [-1.1499318 , -1.1791286 , -1.2667192 , ..., -0.8403168 ,
        -0.6981161 , -0.669676  ],
       [-0.8141679 , -0.6973805 , -0.65358526, ..., -1.2384787 ,
        -1.2100385 , -1.0536178 ],
       ...,
       [-0.09884507, -0.06964822, -0.06964822, ...,  0.01288717,
         0.01288717,  0.0413273 ],
       [-0.08424664, -0.0550498 , -0.0550498 , ...,  0.01288717,
         0.01288717,  0.02710724],
       [-0.15723877, -0.1718372 , -0.1718372 , ..., -0.01555296,
        -0.04399309, -0.05821316]], dtype=float32), array([[-0.5221994 , -1.018546  , -1.1645303 , ...,  0.15508783,
        -0.243074  , -0.02977302],
       [-1.5440893 , -0.96015227, -0.7995695 , ..., -0.38527465,
        -0.31417432, -0.54169536],
       [-1.4856956 , -1.0915381 , -0.82876635, ..., -0.22885394,
        -0.3710546 , -0.38527465],
       ...,
       [-0.5221994 , -0.49300256, -0.25942776, ..., -0.38527465,
        -0.4137148 , -0.39949474],
       [-0.42001042, -0.36161673, -0.37621516, ..., -0.38527465,
        -0.42793486, -0.48481512],
       [-0.5221994 , -0.50760096, -0.47840413, ..., -0.5559154 ,
        -0.5274753 , -0.57013553]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 30]]), array([[ 1, 18, 18]]), array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 24]]), None, None, None, None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A teddy bear holding three boxes of pizza.\n', 'Find me an everyday image that matches the given caption: A room with a taupe rug and large brown sofa with a chimney in the background and other furnitures.\n', 'Find me an everyday image that matches the given caption: Two men dressed in suits holding their cellphones.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An empty train is sitting in a train station.\n', 'Find me an everyday image that matches the given caption: A large slice of pizza on a paper plate.\n', 'Find me an everyday image that matches the given caption: Man on a skateboard preforming a stunt at a skate park.\n', 'Find me an everyday image that matches the given caption: A man in a suit looks into his cel phone camera.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A tabby cat lounges on a cushion set in the middle of a large bowl.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Two zebras looking down a small hill at the camera man.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 101/6000 [03:28<3:29:15,  2.13s/it]                                                    {'loss': 0.42, 'grad_norm': 68.93431091308594, 'learning_rate': 9.998305084745762e-06, 'epoch': 0.02}
  2%|â–         | 101/6000 [03:28<3:29:15,  2.13s/it][2025-11-13 01:34:26,439] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   3241,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   5426,    624],
        [151643, 151643, 151643,  ...,  16517,   4126,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black bear and child separated by a window.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close up of a dog in a field with a toy truck.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young man playing a video game on a Nintendo Wii.\n', 'Find me an everyday image that matches the given caption: A branch in a vase full of water on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Slice of pizza in a box next to bowl of chili.\n', 'Find me an everyday image that matches the given caption: A group of buildings, one building has a clock.\n', 'Find me an everyday image that matches the given caption: Man riding on carriage lead by a horse.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people saying goodbye outside of a train.\n', 'Find me an everyday image that matches the given caption: An elegant modern living room, with a couch, coffee table, and entertainment center.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=384x256 at 0x7F327277C730>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F32727659C0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F32727663E0>], [<PIL.Image.Image image mode=RGB size=325x256 at 0x7F3272765D20>], [None], [None], [<PIL.Image.Image image mode=RGB size=417x256 at 0x7F3272765A20>], [<PIL.Image.Image image mode=RGB size=256x386 at 0x7F3272767910>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F32727647C0>], [None], [None]], 'pixel_values': [array([[-1.500294  , -1.5440893 , -1.4856956 , ..., -1.2669188 ,
        -1.1247182 , -1.0393977 ],
       [-1.3689082 , -1.3543098 , -1.3689082 , ..., -1.1104981 ,
        -1.1531583 , -1.1673783 ],
       [-1.2813176 , -1.3105145 , -1.4127034 , ..., -1.2953589 ,
        -1.2669188 , -1.2242587 ],
       ...,
       [-0.2740262 , -0.5805931 , -0.7557742 , ...,  0.56746984,
         0.43948925,  0.24040821],
       [ 0.03254076, -0.2302309 , -0.65358526, ...,  0.6527902 ,
         0.22618815, -0.17197368],
       [-0.9163569 , -0.94555384, -0.7557742 , ..., -1.1815984 ,
        -1.0393977 , -0.5274753 ]], dtype=float32), None, array([[-1.7922626, -1.7922626, -1.7338688, ..., -1.4802198, -1.4802198,
        -1.4659997],
       [-1.7776641, -1.7484672, -1.7630657, ..., -1.1958185, -1.1958185,
        -1.1673783],
       [-1.5586877, -1.4710971, -1.3689082, ..., -1.3806794, -1.4517797,
        -1.4802198],
       ...,
       [-1.6754751, -1.6608766, -1.6316798, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), None, array([[-0.14264035, -0.09884507, -0.0550498 , ...,  0.68123037,
         0.72389054,  0.75233066],
       [ 0.38290307,  0.41209993,  0.48509204, ...,  1.022512  ,
         1.0509521 ,  1.0793922 ],
       [ 0.25151724,  0.26611567,  0.30991095, ...,  0.93719155,
         0.96563166,  0.9940718 ],
       ...,
       [-1.704672  , -1.7192703 , -1.7192703 , ..., -1.3664593 ,
        -1.3664593 , -1.3664593 ],
       [-1.7192703 , -1.7192703 , -1.7192703 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.7338688 , -1.7192703 , -1.7192703 , ..., -1.4091195 ,
        -1.3948994 , -1.3948994 ]], dtype=float32), array([[1.9303361 , 1.9157377 , 1.9157377 , ..., 1.7761754 , 1.7477353 ,
        1.7903955 ],
       [1.477785  , 1.2296118 , 1.2588086 , ..., 1.2073728 , 1.2784731 ,
        1.1362724 ],
       [1.9303361 , 1.9157377 , 1.9157377 , ..., 1.9468161 , 1.875716  ,
        1.1647125 ],
       ...,
       [0.09093457, 0.32450938, 0.2807141 , ..., 2.145897  , 2.145897  ,
        2.145897  ],
       [0.33910778, 0.38290307, 0.4704936 , ..., 2.117457  , 2.117457  ,
        2.117457  ],
       [0.58728105, 0.5726826 , 0.5726826 , ..., 2.145897  , 2.145897  ,
        2.145897  ]], dtype=float32), None, None, array([[ 0.791659  ,  0.791659  ,  0.8062574 , ...,  1.4064537 ,
         1.4064537 ,  1.4064537 ],
       [ 0.8208558 ,  0.8208558 ,  0.85005265, ...,  1.4206737 ,
         1.4206737 ,  1.4206737 ],
       [ 0.8062574 ,  0.8062574 ,  0.8062574 , ...,  1.3780135 ,
         1.3780135 ,  1.3780135 ],
       ...,
       [-0.6243884 , -0.6681836 , -0.6973805 , ..., -1.2811389 ,
        -1.1531583 , -1.4091195 ],
       [-0.405412  , -0.42001042, -0.44920728, ..., -1.0251776 ,
        -1.1247182 , -1.1247182 ],
       [-0.39081356, -0.47840413, -0.5367978 , ..., -1.1104981 ,
        -0.9256371 , -1.0109575 ]], dtype=float32), array([[-1.6754751, -1.6754751, -1.6754751, ..., -1.2953589, -1.2953589,
        -1.309579 ],
       [-1.6462783, -1.6462783, -1.6316798, ..., -1.3664593, -1.3664593,
        -1.3664593],
       [-1.7192703, -1.6608766, -1.5878845, ..., -1.1104981, -1.2100385,
        -1.2526988],
       ...,
       [-1.6462783, -1.6462783, -1.6462783, ..., -1.3380191, -1.3380191,
        -1.3380191],
       [-1.5586877, -1.5586877, -1.5732862, ..., -1.3948994, -1.4233395,
        -1.4091195],
       [-1.6316798, -1.6316798, -1.6462783, ..., -1.3806794, -1.3806794,
        -1.3948994]], dtype=float32), None, None, None, array([[1.3901944 , 1.5069818 , 1.4485881 , ..., 0.8660912 , 0.8376511 ,
        0.93719155],
       [0.20772196, 0.3537062 , 0.8792495 , ..., 1.4348938 , 1.4206737 ,
        1.4206737 ],
       [1.3318007 , 1.0398322 , 0.5580842 , ..., 0.68123037, 1.2358129 ,
        1.4348938 ],
       ...,
       [0.8208558 , 0.8208558 , 0.8208558 , ..., 1.0793922 , 1.0651721 ,
        1.0651721 ],
       [0.8646511 , 0.85005265, 0.85005265, ..., 1.022512  , 1.022512  ,
        1.022512  ],
       [0.8208558 , 0.8062574 , 0.8062574 , ..., 1.022512  , 1.022512  ,
        1.022512  ]], dtype=float32), None, None], 'image_grid_thw': [array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 30]]), array([[ 1, 28, 18]]), None, None, None, array([[ 1, 24, 18]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A black bear and child separated by a window.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A close up of a dog in a field with a toy truck.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A young man playing a video game on a Nintendo Wii.\n', 'Find me an everyday image that matches the given caption: A branch in a vase full of water on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Slice of pizza in a box next to bowl of chili.\n', 'Find me an everyday image that matches the given caption: A group of buildings, one building has a clock.\n', 'Find me an everyday image that matches the given caption: Man riding on carriage lead by a horse.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people saying goodbye outside of a train.\n', 'Find me an everyday image that matches the given caption: An elegant modern living room, with a couch, coffee table, and entertainment center.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 102/6000 [03:30<3:24:26,  2.08s/it]                                                    {'loss': 0.4479, 'grad_norm': 221.7256622314453, 'learning_rate': 9.996610169491526e-06, 'epoch': 0.02}
  2%|â–         | 102/6000 [03:30<3:24:26,  2.08s/it][2025-11-13 01:34:28,405] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  18636,  20827,    624],
        [151643, 151643, 151643,  ...,  22360,   7002,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,    279,  16359,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   1965,  27292,  16448]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: An array of fruits and vegetables including bananas, apples, tomatoes, and an eggplant.\n', 'Find me an everyday image that matches the given caption: A captured giraffe looking at a wooden wall.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog sitting in a vehicle with a St. Patrick hat on.\n', 'Find me an everyday image that matches the given caption: A person is walking through the snow on skis.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small dog is walking in a room.\n', 'Find me an everyday image that matches the given caption: A baseball player is swinging at the pitch.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in grey shit holding a small piece of fried food.\n', 'Find me an everyday image that matches the given caption: A herd of long horned cows laying on the grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small dinning table with all red napkins and a red table cloth .\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727657E0>], [<PIL.Image.Image image mode=RGB size=441x256 at 0x7F3272764BB0>], [<PIL.Image.Image image mode=RGB size=456x256 at 0x7F32727678E0>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272766590>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272767850>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272B5FEB0>], [None], [None], [<PIL.Image.Image image mode=RGB size=396x256 at 0x7F3272B5FDC0>], [None]], 'pixel_values': [None, None, array([[-0.39081356, -0.55139625, -0.39081356, ..., -1.1815984 ,
        -1.4091195 , -1.3806794 ],
       [ 0.17852512, -0.21563247, -0.4638057 , ..., -1.309579  ,
        -1.3380191 , -1.3806794 ],
       [-0.12804192, -0.36161673, -0.4638057 , ...,  0.80921096,
         1.0793922 ,  1.1078323 ],
       ...,
       [-0.44920728, -0.44920728, -0.44920728, ...,  0.31150854,
         0.28306842,  0.24040821],
       [-0.2740262 , -0.43460885, -0.39081356, ..., -0.31417432,
        -0.27151415, -0.27151415],
       [-0.5221994 , -0.5221994 , -0.5221994 , ..., -0.29995427,
        -0.32839438, -0.34261447]], dtype=float32), array([[-0.39081356, -0.39081356, -0.39081356, ...,  0.5390297 ,
         0.5390297 ,  0.5532498 ],
       [-0.37621516, -0.37621516, -0.3470183 , ...,  0.5816899 ,
         0.5816899 ,  0.5816899 ],
       [-0.37621516, -0.37621516, -0.37621516, ...,  0.59590995,
         0.59590995,  0.59590995],
       ...,
       [-1.6170814 , -1.6170814 , -1.6024829 , ...,  0.7807708 ,
         0.8660912 ,  0.7665507 ],
       [-0.14264035, -0.1718372 , -0.15723877, ..., -1.309579  ,
        -1.2242587 , -1.2526988 ],
       [-0.20103405, -0.2302309 , -0.20103405, ..., -1.3237991 ,
        -1.2669188 , -1.3806794 ]], dtype=float32), array([[-1.5732862 , -1.5586877 , -1.5440893 , ...,  0.93719155,
         0.90875137,  0.8945313 ],
       [-1.5878845 , -1.5440893 , -1.4710971 , ...,  1.0082918 ,
         1.0082918 ,  0.9940718 ],
       [-1.500294  , -1.4710971 , -1.4564987 , ...,  0.88031125,
         0.8660912 ,  0.88031125],
       ...,
       [-1.5732862 , -1.5732862 , -1.5732862 , ...,  1.0509521 ,
         1.022512  ,  1.0082918 ],
       [-1.5732862 , -1.6024829 , -1.6024829 , ...,  1.0936122 ,
         1.0793922 ,  1.0509521 ],
       [-1.500294  , -1.4710971 , -1.4710971 , ...,  1.0509521 ,
         1.036732  ,  1.0509521 ]], dtype=float32), array([[ 0.2807141 ,  0.2807141 ,  0.2807141 , ...,  1.918376  ,
         1.918376  ,  1.918376  ],
       [ 0.2807141 ,  0.2807141 ,  0.2807141 , ...,  1.8899357 ,
         1.8899357 ,  1.8899357 ],
       [ 0.33910778,  0.33910778,  0.33910778, ...,  1.875716  ,
         1.875716  ,  1.875716  ],
       ...,
       [ 0.5726826 ,  0.52888733,  0.5142889 , ...,  0.36838892,
         0.5816899 ,  0.7665507 ],
       [-0.59519154, -0.88716006, -0.9747507 , ...,  0.0839875 ,
         0.05554737, -0.21463387],
       [ 0.04713918, -0.1718372 , -0.3470183 , ..., -0.9825174 ,
        -1.0109575 , -0.9967375 ]], dtype=float32), None, None, array([[ 0.7040684 ,  1.9303361 ,  1.2004149 , ...,  0.24040821,
         0.22618815,  0.18352796],
       [ 1.1420212 ,  1.6967614 ,  1.5653756 , ..., -0.35683453,
        -0.29995427, -0.10087335],
       [ 0.4704936 ,  0.01794233, -0.28862458, ...,  0.11242763,
         0.36838892,  0.8660912 ],
       ...,
       [-1.6170814 , -1.6608766 , -1.6316798 , ..., -1.2953589 ,
        -1.2953589 , -1.309579  ],
       [-1.5148925 , -1.4856956 , -1.5732862 , ...,  0.88031125,
         0.46792936, -0.11509342],
       [-1.7630657 , -1.6754751 , -1.6608766 , ..., -1.3522393 ,
        -1.3522393 , -1.3522393 ]], dtype=float32), None, None, array([[-1.1499318 , -1.018546  , -0.78497106, ...,  1.1220524 ,
         1.0936122 ,  1.0793922 ],
       [ 0.10553299,  0.09093457,  0.09093457, ...,  1.0936122 ,
         1.0651721 ,  1.0793922 ],
       [ 0.2807141 ,  0.2807141 ,  0.25151724, ...,  1.1931527 ,
         1.1931527 ,  1.1931527 ],
       ...,
       [-0.4638057 , -0.47840413, -0.5221994 , ..., -0.25729406,
        -0.27151415, -0.27151415],
       [-0.50760096, -0.50760096, -0.5221994 , ..., -0.4421549 ,
        -0.39949474, -0.35683453],
       [-0.5367978 , -0.5367978 , -0.5659947 , ..., -0.32839438,
        -0.35683453, -0.3710546 ]], dtype=float32), None, None, array([[-0.49300256, -0.3470183 , -0.24482933, ...,  0.05554737,
        -0.07243322, -0.17197368],
       [-0.8579632 , -0.49300256, -0.6389868 , ..., -0.669676  ,
        -0.47059506, -1.0109575 ],
       [-0.5221994 , -0.39081356, -0.50760096, ..., -0.38527465,
        -0.7549964 , -0.17197368],
       ...,
       [-0.9163569 , -1.018546  , -1.7338688 , ...,  0.09820756,
        -0.71233624, -1.3806794 ],
       [-1.1791286 , -1.1207349 , -1.6608766 , ..., -1.1104981 ,
        -0.91141707, -0.6412359 ],
       [-0.9309554 , -1.0477428 , -1.6900735 , ..., -0.6270158 ,
        -0.91141707, -1.4233395 ]], dtype=float32), None], 'image_grid_thw': [None, None, array([[ 1, 28, 18]]), array([[ 1, 18, 32]]), array([[ 1, 18, 32]]), array([[ 1, 18, 28]]), None, None, array([[ 1, 18, 24]]), None, None, array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 28]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: An array of fruits and vegetables including bananas, apples, tomatoes, and an eggplant.\n', 'Find me an everyday image that matches the given caption: A captured giraffe looking at a wooden wall.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A dog sitting in a vehicle with a St. Patrick hat on.\n', 'Find me an everyday image that matches the given caption: A person is walking through the snow on skis.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small dog is walking in a room.\n', 'Find me an everyday image that matches the given caption: A baseball player is swinging at the pitch.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in grey shit holding a small piece of fried food.\n', 'Find me an everyday image that matches the given caption: A herd of long horned cows laying on the grass.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A small dinning table with all red napkins and a red table cloth .\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 103/6000 [03:32<3:24:07,  2.08s/it]                                                    {'loss': 0.347, 'grad_norm': 81.04212188720703, 'learning_rate': 9.994915254237289e-06, 'epoch': 0.02}
  2%|â–         | 103/6000 [03:32<3:24:07,  2.08s/it][2025-11-13 01:34:30,483] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,  26214,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,   3807,  22172,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A rundown restroom with a broken sink and toilet.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Sandwich in paper on counter with man in background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Black and white photograph of a traffic sign covered in graffiti.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people at a table with a cup.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A train that is going  through a stop sign.\n', 'Find me an everyday image that matches the given caption: A man is sitting on an airplane seat with an electronic device.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A clown driving a tour car with several passengers.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5F8E0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E830>], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272B5E260>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5EC50>], [<PIL.Image.Image image mode=RGB size=537x256 at 0x7F3272B5EF20>], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272B5E8F0>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E380>], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5CCA0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5C880>], [None]], 'pixel_values': [array([[-0.65358526, -0.65358526, -0.65358526, ..., -0.39949474,
        -0.39949474, -0.39949474],
       [-0.4638057 , -0.55139625, -0.5367978 , ..., -0.42793486,
        -0.42793486, -0.42793486],
       [-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.1531583 ,
        -1.1531583 , -1.2669188 ],
       ...,
       [-1.2813176 , -1.3397113 , -1.3397113 , ..., -1.0251776 ,
        -0.9967375 , -0.96829736],
       [-0.9893491 , -1.0477428 , -1.0915381 , ..., -1.067838  ,
        -1.1247182 , -1.0962781 ],
       [ 1.5799739 ,  1.6967614 ,  1.6383677 , ..., -1.1958185 ,
        -1.1389382 , -1.1389382 ]], dtype=float32), None, array([[-1.6608766 , -1.7922626 , -1.7922626 , ..., -0.7265563 ,
        -0.882977  , -1.067838  ],
       [-1.3543098 , -1.3251129 , -1.5732862 , ..., -1.2100385 ,
        -1.2526988 , -1.2384787 ],
       [-1.193727  , -1.2083255 , -1.2229239 , ..., -0.95407724,
        -1.1531583 , -1.1815984 ],
       ...,
       [-0.7119789 , -0.4638057 , -0.6973805 , ...,  0.75233066,
         0.80921096,  0.8376511 ],
       [-0.21563247, -0.2740262 , -0.42001042, ...,  0.4252692 ,
         0.35416883,  0.33994877],
       [-0.405412  , -0.14264035, -0.02585294, ...,  0.6243501 ,
         0.6243501 ,  0.59590995]], dtype=float32), None, array([[-0.24482933, -0.14264035, -0.11344349, ..., -0.34261447,
        -0.32839438, -0.31417432],
       [-0.06964822, -0.01125452, -0.09884507, ..., -0.4421549 ,
        -0.669676  , -0.91141707],
       [ 0.16392669,  0.12013142,  0.07633615, ..., -0.10087335,
        -0.10087335, -0.14353354],
       ...,
       [-1.0623412 , -1.0915381 , -1.1207349 , ..., -1.1673783 ,
        -1.1389382 , -1.1247182 ],
       [-1.018546  , -1.018546  , -1.018546  , ..., -1.0109575 ,
        -1.0109575 , -1.0251776 ],
       [-1.1791286 , -1.1645303 , -1.1645303 , ..., -0.9825174 ,
        -0.96829736, -0.95407724]], dtype=float32), None, array([[-5.3679782e-01, -7.2657734e-01, -7.1197891e-01, ...,
        -4.3993089e-02, -4.3993089e-02, -1.3328948e-03],
       [-6.6818362e-01, -6.6818362e-01, -7.5577420e-01, ...,
        -2.1463387e-01, -2.9995427e-01, -4.1371480e-01],
       [-6.2438840e-01, -6.3898683e-01, -6.0978997e-01, ...,
        -7.2433218e-02, -8.6653285e-02, -7.2433218e-02],
       ...,
       [ 1.6529660e+00,  1.6675645e+00,  1.5653756e+00, ...,
         1.7192951e+00,  1.6908550e+00,  1.7192951e+00],
       [ 1.4631865e+00,  1.5799739e+00,  1.7989503e+00, ...,
         1.7903955e+00,  1.6481948e+00,  1.6197547e+00],
       [ 1.7259582e+00,  1.6675645e+00,  1.6675645e+00, ...,
         1.5770944e+00,  1.6339747e+00,  1.7050750e+00]], dtype=float32), array([[ 0.13472985,  0.01794233, -0.2740262 , ...,  0.15508783,
        -0.02977302,  0.4252692 ],
       [-1.3251129 , -1.0477428 , -1.2521207 , ...,  1.6624149 ,
         1.5628744 ,  1.5486543 ],
       [-0.06964822,  0.6018794 ,  0.9814385 , ..., -0.6270158 ,
        -0.34261447,  0.14086775],
       ...,
       [ 1.1858164 ,  1.1566195 ,  1.1128243 , ...,  0.6243501 ,
         0.56746984,  0.72389054],
       [ 1.2880055 ,  1.4485881 ,  1.5361787 , ...,  0.9514116 ,
         0.9514116 ,  0.90875137],
       [ 0.07633615, -0.02585294, -0.08424664, ...,  0.7807708 ,
         0.7381106 ,  0.7381106 ]], dtype=float32), array([[-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.4659997 ,
        -1.4659997 , -1.4659997 ],
       [-1.7776641 , -1.7922626 , -1.7922626 , ..., -0.89719707,
        -0.8545369 , -0.78343654],
       [-1.7776641 , -1.7776641 , -1.7776641 , ..., -1.2526988 ,
        -1.1815984 , -1.1247182 ],
       ...,
       [-1.704672  , -1.6754751 , -1.6608766 , ..., -1.2526988 ,
        -1.2953589 , -1.2953589 ],
       [-1.1645303 , -1.3251129 , -1.500294  , ..., -1.4233395 ,
        -1.4091195 , -1.4091195 ],
       [-1.6170814 , -1.6024829 , -1.5878845 , ..., -1.2953589 ,
        -1.2669188 , -1.2669188 ]], dtype=float32), None, array([[-1.7776641 , -1.0915381 , -1.6170814 , ...,  0.0839875 ,
        -0.15775362,  0.35416883],
       [-1.6608766 , -1.6024829 , -1.4419003 , ..., -0.39949474,
        -0.35683453, -0.39949474],
       [-1.1207349 , -1.193727  , -1.3835065 , ..., -0.18619375,
        -0.11509342,  0.01288717],
       ...,
       [ 0.2807141 ,  0.26611567,  0.26611567, ...,  0.5532498 ,
         0.5390297 ,  0.5532498 ],
       [ 0.2807141 ,  0.2807141 ,  0.29531252, ...,  0.5390297 ,
         0.4963695 ,  0.51058954],
       [ 0.25151724,  0.29531252,  0.2807141 , ...,  0.5390297 ,
         0.52480966,  0.52480966]], dtype=float32), None, None, array([[-0.36161673, -0.36161673, -0.3470183 , ..., -0.51325524,
        -0.68389606, -0.65545595],
       [-0.72657734, -0.8579632 , -1.0039475 , ..., -0.5985757 ,
        -0.42793486, -0.48481512],
       [-0.2740262 , -0.2740262 , -0.25942776, ..., -0.21463387,
        -0.48481512, -0.669676  ],
       ...,
       [-1.1207349 , -1.1353334 , -1.1353334 , ..., -1.2526988 ,
        -1.2669188 , -1.2953589 ],
       [-1.1353334 , -1.1645303 , -1.1499318 , ..., -1.2384787 ,
        -1.2384787 , -1.2384787 ],
       [-1.2813176 , -1.2959161 , -1.3105145 , ..., -1.2669188 ,
        -1.2669188 , -1.2669188 ]], dtype=float32), array([[-1.6024829 , -1.6024829 , -1.6024829 , ...,  0.38260898,
         0.43948925,  0.4963695 ],
       [-1.4710971 , -1.4564987 , -1.4564987 , ...,  0.4963695 ,
         0.4110491 ,  0.29728848],
       [-0.18643562, -0.20103405, -0.2302309 , ...,  0.7665507 ,
         0.8376511 ,  0.85187113],
       ...,
       [ 1.652966  ,  1.1128243 , -0.5659947 , ..., -1.3522393 ,
        -1.3664593 , -1.3948994 ],
       [-0.2302309 , -0.15723877, -0.28862458, ..., -1.4802198 ,
        -1.4802198 , -1.3806794 ],
       [ 0.67487156,  0.8646511 ,  1.1858164 , ..., -1.4091195 ,
        -1.4233395 , -1.4233395 ]], dtype=float32), None], 'image_grid_thw': [array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 28, 18]]), None, array([[ 1, 24, 18]]), array([[ 1, 18, 38]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), None, None, array([[ 1, 24, 18]]), array([[ 1, 18, 24]]), None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A rundown restroom with a broken sink and toilet.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Sandwich in paper on counter with man in background.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Black and white photograph of a traffic sign covered in graffiti.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A group of people at a table with a cup.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A train that is going  through a stop sign.\n', 'Find me an everyday image that matches the given caption: A man is sitting on an airplane seat with an electronic device.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A clown driving a tour car with several passengers.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 104/6000 [03:34<3:23:29,  2.07s/it]                                                    {'loss': 0.3826, 'grad_norm': 46.21074676513672, 'learning_rate': 9.993220338983052e-06, 'epoch': 0.02}
  2%|â–         | 104/6000 [03:34<3:23:29,  2.07s/it][2025-11-13 01:34:32,536] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    279,   4910,    624],
        ...,
        [151643, 151643, 151643,  ...,   4429,    700,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The tower of a building near a park with snow on the ground.\n', 'Find me an everyday image that matches the given caption: A guy standing in a field flying a blue kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in grey suit with microphone and people in an audience.\n', 'Find me an everyday image that matches the given caption: People in the water on a motor boat.\n', 'Find me an everyday image that matches the given caption: A close-up of a public restroom toilet with handicap bars.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A blue bird sitting on a branch in a tree with yellow berries.\n', 'Find me an everyday image that matches the given caption: A dark colored airplane sitting on a tarmac.\n', 'Find me an everyday image that matches the given caption: A pepperoni pizza has a slice taken out.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=430x256 at 0x7F3272B5D960>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5DB10>], [None], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5F490>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=374x256 at 0x7F3272B5C100>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272B5C490>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5C040>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272B5D570>], [<PIL.Image.Image image mode=RGB size=256x473 at 0x7F3272B5D540>]], 'pixel_values': [array([[ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.9303361 ,  1.9303361 ,  1.9303361 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       ...,
       [-1.0769397 , -0.7557742 , -0.6681836 , ..., -1.1389382 ,
        -0.9967375 , -1.082058  ],
       [ 1.9157377 ,  1.9157377 ,  1.9157377 , ..., -1.3664593 ,
        -1.3522393 , -1.3237991 ],
       [-1.2813176 , -0.9163569 , -0.65358526, ..., -1.0962781 ,
        -0.71233624, -0.35683453]], dtype=float32), array([[-0.11344349, -0.25942776, -0.4638057 , ..., -0.8260967 ,
        -0.74077636,  0.31150854],
       [ 1.6967614 ,  0.68947   ,  0.20772196, ...,  0.6243501 ,
         0.4110491 ,  0.24040821],
       [ 0.5580842 ,  1.1274228 ,  1.8135487 , ...,  0.4963695 ,
         1.1647125 ,  1.7903955 ],
       ...,
       [ 0.8208558 ,  0.8208558 ,  0.8208558 , ...,  1.0082918 ,
         1.022512  ,  1.036732  ],
       [ 0.10553299,  0.19312355,  0.29531252, ...,  0.7807708 ,
         0.7949909 ,  0.72389054],
       [ 0.5580842 ,  0.5726826 ,  0.61647785, ...,  0.56746984,
         0.5816899 ,  0.63857013]], dtype=float32), None, None, array([[ 1.7697535 ,  1.7843518 ,  1.8281472 , ...,  2.103237  ,
         2.117457  ,  2.117457  ],
       [ 1.9303361 ,  1.9157377 ,  1.9011393 , ...,  2.145897  ,
         2.145897  ,  2.145897  ],
       [ 1.6383677 ,  1.6821629 ,  1.7405566 , ...,  2.117457  ,
         2.103237  ,  2.103237  ],
       ...,
       [-0.21563247, -0.25942776, -0.21563247, ..., -1.4233395 ,
        -1.4091195 , -1.4375596 ],
       [-1.6900735 , -1.6608766 , -1.6316798 , ..., -1.1673783 ,
        -1.1247182 , -1.082058  ],
       [-1.5294908 , -1.5148925 , -1.500294  , ..., -1.2384787 ,
        -1.2526988 , -1.2811389 ]], dtype=float32), None, None, None, array([[0.04713918, 0.04713918, 0.04713918, ..., 1.9041561 , 1.9041561 ,
        1.9041561 ],
       [0.07633615, 0.07633615, 0.07633615, ..., 1.918376  , 1.918376  ,
        1.918376  ],
       [0.07633615, 0.07633615, 0.07633615, ..., 1.918376  , 1.918376  ,
        1.918376  ],
       ...,
       [1.5215802 , 1.4923834 , 1.4631865 , ..., 1.6197547 , 1.8614956 ,
        1.9894764 ],
       [1.7551551 , 1.6967614 , 1.5945723 , ..., 2.117457  , 2.117457  ,
        2.074797  ],
       [1.7405566 , 1.7113597 , 1.6383677 , ..., 1.1504925 , 1.3069133 ,
        1.463334  ]], dtype=float32), array([[ 1.8865409 ,  1.9157377 ,  1.9303361 , ...,  0.09820756,
         0.16930789,  0.18352796],
       [ 1.652966  ,  1.6821629 ,  1.5361787 , ...,  0.5390297 ,
         0.85187113,  1.5486543 ],
       [ 1.9303361 ,  1.9303361 ,  1.9157377 , ..., -0.5274753 ,
        -0.5274753 , -0.57013553],
       ...,
       [ 0.4704936 ,  0.41209993,  0.38290307, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [ 0.42669836,  0.3975015 ,  0.36830464, ..., -1.4517797 ,
        -1.4375596 , -1.4659997 ],
       [ 0.0617376 ,  0.03254076,  0.03254076, ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ]], dtype=float32), array([[-0.33241987, -0.8141679 , -1.1207349 , ...,  0.9798517 ,
         0.9514116 ,  0.9229715 ],
       [ 0.19312355,  0.19312355, -0.08424664, ...,  0.8945313 ,
         0.8945313 ,  0.9514116 ],
       [-1.500294  , -1.4564987 , -1.3543098 , ..., -1.0251776 ,
        -1.0962781 , -1.1531583 ],
       ...,
       [ 0.33910778,  0.32450938,  0.29531252, ..., -1.2100385 ,
        -1.2100385 , -1.2100385 ],
       [ 0.16392669,  0.17852512,  0.17852512, ..., -1.2526988 ,
        -1.2669188 , -1.2526988 ],
       [ 0.14932826,  0.14932826,  0.12013142, ..., -1.2669188 ,
        -1.2669188 , -1.2669188 ]], dtype=float32), None, None, None, array([[1.7259582 , 1.7259582 , 1.7259582 , ..., 1.918376  , 1.918376  ,
        1.918376  ],
       [1.7259582 , 1.7259582 , 1.7259582 , ..., 1.9325962 , 1.9325962 ,
        1.9325962 ],
       [1.6383677 , 1.6383677 , 1.6383677 , ..., 1.9468161 , 1.9468161 ,
        1.9468161 ],
       ...,
       [0.7332653 , 0.77706057, 0.8062574 , ..., 0.59590995, 0.61013   ,
        0.61013   ],
       [0.76246214, 0.8062574 , 0.8062574 , ..., 0.7665507 , 0.7949909 ,
        0.7807708 ],
       [0.58728105, 0.6456747 , 0.77706057, ..., 0.6243501 , 0.61013   ,
        0.59590995]], dtype=float32), array([[-1.0623412 , -1.018546  , -0.9163569 , ..., -0.6412359 ,
        -0.6981161 , -0.7549964 ],
       [-1.3105145 , -1.2229239 , -1.1207349 , ..., -0.6981161 ,
        -0.68389606, -0.65545595],
       [-0.8141679 , -0.8141679 , -0.82876635, ..., -1.2242587 ,
        -1.2384787 , -1.1958185 ],
       ...,
       [-0.303223  , -0.5221994 , -0.6681836 , ..., -1.2100385 ,
        -1.2811389 , -1.2100385 ],
       [-0.39081356, -0.21563247, -0.20103405, ..., -1.0962781 ,
        -1.082058  , -1.1104981 ],
       [-0.8433648 , -0.82876635, -0.8433648 , ..., -0.96829736,
        -0.7692165 , -0.669676  ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 30]]), array([[ 1, 24, 18]]), None, None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 26]]), array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 28, 18]]), array([[ 1, 34, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The tower of a building near a park with snow on the ground.\n', 'Find me an everyday image that matches the given caption: A guy standing in a field flying a blue kite.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in grey suit with microphone and people in an audience.\n', 'Find me an everyday image that matches the given caption: People in the water on a motor boat.\n', 'Find me an everyday image that matches the given caption: A close-up of a public restroom toilet with handicap bars.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A blue bird sitting on a branch in a tree with yellow berries.\n', 'Find me an everyday image that matches the given caption: A dark colored airplane sitting on a tarmac.\n', 'Find me an everyday image that matches the given caption: A pepperoni pizza has a slice taken out.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 105/6000 [03:36<3:21:34,  2.05s/it]                                                    {'loss': 0.5192, 'grad_norm': 60.02758026123047, 'learning_rate': 9.991525423728814e-06, 'epoch': 0.02}
  2%|â–         | 105/6000 [03:36<3:21:34,  2.05s/it][2025-11-13 01:34:34,541] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   4158,  41274,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    285,  32031,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  14448,  11577,    624],
        [151643, 151643, 151643,  ...,    279,   6010,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A coffee pot sitting on top of a white microwave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a green shirt catching a green frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Brown and white horse grazing grass underneath a tree.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An ornate clock on a small table with some small knick knacks.\n', 'Find me an everyday image that matches the given caption: A couple of women sitting at a hair salon.\n', 'Find me an everyday image that matches the given caption: A cow drinks from a stream in front of a windmill.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Close up of three bananas on top of a bowl of fruit.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An airplane landing on a runway with is landing gear extended.\n', 'Find me an everyday image that matches the given caption: A photo of a river with a clock tower in the distance.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272766590>], [None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272765B70>], [None], [<PIL.Image.Image image mode=RGB size=256x385 at 0x7F32727663E0>], [<PIL.Image.Image image mode=RGB size=340x256 at 0x7F32727650F0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272765F00>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x384 at 0x7F32727644C0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727659C0>], [None], [None]], 'pixel_values': [None, array([[-1.0769397 , -1.2813176 , -1.4564987 , ..., -1.2669188 ,
        -1.2384787 , -1.1958185 ],
       [-0.5659947 , -0.7557742 , -1.2229239 , ..., -0.91141707,
        -0.5985757 , -0.8403168 ],
       [-0.25942776, -0.21563247, -0.2740262 , ..., -0.45637497,
        -0.49903518, -0.47059506],
       ...,
       [-1.7338688 , -1.7192703 , -1.7192703 , ...,  1.9610363 ,
         1.9610363 ,  1.9610363 ],
       [ 1.4485881 ,  1.5507771 ,  1.6383677 , ...,  1.9468161 ,
         1.9325962 ,  1.9325962 ],
       [ 1.7989503 ,  1.7405566 ,  1.7259582 , ...,  1.8899357 ,
         1.875716  ,  1.875716  ]], dtype=float32), None, array([[-1.4710971 , -1.4710971 , -1.4564987 , ..., -1.3664593 ,
        -1.3664593 , -1.3806794 ],
       [-1.398105  , -1.3835065 , -1.3105145 , ..., -1.4802198 ,
        -1.4802198 , -1.4802198 ],
       [-1.2813176 , -1.2813176 , -1.2813176 , ..., -1.4091195 ,
        -1.4233395 , -1.4233395 ],
       ...,
       [-0.7557742 , -0.78497106, -0.78497106, ..., -0.71233624,
        -0.882977  , -0.91141707],
       [ 0.00334391,  0.01794233,  0.03254076, ..., -0.5274753 ,
        -0.51325524, -0.5274753 ],
       [-0.15723877, -0.18643562, -0.21563247, ..., -0.96829736,
        -0.96829736, -0.9825174 ]], dtype=float32), None, array([[ 0.7478637 ,  0.7040684 , -0.8579632 , ...,  0.33994877,
         1.2358129 ,  0.38260898],
       [ 1.5361787 ,  1.4193913 ,  0.2807141 , ..., -0.25729406,
        -0.17197368, -0.10087335],
       [-0.08424664, -0.33241987,  0.04713918, ...,  0.01288717,
         0.06976743,  0.33994877],
       ...,
       [ 1.4339896 ,  1.4193913 ,  1.4193913 , ...,  1.8899357 ,
         1.8899357 ,  1.8899357 ],
       [ 1.3463992 ,  1.3755959 ,  1.4193913 , ...,  1.7761754 ,
         1.7903955 ,  1.8472759 ],
       [ 1.5945723 ,  1.5945723 ,  1.5799739 , ...,  1.8046155 ,
         1.690855  ,  1.6055346 ]], dtype=float32), array([[ 3.2540757e-02,  3.2540757e-02,  3.2540757e-02, ...,
         1.6766349e+00,  1.6908550e+00,  1.6908550e+00],
       [ 9.0934567e-02,  9.0934567e-02,  9.0934567e-02, ...,
         1.7335151e+00,  1.7335151e+00,  1.7335151e+00],
       [ 7.6336145e-02,  7.6336145e-02,  7.6336145e-02, ...,
         1.7335151e+00,  1.7335151e+00,  1.7335151e+00],
       ...,
       [ 4.4129676e-01,  4.2669836e-01,  3.2450938e-01, ...,
         5.2480966e-01,  7.5233066e-01,  1.1647125e+00],
       [ 6.7487156e-01, -2.5852945e-02,  1.4932826e-01, ...,
         3.6838892e-01,  2.8306842e-01,  1.9774802e-01],
       [-2.3023090e-01, -2.7402619e-01, -2.0103405e-01, ...,
         1.9774802e-01,  1.1242763e-01, -1.3328948e-03]], dtype=float32), array([[1.9157377 , 1.9157377 , 1.9157377 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [1.9157377 , 1.9157377 , 1.9157377 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       [1.9157377 , 1.9157377 , 1.9157377 , ..., 2.1316772 , 2.1316772 ,
        2.1316772 ],
       ...,
       [0.6310763 , 0.6456747 , 0.61647785, ..., 0.63857013, 0.6243501 ,
        0.61013   ],
       [0.52888733, 0.52888733, 0.49969047, ..., 0.5390297 , 0.5390297 ,
        0.52480966],
       [0.5142889 , 0.44129676, 0.42669836, ..., 0.38260898, 0.38260898,
        0.38260898]], dtype=float32), None, None, None, array([[ 0.7478637 ,  0.7332653 ,  0.7332653 , ...,  1.2500329 ,
         1.264253  ,  1.264253  ],
       [ 0.85005265,  0.85005265,  0.8646511 , ...,  1.3211333 ,
         1.3495734 ,  1.3780135 ],
       [ 0.76246214,  0.76246214,  0.76246214, ...,  1.2926931 ,
         1.2926931 ,  1.2784731 ],
       ...,
       [-0.6243884 , -0.6243884 , -0.6389868 , ..., -1.0393977 ,
        -1.0536178 , -1.0536178 ],
       [-0.9747507 , -0.9747507 , -0.9747507 , ..., -0.8545369 ,
        -0.9398572 , -0.9398572 ],
       [-0.9309554 , -0.9309554 , -0.94555384, ..., -1.0536178 ,
        -1.0109575 , -0.9825174 ]], dtype=float32), None, array([[ 0.61647785,  0.6456747 ,  0.66027313, ...,  0.59590995,
         0.61013   ,  0.61013   ],
       [ 0.66027313,  0.7040684 ,  0.68947   , ...,  0.7665507 ,
         0.7949909 ,  0.80921096],
       [ 0.9668401 ,  0.9814385 ,  0.9814385 , ...,  0.46792936,
         0.48214942,  0.48214942],
       ...,
       [ 0.52888733,  0.30991095,  0.61647785, ..., -0.39949474,
        -0.9967375 , -1.0962781 ],
       [-1.018546  , -0.9309554 , -0.7995695 , ..., -0.5985757 ,
        -0.58435565, -0.57013553],
       [ 0.7478637 ,  0.8646511 ,  0.77706057, ..., -0.7976566 ,
        -0.8545369 , -0.882977  ]], dtype=float32), None, None], 'image_grid_thw': [None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 28, 18]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), None, None, None, array([[ 1, 28, 18]]), None, array([[ 1, 18, 28]]), None, None], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A coffee pot sitting on top of a white microwave.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man in a green shirt catching a green frisbee.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Brown and white horse grazing grass underneath a tree.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An ornate clock on a small table with some small knick knacks.\n', 'Find me an everyday image that matches the given caption: A couple of women sitting at a hair salon.\n', 'Find me an everyday image that matches the given caption: A cow drinks from a stream in front of a windmill.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Close up of three bananas on top of a bowl of fruit.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: An airplane landing on a runway with is landing gear extended.\n', 'Find me an everyday image that matches the given caption: A photo of a river with a clock tower in the distance.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i']}
  2%|â–         | 106/6000 [03:39<3:22:17,  2.06s/it]                                                    {'loss': 0.3125, 'grad_norm': 433.1173095703125, 'learning_rate': 9.989830508474577e-06, 'epoch': 0.02}
  2%|â–         | 106/6000 [03:39<3:22:17,  2.06s/it][2025-11-13 01:34:36,620] INFO [src.utils:19] {'input_ids': tensor([[151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    264,   6802,    624],
        ...,
        [151643, 151643, 151643,  ...,    264,   1965,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skier is posing on a mountain for a picture.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is holding his skis up while on a bench.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cars are parked outside of a large building with a clock.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Four suitcases stacked up on each other sitting on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5FFD0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5DA80>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5D2A0>], [None], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F3272B5E9B0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5E800>], [<PIL.Image.Image image mode=RGB size=339x256 at 0x7F3272B5EBF0>], [<PIL.Image.Image image mode=RGB size=256x385 at 0x7F3272B5E590>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272B5E140>], [<PIL.Image.Image image mode=RGB size=395x256 at 0x7F3272B5FEB0>], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272B5F670>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5EB00>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5DF60>]], 'pixel_values': [array([[-0.9309554 , -1.0039475 , -1.0477428 , ..., -0.9256371 ,
        -0.9398572 , -0.9967375 ],
       [-0.9163569 , -0.94555384, -1.1061366 , ..., -1.067838  ,
        -1.0536178 , -1.082058  ],
       [-1.1499318 , -1.2521207 , -1.3251129 , ..., -0.74077636,
        -0.669676  , -0.48481512],
       ...,
       [-0.7995695 ,  0.42669836, -0.36161673, ..., -0.54169536,
        -0.3710546 , -0.4137148 ],
       [-0.5805931 , -0.5659947 , -0.55139625, ..., -0.48481512,
        -0.5985757 , -0.5559154 ],
       [-0.33241987, -0.28862458, -0.33241987, ..., -0.5274753 ,
        -0.48481512, -0.51325524]], dtype=float32), array([[-1.7338688 , -1.7338688 , -1.7338688 , ..., -1.3522393 ,
        -1.3806794 , -1.4091195 ],
       [-1.7776641 , -1.7922626 , -1.7922626 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.6608766 , -1.6608766 , -1.6608766 , ..., -1.3522393 ,
        -1.3806794 , -1.4233395 ],
       ...,
       [-1.1499318 , -1.2959161 , -1.4564987 , ..., -1.1104981 ,
        -1.1531583 , -1.1673783 ],
       [-1.398105  , -1.3835065 , -1.3835065 , ..., -0.04399309,
        -0.29995427, -0.42793486],
       [-1.2667192 , -1.2959161 , -1.3251129 , ..., -1.082058  ,
        -1.1531583 , -1.2384787 ]], dtype=float32), None, array([[ 0.13472985,  0.16392669,  0.19312355, ...,  1.690855  ,
         1.7192951 ,  1.7477353 ],
       [ 0.66027313,  0.66027313,  0.67487156, ...,  1.8472759 ,
         1.8614956 ,  1.875716  ],
       [ 0.48509204,  0.49969047,  0.5142889 , ...,  1.875716  ,
         1.8899357 ,  1.9041561 ],
       ...,
       [-1.0039475 , -0.5659947 , -0.3470183 , ...,  0.18352796,
         0.16930789,  0.22618815],
       [-0.7411758 , -0.8141679 , -0.9747507 , ..., -0.31417432,
        -0.35683453, -0.38527465],
       [-0.8433648 , -1.0039475 , -0.94555384, ..., -0.58435565,
        -0.42793486, -0.17197368]], dtype=float32), None, array([[-1.7922626 , -1.7922626 , -1.7922626 , ..., -1.309579  ,
        -1.2953589 , -1.2811389 ],
       [-1.7776641 , -1.7776641 , -1.7922626 , ..., -1.3806794 ,
        -1.3806794 , -1.3806794 ],
       [-1.7776641 , -1.7776641 , -1.7776641 , ...,  1.0509521 ,
         0.88031125,  0.7807708 ],
       ...,
       [ 0.76246214,  0.7478637 ,  0.7478637 , ...,  1.5913146 ,
         1.5628744 ,  1.5486543 ],
       [ 0.71866685,  0.77706057,  0.791659  , ...,  1.705075  ,
         1.7335151 ,  1.7335151 ],
       [ 0.6310763 ,  0.61647785,  0.6310763 , ...,  1.477554  ,
         1.4348938 ,  1.3780135 ]], dtype=float32), array([[ 1.9157377,  1.9157377,  1.9157377, ...,  2.1316772,  2.1316772,
         2.1316772],
       [ 1.9157377,  1.9157377,  1.9157377, ...,  2.1316772,  2.1316772,
         2.1316772],
       [ 1.9157377,  1.9157377,  1.9157377, ...,  2.1316772,  2.1316772,
         2.1316772],
       ...,
       [-1.704672 , -1.704672 , -1.704672 , ..., -1.4375596, -1.4375596,
        -1.4375596],
       [-1.7192703, -1.7192703, -1.7192703, ..., -1.4375596, -1.4375596,
        -1.4375596],
       [-1.7192703, -1.7338688, -1.7338688, ..., -1.4375596, -1.4375596,
        -1.4375596]], dtype=float32), array([[-1.6608766 , -1.6608766 , -1.6608766 , ..., -1.4517797 ,
        -1.4517797 , -1.4375596 ],
       [-1.5586877 , -1.5586877 , -1.5586877 , ..., -1.3948994 ,
        -1.3948994 , -1.3948994 ],
       [-1.6024829 , -1.6024829 , -1.6024829 , ..., -1.4375596 ,
        -1.4375596 , -1.4233395 ],
       ...,
       [-1.3689082 , -1.398105  , -1.398105  , ...,  0.19774802,
         0.14086775,  0.11242763],
       [-0.20103405, -0.2302309 , -0.21563247, ...,  0.6670103 ,
         0.63857013,  0.61013   ],
       [-0.2302309 , -0.21563247, -0.18643562, ...,  0.35416883,
         0.33994877,  0.33994877]], dtype=float32), array([[-1.5732862 , -1.5878845 , -1.6024829 , ..., -1.2526988 ,
        -1.2242587 , -1.2811389 ],
       [-1.5732862 , -1.5732862 , -1.5732862 , ...,  1.5486543 ,
         1.5344343 ,  1.3922336 ],
       [-1.3689082 , -1.3251129 , -1.2813176 , ..., -1.2953589 ,
        -1.2811389 , -1.309579  ],
       ...,
       [-0.88716006, -0.88716006, -0.82876635, ..., -0.57013553,
        -0.6981161 , -0.7692165 ],
       [-1.2229239 , -1.2375224 , -1.2521207 , ..., -0.7265563 ,
        -0.71233624, -0.74077636],
       [-0.88716006, -1.0477428 , -1.1353334 , ..., -0.65545595,
        -0.7549964 , -0.86875695]], dtype=float32), array([[-1.1499318 , -1.0915381 , -1.3689082 , ...,  0.6527902 ,
         1.3780135 ,  1.477554  ],
       [-1.2667192 , -1.4127034 , -1.2521207 , ...,  1.918376  ,
         1.690855  ,  0.63857013],
       [ 0.5580842 ,  0.791659  ,  0.99603695, ...,  1.6624149 ,
         1.5486543 ,  1.6766349 ],
       ...,
       [-0.6243884 ,  0.01794233,  1.1566195 , ..., -0.91141707,
        -0.89719707, -1.0251776 ],
       [-1.3397113 , -1.4419003 , -1.3835065 , ..., -0.31417432,
        -0.96829736, -0.91141707],
       [-1.6608766 , -1.3689082 , -1.5586877 , ...,  0.06976743,
        -0.48481512, -0.6412359 ]], dtype=float32), array([[1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       ...,
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ],
       [1.9303361, 1.9303361, 1.9303361, ..., 2.145897 , 2.145897 ,
        2.145897 ]], dtype=float32), None, array([[-1.1207349 , -1.1499318 , -0.02585294, ..., -0.8545369 ,
         0.06976743, -0.5985757 ],
       [-1.3397113 , -0.15723877, -0.44920728, ...,  0.0413273 ,
        -0.6412359 , -1.0109575 ],
       [-0.8579632 , -1.1353334 , -1.1061366 , ..., -0.81187665,
        -0.91141707, -0.01555296],
       ...,
       [-0.303223  , -0.14264035, -0.18643562, ..., -0.38527465,
        -0.38527465, -0.243074  ],
       [-0.15723877, -0.18643562, -0.15723877, ...,  0.35416883,
        -0.02977302, -0.27151415],
       [-0.21563247, -0.18643562, -0.2302309 , ..., -0.68389606,
        -0.31417432, -0.32839438]], dtype=float32), None, array([[-0.9017585 , -0.87256163, -0.8433648 , ..., -0.71233624,
        -0.7265563 , -0.74077636],
       [-0.6681836 , -0.6681836 , -0.6389868 , ..., -0.61279577,
        -0.5985757 , -0.5985757 ],
       [-1.193727  , -1.193727  , -1.193727  , ..., -0.91141707,
        -0.9256371 , -0.91141707],
       ...,
       [-0.5805931 ,  0.42669836,  0.6310763 , ...,  0.7949909 ,
         0.823431  ,  0.88031125],
       [-0.9893491 , -0.8433648 , -0.96015227, ..., -0.61279577,
        -0.5985757 , -0.49903518],
       [-0.24482933,  0.5726826 ,  0.76246214, ...,  1.0793922 ,
         1.1362724 ,  1.1362724 ]], dtype=float32), array([[-1.3397113 , -1.3397113 , -1.3251129 , ..., -0.89719707,
        -0.86875695, -0.8403168 ],
       [-1.4127034 , -1.3835065 , -1.4273019 , ..., -0.61279577,
        -0.58435565, -0.54169536],
       [-1.2667192 , -1.2959161 , -1.3543098 , ..., -0.78343654,
        -0.7549964 , -0.71233624],
       ...,
       [ 0.32450938,  0.25151724,  0.19312355, ..., -0.4421549 ,
        -0.47059506, -0.48481512],
       [ 0.3537062 ,  0.36830464,  0.32450938, ..., -0.35683453,
        -0.32839438, -0.39949474],
       [ 0.19312355,  0.13472985,  0.12013142, ..., -0.5559154 ,
        -0.5985757 , -0.6412359 ]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), None, array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), array([[ 1, 18, 18]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A skier is posing on a mountain for a picture.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A man is holding his skis up while on a bench.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Cars are parked outside of a large building with a clock.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Four suitcases stacked up on each other sitting on a table.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 107/6000 [03:41<3:20:28,  2.04s/it]                                                    {'loss': 0.5023, 'grad_norm': 63.29424285888672, 'learning_rate': 9.988135593220339e-06, 'epoch': 0.02}
  2%|â–         | 107/6000 [03:41<3:20:28,  2.04s/it][2025-11-13 01:34:38,623] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  44990,  33380,    624],
        [151643, 151643, 151643,  ...,    389,    432,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        ...,
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    323,  12408,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A street with a taxi and two buses driving by a sign directing buses.\n', 'Find me an everyday image that matches the given caption: A center kitchen island with cookie jar on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat and a dog near one another.\n', 'Find me an everyday image that matches the given caption: A long row of parked mopeds line an urban street.\n', 'Find me an everyday image that matches the given caption: A small bird perched on the branch of a tree.\n', 'Find me an everyday image that matches the given caption: A young woman poses while squatting behind a fire hydrant.\n', 'Find me an everyday image that matches the given caption: A commuter train moves along tracks above a river with green banks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The person is packing essentials for his trip.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A giraffe standing in a field with grass and trees.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [None], [<PIL.Image.Image image mode=RGB size=365x256 at 0x7F3272B5D570>], [<PIL.Image.Image image mode=RGB size=256x383 at 0x7F3272B5DA20>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272B5D540>], [None], [None], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=411x256 at 0x7F3272B5E260>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272B5F4F0>], [None], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272B5E830>], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5F8E0>]], 'pixel_values': [None, None, array([[ 0.6018794 ,  0.6018794 ,  0.6018794 , ...,  1.5628744 ,
         1.5628744 ,  1.5628744 ],
       [ 0.6018794 ,  0.6018794 ,  0.61647785, ...,  1.5628744 ,
         1.5770944 ,  1.5770944 ],
       [ 0.8208558 ,  0.8208558 ,  0.8208558 , ...,  1.5628744 ,
         1.5486543 ,  1.5344343 ],
       ...,
       [-0.20103405, -0.1718372 , -0.47840413, ..., -0.81187665,
        -0.7265563 , -0.6981161 ],
       [ 0.13472985,  0.26611567,  0.3537062 , ..., -0.9967375 ,
        -0.882977  , -0.74077636],
       [ 0.10553299, -0.01125452,  0.0617376 , ..., -0.882977  ,
        -0.7976566 , -0.71233624]], dtype=float32), array([[ 0.14932826,  0.03254076, -0.08424664, ...,  0.06976743,
        -0.20041381, -0.54169536],
       [ 1.6967614 ,  1.7551551 ,  1.7843518 , ..., -1.0962781 ,
        -1.082058  , -1.1104981 ],
       [ 0.07633615,  0.12013142,  0.19312355, ...,  0.15508783,
         0.15508783,  0.01288717],
       ...,
       [ 1.4485881 ,  1.5361787 ,  1.6383677 , ...,  1.2358129 ,
         1.264253  ,  1.0793922 ],
       [ 1.5361787 ,  1.3026038 ,  1.0690291 , ...,  1.3637935 ,
         1.7192951 ,  1.5059941 ],
       [ 0.32450938,  0.01794233,  0.36830464, ...,  0.9798517 ,
         1.0082918 ,  1.0082918 ]], dtype=float32), array([[-1.1499318 , -1.1645303 , -1.1061366 , ..., -1.0109575 ,
        -1.0393977 , -1.0393977 ],
       [-1.0477428 , -1.1499318 , -1.0477428 , ..., -1.0393977 ,
        -0.96829736, -0.9398572 ],
       [-1.2375224 , -1.2375224 , -1.2229239 , ..., -0.7692165 ,
        -0.7976566 , -0.8260967 ],
       ...,
       [ 0.85005265,  0.23691882, -0.12804192, ...,  1.5059941 ,
         1.4917741 ,  1.3922336 ],
       [ 1.7843518 ,  1.6383677 ,  1.6237692 , ..., -0.14353354,
        -0.20041381,  0.22618815],
       [ 1.8865409 ,  1.9157377 ,  1.8427455 , ...,  0.8945313 ,
         1.022512  ,  0.93719155]], dtype=float32), None, None, None, None, None, array([[ 1.0398322 ,  1.0106354 ,  0.99603695, ...,  1.2073728 ,
         1.1931527 ,  1.1504925 ],
       [ 0.95224166,  0.95224166,  0.8792495 , ...,  1.1362724 ,
         1.1220524 ,  1.1220524 ],
       [ 0.9084464 ,  0.8646511 ,  0.8208558 , ...,  1.1220524 ,
         1.0793922 ,  1.022512  ],
       ...,
       [-0.9747507 , -0.88716006, -0.7411758 , ..., -0.8260967 ,
        -0.78343654, -0.71233624],
       [-0.82876635, -0.8579632 , -0.7557742 , ..., -0.5559154 ,
        -0.5559154 , -0.5985757 ],
       [-1.0623412 , -1.0623412 , -1.0915381 , ..., -0.7265563 ,
        -0.71233624, -0.68389606]], dtype=float32), array([[-9.7475070e-01, -9.7475070e-01, -9.8934913e-01, ...,
        -1.1389382e+00, -1.1389382e+00, -1.1389382e+00],
       [-1.1499318e+00, -1.1645303e+00, -1.1791286e+00, ...,
        -1.1104981e+00, -1.1104981e+00, -1.1104981e+00],
       [-1.1499318e+00, -1.1499318e+00, -1.1353334e+00, ...,
        -1.2669188e+00, -1.2526988e+00, -1.2384787e+00],
       ...,
       [ 1.9157377e+00,  1.9303361e+00,  1.9303361e+00, ...,
         5.2480966e-01,  4.9636951e-01,  4.9636951e-01],
       [ 1.3026038e+00,  1.2880055e+00,  1.2734070e+00, ...,
         1.2887171e-02, -1.3328948e-03, -1.3328948e-03],
       [ 1.1274228e+00,  1.1128243e+00,  1.0982260e+00, ...,
        -1.5775362e-01, -1.7197368e-01, -1.8619375e-01]], dtype=float32), None, array([[-0.43460885, -0.2302309 , -0.303223  , ...,  0.72389054,
         0.75233066,  0.7665507 ],
       [-0.9893491 , -1.398105  , -1.4127034 , ...,  0.7096705 ,
         0.72389054,  0.7381106 ],
       [-0.12804192, -0.12804192, -0.11344349, ...,  0.68123037,
         0.68123037,  0.6954504 ],
       ...,
       [ 0.3537062 ,  0.3537062 ,  0.3537062 , ...,  0.59590995,
         0.59590995,  0.6670103 ],
       [ 0.30991095,  0.30991095,  0.30991095, ...,  0.6670103 ,
         0.6670103 ,  0.6670103 ],
       [ 0.32450938,  0.32450938,  0.32450938, ...,  0.6954504 ,
         0.6954504 ,  0.6954504 ]], dtype=float32), None, array([[ 0.5142889 ,  0.48509204,  0.48509204, ..., -1.1247182 ,
        -1.1389382 , -1.1389382 ],
       [ 1.5507771 ,  1.5361787 ,  1.5945723 , ..., -1.2242587 ,
        -1.2100385 , -1.1531583 ],
       [ 0.42669836,  0.3975015 ,  0.41209993, ...,  0.6243501 ,
         0.5532498 , -0.48481512],
       ...,
       [-0.9309554 , -1.0039475 , -0.9747507 , ..., -0.882977  ,
        -0.86875695, -0.882977  ],
       [-0.59519154, -0.59519154, -0.6243884 , ..., -1.3806794 ,
        -1.4802198 , -1.3380191 ],
       [-0.7119789 , -0.7557742 , -0.8141679 , ..., -0.8545369 ,
        -0.9398572 , -0.9967375 ]], dtype=float32)], 'image_grid_thw': [None, None, array([[ 1, 18, 26]]), array([[ 1, 28, 18]]), array([[ 1, 18, 28]]), None, None, None, None, None, array([[ 1, 18, 30]]), array([[ 1, 18, 24]]), None, array([[ 1, 18, 28]]), None, array([[ 1, 24, 18]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A street with a taxi and two buses driving by a sign directing buses.\n', 'Find me an everyday image that matches the given caption: A center kitchen island with cookie jar on it.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A cat and a dog near one another.\n', 'Find me an everyday image that matches the given caption: A long row of parked mopeds line an urban street.\n', 'Find me an everyday image that matches the given caption: A small bird perched on the branch of a tree.\n', 'Find me an everyday image that matches the given caption: A young woman poses while squatting behind a fire hydrant.\n', 'Find me an everyday image that matches the given caption: A commuter train moves along tracks above a river with green banks.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The person is packing essentials for his trip.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A giraffe standing in a field with grass and trees.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 108/6000 [03:43<3:22:36,  2.06s/it]                                                    {'loss': 0.2334, 'grad_norm': 40.45005416870117, 'learning_rate': 9.986440677966102e-06, 'epoch': 0.02}
  2%|â–         | 108/6000 [03:43<3:22:36,  2.06s/it][2025-11-13 01:34:40,730] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,    434,  10150,    624],
        [151643, 151643, 151643,  ...,  65867,     82,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: THERE ARE THREE SHEES IN THE FIELD BEHIND THE FENCE.\n', 'Find me an everyday image that matches the given caption: The appointments in the hall include painted wood moldings, an antique console painted with gold filigree and magnificent urns.\n', 'Find me an everyday image that matches the given caption: A multi-colored cat laying down next to several pieces of luggage that are various colors and sizes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sink with cups and towel next to it.\n', 'Find me an everyday image that matches the given caption: A microwave with a stuffed animal inside reads 2:46.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A road that has a few people on bikes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[<PIL.Image.Image image mode=RGB size=381x256 at 0x7F3272FADC90>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=455x256 at 0x7F3272FAD420>], [<PIL.Image.Image image mode=RGB size=256x256 at 0x7F3272FAF190>], [None], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAFD90>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAFD30>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF520>], [<PIL.Image.Image image mode=RGB size=256x386 at 0x7F3272FACA60>], [None], [<PIL.Image.Image image mode=RGB size=765x256 at 0x7F3272FAF280>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAD6F0>], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAEE60>]], 'pixel_values': [array([[ 0.58728105,  0.58728105,  0.58728105, ...,  0.8376511 ,
         0.8376511 ,  0.8376511 ],
       [ 0.58728105,  0.58728105,  0.5726826 , ...,  0.823431  ,
         0.823431  ,  0.823431  ],
       [ 0.58728105,  0.58728105,  0.58728105, ...,  0.8376511 ,
         0.8376511 ,  0.8376511 ],
       ...,
       [-0.28862458, -0.2740262 , -0.33241987, ..., -0.78343654,
        -0.78343654, -0.7265563 ],
       [ 0.00334391,  0.07633615,  0.10553299, ..., -0.96829736,
        -1.0251776 , -1.0393977 ],
       [ 0.12013142,  0.12013142,  0.07633615, ..., -0.9256371 ,
        -0.95407724, -0.9398572 ]], dtype=float32), None, None, None, array([[-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988],
       [-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988],
       [-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988],
       ...,
       [-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988],
       [-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988],
       [-1.5586877, -1.5586877, -1.5586877, ..., -1.2526988, -1.2526988,
        -1.2526988]], dtype=float32), array([[ 6.31076276e-01,  6.89469993e-01,  7.62462139e-01, ...,
        -1.33289478e-03, -1.33289478e-03,  1.28871705e-02],
       [ 1.12742281e+00,  1.11282432e+00,  1.08362746e+00, ...,
         1.26647696e-01,  1.40867755e-01,  1.40867755e-01],
       [-1.86435625e-01, -1.42640352e-01, -1.13443494e-01, ...,
         3.54168832e-01,  3.68388921e-01,  3.68388921e-01],
       ...,
       [ 1.12742281e+00,  1.22961175e+00,  1.36099756e+00, ...,
         1.22159278e+00,  1.23581290e+00,  1.22159278e+00],
       [ 3.39107782e-01,  3.53706211e-01,  4.99690473e-01, ...,
         7.38110602e-01,  5.81689894e-01,  7.80770779e-01],
       [ 9.66840088e-01,  1.09822595e+00,  1.09822595e+00, ...,
         1.43489385e+00,  1.49177408e+00,  1.52021420e+00]], dtype=float32), None, None, array([[ 0.93764323,  0.93764323,  0.95224166, ...,  1.6055346 ,
         1.6055346 ,  1.6197547 ],
       [ 1.0106354 ,  1.0106354 ,  1.0252337 , ...,  1.6481948 ,
         1.6481948 ,  1.6624149 ],
       [ 0.99603695,  0.99603695,  0.99603695, ...,  1.5913146 ,
         1.5913146 ,  1.6055346 ],
       ...,
       [-1.2521207 , -1.2229239 , -1.2229239 , ..., -0.34261447,
        -0.34261447, -0.34261447],
       [-0.7995695 , -0.7995695 , -0.7995695 , ..., -0.3710546 ,
        -0.38527465, -0.38527465],
       [-0.82876635, -0.8579632 , -0.8579632 , ..., -0.42793486,
        -0.42793486, -0.42793486]], dtype=float32), array([[-1.018546  , -0.8579632 , -0.8141679 , ..., -0.7265563 ,
        -0.74077636, -1.0251776 ],
       [-0.5367978 , -0.94555384, -1.0477428 , ..., -1.1958185 ,
        -0.96829736, -0.86875695],
       [-1.3689082 , -1.3835065 , -1.4564987 , ..., -0.54169536,
        -0.6270158 , -0.39949474],
       ...,
       [-1.5586877 , -1.4419003 , -1.4419003 , ..., -1.2669188 ,
        -1.2526988 , -1.2526988 ],
       [-1.5732862 , -1.5294908 , -1.5294908 , ..., -1.1958185 ,
        -1.2100385 , -1.309579  ],
       [-1.5732862 , -1.5878845 , -1.5732862 , ..., -1.3380191 ,
        -1.3380191 , -1.3522393 ]], dtype=float32), array([[-1.7922626, -1.7922626, -1.7922626, ..., -1.4517797, -1.4517797,
        -1.4517797],
       [-1.7922626, -1.7922626, -1.7776641, ..., -1.4659997, -1.4659997,
        -1.4659997],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4659997, -1.4659997,
        -1.4517797],
       ...,
       [-1.6024829, -1.6170814, -1.6462783, ..., -1.3806794, -1.3948994,
        -1.3806794],
       [-1.6608766, -1.6608766, -1.6608766, ..., -0.7549964, -1.2242587,
        -1.4517797],
       [-1.0623412, -0.9893491, -1.0915381, ..., -1.1673783, -1.2384787,
        -1.2526988]], dtype=float32), array([[-1.500294 , -1.500294 , -1.500294 , ..., -1.309579 , -1.309579 ,
        -1.309579 ],
       [-1.500294 , -1.500294 , -1.500294 , ..., -1.309579 , -1.309579 ,
        -1.309579 ],
       [-1.4419003, -1.4419003, -1.4419003, ..., -1.2811389, -1.2811389,
        -1.2811389],
       ...,
       [-1.7776641, -1.7776641, -1.7776641, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198],
       [-1.7922626, -1.7922626, -1.7922626, ..., -1.4802198, -1.4802198,
        -1.4802198]], dtype=float32), None, array([[0.85005265, 0.85005265, 0.85005265, ..., 1.4917741 , 1.4917741 ,
        1.5059941 ],
       [0.8646511 , 0.8646511 , 0.8646511 , ..., 1.5059941 , 1.4917741 ,
        1.4917741 ],
       [0.85005265, 0.85005265, 0.85005265, ..., 1.477554  , 1.477554  ,
        1.477554  ],
       ...,
       [0.5726826 , 0.6310763 , 0.6456747 , ..., 0.61013   , 0.6243501 ,
        0.6527902 ],
       [0.67487156, 0.7040684 , 0.7478637 , ..., 0.52480966, 0.51058954,
        0.51058954],
       [1.0398322 , 1.2442101 , 1.2442101 , ..., 0.5816899 , 0.59590995,
        0.6243501 ]], dtype=float32), array([[-0.02585294, -0.01125452,  0.04713918, ..., -0.5274753 ,
        -0.49903518, -0.4137148 ],
       [-0.09884507,  0.04713918,  0.0617376 , ..., -0.3710546 ,
         0.43948925,  0.8660912 ],
       [ 0.25151724,  0.2223204 ,  0.20772196, ..., -0.89719707,
        -0.9256371 , -0.8545369 ],
       ...,
       [-1.193727  , -1.0477428 , -1.1207349 , ..., -1.0536178 ,
        -1.067838  , -1.082058  ],
       [-1.5294908 , -1.2959161 , -1.0331444 , ..., -1.1958185 ,
        -1.1104981 , -0.91141707],
       [-1.1353334 , -0.7557742 , -0.5367978 , ..., -1.1389382 ,
        -1.1673783 , -1.1673783 ]], dtype=float32), array([[-1.3543098 , -1.500294  , -1.3689082 , ..., -0.31417432,
        -0.18619375, -0.18619375],
       [-1.1207349 , -1.398105  , -1.4127034 , ..., -0.15775362,
         0.15508783, -0.54169536],
       [-1.0915381 , -1.0477428 , -0.8579632 , ..., -1.1104981 ,
        -1.0393977 , -1.0251776 ],
       ...,
       [-1.0915381 , -1.1499318 , -1.1645303 , ..., -0.9256371 ,
        -0.9398572 , -0.95407724],
       [-0.37621516, -0.44920728, -0.50760096, ..., -0.65545595,
        -0.58435565, -0.51325524],
       [-1.0477428 , -1.0623412 , -1.0769397 , ..., -0.5985757 ,
        -0.6270158 , -0.65545595]], dtype=float32)], 'image_grid_thw': [array([[ 1, 18, 28]]), None, None, None, array([[ 1, 18, 32]]), array([[ 1, 18, 18]]), None, None, array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]]), array([[ 1, 28, 18]]), None, array([[ 1, 18, 54]]), array([[ 1, 18, 24]]), array([[ 1, 18, 24]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: THERE ARE THREE SHEES IN THE FIELD BEHIND THE FENCE.\n', 'Find me an everyday image that matches the given caption: The appointments in the hall include painted wood moldings, an antique console painted with gold filigree and magnificent urns.\n', 'Find me an everyday image that matches the given caption: A multi-colored cat laying down next to several pieces of luggage that are various colors and sizes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A sink with cups and towel next to it.\n', 'Find me an everyday image that matches the given caption: A microwave with a stuffed animal inside reads 2:46.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A road that has a few people on bikes.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}
  2%|â–         | 109/6000 [03:45<3:24:55,  2.09s/it]                                                    {'loss': 0.4358, 'grad_norm': 51.19824981689453, 'learning_rate': 9.984745762711865e-06, 'epoch': 0.02}
  2%|â–         | 109/6000 [03:45<3:24:55,  2.09s/it][2025-11-13 01:34:42,874] INFO [src.utils:19] {'input_ids': tensor([[151643, 151643, 151643,  ...,   6006,   1787,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        ...,
        [151655, 151655, 151655,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624],
        [151643, 151643, 151643,  ...,  17778,   2168,    624]]), 'attention_mask': tensor([[0, 0, 0,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        [1, 1, 1,  ..., 1, 1, 1],
        ...,
        [1, 1, 1,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1],
        [0, 0, 0,  ..., 1, 1, 1]]), 'texts': ['Find me an everyday image that matches the given caption: A close up of a person in front of a refrigerator door open.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A giraffe standing on a dirt surface inside a fenced area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Three people eating in a wood-paneled restaurant booth.\n', 'Find me an everyday image that matches the given caption: An intersection with a street sign, traffic sign and a street light.\n', 'Find me an everyday image that matches the given caption: Lighted wooden medicine cabinet and mirror over a sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man is holding the rope for a child who is wakeboarding.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'images': [[None], [<PIL.Image.Image image mode=RGB size=386x256 at 0x7F3272B5FD90>], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAE350>], [None], [<PIL.Image.Image image mode=RGB size=384x256 at 0x7F3272FAF940>], [None], [None], [None], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272FADB70>], [None], [<PIL.Image.Image image mode=RGB size=341x256 at 0x7F3272FAF9D0>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272B5DF60>], [<PIL.Image.Image image mode=RGB size=383x256 at 0x7F32727D8E80>], [<PIL.Image.Image image mode=RGB size=385x256 at 0x7F3272FADF00>], [<PIL.Image.Image image mode=RGB size=256x341 at 0x7F3272FADB40>], [<PIL.Image.Image image mode=RGB size=281x256 at 0x7F3272FAF2E0>]], 'pixel_values': [None, array([[ 1.8865409 ,  1.8865409 ,  1.8865409 , ...,  2.0890167 ,
         2.0890167 ,  2.0890167 ],
       [ 1.9011393 ,  1.9157377 ,  1.8281472 , ...,  0.46792936,
        -0.6412359 , -0.9825174 ],
       [ 1.8135487 ,  1.8135487 ,  1.8135487 , ...,  0.38260898,
         0.7381106 ,  0.7949909 ],
       ...,
       [-0.42001042, -0.37621516, -0.36161673, ..., -0.91141707,
        -0.39949474, -0.35683453],
       [-0.28862458, -0.06964822, -0.04045137, ..., -0.6981161 ,
        -0.58435565, -0.89719707],
       [ 0.01794233, -0.11344349,  0.17852512, ..., -0.81187665,
        -0.9398572 , -0.7265563 ]], dtype=float32), array([[ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       [ 1.9157377 ,  1.9157377 ,  1.9157377 , ...,  2.1316772 ,
         2.1316772 ,  2.1316772 ],
       ...,
       [ 0.48509204,  0.48509204,  0.25151724, ...,  0.25462827,
         0.33994877,  0.33994877],
       [-0.21563247, -0.18643562, -0.14264035, ..., -0.45637497,
        -0.57013553, -0.5985757 ],
       [ 0.09093457, -0.0550498 , -0.08424664, ..., -0.25729406,
        -0.20041381,  0.02710724]], dtype=float32), None, array([[-1.5878845 , -1.6170814 , -1.6754751 , ..., -1.2526988 ,
        -1.2526988 , -1.2526988 ],
       [-1.6462783 , -1.6316798 , -1.6754751 , ..., -1.2242587 ,
        -1.2100385 , -1.2100385 ],
       [-1.5148925 , -1.5148925 , -1.5148925 , ..., -1.2242587 ,
        -1.1958185 , -1.1815984 ],
       ...,
       [-1.0769397 , -1.0623412 , -1.0623412 , ..., -0.86875695,
        -0.882977  , -0.89719707],
       [-1.1353334 , -1.1353334 , -1.1353334 , ..., -0.91141707,
        -0.882977  , -0.89719707],
       [-1.1353334 , -1.1499318 , -1.1499318 , ..., -0.91141707,
        -0.91141707, -0.91141707]], dtype=float32), None, None, None, array([[ 1.5507771 ,  1.5507771 ,  1.5507771 , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       [ 1.5507771 ,  1.5507771 ,  1.5507771 , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       [ 1.5507771 ,  1.5507771 ,  1.5507771 , ...,  1.7761754 ,
         1.7761754 ,  1.7761754 ],
       ...,
       [-1.2083255 , -1.1353334 , -1.0623412 , ..., -0.9398572 ,
        -0.95407724, -0.95407724],
       [-0.8433648 , -0.8579632 , -0.8579632 , ..., -1.0536178 ,
        -1.0251776 , -1.0109575 ],
       [-0.87256163, -0.87256163, -0.87256163, ..., -0.9825174 ,
        -0.96829736, -0.96829736]], dtype=float32), None, array([[0.8208558 , 0.8062574 , 0.791659  , ..., 1.0793922 , 1.0936122 ,
        1.0793922 ],
       [0.76246214, 0.7478637 , 0.76246214, ..., 1.1220524 , 1.0936122 ,
        1.0793922 ],
       [0.7478637 , 0.7478637 , 0.7332653 , ..., 1.1504925 , 1.1362724 ,
        1.1362724 ],
       ...,
       [1.6967614 , 1.7113597 , 1.6821629 , ..., 2.0890167 , 2.0890167 ,
        2.0890167 ],
       [1.857344  , 1.8719424 , 1.8865409 , ..., 1.7477353 , 1.875716  ,
        1.7477353 ],
       [1.857344  , 1.8719424 , 1.8719424 , ..., 1.2784731 , 1.7619553 ,
        1.8046155 ]], dtype=float32), array([[-0.50760096,  0.01794233, -0.4638057 , ..., -0.4137148 ,
        -0.21463387, -0.22885394],
       [-0.303223  , -0.36161673, -0.7703726 , ..., -0.42793486,
        -0.17197368, -0.47059506],
       [ 0.42669836, -0.42001042,  0.19312355, ..., -0.3710546 ,
        -0.29995427, -0.25729406],
       ...,
       [-0.96015227, -0.96015227, -0.96015227, ..., -0.47059506,
        -0.47059506, -0.47059506],
       [-0.9747507 , -0.9747507 , -0.9747507 , ..., -0.4421549 ,
        -0.45637497, -0.4421549 ],
       [-0.9893491 , -0.9893491 , -0.9893491 , ..., -0.47059506,
        -0.47059506, -0.47059506]], dtype=float32), array([[ 0.36830464, -0.0550498 , -0.01125452, ...,  1.1362724 ,
         1.1362724 ,  1.1789327 ],
       [ 1.0836275 ,  1.4485881 ,  1.6675645 , ...,  1.3069133 ,
         1.2926931 ,  1.2784731 ],
       [ 1.1420212 ,  1.1858164 ,  1.1858164 , ...,  1.2358129 ,
         1.1789327 ,  0.93719155],
       ...,
       [-0.2302309 , -0.24482933, -0.24482933, ..., -0.17197368,
        -0.17197368, -0.18619375],
       [-0.01125452,  0.00334391, -0.0550498 , ..., -0.07243322,
        -0.08665328, -0.08665328],
       [-0.20103405, -0.24482933, -0.2740262 , ..., -0.18619375,
        -0.15775362, -0.14353354]], dtype=float32), array([[ 1.6383677 ,  1.6383677 ,  1.6383677 , ...,  2.103237  ,
         2.103237  ,  2.103237  ],
       [ 1.6383677 ,  1.6383677 ,  1.6237692 , ...,  2.117457  ,
         2.117457  ,  2.117457  ],
       [ 1.7113597 ,  1.7113597 ,  1.7113597 , ...,  2.074797  ,
         2.074797  ,  2.074797  ],
       ...,
       [-1.1353334 , -1.1791286 , -1.193727  , ..., -0.11509342,
        -0.08665328, -0.10087335],
       [-1.193727  , -1.2667192 , -1.2521207 , ..., -0.21463387,
        -0.34261447, -0.3710546 ],
       [-1.2521207 , -1.1645303 , -1.1645303 , ..., -0.10087335,
        -0.08665328, -0.29995427]], dtype=float32), array([[-0.04045137, -0.04045137, -0.02585294, ..., -0.08665328,
        -0.07243322, -0.07243322],
       [ 0.14932826,  0.14932826,  0.16392669, ...,  0.0413273 ,
         0.06976743, -0.01555296],
       [ 0.14932826,  0.14932826,  0.16392669, ...,  0.02710724,
         0.02710724,  0.02710724],
       ...,
       [-0.33241987, -0.18643562, -0.15723877, ..., -0.81187665,
        -0.8545369 , -0.91141707],
       [-0.405412  , -0.50760096, -0.4638057 , ..., -0.6981161 ,
        -0.71233624, -0.7692165 ],
       [-0.5221994 , -0.47840413, -0.47840413, ..., -0.9967375 ,
        -0.9398572 , -0.91141707]], dtype=float32), array([[ 1.6237692 ,  1.6821629 ,  1.7405566 , ..., -0.38527465,
        -0.31417432, -0.29995427],
       [ 1.1420212 ,  1.0544306 ,  1.2004149 , ...,  1.2926931 ,
         1.3922336 ,  1.3069133 ],
       [ 1.5361787 ,  1.6237692 ,  1.7551551 , ...,  1.9041561 ,
         1.918376  ,  1.9041561 ],
       ...,
       [ 0.26611567,  0.23691882,  0.16392669, ...,  1.5628744 ,
         1.6339747 ,  1.463334  ],
       [ 0.0617376 , -0.02585294, -0.11344349, ...,  1.9610363 ,
         1.8614956 ,  1.8188357 ],
       [ 0.14932826,  0.03254076,  0.00334391, ...,  1.8330555 ,
         1.7761754 ,  1.8614956 ]], dtype=float32)], 'image_grid_thw': [None, array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), None, array([[ 1, 18, 28]]), None, None, None, array([[ 1, 24, 18]]), None, array([[ 1, 18, 24]]), array([[ 1, 24, 18]]), array([[ 1, 18, 28]]), array([[ 1, 18, 28]]), array([[ 1, 24, 18]]), array([[ 1, 18, 20]])], 'pixel_values_videos': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'video_grid_thw': [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None], 'text': ['Find me an everyday image that matches the given caption: A close up of a person in front of a refrigerator door open.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: A giraffe standing on a dirt surface inside a fenced area.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: Three people eating in a wood-paneled restaurant booth.\n', 'Find me an everyday image that matches the given caption: An intersection with a street sign, traffic sign and a street light.\n', 'Find me an everyday image that matches the given caption: Lighted wooden medicine cabinet and mirror over a sink.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', 'Find me an everyday image that matches the given caption: The man is holding the rope for a child who is wakeboarding.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n', '<|image_pad|>\nFind an image caption describing the given everyday image.\n'], 'global_dataset_name': ['mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_t2i', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t', 'mmeb/MSCOCO_i2t']}

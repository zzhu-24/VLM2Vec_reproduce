/home/infres/zzhu-24/anaconda3/envs/vlm2vec_update/lib/python3.10/site-packages/requests/__init__.py:86: RequestsDependencyWarning: Unable to find acceptable character detection dependency (chardet or charset_normalizer).
  warnings.warn(
[2026-01-16 02:52:11,593] INFO [src.utils:21] Distributed init debug info:
[2026-01-16 02:52:11,594] INFO [src.utils:21] RANK: None
[2026-01-16 02:52:11,594] INFO [src.utils:21] LOCAL_RANK: None
[2026-01-16 02:52:11,594] INFO [src.utils:21] WORLD_SIZE: None
[2026-01-16 02:52:11,594] INFO [src.utils:21] MASTER_ADDR: None
[2026-01-16 02:52:11,594] INFO [src.utils:21] MASTER_PORT: None
[2026-01-16 02:52:13,444] INFO [src.utils:21] Model Backbone: qwen3_vl
[2026-01-16 02:52:13,444] INFO [src.utils:21] Loading processor from: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/5Jan_Qwen3VL4b_rmv_21_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4000
[2026-01-16 02:52:15,465] INFO [src.utils:21] Loading backbone [qwen3_vl] from /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/5Jan_Qwen3VL4b_rmv_21_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4000
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 21.28it/s]
[2026-01-16 02:52:15,972] INFO [src.utils:21] Loading LoRA from /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/5Jan_Qwen3VL4b_rmv_21_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4000
[2026-01-16 02:53:00,420] INFO [src.utils:21] [rank=0] Loading the model from Huggingface: Qwen/Qwen3-VL-4B-Instruct...
[2026-01-16 02:53:01,878] INFO [src.utils:21] --- Evaluating N24News ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 545.94 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1279.27 examples/s]
[2026-01-16 02:53:05,531] INFO [src.utils:21] Encoding queries...
Queries for N24News (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Queries for N24News (rank 0):   2%|▏         | 1/42 [00:03<02:40,  3.92s/it]Queries for N24News (rank 0):   5%|▍         | 2/42 [00:07<02:27,  3.68s/it]Queries for N24News (rank 0):   7%|▋         | 3/42 [00:10<02:20,  3.59s/it]Queries for N24News (rank 0):  10%|▉         | 4/42 [00:14<02:19,  3.68s/it]Queries for N24News (rank 0):  12%|█▏        | 5/42 [00:18<02:12,  3.58s/it]Queries for N24News (rank 0):  14%|█▍        | 6/42 [00:21<02:08,  3.56s/it]Queries for N24News (rank 0):  17%|█▋        | 7/42 [00:25<02:04,  3.55s/it]Queries for N24News (rank 0):  19%|█▉        | 8/42 [00:28<02:03,  3.63s/it]Queries for N24News (rank 0):  21%|██▏       | 9/42 [00:32<01:58,  3.60s/it]Queries for N24News (rank 0):  24%|██▍       | 10/42 [00:36<01:55,  3.60s/it]Queries for N24News (rank 0):  26%|██▌       | 11/42 [00:39<01:51,  3.60s/it]Queries for N24News (rank 0):  29%|██▊       | 12/42 [00:43<01:45,  3.52s/it]Queries for N24News (rank 0):  31%|███       | 13/42 [00:46<01:41,  3.51s/it]Queries for N24News (rank 0):  33%|███▎      | 14/42 [00:50<01:39,  3.54s/it]Queries for N24News (rank 0):  36%|███▌      | 15/42 [00:53<01:34,  3.51s/it]Queries for N24News (rank 0):  38%|███▊      | 16/42 [00:57<01:30,  3.50s/it]Queries for N24News (rank 0):  40%|████      | 17/42 [01:00<01:27,  3.50s/it]Queries for N24News (rank 0):  43%|████▎     | 18/42 [01:04<01:24,  3.52s/it]Queries for N24News (rank 0):  45%|████▌     | 19/42 [01:07<01:19,  3.46s/it]Queries for N24News (rank 0):  48%|████▊     | 20/42 [01:10<01:16,  3.48s/it]Queries for N24News (rank 0):  50%|█████     | 21/42 [01:14<01:13,  3.52s/it]Queries for N24News (rank 0):  52%|█████▏    | 22/42 [01:18<01:10,  3.54s/it]Queries for N24News (rank 0):  55%|█████▍    | 23/42 [01:21<01:07,  3.55s/it]Queries for N24News (rank 0):  57%|█████▋    | 24/42 [01:25<01:03,  3.54s/it]Queries for N24News (rank 0):  60%|█████▉    | 25/42 [01:28<00:59,  3.52s/it]Queries for N24News (rank 0):  62%|██████▏   | 26/42 [01:32<00:56,  3.53s/it]Queries for N24News (rank 0):  64%|██████▍   | 27/42 [01:35<00:53,  3.58s/it]Queries for N24News (rank 0):  67%|██████▋   | 28/42 [01:39<00:49,  3.52s/it]Queries for N24News (rank 0):  69%|██████▉   | 29/42 [01:43<00:47,  3.62s/it]Queries for N24News (rank 0):  71%|███████▏  | 30/42 [01:46<00:42,  3.58s/it]Queries for N24News (rank 0):  74%|███████▍  | 31/42 [01:50<00:39,  3.62s/it]Queries for N24News (rank 0):  76%|███████▌  | 32/42 [01:53<00:35,  3.52s/it]Queries for N24News (rank 0):  79%|███████▊  | 33/42 [01:57<00:31,  3.51s/it]Queries for N24News (rank 0):  81%|████████  | 34/42 [02:00<00:27,  3.48s/it]Queries for N24News (rank 0):  83%|████████▎ | 35/42 [02:04<00:24,  3.47s/it]Queries for N24News (rank 0):  86%|████████▌ | 36/42 [02:07<00:21,  3.51s/it]Queries for N24News (rank 0):  88%|████████▊ | 37/42 [02:11<00:17,  3.51s/it]Queries for N24News (rank 0):  90%|█████████ | 38/42 [02:14<00:13,  3.49s/it]Queries for N24News (rank 0):  93%|█████████▎| 39/42 [02:18<00:10,  3.53s/it]Queries for N24News (rank 0):  95%|█████████▌| 40/42 [02:21<00:07,  3.55s/it]Queries for N24News (rank 0):  98%|█████████▊| 41/42 [02:25<00:03,  3.56s/it]Queries for N24News (rank 0): 100%|██████████| 42/42 [02:27<00:00,  3.21s/it]Queries for N24News (rank 0): 100%|██████████| 42/42 [02:27<00:00,  3.52s/it]
[2026-01-16 02:55:33,368] INFO [src.utils:21] Query embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/N24News_qry, skipping saving.
[2026-01-16 02:55:33,368] INFO [src.utils:21] Encoding candidates...
Candidates for N24News (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for N24News (rank 0): 100%|██████████| 1/1 [00:00<00:00, 12.79it/s]
[2026-01-16 02:55:33,449] INFO [src.utils:21] Target embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/N24News_tgt, skipping saving.
[2026-01-16 02:55:33,450] INFO [src.utils:21] --- Scoring for layer -1 ---
[2026-01-16 02:55:33,450] INFO [src.utils:21] Score of N24News (loaded from previous run): /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/N24News_score.json
[2026-01-16 02:55:33,450] INFO [src.utils:21] {'hit@1': '0.1660', 'hit@5': '0.3890', 'hit@10': '0.6010', 'ndcg_linear@1': '0.1660', 'ndcg_linear@5': '0.2802', 'ndcg_linear@10': '0.3480', 'ndcg_exponential@1': '0.1660', 'ndcg_exponential@5': '0.2802', 'ndcg_exponential@10': '0.3480', 'precision@1': '0.1660', 'precision@5': '0.0778', 'precision@10': '0.0601', 'recall@1': '0.1660', 'recall@5': '0.3890', 'recall@10': '0.6010', 'f1@1': '0.1660', 'f1@5': '0.1297', 'f1@10': '0.1093', 'map@1': '0.1660', 'map@5': '0.2445', 'map@10': '0.2721', 'mrr@1': '0.1660', 'mrr@5': '0.2445', 'mrr@10': '0.2721', 'num_pred': '1000.0000', 'num_data': '1000.0000'}
[2026-01-16 02:55:33,451] INFO [src.utils:21] --- Evaluating HatefulMemes ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 500.21 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1211.55 examples/s]
[2026-01-16 02:55:35,708] INFO [src.utils:21] Encoding queries...
Queries for HatefulMemes (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for HatefulMemes (rank 0):   2%|▏         | 1/42 [00:02<01:46,  2.60s/it]Queries for HatefulMemes (rank 0):   5%|▍         | 2/42 [00:05<01:45,  2.63s/it]Queries for HatefulMemes (rank 0):   7%|▋         | 3/42 [00:07<01:42,  2.63s/it]Queries for HatefulMemes (rank 0):  10%|▉         | 4/42 [00:10<01:35,  2.52s/it]Queries for HatefulMemes (rank 0):  12%|█▏        | 5/42 [00:13<01:37,  2.64s/it]Queries for HatefulMemes (rank 0):  14%|█▍        | 6/42 [00:15<01:38,  2.72s/it]Queries for HatefulMemes (rank 0):  17%|█▋        | 7/42 [00:18<01:38,  2.82s/it]Queries for HatefulMemes (rank 0):  19%|█▉        | 8/42 [00:21<01:31,  2.70s/it]Queries for HatefulMemes (rank 0):  21%|██▏       | 9/42 [00:23<01:25,  2.60s/it]Queries for HatefulMemes (rank 0):  24%|██▍       | 10/42 [00:26<01:24,  2.64s/it]Queries for HatefulMemes (rank 0):  26%|██▌       | 11/42 [00:29<01:23,  2.68s/it]Queries for HatefulMemes (rank 0):  29%|██▊       | 12/42 [00:31<01:19,  2.64s/it]Queries for HatefulMemes (rank 0):  31%|███       | 13/42 [00:34<01:16,  2.64s/it]Queries for HatefulMemes (rank 0):  33%|███▎      | 14/42 [00:37<01:15,  2.68s/it]Queries for HatefulMemes (rank 0):  36%|███▌      | 15/42 [00:39<01:10,  2.62s/it]Queries for HatefulMemes (rank 0):  38%|███▊      | 16/42 [00:42<01:07,  2.60s/it]Queries for HatefulMemes (rank 0):  40%|████      | 17/42 [00:44<01:05,  2.60s/it]Queries for HatefulMemes (rank 0):  43%|████▎     | 18/42 [00:47<01:03,  2.66s/it]Queries for HatefulMemes (rank 0):  45%|████▌     | 19/42 [00:50<01:02,  2.73s/it]Queries for HatefulMemes (rank 0):  48%|████▊     | 20/42 [00:53<01:03,  2.87s/it]Queries for HatefulMemes (rank 0):  50%|█████     | 21/42 [00:56<01:00,  2.86s/it]Queries for HatefulMemes (rank 0):  52%|█████▏    | 22/42 [00:59<00:56,  2.81s/it]Queries for HatefulMemes (rank 0):  55%|█████▍    | 23/42 [01:02<00:53,  2.82s/it]Queries for HatefulMemes (rank 0):  57%|█████▋    | 24/42 [01:05<00:51,  2.83s/it]Queries for HatefulMemes (rank 0):  60%|█████▉    | 25/42 [01:08<00:49,  2.89s/it]Queries for HatefulMemes (rank 0):  62%|██████▏   | 26/42 [01:10<00:44,  2.80s/it]Queries for HatefulMemes (rank 0):  64%|██████▍   | 27/42 [01:13<00:41,  2.76s/it]Queries for HatefulMemes (rank 0):  67%|██████▋   | 28/42 [01:16<00:39,  2.81s/it]Queries for HatefulMemes (rank 0):  69%|██████▉   | 29/42 [01:18<00:35,  2.76s/it]Queries for HatefulMemes (rank 0):  71%|███████▏  | 30/42 [01:21<00:33,  2.76s/it]Queries for HatefulMemes (rank 0):  74%|███████▍  | 31/42 [01:24<00:30,  2.76s/it]Queries for HatefulMemes (rank 0):  76%|███████▌  | 32/42 [01:27<00:27,  2.75s/it]Queries for HatefulMemes (rank 0):  79%|███████▊  | 33/42 [01:29<00:25,  2.78s/it]Queries for HatefulMemes (rank 0):  81%|████████  | 34/42 [01:32<00:22,  2.78s/it]Queries for HatefulMemes (rank 0):  83%|████████▎ | 35/42 [01:36<00:20,  2.93s/it]Queries for HatefulMemes (rank 0):  86%|████████▌ | 36/42 [01:38<00:17,  2.88s/it]Queries for HatefulMemes (rank 0):  88%|████████▊ | 37/42 [01:41<00:13,  2.80s/it]Queries for HatefulMemes (rank 0):  90%|█████████ | 38/42 [01:44<00:11,  2.88s/it]Queries for HatefulMemes (rank 0):  93%|█████████▎| 39/42 [01:46<00:08,  2.76s/it]Queries for HatefulMemes (rank 0):  95%|█████████▌| 40/42 [01:50<00:05,  2.85s/it]Queries for HatefulMemes (rank 0):  98%|█████████▊| 41/42 [01:52<00:02,  2.78s/it]Queries for HatefulMemes (rank 0): 100%|██████████| 42/42 [01:54<00:00,  2.57s/it]Queries for HatefulMemes (rank 0): 100%|██████████| 42/42 [01:54<00:00,  2.73s/it]
[2026-01-16 02:57:30,442] INFO [src.utils:21] Query embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/HatefulMemes_qry, skipping saving.
[2026-01-16 02:57:30,442] INFO [src.utils:21] Encoding candidates...
Candidates for HatefulMemes (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for HatefulMemes (rank 0): 100%|██████████| 1/1 [00:00<00:00, 15.43it/s]
[2026-01-16 02:57:30,511] INFO [src.utils:21] Target embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/HatefulMemes_tgt, skipping saving.
[2026-01-16 02:57:30,511] INFO [src.utils:21] --- Scoring for layer -1 ---
[2026-01-16 02:57:30,512] INFO [src.utils:21] Score of HatefulMemes (loaded from previous run): /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/HatefulMemes_score.json
[2026-01-16 02:57:30,512] INFO [src.utils:21] {'hit@1': '0.4920', 'hit@5': '1.0000', 'hit@10': '1.0000', 'ndcg_linear@1': '0.4920', 'ndcg_linear@5': '0.8125', 'ndcg_linear@10': '0.8125', 'ndcg_exponential@1': '0.4920', 'ndcg_exponential@5': '0.8125', 'ndcg_exponential@10': '0.8125', 'precision@1': '0.4920', 'precision@5': '0.2000', 'precision@10': '0.1000', 'recall@1': '0.4920', 'recall@5': '1.0000', 'recall@10': '1.0000', 'f1@1': '0.4920', 'f1@5': '0.3333', 'f1@10': '0.1818', 'map@1': '0.4920', 'map@5': '0.7460', 'map@10': '0.7460', 'mrr@1': '0.4920', 'mrr@5': '0.7460', 'mrr@10': '0.7460', 'num_pred': '1000.0000', 'num_data': '1000.0000'}
[2026-01-16 02:57:30,512] INFO [src.utils:21] --- Evaluating VOC2007 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 464.99 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1138.12 examples/s]
[2026-01-16 02:57:32,856] INFO [src.utils:21] Encoding queries...
Queries for VOC2007 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for VOC2007 (rank 0):   2%|▏         | 1/42 [00:00<00:32,  1.27it/s]Queries for VOC2007 (rank 0):   5%|▍         | 2/42 [00:01<00:29,  1.34it/s]Queries for VOC2007 (rank 0):   7%|▋         | 3/42 [00:02<00:28,  1.36it/s]Queries for VOC2007 (rank 0):  10%|▉         | 4/42 [00:02<00:25,  1.50it/s]Queries for VOC2007 (rank 0):  12%|█▏        | 5/42 [00:03<00:25,  1.45it/s]Queries for VOC2007 (rank 0):  14%|█▍        | 6/42 [00:04<00:23,  1.55it/s]Queries for VOC2007 (rank 0):  17%|█▋        | 7/42 [00:04<00:24,  1.42it/s]Queries for VOC2007 (rank 0):  19%|█▉        | 8/42 [00:05<00:23,  1.44it/s]Queries for VOC2007 (rank 0):  21%|██▏       | 9/42 [00:06<00:21,  1.51it/s]Queries for VOC2007 (rank 0):  24%|██▍       | 10/42 [00:06<00:20,  1.53it/s]Queries for VOC2007 (rank 0):  26%|██▌       | 11/42 [00:07<00:21,  1.42it/s]Queries for VOC2007 (rank 0):  29%|██▊       | 12/42 [00:08<00:21,  1.36it/s]Queries for VOC2007 (rank 0):  31%|███       | 13/42 [00:09<00:22,  1.32it/s]Queries for VOC2007 (rank 0):  33%|███▎      | 14/42 [00:09<00:20,  1.34it/s]Queries for VOC2007 (rank 0):  36%|███▌      | 15/42 [00:10<00:20,  1.35it/s]Queries for VOC2007 (rank 0):  38%|███▊      | 16/42 [00:11<00:19,  1.35it/s]Queries for VOC2007 (rank 0):  40%|████      | 17/42 [00:12<00:18,  1.34it/s]Queries for VOC2007 (rank 0):  43%|████▎     | 18/42 [00:13<00:18,  1.28it/s]Queries for VOC2007 (rank 0):  45%|████▌     | 19/42 [00:13<00:16,  1.37it/s]Queries for VOC2007 (rank 0):  48%|████▊     | 20/42 [00:14<00:15,  1.45it/s]Queries for VOC2007 (rank 0):  50%|█████     | 21/42 [00:14<00:14,  1.48it/s]Queries for VOC2007 (rank 0):  52%|█████▏    | 22/42 [00:15<00:13,  1.49it/s]Queries for VOC2007 (rank 0):  55%|█████▍    | 23/42 [00:16<00:13,  1.46it/s]Queries for VOC2007 (rank 0):  57%|█████▋    | 24/42 [00:17<00:12,  1.41it/s]Queries for VOC2007 (rank 0):  60%|█████▉    | 25/42 [00:17<00:12,  1.36it/s]Queries for VOC2007 (rank 0):  62%|██████▏   | 26/42 [00:18<00:12,  1.29it/s]Queries for VOC2007 (rank 0):  64%|██████▍   | 27/42 [00:19<00:11,  1.32it/s]Queries for VOC2007 (rank 0):  67%|██████▋   | 28/42 [00:20<00:10,  1.34it/s]Queries for VOC2007 (rank 0):  69%|██████▉   | 29/42 [00:21<00:10,  1.26it/s]Queries for VOC2007 (rank 0):  71%|███████▏  | 30/42 [00:21<00:09,  1.31it/s]Queries for VOC2007 (rank 0):  74%|███████▍  | 31/42 [00:22<00:08,  1.32it/s]Queries for VOC2007 (rank 0):  76%|███████▌  | 32/42 [00:23<00:07,  1.27it/s]Queries for VOC2007 (rank 0):  79%|███████▊  | 33/42 [00:24<00:07,  1.18it/s]Queries for VOC2007 (rank 0):  81%|████████  | 34/42 [00:24<00:06,  1.29it/s]Queries for VOC2007 (rank 0):  83%|████████▎ | 35/42 [00:25<00:05,  1.32it/s]Queries for VOC2007 (rank 0):  86%|████████▌ | 36/42 [00:26<00:04,  1.45it/s]Queries for VOC2007 (rank 0):  88%|████████▊ | 37/42 [00:27<00:03,  1.37it/s]Queries for VOC2007 (rank 0):  90%|█████████ | 38/42 [00:27<00:02,  1.35it/s]Queries for VOC2007 (rank 0):  93%|█████████▎| 39/42 [00:28<00:02,  1.43it/s]Queries for VOC2007 (rank 0):  95%|█████████▌| 40/42 [00:29<00:01,  1.34it/s]Queries for VOC2007 (rank 0):  98%|█████████▊| 41/42 [00:30<00:01,  1.05s/it]Queries for VOC2007 (rank 0): 100%|██████████| 42/42 [00:31<00:00,  1.13it/s]Queries for VOC2007 (rank 0): 100%|██████████| 42/42 [00:31<00:00,  1.33it/s]
[2026-01-16 02:58:04,368] INFO [src.utils:21] Query embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/VOC2007_qry, skipping saving.
[2026-01-16 02:58:04,368] INFO [src.utils:21] Encoding candidates...
Candidates for VOC2007 (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for VOC2007 (rank 0): 100%|██████████| 1/1 [00:00<00:00, 13.58it/s]
[2026-01-16 02:58:04,445] INFO [src.utils:21] Target embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/VOC2007_tgt, skipping saving.
[2026-01-16 02:58:04,445] INFO [src.utils:21] --- Scoring for layer -1 ---
[2026-01-16 02:58:04,446] INFO [src.utils:21] Score of VOC2007 (loaded from previous run): /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/VOC2007_score.json
[2026-01-16 02:58:04,446] INFO [src.utils:21] {'hit@1': '0.2020', 'hit@5': '0.2750', 'hit@10': '0.6250', 'ndcg_linear@1': '0.2020', 'ndcg_linear@5': '0.2371', 'ndcg_linear@10': '0.3465', 'ndcg_exponential@1': '0.2020', 'ndcg_exponential@5': '0.2371', 'ndcg_exponential@10': '0.3465', 'precision@1': '0.2020', 'precision@5': '0.0550', 'precision@10': '0.0625', 'recall@1': '0.2020', 'recall@5': '0.2750', 'recall@10': '0.6250', 'f1@1': '0.2020', 'f1@5': '0.0917', 'f1@10': '0.1136', 'map@1': '0.2020', 'map@5': '0.2248', 'map@10': '0.2679', 'mrr@1': '0.2020', 'mrr@5': '0.2248', 'mrr@10': '0.2679', 'num_pred': '1000.0000', 'num_data': '1000.0000'}
[2026-01-16 02:58:04,446] INFO [src.utils:21] --- Evaluating Place365 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 398.68 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1589.54 examples/s]Map (num_proc=4): 2000 examples [00:01, 866.77 examples/s] 
[2026-01-16 02:58:07,860] INFO [src.utils:21] Encoding queries...
Queries for Place365 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for Place365 (rank 0):   2%|▏         | 1/42 [00:00<00:23,  1.73it/s]Queries for Place365 (rank 0):   5%|▍         | 2/42 [00:01<00:22,  1.77it/s]Queries for Place365 (rank 0):   7%|▋         | 3/42 [00:01<00:21,  1.79it/s]Queries for Place365 (rank 0):  10%|▉         | 4/42 [00:02<00:21,  1.80it/s]Queries for Place365 (rank 0):  12%|█▏        | 5/42 [00:02<00:20,  1.81it/s]Queries for Place365 (rank 0):  14%|█▍        | 6/42 [00:03<00:19,  1.82it/s]Queries for Place365 (rank 0):  17%|█▋        | 7/42 [00:03<00:19,  1.82it/s]Queries for Place365 (rank 0):  19%|█▉        | 8/42 [00:04<00:18,  1.82it/s]Queries for Place365 (rank 0):  21%|██▏       | 9/42 [00:04<00:18,  1.83it/s]Queries for Place365 (rank 0):  24%|██▍       | 10/42 [00:05<00:17,  1.83it/s]Queries for Place365 (rank 0):  26%|██▌       | 11/42 [00:06<00:16,  1.83it/s]Queries for Place365 (rank 0):  29%|██▊       | 12/42 [00:06<00:16,  1.83it/s]Queries for Place365 (rank 0):  31%|███       | 13/42 [00:07<00:15,  1.83it/s]Queries for Place365 (rank 0):  33%|███▎      | 14/42 [00:07<00:15,  1.83it/s]Queries for Place365 (rank 0):  36%|███▌      | 15/42 [00:08<00:14,  1.83it/s]Queries for Place365 (rank 0):  38%|███▊      | 16/42 [00:08<00:14,  1.83it/s]Queries for Place365 (rank 0):  40%|████      | 17/42 [00:09<00:13,  1.83it/s]Queries for Place365 (rank 0):  43%|████▎     | 18/42 [00:09<00:13,  1.83it/s]Queries for Place365 (rank 0):  45%|████▌     | 19/42 [00:10<00:12,  1.83it/s]Queries for Place365 (rank 0):  48%|████▊     | 20/42 [00:10<00:12,  1.82it/s]Queries for Place365 (rank 0):  50%|█████     | 21/42 [00:11<00:11,  1.82it/s]Queries for Place365 (rank 0):  52%|█████▏    | 22/42 [00:12<00:10,  1.82it/s]Queries for Place365 (rank 0):  55%|█████▍    | 23/42 [00:12<00:10,  1.82it/s]Queries for Place365 (rank 0):  57%|█████▋    | 24/42 [00:13<00:09,  1.82it/s]Queries for Place365 (rank 0):  60%|█████▉    | 25/42 [00:13<00:09,  1.82it/s]Queries for Place365 (rank 0):  62%|██████▏   | 26/42 [00:14<00:08,  1.82it/s]Queries for Place365 (rank 0):  64%|██████▍   | 27/42 [00:14<00:08,  1.82it/s]Queries for Place365 (rank 0):  67%|██████▋   | 28/42 [00:15<00:07,  1.82it/s]Queries for Place365 (rank 0):  69%|██████▉   | 29/42 [00:15<00:07,  1.82it/s]Queries for Place365 (rank 0):  71%|███████▏  | 30/42 [00:16<00:06,  1.82it/s]Queries for Place365 (rank 0):  74%|███████▍  | 31/42 [00:17<00:06,  1.82it/s]Queries for Place365 (rank 0):  76%|███████▌  | 32/42 [00:17<00:05,  1.81it/s]Queries for Place365 (rank 0):  79%|███████▊  | 33/42 [00:18<00:04,  1.81it/s]Queries for Place365 (rank 0):  81%|████████  | 34/42 [00:18<00:04,  1.82it/s]Queries for Place365 (rank 0):  83%|████████▎ | 35/42 [00:19<00:03,  1.82it/s]Queries for Place365 (rank 0):  86%|████████▌ | 36/42 [00:19<00:03,  1.82it/s]Queries for Place365 (rank 0):  88%|████████▊ | 37/42 [00:20<00:02,  1.82it/s]Queries for Place365 (rank 0):  90%|█████████ | 38/42 [00:20<00:02,  1.82it/s]Queries for Place365 (rank 0):  93%|█████████▎| 39/42 [00:21<00:01,  1.79it/s]Queries for Place365 (rank 0):  95%|█████████▌| 40/42 [00:22<00:01,  1.80it/s]Queries for Place365 (rank 0):  98%|█████████▊| 41/42 [00:22<00:00,  1.81it/s]Queries for Place365 (rank 0): 100%|██████████| 42/42 [00:22<00:00,  1.97it/s]Queries for Place365 (rank 0): 100%|██████████| 42/42 [00:22<00:00,  1.83it/s]
[2026-01-16 02:58:30,909] INFO [src.utils:21] Query embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Place365_qry, skipping saving.
[2026-01-16 02:58:30,909] INFO [src.utils:21] Encoding candidates...
Candidates for Place365 (rank 0):   0%|          | 0/16 [00:00<?, ?it/s]Candidates for Place365 (rank 0):  12%|█▎        | 2/16 [00:00<00:01, 12.06it/s]Candidates for Place365 (rank 0):  25%|██▌       | 4/16 [00:00<00:00, 12.24it/s]Candidates for Place365 (rank 0):  38%|███▊      | 6/16 [00:00<00:00, 12.06it/s]Candidates for Place365 (rank 0):  50%|█████     | 8/16 [00:00<00:00, 12.27it/s]Candidates for Place365 (rank 0):  62%|██████▎   | 10/16 [00:00<00:00, 12.40it/s]Candidates for Place365 (rank 0):  75%|███████▌  | 12/16 [00:00<00:00, 12.75it/s]Candidates for Place365 (rank 0):  88%|████████▊ | 14/16 [00:01<00:00, 12.70it/s]Candidates for Place365 (rank 0): 100%|██████████| 16/16 [00:01<00:00, 12.88it/s]Candidates for Place365 (rank 0): 100%|██████████| 16/16 [00:01<00:00, 12.59it/s]
[2026-01-16 02:58:32,185] INFO [src.utils:21] Target embeddings for layer -1 already exist at /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Place365_tgt, skipping saving.
[2026-01-16 02:58:32,185] INFO [src.utils:21] --- Scoring for layer -1 ---
[2026-01-16 02:58:32,186] INFO [src.utils:21] Score of Place365 (loaded from previous run): /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Place365_score.json
[2026-01-16 02:58:32,186] INFO [src.utils:21] {'hit@1': '0.2870', 'hit@5': '0.5160', 'hit@10': '0.6240', 'ndcg_linear@1': '0.2870', 'ndcg_linear@5': '0.4083', 'ndcg_linear@10': '0.4434', 'ndcg_exponential@1': '0.2870', 'ndcg_exponential@5': '0.4083', 'ndcg_exponential@10': '0.4434', 'precision@1': '0.2870', 'precision@5': '0.1032', 'precision@10': '0.0624', 'recall@1': '0.2870', 'recall@5': '0.5160', 'recall@10': '0.6240', 'f1@1': '0.2870', 'f1@5': '0.1720', 'f1@10': '0.1135', 'map@1': '0.2870', 'map@5': '0.3725', 'map@10': '0.3872', 'mrr@1': '0.2870', 'mrr@5': '0.3725', 'mrr@10': '0.3872', 'num_pred': '1000.0000', 'num_data': '1000.0000'}
[2026-01-16 02:58:32,186] INFO [src.utils:21] --- Evaluating Country211 ---
Generating test split:   0%|          | 0/1000 [00:00<?, ? examples/s]Generating test split: 100%|██████████| 1000/1000 [00:00<00:00, 20930.50 examples/s]
Map (num_proc=4):   0%|          | 0/1000 [00:00<?, ? examples/s]Map (num_proc=4):  25%|██▌       | 250/1000 [00:00<00:01, 427.26 examples/s]Map (num_proc=4): 100%|██████████| 1000/1000 [00:01<00:00, 964.82 examples/s]
[2026-01-16 02:58:35,863] INFO [src.utils:21] Encoding queries...
Queries for Country211 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for Country211 (rank 0):   2%|▏         | 1/42 [00:01<00:52,  1.28s/it]Queries for Country211 (rank 0):   5%|▍         | 2/42 [00:02<00:50,  1.26s/it]Queries for Country211 (rank 0):   7%|▋         | 3/42 [00:03<00:49,  1.26s/it]Queries for Country211 (rank 0):  10%|▉         | 4/42 [00:05<00:47,  1.26s/it]Queries for Country211 (rank 0):  12%|█▏        | 5/42 [00:06<00:46,  1.25s/it]Queries for Country211 (rank 0):  14%|█▍        | 6/42 [00:07<00:46,  1.30s/it]Queries for Country211 (rank 0):  17%|█▋        | 7/42 [00:09<00:47,  1.36s/it]Queries for Country211 (rank 0):  19%|█▉        | 8/42 [00:10<00:45,  1.33s/it]Queries for Country211 (rank 0):  21%|██▏       | 9/42 [00:11<00:43,  1.31s/it]Queries for Country211 (rank 0):  24%|██▍       | 10/42 [00:13<00:43,  1.37s/it]Queries for Country211 (rank 0):  26%|██▌       | 11/42 [00:14<00:43,  1.40s/it]Queries for Country211 (rank 0):  29%|██▊       | 12/42 [00:16<00:42,  1.42s/it]Queries for Country211 (rank 0):  31%|███       | 13/42 [00:17<00:39,  1.38s/it]Queries for Country211 (rank 0):  33%|███▎      | 14/42 [00:18<00:39,  1.41s/it]Queries for Country211 (rank 0):  36%|███▌      | 15/42 [00:20<00:36,  1.36s/it]Queries for Country211 (rank 0):  38%|███▊      | 16/42 [00:21<00:36,  1.40s/it]Queries for Country211 (rank 0):  40%|████      | 17/42 [00:23<00:35,  1.42s/it]Queries for Country211 (rank 0):  43%|████▎     | 18/42 [00:24<00:34,  1.44s/it]Queries for Country211 (rank 0):  45%|████▌     | 19/42 [00:25<00:32,  1.39s/it]Queries for Country211 (rank 0):  48%|████▊     | 20/42 [00:27<00:35,  1.59s/it]Queries for Country211 (rank 0):  50%|█████     | 21/42 [00:29<00:31,  1.48s/it]Queries for Country211 (rank 0):  52%|█████▏    | 22/42 [00:30<00:29,  1.48s/it]Queries for Country211 (rank 0):  55%|█████▍    | 23/42 [00:32<00:28,  1.47s/it]Queries for Country211 (rank 0):  57%|█████▋    | 24/42 [00:33<00:26,  1.48s/it]Queries for Country211 (rank 0):  60%|█████▉    | 25/42 [00:35<00:25,  1.48s/it]Queries for Country211 (rank 0):  62%|██████▏   | 26/42 [00:36<00:23,  1.47s/it]Queries for Country211 (rank 0):  64%|██████▍   | 27/42 [00:37<00:21,  1.43s/it]Queries for Country211 (rank 0):  67%|██████▋   | 28/42 [00:39<00:19,  1.38s/it]Queries for Country211 (rank 0):  69%|██████▉   | 29/42 [00:40<00:18,  1.41s/it]Queries for Country211 (rank 0):  71%|███████▏  | 30/42 [00:41<00:16,  1.40s/it]Queries for Country211 (rank 0):  74%|███████▍  | 31/42 [00:43<00:14,  1.35s/it]Queries for Country211 (rank 0):  76%|███████▌  | 32/42 [00:44<00:13,  1.38s/it]Queries for Country211 (rank 0):  79%|███████▊  | 33/42 [00:46<00:12,  1.41s/it]Queries for Country211 (rank 0):  81%|████████  | 34/42 [00:47<00:11,  1.38s/it]Queries for Country211 (rank 0):  83%|████████▎ | 35/42 [00:48<00:09,  1.38s/it]Queries for Country211 (rank 0):  86%|████████▌ | 36/42 [00:50<00:08,  1.41s/it]Queries for Country211 (rank 0):  88%|████████▊ | 37/42 [00:51<00:07,  1.43s/it]Queries for Country211 (rank 0):  90%|█████████ | 38/42 [00:53<00:05,  1.45s/it]Queries for Country211 (rank 0):  93%|█████████▎| 39/42 [00:54<00:04,  1.45s/it]Queries for Country211 (rank 0):  95%|█████████▌| 40/42 [00:55<00:02,  1.39s/it]Queries for Country211 (rank 0):  98%|█████████▊| 41/42 [00:57<00:01,  1.42s/it]Queries for Country211 (rank 0): 100%|██████████| 42/42 [00:58<00:00,  1.31s/it]Queries for Country211 (rank 0): 100%|██████████| 42/42 [00:58<00:00,  1.39s/it]
[2026-01-16 02:59:34,510] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Country211_qry
[2026-01-16 02:59:34,510] INFO [src.utils:21] Encoding candidates...
Candidates for Country211 (rank 0):   0%|          | 0/9 [00:00<?, ?it/s]Candidates for Country211 (rank 0):  11%|█         | 1/9 [00:00<00:00,  9.75it/s]Candidates for Country211 (rank 0):  33%|███▎      | 3/9 [00:00<00:00, 11.73it/s]Candidates for Country211 (rank 0):  56%|█████▌    | 5/9 [00:00<00:00, 12.20it/s]Candidates for Country211 (rank 0):  78%|███████▊  | 7/9 [00:00<00:00, 11.80it/s]Candidates for Country211 (rank 0): 100%|██████████| 9/9 [00:00<00:00, 12.18it/s]Candidates for Country211 (rank 0): 100%|██████████| 9/9 [00:00<00:00, 11.98it/s]
[2026-01-16 02:59:35,287] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Country211_tgt
[2026-01-16 02:59:35,287] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for Country211: 0it [00:00, ?it/s]Calculating scores for Country211: 147it [00:00, 1463.33it/s]Calculating scores for Country211: 294it [00:00, 1421.52it/s]Calculating scores for Country211: 440it [00:00, 1435.23it/s]Calculating scores for Country211: 584it [00:00, 1436.07it/s]Calculating scores for Country211: 731it [00:00, 1444.76it/s]Calculating scores for Country211: 876it [00:00, 1445.77it/s]Calculating scores for Country211: 1000it [00:00, 1439.54it/s]
[2026-01-16 02:59:36,139] INFO [src.utils:21] Score of Country211:
[2026-01-16 02:59:36,139] INFO [src.utils:21] {'hit@1': '0.0390', 'hit@5': '0.1310', 'hit@10': '0.2080', 'ndcg_linear@1': '0.0390', 'ndcg_linear@5': '0.0870', 'ndcg_linear@10': '0.1115', 'ndcg_exponential@1': '0.0390', 'ndcg_exponential@5': '0.0870', 'ndcg_exponential@10': '0.1115', 'precision@1': '0.0390', 'precision@5': '0.0262', 'precision@10': '0.0208', 'recall@1': '0.0390', 'recall@5': '0.1310', 'recall@10': '0.2080', 'f1@1': '0.0390', 'f1@5': '0.0437', 'f1@10': '0.0378', 'map@1': '0.0390', 'map@5': '0.0724', 'map@10': '0.0824', 'mrr@1': '0.0390', 'mrr@5': '0.0724', 'mrr@10': '0.0824'}
[2026-01-16 02:59:36,139] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/5Jan_Qwen3VL4b_rmv_21_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Country211_score.json

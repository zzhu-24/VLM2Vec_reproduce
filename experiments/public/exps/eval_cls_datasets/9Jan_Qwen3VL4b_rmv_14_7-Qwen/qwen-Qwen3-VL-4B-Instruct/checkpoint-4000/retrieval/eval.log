/home/infres/zzhu-24/anaconda3/envs/vlm2vec_update/lib/python3.10/site-packages/requests/__init__.py:86: RequestsDependencyWarning: Unable to find acceptable character detection dependency (chardet or charset_normalizer).
  warnings.warn(
[2026-01-16 03:44:33,953] INFO [src.utils:21] Distributed init debug info:
[2026-01-16 03:44:33,954] INFO [src.utils:21] RANK: None
[2026-01-16 03:44:33,954] INFO [src.utils:21] LOCAL_RANK: None
[2026-01-16 03:44:33,954] INFO [src.utils:21] WORLD_SIZE: None
[2026-01-16 03:44:33,954] INFO [src.utils:21] MASTER_ADDR: None
[2026-01-16 03:44:33,954] INFO [src.utils:21] MASTER_PORT: None
[2026-01-16 03:44:35,764] INFO [src.utils:21] Model Backbone: qwen3_vl
[2026-01-16 03:44:35,764] INFO [src.utils:21] Loading processor from: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/9Jan_Qwen3VL4b_rmv_14_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4000
[2026-01-16 03:44:37,896] INFO [src.utils:21] Loading backbone [qwen3_vl] from /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/9Jan_Qwen3VL4b_rmv_14_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4000
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 21.21it/s]
[2026-01-16 03:44:38,404] INFO [src.utils:21] Loading LoRA from /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/9Jan_Qwen3VL4b_rmv_14_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4000
[2026-01-16 03:45:24,166] INFO [src.utils:21] [rank=0] Loading the model from Huggingface: Qwen/Qwen3-VL-4B-Instruct...
[2026-01-16 03:45:25,702] INFO [src.utils:21] --- Evaluating N24News ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 1096.99 examples/s]         Map (num_proc=4): 2000 examples [00:00, 2271.45 examples/s]
[2026-01-16 03:45:28,091] INFO [src.utils:21] Encoding queries...
Queries for N24News (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Queries for N24News (rank 0):   2%|▏         | 1/42 [00:04<02:46,  4.05s/it]Queries for N24News (rank 0):   5%|▍         | 2/42 [00:07<02:31,  3.78s/it]Queries for N24News (rank 0):   7%|▋         | 3/42 [00:11<02:21,  3.62s/it]Queries for N24News (rank 0):  10%|▉         | 4/42 [00:14<02:20,  3.70s/it]Queries for N24News (rank 0):  12%|█▏        | 5/42 [00:18<02:12,  3.59s/it]Queries for N24News (rank 0):  14%|█▍        | 6/42 [00:21<02:08,  3.57s/it]Queries for N24News (rank 0):  17%|█▋        | 7/42 [00:25<02:04,  3.56s/it]Queries for N24News (rank 0):  19%|█▉        | 8/42 [00:29<02:03,  3.63s/it]Queries for N24News (rank 0):  21%|██▏       | 9/42 [00:32<01:58,  3.60s/it]Queries for N24News (rank 0):  24%|██▍       | 10/42 [00:36<01:55,  3.59s/it]Queries for N24News (rank 0):  26%|██▌       | 11/42 [00:39<01:51,  3.59s/it]Queries for N24News (rank 0):  29%|██▊       | 12/42 [00:43<01:45,  3.51s/it]Queries for N24News (rank 0):  31%|███       | 13/42 [00:46<01:41,  3.50s/it]Queries for N24News (rank 0):  33%|███▎      | 14/42 [00:50<01:38,  3.53s/it]Queries for N24News (rank 0):  36%|███▌      | 15/42 [00:53<01:34,  3.49s/it]Queries for N24News (rank 0):  38%|███▊      | 16/42 [00:57<01:32,  3.58s/it]Queries for N24News (rank 0):  40%|████      | 17/42 [01:00<01:28,  3.55s/it]Queries for N24News (rank 0):  43%|████▎     | 18/42 [01:04<01:25,  3.55s/it]Queries for N24News (rank 0):  45%|████▌     | 19/42 [01:07<01:20,  3.49s/it]Queries for N24News (rank 0):  48%|████▊     | 20/42 [01:11<01:16,  3.50s/it]Queries for N24News (rank 0):  50%|█████     | 21/42 [01:14<01:14,  3.53s/it]Queries for N24News (rank 0):  52%|█████▏    | 22/42 [01:18<01:10,  3.54s/it]Queries for N24News (rank 0):  55%|█████▍    | 23/42 [01:22<01:07,  3.54s/it]Queries for N24News (rank 0):  57%|█████▋    | 24/42 [01:25<01:03,  3.53s/it]Queries for N24News (rank 0):  60%|█████▉    | 25/42 [01:28<00:59,  3.51s/it]Queries for N24News (rank 0):  62%|██████▏   | 26/42 [01:32<00:57,  3.58s/it]Queries for N24News (rank 0):  64%|██████▍   | 27/42 [01:36<00:54,  3.62s/it]Queries for N24News (rank 0):  67%|██████▋   | 28/42 [01:39<00:49,  3.55s/it]Queries for N24News (rank 0):  69%|██████▉   | 29/42 [01:43<00:47,  3.64s/it]Queries for N24News (rank 0):  71%|███████▏  | 30/42 [01:47<00:43,  3.59s/it]Queries for N24News (rank 0):  74%|███████▍  | 31/42 [01:50<00:39,  3.63s/it]Queries for N24News (rank 0):  76%|███████▌  | 32/42 [01:54<00:35,  3.52s/it]Queries for N24News (rank 0):  79%|███████▊  | 33/42 [01:57<00:31,  3.51s/it]Queries for N24News (rank 0):  81%|████████  | 34/42 [02:01<00:27,  3.47s/it]Queries for N24News (rank 0):  83%|████████▎ | 35/42 [02:04<00:24,  3.47s/it]Queries for N24News (rank 0):  86%|████████▌ | 36/42 [02:08<00:20,  3.49s/it]Queries for N24News (rank 0):  88%|████████▊ | 37/42 [02:11<00:17,  3.49s/it]Queries for N24News (rank 0):  90%|█████████ | 38/42 [02:14<00:13,  3.48s/it]Queries for N24News (rank 0):  93%|█████████▎| 39/42 [02:18<00:10,  3.53s/it]Queries for N24News (rank 0):  95%|█████████▌| 40/42 [02:22<00:07,  3.55s/it]Queries for N24News (rank 0):  98%|█████████▊| 41/42 [02:25<00:03,  3.55s/it]Queries for N24News (rank 0): 100%|██████████| 42/42 [02:28<00:00,  3.20s/it]Queries for N24News (rank 0): 100%|██████████| 42/42 [02:28<00:00,  3.53s/it]
[2026-01-16 03:47:56,343] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/N24News_qry
[2026-01-16 03:47:56,343] INFO [src.utils:21] Encoding candidates...
Candidates for N24News (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for N24News (rank 0): 100%|██████████| 1/1 [00:00<00:00, 11.61it/s]
[2026-01-16 03:47:56,436] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/N24News_tgt
[2026-01-16 03:47:56,436] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for N24News: 0it [00:00, ?it/s]Calculating scores for N24News: 1000it [00:00, 10194.68it/s]
[2026-01-16 03:47:56,671] INFO [src.utils:21] Score of N24News:
[2026-01-16 03:47:56,671] INFO [src.utils:21] {'hit@1': '0.1910', 'hit@5': '0.4580', 'hit@10': '0.6640', 'ndcg_linear@1': '0.1910', 'ndcg_linear@5': '0.3271', 'ndcg_linear@10': '0.3928', 'ndcg_exponential@1': '0.1910', 'ndcg_exponential@5': '0.3271', 'ndcg_exponential@10': '0.3928', 'precision@1': '0.1910', 'precision@5': '0.0916', 'precision@10': '0.0664', 'recall@1': '0.1910', 'recall@5': '0.4580', 'recall@10': '0.6640', 'f1@1': '0.1910', 'f1@5': '0.1527', 'f1@10': '0.1207', 'map@1': '0.1910', 'map@5': '0.2841', 'map@10': '0.3107', 'mrr@1': '0.1910', 'mrr@5': '0.2841', 'mrr@10': '0.3107'}
[2026-01-16 03:47:56,671] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/N24News_score.json
[2026-01-16 03:47:56,681] INFO [src.utils:21] --- Evaluating HatefulMemes ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 507.14 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1213.53 examples/s]
[2026-01-16 03:47:58,710] INFO [src.utils:21] Encoding queries...
Queries for HatefulMemes (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for HatefulMemes (rank 0):   2%|▏         | 1/42 [00:02<01:46,  2.60s/it]Queries for HatefulMemes (rank 0):   5%|▍         | 2/42 [00:05<01:45,  2.64s/it]Queries for HatefulMemes (rank 0):   7%|▋         | 3/42 [00:07<01:43,  2.65s/it]Queries for HatefulMemes (rank 0):  10%|▉         | 4/42 [00:10<01:36,  2.54s/it]Queries for HatefulMemes (rank 0):  12%|█▏        | 5/42 [00:13<01:38,  2.67s/it]Queries for HatefulMemes (rank 0):  14%|█▍        | 6/42 [00:16<01:38,  2.75s/it]Queries for HatefulMemes (rank 0):  17%|█▋        | 7/42 [00:19<01:39,  2.83s/it]Queries for HatefulMemes (rank 0):  19%|█▉        | 8/42 [00:21<01:32,  2.71s/it]Queries for HatefulMemes (rank 0):  21%|██▏       | 9/42 [00:23<01:26,  2.62s/it]Queries for HatefulMemes (rank 0):  24%|██▍       | 10/42 [00:26<01:24,  2.64s/it]Queries for HatefulMemes (rank 0):  26%|██▌       | 11/42 [00:29<01:22,  2.67s/it]Queries for HatefulMemes (rank 0):  29%|██▊       | 12/42 [00:31<01:18,  2.63s/it]Queries for HatefulMemes (rank 0):  31%|███       | 13/42 [00:34<01:16,  2.63s/it]Queries for HatefulMemes (rank 0):  33%|███▎      | 14/42 [00:37<01:14,  2.67s/it]Queries for HatefulMemes (rank 0):  36%|███▌      | 15/42 [00:39<01:10,  2.62s/it]Queries for HatefulMemes (rank 0):  38%|███▊      | 16/42 [00:42<01:07,  2.59s/it]Queries for HatefulMemes (rank 0):  40%|████      | 17/42 [00:44<01:04,  2.59s/it]Queries for HatefulMemes (rank 0):  43%|████▎     | 18/42 [00:47<01:03,  2.64s/it]Queries for HatefulMemes (rank 0):  45%|████▌     | 19/42 [00:50<01:02,  2.72s/it]Queries for HatefulMemes (rank 0):  48%|████▊     | 20/42 [00:53<01:02,  2.85s/it]Queries for HatefulMemes (rank 0):  50%|█████     | 21/42 [00:56<00:59,  2.84s/it]Queries for HatefulMemes (rank 0):  52%|█████▏    | 22/42 [00:59<00:55,  2.80s/it]Queries for HatefulMemes (rank 0):  55%|█████▍    | 23/42 [01:02<00:53,  2.81s/it]Queries for HatefulMemes (rank 0):  57%|█████▋    | 24/42 [01:04<00:50,  2.83s/it]Queries for HatefulMemes (rank 0):  60%|█████▉    | 25/42 [01:07<00:48,  2.88s/it]Queries for HatefulMemes (rank 0):  62%|██████▏   | 26/42 [01:10<00:44,  2.79s/it]Queries for HatefulMemes (rank 0):  64%|██████▍   | 27/42 [01:13<00:42,  2.81s/it]Queries for HatefulMemes (rank 0):  67%|██████▋   | 28/42 [01:16<00:39,  2.85s/it]Queries for HatefulMemes (rank 0):  69%|██████▉   | 29/42 [01:18<00:36,  2.78s/it]Queries for HatefulMemes (rank 0):  71%|███████▏  | 30/42 [01:21<00:33,  2.78s/it]Queries for HatefulMemes (rank 0):  74%|███████▍  | 31/42 [01:24<00:30,  2.78s/it]Queries for HatefulMemes (rank 0):  76%|███████▌  | 32/42 [01:27<00:27,  2.75s/it]Queries for HatefulMemes (rank 0):  79%|███████▊  | 33/42 [01:30<00:24,  2.77s/it]Queries for HatefulMemes (rank 0):  81%|████████  | 34/42 [01:32<00:22,  2.78s/it]Queries for HatefulMemes (rank 0):  83%|████████▎ | 35/42 [01:36<00:20,  2.93s/it]Queries for HatefulMemes (rank 0):  86%|████████▌ | 36/42 [01:38<00:17,  2.88s/it]Queries for HatefulMemes (rank 0):  88%|████████▊ | 37/42 [01:41<00:13,  2.80s/it]Queries for HatefulMemes (rank 0):  90%|█████████ | 38/42 [01:44<00:11,  2.88s/it]Queries for HatefulMemes (rank 0):  93%|█████████▎| 39/42 [01:47<00:08,  2.75s/it]Queries for HatefulMemes (rank 0):  95%|█████████▌| 40/42 [01:50<00:05,  2.84s/it]Queries for HatefulMemes (rank 0):  98%|█████████▊| 41/42 [01:52<00:02,  2.78s/it]Queries for HatefulMemes (rank 0): 100%|██████████| 42/42 [01:54<00:00,  2.57s/it]Queries for HatefulMemes (rank 0): 100%|██████████| 42/42 [01:54<00:00,  2.73s/it]
[2026-01-16 03:49:53,584] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/HatefulMemes_qry
[2026-01-16 03:49:53,585] INFO [src.utils:21] Encoding candidates...
Candidates for HatefulMemes (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for HatefulMemes (rank 0): 100%|██████████| 1/1 [00:00<00:00, 13.79it/s]
[2026-01-16 03:49:53,662] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/HatefulMemes_tgt
[2026-01-16 03:49:53,663] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for HatefulMemes: 0it [00:00, ?it/s]Calculating scores for HatefulMemes: 1000it [00:00, 36447.80it/s]
[2026-01-16 03:49:53,856] INFO [src.utils:21] Score of HatefulMemes:
[2026-01-16 03:49:53,856] INFO [src.utils:21] {'hit@1': '0.4870', 'hit@5': '1.0000', 'hit@10': '1.0000', 'ndcg_linear@1': '0.4870', 'ndcg_linear@5': '0.8107', 'ndcg_linear@10': '0.8107', 'ndcg_exponential@1': '0.4870', 'ndcg_exponential@5': '0.8107', 'ndcg_exponential@10': '0.8107', 'precision@1': '0.4870', 'precision@5': '0.2000', 'precision@10': '0.1000', 'recall@1': '0.4870', 'recall@5': '1.0000', 'recall@10': '1.0000', 'f1@1': '0.4870', 'f1@5': '0.3333', 'f1@10': '0.1818', 'map@1': '0.4870', 'map@5': '0.7435', 'map@10': '0.7435', 'mrr@1': '0.4870', 'mrr@5': '0.7435', 'mrr@10': '0.7435'}
[2026-01-16 03:49:53,856] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/HatefulMemes_score.json
[2026-01-16 03:49:53,861] INFO [src.utils:21] --- Evaluating VOC2007 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 498.10 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1200.16 examples/s]
[2026-01-16 03:49:59,402] INFO [src.utils:21] Encoding queries...
Queries for VOC2007 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for VOC2007 (rank 0):   2%|▏         | 1/42 [00:00<00:31,  1.31it/s]Queries for VOC2007 (rank 0):   5%|▍         | 2/42 [00:01<00:29,  1.36it/s]Queries for VOC2007 (rank 0):   7%|▋         | 3/42 [00:02<00:28,  1.37it/s]Queries for VOC2007 (rank 0):  10%|▉         | 4/42 [00:02<00:25,  1.51it/s]Queries for VOC2007 (rank 0):  12%|█▏        | 5/42 [00:03<00:25,  1.46it/s]Queries for VOC2007 (rank 0):  14%|█▍        | 6/42 [00:04<00:23,  1.56it/s]Queries for VOC2007 (rank 0):  17%|█▋        | 7/42 [00:04<00:24,  1.43it/s]Queries for VOC2007 (rank 0):  19%|█▉        | 8/42 [00:05<00:23,  1.45it/s]Queries for VOC2007 (rank 0):  21%|██▏       | 9/42 [00:06<00:21,  1.52it/s]Queries for VOC2007 (rank 0):  24%|██▍       | 10/42 [00:06<00:20,  1.54it/s]Queries for VOC2007 (rank 0):  26%|██▌       | 11/42 [00:07<00:21,  1.42it/s]Queries for VOC2007 (rank 0):  29%|██▊       | 12/42 [00:08<00:21,  1.37it/s]Queries for VOC2007 (rank 0):  31%|███       | 13/42 [00:09<00:22,  1.32it/s]Queries for VOC2007 (rank 0):  33%|███▎      | 14/42 [00:09<00:20,  1.34it/s]Queries for VOC2007 (rank 0):  36%|███▌      | 15/42 [00:10<00:19,  1.35it/s]Queries for VOC2007 (rank 0):  38%|███▊      | 16/42 [00:11<00:19,  1.35it/s]Queries for VOC2007 (rank 0):  40%|████      | 17/42 [00:12<00:18,  1.34it/s]Queries for VOC2007 (rank 0):  43%|████▎     | 18/42 [00:13<00:19,  1.26it/s]Queries for VOC2007 (rank 0):  45%|████▌     | 19/42 [00:13<00:16,  1.36it/s]Queries for VOC2007 (rank 0):  48%|████▊     | 20/42 [00:14<00:15,  1.44it/s]Queries for VOC2007 (rank 0):  50%|█████     | 21/42 [00:14<00:14,  1.47it/s]Queries for VOC2007 (rank 0):  52%|█████▏    | 22/42 [00:15<00:13,  1.48it/s]Queries for VOC2007 (rank 0):  55%|█████▍    | 23/42 [00:16<00:13,  1.45it/s]Queries for VOC2007 (rank 0):  57%|█████▋    | 24/42 [00:17<00:12,  1.40it/s]Queries for VOC2007 (rank 0):  60%|█████▉    | 25/42 [00:17<00:12,  1.35it/s]Queries for VOC2007 (rank 0):  62%|██████▏   | 26/42 [00:18<00:12,  1.29it/s]Queries for VOC2007 (rank 0):  64%|██████▍   | 27/42 [00:19<00:11,  1.32it/s]Queries for VOC2007 (rank 0):  67%|██████▋   | 28/42 [00:20<00:10,  1.33it/s]Queries for VOC2007 (rank 0):  69%|██████▉   | 29/42 [00:21<00:10,  1.26it/s]Queries for VOC2007 (rank 0):  71%|███████▏  | 30/42 [00:21<00:09,  1.31it/s]Queries for VOC2007 (rank 0):  74%|███████▍  | 31/42 [00:22<00:08,  1.32it/s]Queries for VOC2007 (rank 0):  76%|███████▌  | 32/42 [00:23<00:07,  1.27it/s]Queries for VOC2007 (rank 0):  79%|███████▊  | 33/42 [00:24<00:07,  1.18it/s]Queries for VOC2007 (rank 0):  81%|████████  | 34/42 [00:24<00:06,  1.29it/s]Queries for VOC2007 (rank 0):  83%|████████▎ | 35/42 [00:25<00:05,  1.32it/s]Queries for VOC2007 (rank 0):  86%|████████▌ | 36/42 [00:26<00:04,  1.45it/s]Queries for VOC2007 (rank 0):  88%|████████▊ | 37/42 [00:27<00:03,  1.37it/s]Queries for VOC2007 (rank 0):  90%|█████████ | 38/42 [00:27<00:02,  1.35it/s]Queries for VOC2007 (rank 0):  93%|█████████▎| 39/42 [00:28<00:02,  1.43it/s]Queries for VOC2007 (rank 0):  95%|█████████▌| 40/42 [00:29<00:01,  1.35it/s]Queries for VOC2007 (rank 0):  98%|█████████▊| 41/42 [00:30<00:00,  1.31it/s]Queries for VOC2007 (rank 0): 100%|██████████| 42/42 [00:30<00:00,  1.45it/s]Queries for VOC2007 (rank 0): 100%|██████████| 42/42 [00:30<00:00,  1.37it/s]
[2026-01-16 03:50:30,063] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/VOC2007_qry
[2026-01-16 03:50:30,063] INFO [src.utils:21] Encoding candidates...
Candidates for VOC2007 (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for VOC2007 (rank 0): 100%|██████████| 1/1 [00:00<00:00, 12.46it/s]
[2026-01-16 03:50:30,150] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/VOC2007_tgt
[2026-01-16 03:50:30,150] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for VOC2007: 0it [00:00, ?it/s]Calculating scores for VOC2007: 1000it [00:00, 12536.59it/s]
[2026-01-16 03:50:30,369] INFO [src.utils:21] Score of VOC2007:
[2026-01-16 03:50:30,369] INFO [src.utils:21] {'hit@1': '0.2080', 'hit@5': '0.4510', 'hit@10': '0.7880', 'ndcg_linear@1': '0.2080', 'ndcg_linear@5': '0.3223', 'ndcg_linear@10': '0.4308', 'ndcg_exponential@1': '0.2080', 'ndcg_exponential@5': '0.3223', 'ndcg_exponential@10': '0.4308', 'precision@1': '0.2080', 'precision@5': '0.0902', 'precision@10': '0.0788', 'recall@1': '0.2080', 'recall@5': '0.4510', 'recall@10': '0.7880', 'f1@1': '0.2080', 'f1@5': '0.1503', 'f1@10': '0.1433', 'map@1': '0.2080', 'map@5': '0.2811', 'map@10': '0.3255', 'mrr@1': '0.2080', 'mrr@5': '0.2811', 'mrr@10': '0.3255'}
[2026-01-16 03:50:30,369] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/VOC2007_score.json
[2026-01-16 03:50:30,377] INFO [src.utils:21] --- Evaluating Place365 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 410.38 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1650.56 examples/s]Map (num_proc=4): 2000 examples [00:01, 881.95 examples/s] 
[2026-01-16 03:50:33,487] INFO [src.utils:21] Encoding queries...
Queries for Place365 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for Place365 (rank 0):   2%|▏         | 1/42 [00:00<00:24,  1.65it/s]Queries for Place365 (rank 0):   5%|▍         | 2/42 [00:01<00:23,  1.74it/s]Queries for Place365 (rank 0):   7%|▋         | 3/42 [00:01<00:22,  1.77it/s]Queries for Place365 (rank 0):  10%|▉         | 4/42 [00:02<00:21,  1.77it/s]Queries for Place365 (rank 0):  12%|█▏        | 5/42 [00:02<00:20,  1.79it/s]Queries for Place365 (rank 0):  14%|█▍        | 6/42 [00:03<00:20,  1.77it/s]Queries for Place365 (rank 0):  17%|█▋        | 7/42 [00:03<00:19,  1.78it/s]Queries for Place365 (rank 0):  19%|█▉        | 8/42 [00:04<00:18,  1.79it/s]Queries for Place365 (rank 0):  21%|██▏       | 9/42 [00:05<00:18,  1.80it/s]Queries for Place365 (rank 0):  24%|██▍       | 10/42 [00:05<00:17,  1.80it/s]Queries for Place365 (rank 0):  26%|██▌       | 11/42 [00:06<00:17,  1.81it/s]Queries for Place365 (rank 0):  29%|██▊       | 12/42 [00:06<00:16,  1.81it/s]Queries for Place365 (rank 0):  31%|███       | 13/42 [00:07<00:16,  1.81it/s]Queries for Place365 (rank 0):  33%|███▎      | 14/42 [00:07<00:15,  1.81it/s]Queries for Place365 (rank 0):  36%|███▌      | 15/42 [00:08<00:14,  1.81it/s]Queries for Place365 (rank 0):  38%|███▊      | 16/42 [00:08<00:14,  1.81it/s]Queries for Place365 (rank 0):  40%|████      | 17/42 [00:09<00:13,  1.81it/s]Queries for Place365 (rank 0):  43%|████▎     | 18/42 [00:10<00:13,  1.82it/s]Queries for Place365 (rank 0):  45%|████▌     | 19/42 [00:10<00:12,  1.82it/s]Queries for Place365 (rank 0):  48%|████▊     | 20/42 [00:11<00:12,  1.82it/s]Queries for Place365 (rank 0):  50%|█████     | 21/42 [00:11<00:11,  1.82it/s]Queries for Place365 (rank 0):  52%|█████▏    | 22/42 [00:12<00:11,  1.82it/s]Queries for Place365 (rank 0):  55%|█████▍    | 23/42 [00:12<00:10,  1.81it/s]Queries for Place365 (rank 0):  57%|█████▋    | 24/42 [00:13<00:10,  1.78it/s]Queries for Place365 (rank 0):  60%|█████▉    | 25/42 [00:13<00:09,  1.80it/s]Queries for Place365 (rank 0):  62%|██████▏   | 26/42 [00:14<00:08,  1.81it/s]Queries for Place365 (rank 0):  64%|██████▍   | 27/42 [00:14<00:08,  1.81it/s]Queries for Place365 (rank 0):  67%|██████▋   | 28/42 [00:15<00:07,  1.82it/s]Queries for Place365 (rank 0):  69%|██████▉   | 29/42 [00:16<00:07,  1.82it/s]Queries for Place365 (rank 0):  71%|███████▏  | 30/42 [00:16<00:06,  1.82it/s]Queries for Place365 (rank 0):  74%|███████▍  | 31/42 [00:17<00:06,  1.81it/s]Queries for Place365 (rank 0):  76%|███████▌  | 32/42 [00:17<00:05,  1.82it/s]Queries for Place365 (rank 0):  79%|███████▊  | 33/42 [00:18<00:04,  1.82it/s]Queries for Place365 (rank 0):  81%|████████  | 34/42 [00:18<00:04,  1.82it/s]Queries for Place365 (rank 0):  83%|████████▎ | 35/42 [00:19<00:03,  1.82it/s]Queries for Place365 (rank 0):  86%|████████▌ | 36/42 [00:19<00:03,  1.82it/s]Queries for Place365 (rank 0):  88%|████████▊ | 37/42 [00:20<00:02,  1.82it/s]Queries for Place365 (rank 0):  90%|█████████ | 38/42 [00:21<00:02,  1.82it/s]Queries for Place365 (rank 0):  93%|█████████▎| 39/42 [00:21<00:01,  1.81it/s]Queries for Place365 (rank 0):  95%|█████████▌| 40/42 [00:22<00:01,  1.80it/s]Queries for Place365 (rank 0):  98%|█████████▊| 41/42 [00:22<00:00,  1.80it/s]Queries for Place365 (rank 0): 100%|██████████| 42/42 [00:23<00:00,  1.96it/s]Queries for Place365 (rank 0): 100%|██████████| 42/42 [00:23<00:00,  1.82it/s]
[2026-01-16 03:50:56,794] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Place365_qry
[2026-01-16 03:50:56,794] INFO [src.utils:21] Encoding candidates...
Candidates for Place365 (rank 0):   0%|          | 0/16 [00:00<?, ?it/s]Candidates for Place365 (rank 0):  12%|█▎        | 2/16 [00:00<00:01, 10.89it/s]Candidates for Place365 (rank 0):  25%|██▌       | 4/16 [00:00<00:01, 11.64it/s]Candidates for Place365 (rank 0):  38%|███▊      | 6/16 [00:00<00:00, 11.50it/s]Candidates for Place365 (rank 0):  50%|█████     | 8/16 [00:00<00:00, 11.79it/s]Candidates for Place365 (rank 0):  62%|██████▎   | 10/16 [00:00<00:00, 12.06it/s]Candidates for Place365 (rank 0):  75%|███████▌  | 12/16 [00:00<00:00, 12.41it/s]Candidates for Place365 (rank 0):  88%|████████▊ | 14/16 [00:01<00:00, 12.28it/s]Candidates for Place365 (rank 0): 100%|██████████| 16/16 [00:01<00:00, 12.47it/s]Candidates for Place365 (rank 0): 100%|██████████| 16/16 [00:01<00:00, 12.12it/s]
[2026-01-16 03:50:58,155] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Place365_tgt
[2026-01-16 03:50:58,155] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for Place365: 0it [00:00, ?it/s]Calculating scores for Place365: 72it [00:00, 714.65it/s]Calculating scores for Place365: 145it [00:00, 719.59it/s]Calculating scores for Place365: 218it [00:00, 721.97it/s]Calculating scores for Place365: 291it [00:00, 712.25it/s]Calculating scores for Place365: 365it [00:00, 719.86it/s]Calculating scores for Place365: 438it [00:00, 721.26it/s]Calculating scores for Place365: 511it [00:00, 718.26it/s]Calculating scores for Place365: 584it [00:00, 720.19it/s]Calculating scores for Place365: 657it [00:00, 720.93it/s]Calculating scores for Place365: 730it [00:01, 721.28it/s]Calculating scores for Place365: 803it [00:01, 717.02it/s]Calculating scores for Place365: 876it [00:01, 718.26it/s]Calculating scores for Place365: 950it [00:01, 722.35it/s]Calculating scores for Place365: 1000it [00:01, 719.09it/s]
[2026-01-16 03:50:59,852] INFO [src.utils:21] Score of Place365:
[2026-01-16 03:50:59,853] INFO [src.utils:21] {'hit@1': '0.2210', 'hit@5': '0.4720', 'hit@10': '0.5580', 'ndcg_linear@1': '0.2210', 'ndcg_linear@5': '0.3552', 'ndcg_linear@10': '0.3830', 'ndcg_exponential@1': '0.2210', 'ndcg_exponential@5': '0.3552', 'ndcg_exponential@10': '0.3830', 'precision@1': '0.2210', 'precision@5': '0.0944', 'precision@10': '0.0558', 'recall@1': '0.2210', 'recall@5': '0.4720', 'recall@10': '0.5580', 'f1@1': '0.2210', 'f1@5': '0.1573', 'f1@10': '0.1015', 'map@1': '0.2210', 'map@5': '0.3163', 'map@10': '0.3278', 'mrr@1': '0.2210', 'mrr@5': '0.3163', 'mrr@10': '0.3278'}
[2026-01-16 03:50:59,853] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Place365_score.json
[2026-01-16 03:50:59,948] INFO [src.utils:21] --- Evaluating Country211 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 446.09 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1017.52 examples/s]
[2026-01-16 03:51:02,793] INFO [src.utils:21] Encoding queries...
Queries for Country211 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for Country211 (rank 0):   2%|▏         | 1/42 [00:01<00:51,  1.25s/it]Queries for Country211 (rank 0):   5%|▍         | 2/42 [00:02<00:48,  1.22s/it]Queries for Country211 (rank 0):   7%|▋         | 3/42 [00:03<00:47,  1.22s/it]Queries for Country211 (rank 0):  10%|▉         | 4/42 [00:04<00:46,  1.22s/it]Queries for Country211 (rank 0):  12%|█▏        | 5/42 [00:06<00:44,  1.21s/it]Queries for Country211 (rank 0):  14%|█▍        | 6/42 [00:07<00:45,  1.27s/it]Queries for Country211 (rank 0):  17%|█▋        | 7/42 [00:08<00:46,  1.33s/it]Queries for Country211 (rank 0):  19%|█▉        | 8/42 [00:10<00:44,  1.30s/it]Queries for Country211 (rank 0):  21%|██▏       | 9/42 [00:11<00:41,  1.27s/it]Queries for Country211 (rank 0):  24%|██▍       | 10/42 [00:12<00:42,  1.33s/it]Queries for Country211 (rank 0):  26%|██▌       | 11/42 [00:14<00:42,  1.37s/it]Queries for Country211 (rank 0):  29%|██▊       | 12/42 [00:15<00:41,  1.39s/it]Queries for Country211 (rank 0):  31%|███       | 13/42 [00:16<00:38,  1.34s/it]Queries for Country211 (rank 0):  33%|███▎      | 14/42 [00:18<00:38,  1.37s/it]Queries for Country211 (rank 0):  36%|███▌      | 15/42 [00:19<00:35,  1.32s/it]Queries for Country211 (rank 0):  38%|███▊      | 16/42 [00:21<00:35,  1.36s/it]Queries for Country211 (rank 0):  40%|████      | 17/42 [00:22<00:34,  1.38s/it]Queries for Country211 (rank 0):  43%|████▎     | 18/42 [00:23<00:33,  1.40s/it]Queries for Country211 (rank 0):  45%|████▌     | 19/42 [00:25<00:31,  1.36s/it]Queries for Country211 (rank 0):  48%|████▊     | 20/42 [00:26<00:28,  1.31s/it]Queries for Country211 (rank 0):  50%|█████     | 21/42 [00:27<00:26,  1.28s/it]Queries for Country211 (rank 0):  52%|█████▏    | 22/42 [00:29<00:26,  1.32s/it]Queries for Country211 (rank 0):  55%|█████▍    | 23/42 [00:30<00:25,  1.36s/it]Queries for Country211 (rank 0):  57%|█████▋    | 24/42 [00:31<00:25,  1.39s/it]Queries for Country211 (rank 0):  60%|█████▉    | 25/42 [00:33<00:23,  1.40s/it]Queries for Country211 (rank 0):  62%|██████▏   | 26/42 [00:34<00:22,  1.41s/it]Queries for Country211 (rank 0):  64%|██████▍   | 27/42 [00:36<00:20,  1.38s/it]Queries for Country211 (rank 0):  67%|██████▋   | 28/42 [00:37<00:18,  1.33s/it]Queries for Country211 (rank 0):  69%|██████▉   | 29/42 [00:38<00:17,  1.37s/it]Queries for Country211 (rank 0):  71%|███████▏  | 30/42 [00:40<00:16,  1.36s/it]Queries for Country211 (rank 0):  74%|███████▍  | 31/42 [00:41<00:14,  1.33s/it]Queries for Country211 (rank 0):  76%|███████▌  | 32/42 [00:42<00:13,  1.36s/it]Queries for Country211 (rank 0):  79%|███████▊  | 33/42 [00:44<00:12,  1.39s/it]Queries for Country211 (rank 0):  81%|████████  | 34/42 [00:45<00:10,  1.35s/it]Queries for Country211 (rank 0):  83%|████████▎ | 35/42 [00:46<00:09,  1.36s/it]Queries for Country211 (rank 0):  86%|████████▌ | 36/42 [00:48<00:08,  1.46s/it]Queries for Country211 (rank 0):  88%|████████▊ | 37/42 [00:50<00:07,  1.46s/it]Queries for Country211 (rank 0):  90%|█████████ | 38/42 [00:51<00:05,  1.46s/it]Queries for Country211 (rank 0):  93%|█████████▎| 39/42 [00:52<00:04,  1.45s/it]Queries for Country211 (rank 0):  95%|█████████▌| 40/42 [00:54<00:02,  1.38s/it]Queries for Country211 (rank 0):  98%|█████████▊| 41/42 [00:55<00:01,  1.40s/it]Queries for Country211 (rank 0): 100%|██████████| 42/42 [00:56<00:00,  1.29s/it]Queries for Country211 (rank 0): 100%|██████████| 42/42 [00:56<00:00,  1.35s/it]
[2026-01-16 03:51:59,580] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Country211_qry
[2026-01-16 03:51:59,580] INFO [src.utils:21] Encoding candidates...
Candidates for Country211 (rank 0):   0%|          | 0/9 [00:00<?, ?it/s]Candidates for Country211 (rank 0):  11%|█         | 1/9 [00:00<00:00,  9.66it/s]Candidates for Country211 (rank 0):  33%|███▎      | 3/9 [00:00<00:00, 11.60it/s]Candidates for Country211 (rank 0):  56%|█████▌    | 5/9 [00:00<00:00, 12.07it/s]Candidates for Country211 (rank 0):  78%|███████▊  | 7/9 [00:00<00:00, 11.68it/s]Candidates for Country211 (rank 0): 100%|██████████| 9/9 [00:00<00:00, 12.07it/s]Candidates for Country211 (rank 0): 100%|██████████| 9/9 [00:00<00:00, 11.86it/s]
[2026-01-16 03:52:00,366] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Country211_tgt
[2026-01-16 03:52:00,366] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for Country211: 0it [00:00, ?it/s]Calculating scores for Country211: 142it [00:00, 1412.85it/s]Calculating scores for Country211: 284it [00:00, 1396.43it/s]Calculating scores for Country211: 428it [00:00, 1411.89it/s]Calculating scores for Country211: 570it [00:00, 1412.44it/s]Calculating scores for Country211: 713it [00:00, 1418.62it/s]Calculating scores for Country211: 855it [00:00, 1415.39it/s]Calculating scores for Country211: 997it [00:00, 1414.05it/s]Calculating scores for Country211: 1000it [00:00, 1412.60it/s]
[2026-01-16 03:52:01,244] INFO [src.utils:21] Score of Country211:
[2026-01-16 03:52:01,244] INFO [src.utils:21] {'hit@1': '0.0270', 'hit@5': '0.0760', 'hit@10': '0.1270', 'ndcg_linear@1': '0.0270', 'ndcg_linear@5': '0.0510', 'ndcg_linear@10': '0.0671', 'ndcg_exponential@1': '0.0270', 'ndcg_exponential@5': '0.0510', 'ndcg_exponential@10': '0.0671', 'precision@1': '0.0270', 'precision@5': '0.0152', 'precision@10': '0.0127', 'recall@1': '0.0270', 'recall@5': '0.0760', 'recall@10': '0.1270', 'f1@1': '0.0270', 'f1@5': '0.0253', 'f1@10': '0.0231', 'map@1': '0.0270', 'map@5': '0.0429', 'map@10': '0.0494', 'mrr@1': '0.0270', 'mrr@5': '0.0429', 'mrr@10': '0.0494'}
[2026-01-16 03:52:01,244] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/9Jan_Qwen3VL4b_rmv_14_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4000/retrieval/layer_-1/Country211_score.json

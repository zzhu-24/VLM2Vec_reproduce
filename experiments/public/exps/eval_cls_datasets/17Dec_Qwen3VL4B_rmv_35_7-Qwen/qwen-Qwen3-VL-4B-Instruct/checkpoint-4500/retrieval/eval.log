/home/infres/zzhu-24/anaconda3/envs/vlm2vec_update/lib/python3.10/site-packages/requests/__init__.py:86: RequestsDependencyWarning: Unable to find acceptable character detection dependency (chardet or charset_normalizer).
  warnings.warn(
[2026-01-16 03:08:50,365] INFO [src.utils:21] Distributed init debug info:
[2026-01-16 03:08:50,366] INFO [src.utils:21] RANK: None
[2026-01-16 03:08:50,366] INFO [src.utils:21] LOCAL_RANK: None
[2026-01-16 03:08:50,366] INFO [src.utils:21] WORLD_SIZE: None
[2026-01-16 03:08:50,366] INFO [src.utils:21] MASTER_ADDR: None
[2026-01-16 03:08:50,366] INFO [src.utils:21] MASTER_PORT: None
[2026-01-16 03:08:52,141] INFO [src.utils:21] Model Backbone: qwen3_vl
[2026-01-16 03:08:52,141] INFO [src.utils:21] Loading processor from: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/17Dec_Qwen3VL4B_rmv_35_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4500
[2026-01-16 03:08:54,010] INFO [src.utils:21] Loading backbone [qwen3_vl] from /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/17Dec_Qwen3VL4B_rmv_35_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4500
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 21.35it/s]
[2026-01-16 03:08:54,523] INFO [src.utils:21] Loading LoRA from /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/train/17Dec_Qwen3VL4B_rmv_35_7-Qwen/Qwen3-VL-4B-Instruct/checkpoint-4500
[2026-01-16 03:09:39,305] INFO [src.utils:21] [rank=0] Loading the model from Huggingface: Qwen/Qwen3-VL-4B-Instruct...
[2026-01-16 03:09:40,770] INFO [src.utils:21] --- Evaluating N24News ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 544.34 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1342.50 examples/s]
[2026-01-16 03:09:43,658] INFO [src.utils:21] Encoding queries...
Queries for N24News (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]You're using a Qwen2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Queries for N24News (rank 0):   2%|▏         | 1/42 [00:03<02:37,  3.85s/it]Queries for N24News (rank 0):   5%|▍         | 2/42 [00:07<02:25,  3.65s/it]Queries for N24News (rank 0):   7%|▋         | 3/42 [00:10<02:19,  3.58s/it]Queries for N24News (rank 0):  10%|▉         | 4/42 [00:14<02:19,  3.67s/it]Queries for N24News (rank 0):  12%|█▏        | 5/42 [00:18<02:15,  3.67s/it]Queries for N24News (rank 0):  14%|█▍        | 6/42 [00:21<02:10,  3.61s/it]Queries for N24News (rank 0):  17%|█▋        | 7/42 [00:25<02:05,  3.59s/it]Queries for N24News (rank 0):  19%|█▉        | 8/42 [00:29<02:04,  3.65s/it]Queries for N24News (rank 0):  21%|██▏       | 9/42 [00:32<01:59,  3.62s/it]Queries for N24News (rank 0):  24%|██▍       | 10/42 [00:36<01:55,  3.61s/it]Queries for N24News (rank 0):  26%|██▌       | 11/42 [00:39<01:51,  3.59s/it]Queries for N24News (rank 0):  29%|██▊       | 12/42 [00:43<01:45,  3.51s/it]Queries for N24News (rank 0):  31%|███       | 13/42 [00:46<01:41,  3.50s/it]Queries for N24News (rank 0):  33%|███▎      | 14/42 [00:50<01:38,  3.53s/it]Queries for N24News (rank 0):  36%|███▌      | 15/42 [00:53<01:34,  3.49s/it]Queries for N24News (rank 0):  38%|███▊      | 16/42 [00:57<01:30,  3.49s/it]Queries for N24News (rank 0):  40%|████      | 17/42 [01:00<01:26,  3.48s/it]Queries for N24News (rank 0):  43%|████▎     | 18/42 [01:04<01:23,  3.49s/it]Queries for N24News (rank 0):  45%|████▌     | 19/42 [01:07<01:19,  3.44s/it]Queries for N24News (rank 0):  48%|████▊     | 20/42 [01:10<01:16,  3.46s/it]Queries for N24News (rank 0):  50%|█████     | 21/42 [01:14<01:13,  3.52s/it]Queries for N24News (rank 0):  52%|█████▏    | 22/42 [01:18<01:10,  3.53s/it]Queries for N24News (rank 0):  55%|█████▍    | 23/42 [01:21<01:07,  3.53s/it]Queries for N24News (rank 0):  57%|█████▋    | 24/42 [01:25<01:03,  3.52s/it]Queries for N24News (rank 0):  60%|█████▉    | 25/42 [01:28<00:59,  3.51s/it]Queries for N24News (rank 0):  62%|██████▏   | 26/42 [01:32<00:56,  3.52s/it]Queries for N24News (rank 0):  64%|██████▍   | 27/42 [01:35<00:53,  3.57s/it]Queries for N24News (rank 0):  67%|██████▋   | 28/42 [01:39<00:49,  3.52s/it]Queries for N24News (rank 0):  69%|██████▉   | 29/42 [01:43<00:47,  3.64s/it]Queries for N24News (rank 0):  71%|███████▏  | 30/42 [01:46<00:43,  3.60s/it]Queries for N24News (rank 0):  74%|███████▍  | 31/42 [01:50<00:39,  3.62s/it]Queries for N24News (rank 0):  76%|███████▌  | 32/42 [01:53<00:35,  3.52s/it]Queries for N24News (rank 0):  79%|███████▊  | 33/42 [01:57<00:31,  3.51s/it]Queries for N24News (rank 0):  81%|████████  | 34/42 [02:00<00:27,  3.47s/it]Queries for N24News (rank 0):  83%|████████▎ | 35/42 [02:04<00:24,  3.47s/it]Queries for N24News (rank 0):  86%|████████▌ | 36/42 [02:07<00:20,  3.49s/it]Queries for N24News (rank 0):  88%|████████▊ | 37/42 [02:11<00:17,  3.49s/it]Queries for N24News (rank 0):  90%|█████████ | 38/42 [02:14<00:13,  3.48s/it]Queries for N24News (rank 0):  93%|█████████▎| 39/42 [02:18<00:10,  3.52s/it]Queries for N24News (rank 0):  95%|█████████▌| 40/42 [02:22<00:07,  3.85s/it]Queries for N24News (rank 0):  98%|█████████▊| 41/42 [02:26<00:03,  3.77s/it]Queries for N24News (rank 0): 100%|██████████| 42/42 [02:28<00:00,  3.36s/it]Queries for N24News (rank 0): 100%|██████████| 42/42 [02:28<00:00,  3.54s/it]
[2026-01-16 03:12:12,458] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/N24News_qry
[2026-01-16 03:12:12,459] INFO [src.utils:21] Encoding candidates...
Candidates for N24News (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for N24News (rank 0): 100%|██████████| 1/1 [00:00<00:00, 10.62it/s]
[2026-01-16 03:12:12,561] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/N24News_tgt
[2026-01-16 03:12:12,561] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for N24News: 0it [00:00, ?it/s]Calculating scores for N24News: 1000it [00:00, 10203.13it/s]
[2026-01-16 03:12:12,794] INFO [src.utils:21] Score of N24News:
[2026-01-16 03:12:12,794] INFO [src.utils:21] {'hit@1': '0.0210', 'hit@5': '0.1890', 'hit@10': '0.3920', 'ndcg_linear@1': '0.0210', 'ndcg_linear@5': '0.1040', 'ndcg_linear@10': '0.1685', 'ndcg_exponential@1': '0.0210', 'ndcg_exponential@5': '0.1040', 'ndcg_exponential@10': '0.1685', 'precision@1': '0.0210', 'precision@5': '0.0378', 'precision@10': '0.0392', 'recall@1': '0.0210', 'recall@5': '0.1890', 'recall@10': '0.3920', 'f1@1': '0.0210', 'f1@5': '0.0630', 'f1@10': '0.0713', 'map@1': '0.0210', 'map@5': '0.0765', 'map@10': '0.1024', 'mrr@1': '0.0210', 'mrr@5': '0.0765', 'mrr@10': '0.1024'}
[2026-01-16 03:12:12,794] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/N24News_score.json
[2026-01-16 03:12:12,803] INFO [src.utils:21] --- Evaluating HatefulMemes ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 491.79 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1164.13 examples/s]
[2026-01-16 03:12:15,096] INFO [src.utils:21] Encoding queries...
Queries for HatefulMemes (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for HatefulMemes (rank 0):   2%|▏         | 1/42 [00:02<01:46,  2.59s/it]Queries for HatefulMemes (rank 0):   5%|▍         | 2/42 [00:05<01:45,  2.63s/it]Queries for HatefulMemes (rank 0):   7%|▋         | 3/42 [00:07<01:42,  2.62s/it]Queries for HatefulMemes (rank 0):  10%|▉         | 4/42 [00:10<01:35,  2.51s/it]Queries for HatefulMemes (rank 0):  12%|█▏        | 5/42 [00:13<01:37,  2.63s/it]Queries for HatefulMemes (rank 0):  14%|█▍        | 6/42 [00:15<01:37,  2.72s/it]Queries for HatefulMemes (rank 0):  17%|█▋        | 7/42 [00:18<01:38,  2.81s/it]Queries for HatefulMemes (rank 0):  19%|█▉        | 8/42 [00:21<01:31,  2.69s/it]Queries for HatefulMemes (rank 0):  21%|██▏       | 9/42 [00:23<01:25,  2.60s/it]Queries for HatefulMemes (rank 0):  24%|██▍       | 10/42 [00:26<01:24,  2.63s/it]Queries for HatefulMemes (rank 0):  26%|██▌       | 11/42 [00:29<01:22,  2.66s/it]Queries for HatefulMemes (rank 0):  29%|██▊       | 12/42 [00:31<01:18,  2.62s/it]Queries for HatefulMemes (rank 0):  31%|███       | 13/42 [00:34<01:16,  2.62s/it]Queries for HatefulMemes (rank 0):  33%|███▎      | 14/42 [00:37<01:14,  2.67s/it]Queries for HatefulMemes (rank 0):  36%|███▌      | 15/42 [00:39<01:10,  2.60s/it]Queries for HatefulMemes (rank 0):  38%|███▊      | 16/42 [00:42<01:07,  2.58s/it]Queries for HatefulMemes (rank 0):  40%|████      | 17/42 [00:44<01:04,  2.58s/it]Queries for HatefulMemes (rank 0):  43%|████▎     | 18/42 [00:47<01:03,  2.64s/it]Queries for HatefulMemes (rank 0):  45%|████▌     | 19/42 [00:50<01:02,  2.71s/it]Queries for HatefulMemes (rank 0):  48%|████▊     | 20/42 [00:53<01:02,  2.85s/it]Queries for HatefulMemes (rank 0):  50%|█████     | 21/42 [00:56<00:59,  2.83s/it]Queries for HatefulMemes (rank 0):  52%|█████▏    | 22/42 [00:58<00:55,  2.79s/it]Queries for HatefulMemes (rank 0):  55%|█████▍    | 23/42 [01:01<00:53,  2.80s/it]Queries for HatefulMemes (rank 0):  57%|█████▋    | 24/42 [01:04<00:50,  2.82s/it]Queries for HatefulMemes (rank 0):  60%|█████▉    | 25/42 [01:07<00:48,  2.87s/it]Queries for HatefulMemes (rank 0):  62%|██████▏   | 26/42 [01:10<00:44,  2.78s/it]Queries for HatefulMemes (rank 0):  64%|██████▍   | 27/42 [01:12<00:41,  2.74s/it]Queries for HatefulMemes (rank 0):  67%|██████▋   | 28/42 [01:15<00:39,  2.80s/it]Queries for HatefulMemes (rank 0):  69%|██████▉   | 29/42 [01:18<00:35,  2.75s/it]Queries for HatefulMemes (rank 0):  71%|███████▏  | 30/42 [01:21<00:33,  2.75s/it]Queries for HatefulMemes (rank 0):  74%|███████▍  | 31/42 [01:23<00:30,  2.76s/it]Queries for HatefulMemes (rank 0):  76%|███████▌  | 32/42 [01:26<00:27,  2.74s/it]Queries for HatefulMemes (rank 0):  79%|███████▊  | 33/42 [01:29<00:24,  2.76s/it]Queries for HatefulMemes (rank 0):  81%|████████  | 34/42 [01:32<00:22,  2.77s/it]Queries for HatefulMemes (rank 0):  83%|████████▎ | 35/42 [01:35<00:20,  2.93s/it]Queries for HatefulMemes (rank 0):  86%|████████▌ | 36/42 [01:38<00:17,  2.87s/it]Queries for HatefulMemes (rank 0):  88%|████████▊ | 37/42 [01:40<00:13,  2.79s/it]Queries for HatefulMemes (rank 0):  90%|█████████ | 38/42 [01:44<00:11,  2.88s/it]Queries for HatefulMemes (rank 0):  93%|█████████▎| 39/42 [01:46<00:08,  2.75s/it]Queries for HatefulMemes (rank 0):  95%|█████████▌| 40/42 [01:50<00:06,  3.20s/it]Queries for HatefulMemes (rank 0):  98%|█████████▊| 41/42 [01:53<00:03,  3.03s/it]Queries for HatefulMemes (rank 0): 100%|██████████| 42/42 [01:55<00:00,  2.74s/it]Queries for HatefulMemes (rank 0): 100%|██████████| 42/42 [01:55<00:00,  2.75s/it]
[2026-01-16 03:14:10,625] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/HatefulMemes_qry
[2026-01-16 03:14:10,625] INFO [src.utils:21] Encoding candidates...
Candidates for HatefulMemes (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for HatefulMemes (rank 0): 100%|██████████| 1/1 [00:00<00:00, 13.97it/s]
[2026-01-16 03:14:10,702] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/HatefulMemes_tgt
[2026-01-16 03:14:10,703] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for HatefulMemes: 0it [00:00, ?it/s]Calculating scores for HatefulMemes: 1000it [00:00, 76023.71it/s]
[2026-01-16 03:14:10,786] INFO [src.utils:21] Score of HatefulMemes:
[2026-01-16 03:14:10,787] INFO [src.utils:21] {'hit@1': '0.4900', 'hit@5': '1.0000', 'hit@10': '1.0000', 'ndcg_linear@1': '0.4900', 'ndcg_linear@5': '0.8118', 'ndcg_linear@10': '0.8118', 'ndcg_exponential@1': '0.4900', 'ndcg_exponential@5': '0.8118', 'ndcg_exponential@10': '0.8118', 'precision@1': '0.4900', 'precision@5': '0.2000', 'precision@10': '0.1000', 'recall@1': '0.4900', 'recall@5': '1.0000', 'recall@10': '1.0000', 'f1@1': '0.4900', 'f1@5': '0.3333', 'f1@10': '0.1818', 'map@1': '0.4900', 'map@5': '0.7450', 'map@10': '0.7450', 'mrr@1': '0.4900', 'mrr@5': '0.7450', 'mrr@10': '0.7450'}
[2026-01-16 03:14:10,787] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/HatefulMemes_score.json
[2026-01-16 03:14:10,792] INFO [src.utils:21] --- Evaluating VOC2007 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 488.79 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1174.46 examples/s]
[2026-01-16 03:14:13,277] INFO [src.utils:21] Encoding queries...
Queries for VOC2007 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for VOC2007 (rank 0):   2%|▏         | 1/42 [00:00<00:31,  1.31it/s]Queries for VOC2007 (rank 0):   5%|▍         | 2/42 [00:01<00:29,  1.36it/s]Queries for VOC2007 (rank 0):   7%|▋         | 3/42 [00:02<00:28,  1.37it/s]Queries for VOC2007 (rank 0):  10%|▉         | 4/42 [00:02<00:25,  1.51it/s]Queries for VOC2007 (rank 0):  12%|█▏        | 5/42 [00:03<00:25,  1.46it/s]Queries for VOC2007 (rank 0):  14%|█▍        | 6/42 [00:04<00:23,  1.56it/s]Queries for VOC2007 (rank 0):  17%|█▋        | 7/42 [00:04<00:24,  1.43it/s]Queries for VOC2007 (rank 0):  19%|█▉        | 8/42 [00:05<00:23,  1.45it/s]Queries for VOC2007 (rank 0):  21%|██▏       | 9/42 [00:06<00:21,  1.52it/s]Queries for VOC2007 (rank 0):  24%|██▍       | 10/42 [00:06<00:20,  1.54it/s]Queries for VOC2007 (rank 0):  26%|██▌       | 11/42 [00:07<00:21,  1.41it/s]Queries for VOC2007 (rank 0):  29%|██▊       | 12/42 [00:08<00:22,  1.36it/s]Queries for VOC2007 (rank 0):  31%|███       | 13/42 [00:09<00:22,  1.32it/s]Queries for VOC2007 (rank 0):  33%|███▎      | 14/42 [00:09<00:20,  1.34it/s]Queries for VOC2007 (rank 0):  36%|███▌      | 15/42 [00:10<00:20,  1.35it/s]Queries for VOC2007 (rank 0):  38%|███▊      | 16/42 [00:11<00:19,  1.35it/s]Queries for VOC2007 (rank 0):  40%|████      | 17/42 [00:12<00:18,  1.34it/s]Queries for VOC2007 (rank 0):  43%|████▎     | 18/42 [00:13<00:18,  1.28it/s]Queries for VOC2007 (rank 0):  45%|████▌     | 19/42 [00:13<00:16,  1.38it/s]Queries for VOC2007 (rank 0):  48%|████▊     | 20/42 [00:14<00:15,  1.46it/s]Queries for VOC2007 (rank 0):  50%|█████     | 21/42 [00:14<00:14,  1.49it/s]Queries for VOC2007 (rank 0):  52%|█████▏    | 22/42 [00:15<00:13,  1.49it/s]Queries for VOC2007 (rank 0):  55%|█████▍    | 23/42 [00:16<00:13,  1.46it/s]Queries for VOC2007 (rank 0):  57%|█████▋    | 24/42 [00:16<00:12,  1.41it/s]Queries for VOC2007 (rank 0):  60%|█████▉    | 25/42 [00:17<00:12,  1.36it/s]Queries for VOC2007 (rank 0):  62%|██████▏   | 26/42 [00:18<00:12,  1.29it/s]Queries for VOC2007 (rank 0):  64%|██████▍   | 27/42 [00:19<00:11,  1.32it/s]Queries for VOC2007 (rank 0):  67%|██████▋   | 28/42 [00:20<00:10,  1.34it/s]Queries for VOC2007 (rank 0):  69%|██████▉   | 29/42 [00:20<00:10,  1.26it/s]Queries for VOC2007 (rank 0):  71%|███████▏  | 30/42 [00:21<00:09,  1.31it/s]Queries for VOC2007 (rank 0):  74%|███████▍  | 31/42 [00:22<00:08,  1.33it/s]Queries for VOC2007 (rank 0):  76%|███████▌  | 32/42 [00:23<00:07,  1.28it/s]Queries for VOC2007 (rank 0):  79%|███████▊  | 33/42 [00:24<00:07,  1.19it/s]Queries for VOC2007 (rank 0):  81%|████████  | 34/42 [00:24<00:06,  1.30it/s]Queries for VOC2007 (rank 0):  83%|████████▎ | 35/42 [00:25<00:05,  1.32it/s]Queries for VOC2007 (rank 0):  86%|████████▌ | 36/42 [00:26<00:04,  1.45it/s]Queries for VOC2007 (rank 0):  88%|████████▊ | 37/42 [00:26<00:03,  1.37it/s]Queries for VOC2007 (rank 0):  90%|█████████ | 38/42 [00:27<00:02,  1.35it/s]Queries for VOC2007 (rank 0):  93%|█████████▎| 39/42 [00:28<00:02,  1.43it/s]Queries for VOC2007 (rank 0):  95%|█████████▌| 40/42 [00:29<00:01,  1.35it/s]Queries for VOC2007 (rank 0):  98%|█████████▊| 41/42 [00:29<00:00,  1.30it/s]Queries for VOC2007 (rank 0): 100%|██████████| 42/42 [00:30<00:00,  1.45it/s]Queries for VOC2007 (rank 0): 100%|██████████| 42/42 [00:30<00:00,  1.38it/s]
[2026-01-16 03:14:43,849] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/VOC2007_qry
[2026-01-16 03:14:43,850] INFO [src.utils:21] Encoding candidates...
Candidates for VOC2007 (rank 0):   0%|          | 0/1 [00:00<?, ?it/s]Candidates for VOC2007 (rank 0): 100%|██████████| 1/1 [00:00<00:00, 12.30it/s]
[2026-01-16 03:14:43,938] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/VOC2007_tgt
[2026-01-16 03:14:43,938] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for VOC2007: 0it [00:00, ?it/s]Calculating scores for VOC2007: 1000it [00:00, 12760.09it/s]
[2026-01-16 03:14:44,153] INFO [src.utils:21] Score of VOC2007:
[2026-01-16 03:14:44,153] INFO [src.utils:21] {'hit@1': '0.0280', 'hit@5': '0.1430', 'hit@10': '0.3260', 'ndcg_linear@1': '0.0280', 'ndcg_linear@5': '0.0818', 'ndcg_linear@10': '0.1385', 'ndcg_exponential@1': '0.0280', 'ndcg_exponential@5': '0.0818', 'ndcg_exponential@10': '0.1385', 'precision@1': '0.0280', 'precision@5': '0.0286', 'precision@10': '0.0326', 'recall@1': '0.0280', 'recall@5': '0.1430', 'recall@10': '0.3260', 'f1@1': '0.0280', 'f1@5': '0.0477', 'f1@10': '0.0593', 'map@1': '0.0280', 'map@5': '0.0623', 'map@10': '0.0843', 'mrr@1': '0.0280', 'mrr@5': '0.0623', 'mrr@10': '0.0843'}
[2026-01-16 03:14:44,153] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/VOC2007_score.json
[2026-01-16 03:14:44,161] INFO [src.utils:21] --- Evaluating Place365 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 395.56 examples/s]          Map (num_proc=4): 2000 examples [00:00, 1580.80 examples/s]Map (num_proc=4): 2000 examples [00:01, 853.65 examples/s] 
[2026-01-16 03:14:47,525] INFO [src.utils:21] Encoding queries...
Queries for Place365 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for Place365 (rank 0):   2%|▏         | 1/42 [00:00<00:23,  1.75it/s]Queries for Place365 (rank 0):   5%|▍         | 2/42 [00:01<00:22,  1.78it/s]Queries for Place365 (rank 0):   7%|▋         | 3/42 [00:01<00:21,  1.80it/s]Queries for Place365 (rank 0):  10%|▉         | 4/42 [00:02<00:21,  1.80it/s]Queries for Place365 (rank 0):  12%|█▏        | 5/42 [00:02<00:20,  1.81it/s]Queries for Place365 (rank 0):  14%|█▍        | 6/42 [00:03<00:19,  1.81it/s]Queries for Place365 (rank 0):  17%|█▋        | 7/42 [00:03<00:19,  1.80it/s]Queries for Place365 (rank 0):  19%|█▉        | 8/42 [00:04<00:18,  1.81it/s]Queries for Place365 (rank 0):  21%|██▏       | 9/42 [00:04<00:18,  1.81it/s]Queries for Place365 (rank 0):  24%|██▍       | 10/42 [00:05<00:17,  1.78it/s]Queries for Place365 (rank 0):  26%|██▌       | 11/42 [00:06<00:17,  1.79it/s]Queries for Place365 (rank 0):  29%|██▊       | 12/42 [00:06<00:16,  1.81it/s]Queries for Place365 (rank 0):  31%|███       | 13/42 [00:07<00:15,  1.81it/s]Queries for Place365 (rank 0):  33%|███▎      | 14/42 [00:07<00:15,  1.82it/s]Queries for Place365 (rank 0):  36%|███▌      | 15/42 [00:08<00:14,  1.82it/s]Queries for Place365 (rank 0):  38%|███▊      | 16/42 [00:08<00:14,  1.83it/s]Queries for Place365 (rank 0):  40%|████      | 17/42 [00:09<00:13,  1.83it/s]Queries for Place365 (rank 0):  43%|████▎     | 18/42 [00:09<00:13,  1.83it/s]Queries for Place365 (rank 0):  45%|████▌     | 19/42 [00:10<00:12,  1.83it/s]Queries for Place365 (rank 0):  48%|████▊     | 20/42 [00:11<00:12,  1.83it/s]Queries for Place365 (rank 0):  50%|█████     | 21/42 [00:11<00:11,  1.79it/s]Queries for Place365 (rank 0):  52%|█████▏    | 22/42 [00:12<00:11,  1.80it/s]Queries for Place365 (rank 0):  55%|█████▍    | 23/42 [00:12<00:10,  1.81it/s]Queries for Place365 (rank 0):  57%|█████▋    | 24/42 [00:13<00:09,  1.81it/s]Queries for Place365 (rank 0):  60%|█████▉    | 25/42 [00:13<00:09,  1.81it/s]Queries for Place365 (rank 0):  62%|██████▏   | 26/42 [00:14<00:08,  1.81it/s]Queries for Place365 (rank 0):  64%|██████▍   | 27/42 [00:14<00:08,  1.76it/s]Queries for Place365 (rank 0):  67%|██████▋   | 28/42 [00:15<00:07,  1.78it/s]Queries for Place365 (rank 0):  69%|██████▉   | 29/42 [00:16<00:07,  1.79it/s]Queries for Place365 (rank 0):  71%|███████▏  | 30/42 [00:16<00:06,  1.80it/s]Queries for Place365 (rank 0):  74%|███████▍  | 31/42 [00:17<00:06,  1.81it/s]Queries for Place365 (rank 0):  76%|███████▌  | 32/42 [00:17<00:05,  1.80it/s]Queries for Place365 (rank 0):  79%|███████▊  | 33/42 [00:18<00:04,  1.81it/s]Queries for Place365 (rank 0):  81%|████████  | 34/42 [00:18<00:04,  1.81it/s]Queries for Place365 (rank 0):  83%|████████▎ | 35/42 [00:19<00:03,  1.81it/s]Queries for Place365 (rank 0):  86%|████████▌ | 36/42 [00:19<00:03,  1.81it/s]Queries for Place365 (rank 0):  88%|████████▊ | 37/42 [00:20<00:02,  1.81it/s]Queries for Place365 (rank 0):  90%|█████████ | 38/42 [00:21<00:02,  1.82it/s]Queries for Place365 (rank 0):  93%|█████████▎| 39/42 [00:21<00:01,  1.81it/s]Queries for Place365 (rank 0):  95%|█████████▌| 40/42 [00:22<00:01,  1.81it/s]Queries for Place365 (rank 0):  98%|█████████▊| 41/42 [00:22<00:00,  1.81it/s]Queries for Place365 (rank 0): 100%|██████████| 42/42 [00:23<00:00,  1.97it/s]Queries for Place365 (rank 0): 100%|██████████| 42/42 [00:23<00:00,  1.82it/s]
[2026-01-16 03:15:10,811] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/Place365_qry
[2026-01-16 03:15:10,812] INFO [src.utils:21] Encoding candidates...
Candidates for Place365 (rank 0):   0%|          | 0/16 [00:00<?, ?it/s]Candidates for Place365 (rank 0):  12%|█▎        | 2/16 [00:00<00:01, 10.65it/s]Candidates for Place365 (rank 0):  25%|██▌       | 4/16 [00:00<00:01, 11.39it/s]Candidates for Place365 (rank 0):  38%|███▊      | 6/16 [00:00<00:00, 11.39it/s]Candidates for Place365 (rank 0):  50%|█████     | 8/16 [00:00<00:00, 11.83it/s]Candidates for Place365 (rank 0):  62%|██████▎   | 10/16 [00:00<00:00, 12.11it/s]Candidates for Place365 (rank 0):  75%|███████▌  | 12/16 [00:00<00:00, 12.52it/s]Candidates for Place365 (rank 0):  88%|████████▊ | 14/16 [00:01<00:00, 12.53it/s]Candidates for Place365 (rank 0): 100%|██████████| 16/16 [00:01<00:00, 12.76it/s]Candidates for Place365 (rank 0): 100%|██████████| 16/16 [00:01<00:00, 12.24it/s]
[2026-01-16 03:15:12,160] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/Place365_tgt
[2026-01-16 03:15:12,161] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for Place365: 0it [00:00, ?it/s]Calculating scores for Place365: 73it [00:00, 721.01it/s]Calculating scores for Place365: 147it [00:00, 728.73it/s]Calculating scores for Place365: 220it [00:00, 727.84it/s]Calculating scores for Place365: 293it [00:00, 714.43it/s]Calculating scores for Place365: 366it [00:00, 718.55it/s]Calculating scores for Place365: 439it [00:00, 721.33it/s]Calculating scores for Place365: 512it [00:00, 717.92it/s]Calculating scores for Place365: 585it [00:00, 720.29it/s]Calculating scores for Place365: 660it [00:00, 728.99it/s]Calculating scores for Place365: 733it [00:01, 727.65it/s]Calculating scores for Place365: 806it [00:01, 722.56it/s]Calculating scores for Place365: 880it [00:01, 724.81it/s]Calculating scores for Place365: 953it [00:01, 725.02it/s]Calculating scores for Place365: 1000it [00:01, 722.89it/s]
[2026-01-16 03:15:13,756] INFO [src.utils:21] Score of Place365:
[2026-01-16 03:15:13,756] INFO [src.utils:21] {'hit@1': '0.0060', 'hit@5': '0.0260', 'hit@10': '0.0380', 'ndcg_linear@1': '0.0060', 'ndcg_linear@5': '0.0156', 'ndcg_linear@10': '0.0195', 'ndcg_exponential@1': '0.0060', 'ndcg_exponential@5': '0.0156', 'ndcg_exponential@10': '0.0195', 'precision@1': '0.0060', 'precision@5': '0.0052', 'precision@10': '0.0038', 'recall@1': '0.0060', 'recall@5': '0.0260', 'recall@10': '0.0380', 'f1@1': '0.0060', 'f1@5': '0.0087', 'f1@10': '0.0069', 'map@1': '0.0060', 'map@5': '0.0122', 'map@10': '0.0139', 'mrr@1': '0.0060', 'mrr@5': '0.0122', 'mrr@10': '0.0139'}
[2026-01-16 03:15:13,756] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/Place365_score.json
[2026-01-16 03:15:13,853] INFO [src.utils:21] --- Evaluating Country211 ---
Map (num_proc=4): 100%|██████████| 1000/1000 [00:00<?, ? examples/s]Map (num_proc=4): 1250 examples [00:00, 432.29 examples/s]          Map (num_proc=4): 2000 examples [00:01, 970.39 examples/s]
[2026-01-16 03:15:16,781] INFO [src.utils:21] Encoding queries...
Queries for Country211 (rank 0):   0%|          | 0/42 [00:00<?, ?it/s]Queries for Country211 (rank 0):   2%|▏         | 1/42 [00:01<00:52,  1.27s/it]Queries for Country211 (rank 0):   5%|▍         | 2/42 [00:02<00:51,  1.28s/it]Queries for Country211 (rank 0):   7%|▋         | 3/42 [00:03<00:48,  1.26s/it]Queries for Country211 (rank 0):  10%|▉         | 4/42 [00:05<00:47,  1.24s/it]Queries for Country211 (rank 0):  12%|█▏        | 5/42 [00:06<00:45,  1.23s/it]Queries for Country211 (rank 0):  14%|█▍        | 6/42 [00:07<00:45,  1.28s/it]Queries for Country211 (rank 0):  17%|█▋        | 7/42 [00:09<00:46,  1.34s/it]Queries for Country211 (rank 0):  19%|█▉        | 8/42 [00:10<00:44,  1.30s/it]Queries for Country211 (rank 0):  21%|██▏       | 9/42 [00:11<00:42,  1.28s/it]Queries for Country211 (rank 0):  24%|██▍       | 10/42 [00:12<00:42,  1.34s/it]Queries for Country211 (rank 0):  26%|██▌       | 11/42 [00:14<00:42,  1.37s/it]Queries for Country211 (rank 0):  29%|██▊       | 12/42 [00:15<00:41,  1.39s/it]Queries for Country211 (rank 0):  31%|███       | 13/42 [00:17<00:39,  1.35s/it]Queries for Country211 (rank 0):  33%|███▎      | 14/42 [00:18<00:38,  1.38s/it]Queries for Country211 (rank 0):  36%|███▌      | 15/42 [00:19<00:35,  1.33s/it]Queries for Country211 (rank 0):  38%|███▊      | 16/42 [00:21<00:35,  1.37s/it]Queries for Country211 (rank 0):  40%|████      | 17/42 [00:22<00:34,  1.39s/it]Queries for Country211 (rank 0):  43%|████▎     | 18/42 [00:24<00:33,  1.41s/it]Queries for Country211 (rank 0):  45%|████▌     | 19/42 [00:25<00:31,  1.36s/it]Queries for Country211 (rank 0):  48%|████▊     | 20/42 [00:26<00:29,  1.32s/it]Queries for Country211 (rank 0):  50%|█████     | 21/42 [00:27<00:26,  1.29s/it]Queries for Country211 (rank 0):  52%|█████▏    | 22/42 [00:29<00:26,  1.33s/it]Queries for Country211 (rank 0):  55%|█████▍    | 23/42 [00:30<00:25,  1.36s/it]Queries for Country211 (rank 0):  57%|█████▋    | 24/42 [00:32<00:24,  1.39s/it]Queries for Country211 (rank 0):  60%|█████▉    | 25/42 [00:33<00:23,  1.40s/it]Queries for Country211 (rank 0):  62%|██████▏   | 26/42 [00:34<00:22,  1.41s/it]Queries for Country211 (rank 0):  64%|██████▍   | 27/42 [00:36<00:20,  1.38s/it]Queries for Country211 (rank 0):  67%|██████▋   | 28/42 [00:37<00:18,  1.33s/it]Queries for Country211 (rank 0):  69%|██████▉   | 29/42 [00:38<00:17,  1.36s/it]Queries for Country211 (rank 0):  71%|███████▏  | 30/42 [00:40<00:16,  1.36s/it]Queries for Country211 (rank 0):  74%|███████▍  | 31/42 [00:41<00:14,  1.32s/it]Queries for Country211 (rank 0):  76%|███████▌  | 32/42 [00:42<00:13,  1.35s/it]Queries for Country211 (rank 0):  79%|███████▊  | 33/42 [00:44<00:12,  1.39s/it]Queries for Country211 (rank 0):  81%|████████  | 34/42 [00:45<00:10,  1.35s/it]Queries for Country211 (rank 0):  83%|████████▎ | 35/42 [00:47<00:09,  1.37s/it]Queries for Country211 (rank 0):  86%|████████▌ | 36/42 [00:48<00:08,  1.45s/it]Queries for Country211 (rank 0):  88%|████████▊ | 37/42 [00:50<00:07,  1.46s/it]Queries for Country211 (rank 0):  90%|█████████ | 38/42 [00:51<00:05,  1.46s/it]Queries for Country211 (rank 0):  93%|█████████▎| 39/42 [00:53<00:04,  1.45s/it]Queries for Country211 (rank 0):  95%|█████████▌| 40/42 [00:54<00:02,  1.38s/it]Queries for Country211 (rank 0):  98%|█████████▊| 41/42 [00:55<00:01,  1.40s/it]Queries for Country211 (rank 0): 100%|██████████| 42/42 [00:56<00:00,  1.29s/it]Queries for Country211 (rank 0): 100%|██████████| 42/42 [00:56<00:00,  1.35s/it]
[2026-01-16 03:16:13,688] INFO [src.utils:21] Saved query embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/Country211_qry
[2026-01-16 03:16:13,688] INFO [src.utils:21] Encoding candidates...
Candidates for Country211 (rank 0):   0%|          | 0/9 [00:00<?, ?it/s]Candidates for Country211 (rank 0):  22%|██▏       | 2/9 [00:00<00:00, 11.28it/s]Candidates for Country211 (rank 0):  44%|████▍     | 4/9 [00:00<00:00, 12.49it/s]Candidates for Country211 (rank 0):  67%|██████▋   | 6/9 [00:00<00:00, 11.58it/s]Candidates for Country211 (rank 0):  89%|████████▉ | 8/9 [00:00<00:00, 12.28it/s]Candidates for Country211 (rank 0): 100%|██████████| 9/9 [00:00<00:00, 12.11it/s]
[2026-01-16 03:16:14,457] INFO [src.utils:21] Saved candidate embeddings to /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/Country211_tgt
[2026-01-16 03:16:14,457] INFO [src.utils:21] --- Scoring for layer -1 ---
Calculating scores for Country211: 0it [00:00, ?it/s]Calculating scores for Country211: 143it [00:00, 1426.41it/s]Calculating scores for Country211: 286it [00:00, 1405.90it/s]Calculating scores for Country211: 430it [00:00, 1417.93it/s]Calculating scores for Country211: 572it [00:00, 1416.18it/s]Calculating scores for Country211: 716it [00:00, 1422.98it/s]Calculating scores for Country211: 859it [00:00, 1421.43it/s]Calculating scores for Country211: 1000it [00:00, 1419.10it/s]
[2026-01-16 03:16:15,331] INFO [src.utils:21] Score of Country211:
[2026-01-16 03:16:15,331] INFO [src.utils:21] {'hit@1': '0.0040', 'hit@5': '0.0310', 'hit@10': '0.0490', 'ndcg_linear@1': '0.0040', 'ndcg_linear@5': '0.0177', 'ndcg_linear@10': '0.0233', 'ndcg_exponential@1': '0.0040', 'ndcg_exponential@5': '0.0177', 'ndcg_exponential@10': '0.0233', 'precision@1': '0.0040', 'precision@5': '0.0062', 'precision@10': '0.0049', 'recall@1': '0.0040', 'recall@5': '0.0310', 'recall@10': '0.0490', 'f1@1': '0.0040', 'f1@5': '0.0103', 'f1@10': '0.0089', 'map@1': '0.0040', 'map@5': '0.0134', 'map@10': '0.0155', 'mrr@1': '0.0040', 'mrr@5': '0.0134', 'mrr@10': '0.0155'}
[2026-01-16 03:16:15,331] INFO [src.utils:21] Outputting final score to: /home/infres/zzhu-24/PRIM/VLM2Vec/experiments/public/exps/eval_cls_datasets/17Dec_Qwen3VL4B_rmv_35_7-Qwen/qwen-Qwen3-VL-4B-Instruct/checkpoint-4500/retrieval/layer_-1/Country211_score.json
